nohup: ignoring input
./temp/fl_acc_cifar100_resnet34_cons_frac0.2_iidFalse_iter2500_ep1_lr0.03_N20_100_seed3407_p1_dirichlet0.5_IF0.01_LossCE.txt
Files already downloaded and verified
[500, 477, 455, 434, 415, 396, 378, 361, 344, 328, 314, 299, 286, 273, 260, 248, 237, 226, 216, 206, 197, 188, 179, 171, 163, 156, 149, 142, 135, 129, 123, 118, 112, 107, 102, 98, 93, 89, 85, 81, 77, 74, 70, 67, 64, 61, 58, 56, 53, 51, 48, 46, 44, 42, 40, 38, 36, 35, 33, 32, 30, 29, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 15, 14, 13, 13, 12, 12, 11, 11, 10, 10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5]
10847
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[573, 766, 469, 733, 726, 766, 466, 320, 676, 410, 554, 546, 535, 512, 586, 396, 460, 448, 431, 474]
training set distribution:
[[  8   5  18   0  32  55  32   1  64   2   4  41   7   3  47  19   2   3
    0   6   0   3   5  14   6   4   9  50   0  11   3   0   2   0  38  12
   11   1  19   0   1   0   0   0   1  10   0   0   3   0   0   0   0   0
    1   0   2   2   0   0   1   0   2   0   2   4   0   0   0   0   0   0
    0   0   1   0   0   1   0   0   0   0   2   0   0   0   1   0   0   0
    0   0   0   0   0   1   1   0   0   0]
 [ 99   7  26  25  22   2  54  80   2  28  22  33   7  19 105   0   1   3
    4  13   2  26   9   3   0   4   4   4  37   0  18   1   2   6   5  16
    4   0  15  13   1   0   0   0   3   2   0   0   0   0   2   2   3   9
    1   0   2   0   2   1   0   0   3   0   0   0   0   0   0   7   0   0
    0   0   0   0   0   0   0   0   0   0   0   1   0   2   1   0   0   0
    0   2   0   1   0   0   0   0   0   0]
 [ 14  60   9  13   3  40   0   8   0   6  24  11  75  13  14   6  11   2
    2   7   0   0   0   0   0  10   0   4   0   3   7  10  11   3   5   0
    8   6   1   0   1   8   1   1   5   0   5   2   4   8   0   1   3   0
    2   1   1   1   3   3   2   2   0   0   0   0   0   0   0   0   2   0
    0   1   4   0   6   1   0   0   4   0   3   0   3   0   1   0   1   2
    0   0   0   0   0   0   0   1   0   0]
 [ 23  89  56   2  47   1   7   8  48  33   0  49   1  29   5  32   2  17
   76   5  13  10   0  12   0   0   2   0   9  19  16   2   0  18   2   0
    6   0   0   2   2   1  26   5  10   2   0   1   0   0   4   1   0   1
    1   0   0   0   0   1   3   0   0   8   3   2   0   1   3   0   1   0
    0   4   0   0   0   0   0   0   0   0   0   1   0   1   0   1   3   0
    3   0   1   0   2   0   0   0   0   0]
 [  9  95  66   3  48   7  41  15  36  24  65   1   2   1   0   2   4   8
    0   6  29   0   2  53   7   2  24  19  10  14   0   3   0  25   2   5
    0  30   3   0   4   0   4   7   7   4   0   0   8   4   3   1   0   0
    2   0   0   4   0   0   0   0   1   0   4   0   0   0   0   0   1   3
    1   0   0   1   0   0   2   1   0   0   1   0   0   0   1   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 22  45  14  67   2   2  54  10  18  22  47  12  10  71  16   1  52   4
    7   1  31  36  16   8  25  30   7   0   8   0   3   0   6   6   6  27
    0   0   0   0   4   0   0   0   2   5   4   5   9   1   5   3   3   0
    1   0   6  14   1   1   0   0   1   0   1   3   0   0   0   0   0   4
    1   2   0   0   0   1   0   1   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [  5   0   1  11  50   1  31  30  22  10   1   1   8   4   2   0   2   6
   31   0  15  46   1   7   9   1  18   0   0  10   5   0   7   2  24   2
    6   2   5  18   4   3   3   0   0   0   2   4   3   8   0   3   1   1
    0   2   4   3   0   0   0   6   0   2   0   2   0   2   0   2   3   0
    0   0   0   0   0   2   1   3   0   0   0   0   0   0   1   0   3   0
    0   0   0   2   0   0   1   0   0   1]
 [  0  19   5  26  11  14   5  14   2  11   1  12  20   2   7   6   0   0
    3   0  21   0   3   0   1   1  14   0   2  12   1   9   3   0   4   6
    1   1   5   0   2  10   1   4   1   2   6   0   2   2   1   4   3   1
    0  16   3   0   0   0   1   0   1   1   0   1   0   3   2   0   1   0
    0   1   1   2   0   1   1   2   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [ 44  21  72  58  46  20   1   1  52   0  37  46  14   5  10  11  17   8
    1   1   1   1   8  16  15  40   0   0   0  12   1  10   1   0   0   3
    9   0   5   3   6   5   6   2   7   0   0   5   0   0   2   1   0   0
    7  11   3   0   1   1   2   0   0   0   3   0   4   0   0   1   5   0
    1   0   0   0   0   0   1   0   2   1   0   0   0   0   2   2   0   1
    0   1   0   0   0   0   1   0   0   2]
 [  0  16   3   2  33  70   1  22   1   5  45   9   5   6   3   7   0  14
    7   5   8   5   2   0   1   4   2   5   0   0   1  12   1   7   0   2
    1   2  15  18   0   2   0   0   7  10   3   0   1   2   2   0   5   0
    1   0   7   0   2   0   0   1   0   0   0   0   1   0   0   0   3   1
    0   3   0   3   1   0   0   0   0   0   3   0   2   2   0   2   0   1
    0   1   0   1   0   1   0   0   0   2]
 [  0   0   0  28  16   3  89  14  43   6   9   7   0  12   0   2  62   0
    8  74   2   2   0  26   2   1   8   2   6   0   1   0   2   2   1   2
    5   1   1   0   8   2   0   1   4   7   0  18   0   2   1   0   0  13
    4   0   4   1   0   3   3   0   0   3   3   0   8   0   2   1   0   0
    9   1   2   3   0   1   4   0   1   0   0   1   0   2   0   0   0   0
    0   0   1   0   1   1   0   0   2   0]
 [ 90   0  30  51   5   0   4   3   1   5   1   1   8  11  23  84   0  23
    4   6   0   2   9   0   0   3   0   7   7  17   5   2  21   5   0   3
    0   2   0   2   0   0   0  10   0   1  13   3   0   7   1   2   3   1
    5   0   0   0   6   3   1   1   3   0   5  11   0  12   0   1   0   4
    1   0   4   0   0   0   0   0   1   0   0   3   0   0   0   1   0   1
    2   0   0   0   0   1   1   1   2   0]
 [  9  41   0  22   1  13   6   1   0  53  13   6  47  19   4   2   2  13
   10  15   3   0   0   0  67   8   7   2  37   0  35   0   0  11   0   4
    4   1   2   0   0   8   3   4   2   0   0   0   3   0   5   3   2   8
    5   1   0   5   1   0   1   0   3   0   2   0   0   0   7   0   0   2
    0   0   0   1   3   0   1   0   2   0   1   0   1   0   0   0   0   0
    0   1   0   0   1   0   1   0   0   0]
 [ 14  17   3  80   2  97  18   3   0  17   3   1  13  20   0   1   3   6
    0   0   1  24  40   6   2   1   2   8   0   7   5   1   0   2   1   0
    1   0   5   1  12   4   0  19   6   4   1   5   0   8   0   6   6   0
    2   3   0   0   1   5   0   1   1   6   0   0   0   0   0   1   1   2
    0   0   0   1   3   0   0   2   0   3   0   2   1   0   0   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 30  43   0  19   2   1  17 114   1  68   2   0   6   2   4   9   7  28
    0  11   2   0   7   2  11  12   5  14   9  12   3   2  10   7   0   2
    8   2   0   6  14   4   1   0   0   0  13   1   4   0   8   5   4   0
    6   0   0   4   0   0   2   7   7   2   0   1   2   0   2   3   0   2
    1   0   0   1   0   1   0   2   1   1   0   0   2   2   2   0   0   1
    0   0   0   0   0   1   0   0   1   0]
 [  3   5  43   6  25   7   1  18   0   8   2   2   7   0   0   1   0   0
   37  11   7   0   6   1   3   0  19   0   0   8   0  35  25   0   1  10
    4   0   1  11   6   0   0   4   4   8   5   0  11   9   2   3   0   2
    0   1   1   0   2   2   8   0   4   1   0   0   0   3   1   1   1   0
    0   2   1   2   0   1   0   0   0   3   0   0   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   0   0]
 [ 19   2  21  13   2   0   8  10   1   3  15  15   4  12  17  10  27  40
    1   2   6   1  62  18   2  11  21   7   6   1   0   1   1   1   2   4
   24  15   1   0   2   0   4   1   0   0   2  10   0   0   1   3   4   5
    0   3   0   0   0   0   0   3   0   0   1   0   2   0   0   0   0   0
    0   0   1   0   1   2   3   1   0   0   0   1   1   0   0   0   0   0
    0   1   0   0   2   0   0   0   0   0]
 [  7   5   3   5  21  54   9   0  10   9  20  45  36  35   3  12  23   8
    1   7   0  24   0   4   6  20   6  10   1   0   0   2   0   0   5   0
    0  22   0   6   1   0   0   1   0   0   4   0   3   0   1   0   1   0
    0   0   0   1   0   0   0   6   0   0   1   0   0   0   0   0   0   0
    1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   1
    1   1   1   1   0   0   0   1   0   0]
 [ 87   7  18   0  21   1   0   8   3   2   0   1   6   7   0  10   3  41
    4  35   2   7   7   0   1   2   0  10   3   1  17   2  20   0   0   0
    1   3   0   0   5  20  20   1   5   2   0   2   0   0   9   3   1   1
    2   0   1   0   1  11   1   1   0   3   0   0   3   1   0   3   1   0
    0   1   1   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   1   0   0   0   0]
 [ 17   0  67   3  26   8   0   1  40  16   3   6  10   2   0  33  19   2
   20   1  54   1   2   1   5   2   1   0   0   2   2  26   0  12   6   0
    0   1   7   1   4   7   1   7   0   4   0   0   2   0   1   5   5   0
    0   0   2   0  13   1   5   1   1   0   0   0   3   0   4   0   0   0
    2   0   0   1   0   1   0   0   0   3   0   1   0   0   0   1   0   0
    0   0   1   1   0   0   0   0   0   0]]
Total size of training set
10847
local test distribution:
[[  7   4  16   0  29  50  29   0  59   1   3  37   6   2  43  17   1   2
    0   5   0   2   4  12   5   3   8  46   0  10   2   0   1   0  35  11
   10   0  17   0   0   0   0   0   0   9   0   0   2   0   0   0   0   0
    0   0   1   1   0   0   0   0   1   0   1   3   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 91   6  23  23  20   1  49  73   1  25  20  30   6  17  96   0   0   2
    3  11   1  23   8   2   0   3   3   3  34   0  16   0   1   5   4  14
    3   0  13  11   0   0   0   0   2   1   0   0   0   0   1   1   2   8
    0   0   1   0   1   0   0   0   2   0   0   0   0   0   0   6   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0
    0   1   0   0   0   0   0   0   0   0]
 [ 12  55   8  11   2  36   0   7   0   5  22  10  69  11  12   5  10   1
    1   6   0   0   0   0   0   9   0   3   0   2   6   9  10   2   4   0
    7   5   0   0   0   7   0   0   4   0   4   1   3   7   0   0   2   0
    1   0   0   0   2   2   1   1   0   0   0   0   0   0   0   0   1   0
    0   0   3   0   5   0   0   0   3   0   2   0   2   0   0   0   0   1
    0   0   0   0   0   0   0   0   0   0]
 [ 21  82  51   1  43   0   6   7  44  30   0  45   0  26   4  29   1  15
   70   4  11   9   0  11   0   0   1   0   8  17  14   1   0  16   1   0
    5   0   0   1   1   0  23   4   9   1   0   0   0   0   3   0   0   0
    0   0   0   0   0   0   2   0   0   7   2   1   0   0   2   0   0   0
    0   3   0   0   0   0   0   0   0   0   0   0   0   0   0   0   2   0
    2   0   0   0   1   0   0   0   0   0]
 [  8  87  60   2  44   6  37  13  33  22  59   0   1   0   0   1   3   7
    0   5  26   0   1  48   6   1  22  17   9  12   0   2   0  23   1   4
    0  27   2   0   3   0   3   6   6   3   0   0   7   3   2   0   0   0
    1   0   0   3   0   0   0   0   0   0   3   0   0   0   0   0   0   2
    0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 20  41  12  61   1   1  49   9  16  20  43  11   9  65  14   0  47   3
    6   0  28  33  14   7  23  27   6   0   7   0   2   0   5   5   5  24
    0   0   0   0   3   0   0   0   1   4   3   4   8   0   4   2   2   0
    0   0   5  12   0   0   0   0   0   0   0   2   0   0   0   0   0   3
    0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  4   0   0  10  46   0  28  27  20   9   0   0   7   3   1   0   1   5
   28   0  13  42   0   6   8   0  16   0   0   9   4   0   6   1  22   1
    5   1   4  16   3   2   2   0   0   0   1   3   2   7   0   2   0   0
    0   1   3   2   0   0   0   5   0   1   0   1   0   1   0   1   2   0
    0   0   0   0   0   1   0   2   0   0   0   0   0   0   0   0   2   0
    0   0   0   1   0   0   0   0   0   0]
 [  0  17   4  23  10  12   4  12   1  10   0  11  18   1   6   5   0   0
    2   0  19   0   2   0   0   0  12   0   1  11   0   8   2   0   3   5
    0   0   4   0   1   9   0   3   0   1   5   0   1   1   0   3   2   0
    0  14   2   0   0   0   0   0   0   0   0   0   0   2   1   0   0   0
    0   0   0   1   0   0   0   1   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 40  19  66  53  42  18   0   0  47   0  34  42  12   4   9  10  15   7
    0   0   0   0   7  14  13  36   0   0   0  11   0   9   0   0   0   2
    8   0   4   2   5   4   5   1   6   0   0   4   0   0   1   0   0   0
    6  10   2   0   0   0   1   0   0   0   2   0   3   0   0   0   4   0
    0   0   0   0   0   0   0   0   1   0   0   0   0   0   1   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0  14   2   1  30  64   0  20   0   4  41   8   4   5   2   6   0  12
    6   4   7   4   1   0   0   3   1   4   0   0   0  11   0   6   0   1
    0   1  13  16   0   1   0   0   6   9   2   0   0   1   1   0   4   0
    0   0   6   0   1   0   0   0   0   0   0   0   0   0   0   0   2   0
    0   2   0   2   0   0   0   0   0   0   2   0   1   1   0   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0   0   0  25  14   2  82  12  39   5   8   6   0  11   0   1  57   0
    7  68   1   1   0  23   1   0   7   1   5   0   0   0   1   1   0   1
    4   0   0   0   7   1   0   0   3   6   0  16   0   1   0   0   0  11
    3   0   3   0   0   2   2   0   0   2   2   0   7   0   1   0   0   0
    8   0   1   2   0   0   3   0   0   0   0   0   0   1   0   0   0   0
    0   0   0   0   0   0   0   0   1   0]
 [ 82   0  27  47   4   0   3   2   0   4   0   0   7  10  21  77   0  21
    3   5   0   1   8   0   0   2   0   6   6  15   4   1  19   4   0   2
    0   1   0   1   0   0   0   9   0   0  11   2   0   6   0   1   2   0
    4   0   0   0   5   2   0   0   2   0   4  10   0  11   0   0   0   3
    0   0   3   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   1   0]
 [  8  37   0  20   0  11   5   0   0  48  11   5  43  17   3   1   1  11
    9  13   2   0   0   0  61   7   6   1  34   0  32   0   0  10   0   3
    3   0   1   0   0   7   2   3   1   0   0   0   2   0   4   2   1   7
    4   0   0   4   0   0   0   0   2   0   1   0   0   0   6   0   0   1
    0   0   0   0   2   0   0   0   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 12  15   2  73   1  89  16   2   0  15   2   0  11  18   0   0   2   5
    0   0   0  22  36   5   1   0   1   7   0   6   4   0   0   1   0   0
    0   0   4   0  11   3   0  17   5   3   0   4   0   7   0   5   5   0
    1   2   0   0   0   4   0   0   0   5   0   0   0   0   0   0   0   1
    0   0   0   0   2   0   0   1   0   2   0   1   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 27  39   0  17   1   0  15 105   0  62   1   0   5   1   3   8   6  25
    0  10   1   0   6   1  10  11   4  12   8  11   2   1   9   6   0   1
    7   1   0   5  12   3   0   0   0   0  11   0   3   0   7   4   3   0
    5   0   0   3   0   0   1   6   6   1   0   0   1   0   1   2   0   1
    0   0   0   0   0   0   0   1   0   0   0   0   1   1   1   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  2   4  39   5  23   6   0  16   0   7   1   1   6   0   0   0   0   0
   34  10   6   0   5   0   2   0  17   0   0   7   0  32  23   0   0   9
    3   0   0  10   5   0   0   3   3   7   4   0  10   8   1   2   0   1
    0   0   0   0   1   1   7   0   3   0   0   0   0   2   0   0   0   0
    0   1   0   1   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 17   1  19  11   1   0   7   9   0   2  13  13   3  11  15   9  24  36
    0   1   5   0  57  16   1  10  19   6   5   0   0   0   0   0   1   3
   22  13   0   0   1   0   3   0   0   0   1   9   0   0   0   2   3   4
    0   2   0   0   0   0   0   2   0   0   0   0   1   0   0   0   0   0
    0   0   0   0   0   1   2   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   1   0   0   0   0   0]
 [  6   4   2   4  19  49   8   0   9   8  18  41  33  32   2  11  21   7
    0   6   0  22   0   3   5  18   5   9   0   0   0   1   0   0   4   0
    0  20   0   5   0   0   0   0   0   0   3   0   2   0   0   0   0   0
    0   0   0   0   0   0   0   5   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 80   6  16   0  19   0   0   7   2   1   0   0   5   6   0   9   2  37
    3  32   1   6   6   0   0   1   0   9   2   0  15   1  18   0   0   0
    0   2   0   0   4  18  18   0   4   1   0   1   0   0   8   2   0   0
    1   0   0   0   0  10   0   0   0   2   0   0   2   0   0   2   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 15   0  61   2  23   7   0   0  36  14   2   5   9   1   0  30  17   1
   18   0  49   0   1   0   4   1   0   0   0   1   1  23   0  11   5   0
    0   0   6   0   3   6   0   6   0   3   0   0   1   0   0   4   4   0
    0   0   1   0  11   0   4   0   0   0   0   0   2   0   3   0   0   0
    1   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]]
Total size of testing set
9199
[452 431 408 389 372 352 338 321 307 292 278 265 254 241 231 219 208 197
 190 180 170 165 156 148 140 132 128 124 119 112 102  99  95  91  85  81
  77  71  68  67  59  61  56  52  50  48  45  44  41  41  32  30  30  31
  26  29  24  25  21  21  18  19  16  18  15  17  16  16  14  11   9  11
   9   7   7   6   9   2   6   5   5   6   5   3   4   4   2   2   4   1
   3   1   0   1   2   0   0   0   2   2]
20
  0%|          | 0/2500 [00:00<?, ?it/s]  0%|          | 1/2500 [00:54<37:39:54, 54.26s/it]round 0, global test acc  0.0099 

round 0, global 3shot acc: [head: 0.0359, middle: 0.0008, tail: 0.0000] 

3shot of client 0:head:0.15608465608465608, middle:0.0, tail0.0
3shot of client 1:head:0.14398422090729784, middle:0.0, tail0.0
3shot of client 2:head:0.0, middle:0.07894736842105263, tail0.0
3shot of client 3:head:0.10602910602910603, middle:0.0, tail0.0
3shot of client 4:head:0.09836065573770492, middle:0.0, tail0.0
3shot of client 5:head:0.12524461839530332, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.09333333333333334, tail0.0
3shot of client 7:head:0.0, middle:0.08695652173913043, tail0.0
3shot of client 8:head:0.12072892938496584, middle:0.0, tail0.0
3shot of client 9:head:0.0, middle:0.058823529411764705, tail0.0
3shot of client 10:head:0.10893854748603352, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.045454545454545456, tail0.0
3shot of client 12:head:0.09770114942528736, middle:0.0, tail0.0
3shot of client 13:head:0.22530864197530864, middle:0.0, tail0.0
3shot of client 14:head:0.02425876010781671, middle:0.0, tail0.0
3shot of client 15:head:0.15476190476190477, middle:0.0, tail0.0
3shot of client 16:head:0.037162162162162164, middle:0.0, tail0.0
3shot of client 17:head:0.06143344709897611, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.08571428571428572, tail0.0
3shot of client 19:head:0.0, middle:0.0375, tail0.0
round 0, local average test acc  0.0603 

round 0, local macro average F1 score  0.0025 

round 0, local weighted average F1 score  0.0098 

round 0, global test acc  0.0099 

round 0, average 3shot acc: [head: 0.0730, middle: 0.0243, tail: 0.0000] 

round 0, global 3shot acc: [head: 0.0359, middle: 0.0008, tail: 0.0000] 

l_head tensor([0.6100, 0.5897, 0.6667, 0.5931, 0.6413, 0.7838, 0.7155, 0.5883, 0.9655,
        0.6120, 0.5944, 0.7481, 0.6219, 0.5894, 0.6808, 0.6554, 0.6196, 0.6337,
        0.5689, 0.5897, 0.5819, 0.5705, 0.5864, 0.6412, 0.6308, 0.6110, 0.6924,
        0.7729, 0.5758, 0.5925, 0.6082, 0.5861, 0.5820, 0.5824, 0.7413, 0.6283,
        0.6451, 0.6208, 0.7740, 0.5660, 0.5926, 0.5796, 0.6045, 0.5718, 0.5714,
        0.6013, 0.5504, 0.5696, 0.5835, 0.5791, 0.5664, 0.5629, 0.5663, 0.5888,
        0.5767, 0.5879, 0.5982, 0.5767, 0.5909, 0.5785, 0.5846, 0.5705, 0.6217,
        0.5867, 0.6181, 0.5829, 0.5863, 0.5832, 0.5919, 0.5834, 0.5798, 0.5925,
        0.5815, 0.5852, 0.6104, 0.5860, 0.5700, 0.5636, 0.5753, 0.5880, 0.5715,
        0.5606, 0.5721, 0.5581, 0.5812, 0.5796, 0.6337, 0.5965, 0.5649, 0.5782,
        0.5945, 0.5698, 0.5834, 0.5998, 0.5524, 0.5780, 0.5932, 0.5665, 0.5967,
        0.5845], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([0.6099, 0.6065, 0.5902, 0.5812, 0.5744, 0.5772, 0.6011, 0.5927, 0.6115,
        0.5775, 0.5851, 0.5852, 0.5823, 0.5795, 0.5666, 0.5782, 0.5862, 0.5873,
        0.5667, 0.5795, 0.5811, 0.5660, 0.5980, 0.5964, 0.5545, 0.5696, 0.5937,
        0.5896, 0.5804, 0.5470, 0.5674, 0.5865, 0.5734, 0.5761, 0.5685, 0.5743,
        0.5757, 0.5821, 0.5772, 0.5692, 0.5645, 0.5869, 0.5805, 0.5651, 0.5842,
        0.5850, 0.5622, 0.5896, 0.5963, 0.5979, 0.5679, 0.5747, 0.5776, 0.5686,
        0.5714, 0.5842, 0.5661, 0.5687, 0.5874, 0.5733, 0.5710, 0.5836, 0.5868,
        0.5670, 0.5699, 0.5754, 0.5773, 0.5766, 0.5710, 0.5669, 0.5893, 0.5813,
        0.5943, 0.5961, 0.5843, 0.5525, 0.5958, 0.5767, 0.5870, 0.5971, 0.5767,
        0.5639, 0.5828, 0.5867, 0.5967, 0.5918, 0.5681, 0.5815, 0.5864, 0.5515,
        0.5748, 0.5672, 0.5655, 0.5703, 0.5775, 0.5876, 0.5729, 0.5617, 0.5731,
        0.5889], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.13227513227513227, middle:0.0, tail0.0
3shot of client 1:head:0.14201183431952663, middle:0.0, tail0.0
3shot of client 2:head:0.23154362416107382, middle:0.0, tail0.0
3shot of client 3:head:0.10602910602910603, middle:0.0, tail0.0
3shot of client 4:head:0.06762295081967214, middle:0.0, tail0.0
3shot of client 5:head:0.0958904109589041, middle:0.0, tail0.0
3shot of client 6:head:0.09523809523809523, middle:0.0, tail0.0
3shot of client 7:head:0.08854166666666667, middle:0.0, tail0.0
3shot of client 8:head:0.1070615034168565, middle:0.0, tail0.0
3shot of client 9:head:0.11952191235059761, middle:0.0, tail0.0
3shot of client 10:head:0.00558659217877095, middle:0.08139534883720931, tail0.0
3shot of client 11:head:0.03133903133903134, middle:0.0, tail0.0
3shot of client 12:head:0.1235632183908046, middle:0.0, tail0.0
3shot of client 13:head:0.22530864197530864, middle:0.0, tail0.0
3shot of client 14:head:0.2695417789757412, middle:0.0, tail0.0
3shot of client 15:head:0.027777777777777776, middle:0.0, tail0.0
3shot of client 16:head:0.19256756756756757, middle:0.0, tail0.0
3shot of client 17:head:0.11262798634812286, middle:0.0, tail0.0
3shot of client 18:head:0.058823529411764705, middle:0.0, tail0.0
3shot of client 19:head:0.2053872053872054, middle:0.0, tail0.0
round 1, local average test acc  0.0935 

round 1, local macro average F1 score  0.0039 

round 1, local weighted average F1 score  0.0202 

round 1, global test acc  0.0099 

round 1, average 3shot acc: [head: 0.1219, middle: 0.0041, tail: 0.0000] 

round 1, global 3shot acc: [head: 0.0359, middle: 0.0008, tail: 0.0000] 

l_head tensor([0.7599, 0.6525, 0.6924, 0.5947, 0.7975, 0.9908, 0.8287, 0.5878, 0.9748,
        0.6320, 0.6158, 0.9735, 0.6557, 0.5858, 0.9057, 0.7837, 0.6182, 0.6435,
        0.5706, 0.6756, 0.5834, 0.6186, 0.6911, 0.7496, 0.6431, 0.6302, 0.7427,
        0.8498, 0.5775, 0.6890, 0.6465, 0.5878, 0.6216, 0.5839, 0.8140, 0.6707,
        0.6794, 0.6029, 0.7980, 0.5676, 0.5992, 0.5812, 0.6061, 0.5735, 0.5813,
        0.7373, 0.5522, 0.5713, 0.6396, 0.5807, 0.5681, 0.5645, 0.5679, 0.5904,
        0.5793, 0.5895, 0.5864, 0.5958, 0.5926, 0.5801, 0.5864, 0.5722, 0.6575,
        0.5883, 0.6424, 0.5923, 0.5880, 0.5847, 0.5936, 0.5850, 0.5815, 0.5942,
        0.5832, 0.5869, 0.6193, 0.5877, 0.5717, 0.5665, 0.5770, 0.5897, 0.5732,
        0.5624, 0.6333, 0.5596, 0.5829, 0.5813, 0.6144, 0.5981, 0.5666, 0.5798,
        0.5962, 0.5715, 0.5850, 0.6014, 0.5542, 0.5835, 0.5966, 0.5682, 0.5982,
        0.5861], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux   0%|          | 2/2500 [01:36<32:47:05, 47.25s/it]  0%|          | 3/2500 [02:20<31:42:46, 45.72s/it]tensor([0.6520, 0.6330, 0.6245, 0.5939, 0.5883, 0.5985, 0.6190, 0.5961, 0.6059,
        0.5826, 0.5929, 0.5914, 0.5926, 0.5783, 0.5774, 0.5795, 0.5942, 0.5894,
        0.5718, 0.5851, 0.5913, 0.5753, 0.6037, 0.5950, 0.5601, 0.5788, 0.5949,
        0.5900, 0.5824, 0.5503, 0.5700, 0.5832, 0.5747, 0.5768, 0.5696, 0.5759,
        0.5794, 0.5828, 0.5762, 0.5702, 0.5683, 0.5897, 0.5818, 0.5673, 0.5861,
        0.5867, 0.5647, 0.5906, 0.5965, 0.5964, 0.5680, 0.5771, 0.5786, 0.5713,
        0.5735, 0.5844, 0.5641, 0.5692, 0.5877, 0.5733, 0.5694, 0.5827, 0.5886,
        0.5681, 0.5673, 0.5741, 0.5782, 0.5748, 0.5704, 0.5687, 0.5890, 0.5812,
        0.5954, 0.5953, 0.5854, 0.5530, 0.5960, 0.5757, 0.5866, 0.5996, 0.5766,
        0.5651, 0.5846, 0.5914, 0.5986, 0.5919, 0.5686, 0.5816, 0.5860, 0.5513,
        0.5755, 0.5684, 0.5667, 0.5712, 0.5774, 0.5887, 0.5745, 0.5628, 0.5743,
        0.5898], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.0, middle:0.0425531914893617, tail0.0
3shot of client 1:head:0.14201183431952663, middle:0.0, tail0.0
3shot of client 2:head:0.22818791946308725, middle:0.0, tail0.0
3shot of client 3:head:0.1704781704781705, middle:0.0, tail0.0
3shot of client 4:head:0.0020491803278688526, middle:0.0, tail0.10344827586206896
3shot of client 5:head:0.12720156555772993, middle:0.0, tail0.0
3shot of client 6:head:0.034013605442176874, middle:0.0, tail0.0
3shot of client 7:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 8:head:0.03416856492027335, middle:0.0, tail0.0
3shot of client 9:head:0.04780876494023904, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.045454545454545456
3shot of client 11:head:0.21937321937321938, middle:0.0, tail0.0
3shot of client 12:head:0.07471264367816093, middle:0.0, tail0.0
3shot of client 13:head:0.12037037037037036, middle:0.0, tail0.0
3shot of client 14:head:0.2695417789757412, middle:0.0, tail0.0
3shot of client 15:head:0.031746031746031744, middle:0.0, tail0.0
3shot of client 16:head:0.12162162162162163, middle:0.0, tail0.0
3shot of client 17:head:0.10921501706484642, middle:0.0, tail0.0
3shot of client 18:head:0.05514705882352941, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.1375, tail0.0
round 2, local average test acc  0.0717 

round 2, local macro average F1 score  0.0034 

round 2, local weighted average F1 score  0.0191 

round 2, global test acc  0.0099 

round 2, average 3shot acc: [head: 0.0915, middle: 0.0090, tail: 0.0074] 

round 2, global 3shot acc: [head: 0.0359, middle: 0.0008, tail: 0.0000] 

l_head tensor([0.7582, 0.6690, 0.7625, 0.5954, 0.8372, 1.2359, 0.9620, 0.5970, 1.0648,
        0.6256, 0.6740, 1.2708, 0.7195, 0.5902, 1.0211, 0.8739, 0.6099, 0.6699,
        0.5714, 0.7344, 0.5842, 0.6729, 0.8172, 0.7502, 0.7086, 0.6681, 0.7556,
        0.9438, 0.5784, 0.6961, 0.6877, 0.5887, 0.6349, 0.5847, 0.9195, 0.6928,
        0.7317, 0.6025, 0.7692, 0.5684, 0.6161, 0.5820, 0.6069, 0.5744, 0.5820,
        0.6815, 0.5531, 0.5722, 0.6830, 0.5815, 0.5689, 0.5653, 0.5687, 0.5912,
        0.5888, 0.5903, 0.6114, 0.5983, 0.5934, 0.5809, 0.5990, 0.5730, 0.6459,
        0.5891, 0.6315, 0.6324, 0.5888, 0.5855, 0.5944, 0.5859, 0.5823, 0.5950,
        0.5839, 0.5877, 0.6207, 0.5885, 0.5725, 0.5833, 0.5777, 0.5905, 0.5740,
        0.5632, 0.6576, 0.5605, 0.5838, 0.5821, 0.6284, 0.5989, 0.5675, 0.5806,
        0.5970, 0.5723, 0.5858, 0.6022, 0.5551, 0.6073, 0.6057, 0.5690, 0.5990,
        0.5869], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([0.6949, 0.6615, 0.6395, 0.6079, 0.6020, 0.6148, 0.6453, 0.6141, 0.6127,
        0.6213, 0.6173, 0.6094, 0.5849, 0.6080, 0.5809, 0.5900, 0.6058, 0.5936,
        0.5787, 0.5880, 0.6002, 0.5753, 0.6126, 0.5932, 0.5680, 0.5800, 0.6069,
        0.6005, 0.5880, 0.5523, 0.5769, 0.5797, 0.5780, 0.5805, 0.5722, 0.5813,
        0.5840, 0.5839, 0.5773, 0.5720, 0.5712, 0.5913, 0.5807, 0.5703, 0.5862,
        0.5873, 0.5700, 0.5930, 0.5968, 0.5985, 0.5695, 0.5770, 0.5798, 0.5803,
        0.5756, 0.5844, 0.5656, 0.5731, 0.5885, 0.5735, 0.5692, 0.5771, 0.5900,
        0.5705, 0.5668, 0.5746, 0.5776, 0.5753, 0.5684, 0.5701, 0.5885, 0.5822,
        0.5946, 0.5971, 0.5830, 0.5518, 0.5949, 0.5744, 0.5864, 0.5981, 0.5757,
        0.5634, 0.5865, 0.5911, 0.5979, 0.5903, 0.5678, 0.5814, 0.5847, 0.5513,
        0.5755, 0.5678, 0.5674, 0.5719, 0.5773, 0.5893, 0.5746, 0.5620, 0.5768,
        0.5886], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.15608465608465608, middle:0.0, tail0.0
3shot of client 1:head:0.07889546351084813, middle:0.0, tail0.0
3shot of client 2:head:0.053691275167785234, middle:0.0, tail0.0
3shot of client 3:head:0.12058212058212059, middle:0.0, tail0.0
3shot of client 4:head:0.06352459016393443, middle:0.0782608695652174, tail0.0
3shot of client 5:head:0.009784735812133072, middle:0.064, tail0.0
3shot of client 6:head:0.01020408163265306, middle:0.05333333333333334, tail0.0
3shot of client 7:head:0.109375, middle:0.0, tail0.0
3shot of client 8:head:0.04100227790432802, middle:0.0, tail0.0
3shot of client 9:head:0.035856573705179286, middle:0.0, tail0.0
3shot of client 10:head:0.1787709497206704, middle:0.0, tail0.0
3shot of client 11:head:0.23076923076923078, middle:0.0, tail0.0
3shot of client 12:head:0.09195402298850575, middle:0.0, tail0.0
3shot of client 13:head:0.24074074074074073, middle:0.0, tail0.0
3shot of client 14:head:0.013477088948787063, middle:0.05263157894736842, tail0.0
3shot of client 15:head:0.1111111111111111, middle:0.0, tail0.0
3shot of client 16:head:0.0777027027027027, middle:0.0, tail0.0
3shot of client 17:head:0.08532423208191127, middle:0.0, tail0.0
3shot of client 18:head:0.06985294117647059, middle:0.0, tail0.0
3shot of client 19:head:0.16498316498316498, middle:0.0, tail0.0
round 3, local average test acc  0.0763 

round 3, local macro average F1 score  0.0065 

round 3, local weighted average F1 score  0.0277 

round 3, global test acc  0.0099 

round 3, average 3shot acc: [head: 0.0972, middle: 0.0124, tail: 0.0000] 

round 3, global 3shot acc: [head: 0.0359, middle: 0.0008, tail: 0.0000] 

l_head tensor([0.8325, 0.7514, 0.8772, 0.5957, 0.9565, 1.4186, 1.0823, 0.6068, 1.3119,
        0.6607, 0.7217, 1.4218, 0.7235, 0.6211, 1.2185, 1.0830, 0.6835, 0.6395,
        0.5717, 0.8163, 0.5845, 0.6692, 0.8649, 0.8307, 0.7408, 0.7075, 0.8775,
        1.0237, 0.5786, 0.8327, 0.6560, 0.5889, 0.6259, 0.5849, 1.0609, 0.7760,
        0.8002, 0.6289, 0.8311, 0.5687, 0.6381, 0.5822, 0.6071, 0.5746, 0.6006,
        0.6996, 0.5533, 0.5724, 0.6457, 0.5818, 0.5692, 0.5655, 0.5690, 0.5915,
        0.5900, 0.5905, 0.6107, 0.6350, 0.5937, 0.5811, 0.6438, 0.5732, 0.8107,
        0.5894, 0.6389, 0.6313, 0.5891, 0.5858, 0.5947, 0.5861, 0.5826, 0.5953,
        0.5842, 0.5880, 0.6437, 0.5888, 0.5728, 0.6015, 0.5780, 0.5908, 0.5742,
        0.5635, 0.7531, 0.5608, 0.5840, 0.5824, 0.6279, 0.5992, 0.5677, 0.5808,
        0.5972, 0.5725, 0.5861, 0.6025, 0.5554, 0.7101, 0.6135, 0.5693, 0.5992,
        0.5872], device='cuda:6', grad_fn=<NormBackward1>)
g_head   0%|          | 4/2500 [03:03<31:03:51, 44.80s/it]  0%|          | 5/2500 [03:46<30:27:50, 43.96s/it]tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([0.7358, 0.7004, 0.6865, 0.6206, 0.6304, 0.6463, 0.6699, 0.6395, 0.6295,
        0.6550, 0.6574, 0.6388, 0.5958, 0.5993, 0.5958, 0.5974, 0.6152, 0.5988,
        0.5764, 0.5934, 0.6229, 0.5772, 0.6252, 0.6011, 0.5770, 0.5914, 0.6243,
        0.5931, 0.5948, 0.5573, 0.5805, 0.5807, 0.5828, 0.5835, 0.5765, 0.5870,
        0.5880, 0.5863, 0.5760, 0.5745, 0.5698, 0.5923, 0.5797, 0.5704, 0.5857,
        0.5933, 0.5735, 0.5946, 0.5990, 0.6017, 0.5661, 0.5760, 0.5827, 0.5864,
        0.5797, 0.5854, 0.5639, 0.5747, 0.5924, 0.5733, 0.5691, 0.5766, 0.5895,
        0.5718, 0.5672, 0.5750, 0.5787, 0.5752, 0.5692, 0.5680, 0.5880, 0.5833,
        0.5938, 0.5985, 0.5846, 0.5524, 0.5961, 0.5744, 0.5868, 0.5979, 0.5762,
        0.5628, 0.5889, 0.5928, 0.5981, 0.5918, 0.5658, 0.5780, 0.5840, 0.5498,
        0.5753, 0.5676, 0.5662, 0.5730, 0.5763, 0.5887, 0.5748, 0.5602, 0.5764,
        0.5880], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.12698412698412698, middle:0.0, tail0.041666666666666664
3shot of client 1:head:0.29191321499013806, middle:0.0, tail0.0
3shot of client 2:head:0.07046979865771812, middle:0.09210526315789473, tail0.0
3shot of client 3:head:0.08108108108108109, middle:0.0, tail0.0
3shot of client 4:head:0.12704918032786885, middle:0.0, tail0.0
3shot of client 5:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 6:head:0.13945578231292516, middle:0.0, tail0.0
3shot of client 7:head:0.03125, middle:0.0, tail0.0
3shot of client 8:head:0.11161731207289294, middle:0.0, tail0.0
3shot of client 9:head:0.14342629482071714, middle:0.014705882352941176, tail0.0
3shot of client 10:head:0.12569832402234637, middle:0.0, tail0.0
3shot of client 11:head:0.1452991452991453, middle:0.06818181818181818, tail0.0
3shot of client 12:head:0.10632183908045977, middle:0.0, tail0.0
3shot of client 13:head:0.16666666666666666, middle:0.0, tail0.0
3shot of client 14:head:0.04582210242587601, middle:0.031578947368421054, tail0.0
3shot of client 15:head:0.15476190476190477, middle:0.0, tail0.0
3shot of client 16:head:0.16554054054054054, middle:0.058823529411764705, tail0.0
3shot of client 17:head:0.11262798634812286, middle:0.041666666666666664, tail0.0
3shot of client 18:head:0.3897058823529412, middle:0.0, tail0.0
3shot of client 19:head:0.05723905723905724, middle:0.0, tail0.0
round 4, local average test acc  0.1071 

round 4, local macro average F1 score  0.0100 

round 4, local weighted average F1 score  0.0474 

round 4, global test acc  0.0099 

round 4, average 3shot acc: [head: 0.1368, middle: 0.0154, tail: 0.0021] 

round 4, global 3shot acc: [head: 0.0359, middle: 0.0008, tail: 0.0000] 

l_head tensor([0.9471, 0.7504, 0.8896, 0.5958, 1.0542, 1.5992, 1.2108, 0.6009, 1.4311,
        0.7123, 0.7750, 1.5534, 0.7196, 0.6737, 1.4057, 1.1165, 0.6995, 0.6772,
        0.5719, 0.9075, 0.5846, 0.7695, 0.7716, 0.8690, 0.8345, 0.7057, 0.8687,
        1.1148, 0.5788, 0.8615, 0.7290, 0.5891, 0.6402, 0.5851, 1.1167, 0.7617,
        0.8476, 0.6798, 0.8497, 0.5689, 0.7970, 0.5824, 0.6072, 0.5748, 0.6150,
        0.7349, 0.5535, 0.5726, 0.7321, 0.5819, 0.5694, 0.5657, 0.5692, 0.5916,
        0.5852, 0.5907, 0.6587, 0.7100, 0.5938, 0.5813, 0.6079, 0.5734, 0.9425,
        0.5896, 0.6412, 0.7876, 0.5892, 0.5859, 0.5949, 0.5863, 0.5828, 0.5955,
        0.5844, 0.5882, 0.6634, 0.5890, 0.5730, 0.6080, 0.5781, 0.5910, 0.5744,
        0.5637, 0.7603, 0.5609, 0.5842, 0.5826, 0.6241, 0.5993, 0.5679, 0.5810,
        0.5974, 0.5727, 0.5863, 0.6027, 0.5556, 0.6328, 0.6211, 0.5695, 0.5994,
        0.5874], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([0.8163, 0.7447, 0.7020, 0.6372, 0.6619, 0.6682, 0.6991, 0.6445, 0.6458,
        0.6947, 0.6762, 0.6556, 0.6137, 0.6205, 0.6173, 0.6170, 0.6377, 0.6072,
        0.5888, 0.6011, 0.6426, 0.5786, 0.6328, 0.6111, 0.5926, 0.6055, 0.6261,
        0.6044, 0.6072, 0.5689, 0.5929, 0.5840, 0.5877, 0.5876, 0.5836, 0.5933,
        0.5919, 0.5875, 0.5775, 0.5767, 0.5736, 0.5998, 0.5806, 0.5739, 0.5868,
        0.5982, 0.5741, 0.6005, 0.5980, 0.6040, 0.5690, 0.5782, 0.5824, 0.5991,
        0.5811, 0.5862, 0.5605, 0.5828, 0.5916, 0.5745, 0.5699, 0.5761, 0.5945,
        0.5697, 0.5674, 0.5748, 0.5788, 0.5787, 0.5691, 0.5683, 0.5901, 0.5842,
        0.5946, 0.5973, 0.5829, 0.5524, 0.5957, 0.5749, 0.5861, 0.5960, 0.5758,
        0.5623, 0.5917, 0.5949, 0.5977, 0.5903, 0.5645, 0.5763, 0.5832, 0.5488,
        0.5754, 0.5679, 0.5680, 0.5719, 0.5755, 0.5897, 0.5755, 0.5596, 0.5756,
        0.5877], device='cuda:6', grad_fn=<NormBackward1>)
round 5, global test acc  0.0242 

round 5, global 3shot acc: [head: 0.0896, middle: 0.0000, tail: 0.0000] 

3shot of client 0:head:0.18518518518518517, middle:0.0, tail0.0
3shot of client 1:head:0.16173570019723865, middle:0.0, tail0.0
3shot of client 2:head:0.09395973154362416, middle:0.0, tail0.0
3shot of client 3:head:0.1288981288981289, middle:0.0, tail0.0
3shot of client 4:head:0.09016393442622951, middle:0.008695652173913044, tail0.0
3shot of client 5:head:0.005870841487279843, middle:0.056, tail0.0
3shot of client 6:head:0.006802721088435374, middle:0.08, tail0.0
3shot of client 7:head:0.125, middle:0.0, tail0.0
3shot of client 8:head:0.12300683371298406, middle:0.0, tail0.0
3shot of client 9:head:0.2549800796812749, middle:0.0, tail0.0
3shot of client 10:head:0.08379888268156424, middle:0.08139534883720931, tail0.0
3shot of client 11:head:0.2706552706552707, middle:0.0, tail0.0
3shot of client 12:head:0.06609195402298851, middle:0.0, tail0.0
3shot of client 13:head:0.040123456790123455, middle:0.0, tail0.1
3shot of client 14:head:0.03504043126684636, middle:0.06315789473684211, tail0.0
3shot of client 15:head:0.07936507936507936, middle:0.0, tail0.0
3shot of client 16:head:0.0777027027027027, middle:0.0, tail0.0
3shot of client 17:head:0.22866894197952217, middle:0.0, tail0.0
3shot of client 18:head:0.14338235294117646, middle:0.0, tail0.0
3shot of client 19:head:0.1111111111111111, middle:0.0, tail0.0
round 5, local average test acc  0.0909 

round 5, local macro average F1 score  0.0091 

round 5, local weighted average F1 score  0.0410 

round 5, global test acc  0.0242 

round 5, average 3shot acc: [head: 0.1156, middle: 0.0145, tail: 0.0050] 

  0%|          | 6/2500 [04:41<33:03:16, 47.71s/it]  0%|          | 7/2500 [05:23<31:51:24, 46.00s/it]round 5, global 3shot acc: [head: 0.0896, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.9742, 0.7908, 0.9347, 0.5960, 1.0918, 1.7466, 1.4297, 0.6188, 1.5337,
        0.6980, 0.7404, 1.6976, 0.7140, 0.6867, 1.5828, 1.1806, 0.6988, 0.6659,
        0.5720, 0.8115, 0.5848, 0.7227, 0.7711, 0.9546, 0.8383, 0.7398, 0.9745,
        1.3207, 0.5789, 0.9367, 0.6928, 0.5892, 0.6358, 0.5852, 1.3028, 0.7814,
        0.8811, 0.6579, 0.9193, 0.5690, 0.7651, 0.5825, 0.6074, 0.5749, 0.5934,
        0.8820, 0.5537, 0.5727, 0.6950, 0.5821, 0.5696, 0.5658, 0.5693, 0.5918,
        0.6209, 0.5908, 0.6521, 0.6533, 0.5940, 0.5814, 0.6049, 0.5735, 0.8697,
        0.5897, 0.6541, 0.7330, 0.5894, 0.5861, 0.5950, 0.5864, 0.5829, 0.5956,
        0.5845, 0.5883, 0.6386, 0.5891, 0.5731, 0.6234, 0.5783, 0.5911, 0.5745,
        0.5638, 0.7850, 0.5611, 0.5844, 0.5827, 0.6184, 0.5995, 0.5681, 0.5812,
        0.5976, 0.5728, 0.5864, 0.6028, 0.5557, 0.6369, 0.6384, 0.5696, 0.5995,
        0.5875], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([0.8541, 0.7984, 0.7435, 0.6660, 0.7047, 0.6930, 0.7412, 0.6674, 0.6872,
        0.7386, 0.7139, 0.6926, 0.6338, 0.6327, 0.6452, 0.6414, 0.6591, 0.6152,
        0.6018, 0.6135, 0.6727, 0.5880, 0.6451, 0.6250, 0.6103, 0.6158, 0.6385,
        0.6103, 0.6120, 0.5824, 0.6184, 0.5855, 0.5986, 0.5973, 0.5875, 0.5964,
        0.5973, 0.5942, 0.5784, 0.5882, 0.5787, 0.6031, 0.5830, 0.5785, 0.5896,
        0.6051, 0.5758, 0.6067, 0.5984, 0.6076, 0.5638, 0.5800, 0.5859, 0.6140,
        0.5849, 0.5857, 0.5604, 0.5830, 0.5923, 0.5750, 0.5718, 0.5834, 0.6025,
        0.5695, 0.5666, 0.5731, 0.5792, 0.5806, 0.5697, 0.5702, 0.5925, 0.5850,
        0.5943, 0.5978, 0.5829, 0.5528, 0.5970, 0.5746, 0.5863, 0.5955, 0.5769,
        0.5628, 0.5900, 0.5952, 0.5987, 0.5907, 0.5642, 0.5749, 0.5816, 0.5485,
        0.5750, 0.5686, 0.5673, 0.5714, 0.5754, 0.5901, 0.5760, 0.5596, 0.5753,
        0.5868], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.15343915343915343, middle:0.0, tail0.0
3shot of client 1:head:0.10650887573964497, middle:0.0, tail0.0
3shot of client 2:head:0.09060402684563758, middle:0.0, tail0.0
3shot of client 3:head:0.15384615384615385, middle:0.0873015873015873, tail0.0
3shot of client 4:head:0.13524590163934427, middle:0.05217391304347826, tail0.034482758620689655
3shot of client 5:head:0.05675146771037182, middle:0.0, tail0.0
3shot of client 6:head:0.09863945578231292, middle:0.0, tail0.0
3shot of client 7:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 8:head:0.03189066059225513, middle:0.09401709401709402, tail0.0
3shot of client 9:head:0.2549800796812749, middle:0.0, tail0.0
3shot of client 10:head:0.1005586592178771, middle:0.0, tail0.0
3shot of client 11:head:0.21937321937321938, middle:0.0, tail0.0
3shot of client 12:head:0.1810344827586207, middle:0.0, tail0.0
3shot of client 13:head:0.1574074074074074, middle:0.0, tail0.0
3shot of client 14:head:0.21293800539083557, middle:0.0, tail0.0
3shot of client 15:head:0.09126984126984126, middle:0.0, tail0.0
3shot of client 16:head:0.06756756756756757, middle:0.0, tail0.0
3shot of client 17:head:0.12627986348122866, middle:0.0, tail0.0
3shot of client 18:head:0.24632352941176472, middle:0.0, tail0.0
3shot of client 19:head:0.13468013468013468, middle:0.0, tail0.0
round 6, local average test acc  0.1035 

round 6, local macro average F1 score  0.0125 

round 6, local weighted average F1 score  0.0487 

round 6, global test acc  0.0242 

round 6, average 3shot acc: [head: 0.1331, middle: 0.0117, tail: 0.0017] 

round 6, global 3shot acc: [head: 0.0896, middle: 0.0000, tail: 0.0000] 

l_head tensor([1.1018, 0.8854, 1.1245, 0.5960, 1.2332, 1.8976, 1.4458, 0.6520, 1.7312,
        0.7495, 0.7868, 1.8944, 0.7676, 0.6661, 1.8548, 1.2336, 0.6785, 0.6766,
        0.5721, 0.8119, 0.5849, 0.7558, 0.8394, 0.9942, 0.9580, 0.7457, 1.0357,
        1.5644, 0.5790, 0.9526, 0.7705, 0.5893, 0.6637, 0.5853, 1.4552, 0.8492,
        0.9164, 0.7608, 1.0002, 0.5691, 0.7353, 0.5826, 0.6074, 0.5750, 0.5911,
        0.7854, 0.5537, 0.5728, 0.7313, 0.5822, 0.5696, 0.5659, 0.5694, 0.5919,
        0.6166, 0.5909, 0.6159, 0.6991, 0.5941, 0.5815, 0.6154, 0.5736, 0.9025,
        0.5898, 0.7069, 0.7314, 0.5895, 0.5861, 0.5951, 0.5865, 0.5830, 0.5957,
        0.5846, 0.5884, 0.7812, 0.5892, 0.5732, 0.6672, 0.5783, 0.5912, 0.5746,
        0.5639, 0.8356, 0.5612, 0.5844, 0.5828, 0.6254, 0.5996, 0.5681, 0.5812,
        0.5976, 0.5729, 0.5865, 0.6029, 0.5558, 0.6569, 0.6398, 0.5697, 0.5996,
        0.5876], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([0.9170, 0.8641, 0.7937, 0.6978, 0.7405, 0.7274, 0.7851, 0.6924, 0.7207,
        0.7910, 0.7538, 0.7301, 0.6670, 0.6540, 0.6842, 0.6631, 0.6873, 0.6312,
        0.6265, 0.6334, 0.6992, 0.5956, 0.6641, 0.6605, 0.6294, 0.6387, 0.6573,
        0.6169, 0.6194, 0.5981, 0.6390, 0.5962, 0.6028, 0.6140, 0.5972, 0.6037,
        0.6121, 0.6001, 0.5837, 0.5960, 0.5812, 0.6066, 0.5861, 0.5857, 0.5909,
        0.6088, 0.5816, 0.6095, 0.5980, 0.6181, 0.5661, 0.5790, 0.5844, 0.6252,
        0.5899, 0.5855, 0.5607, 0.5902, 0.5922, 0.5753, 0.5741, 0.5847, 0.6044,
        0.5711, 0.5683, 0.5716, 0.5791, 0.5839, 0.5702, 0.5701, 0.5955, 0.5850,
        0.5947, 0.5951, 0.5847, 0.5535, 0.5989, 0.5762, 0.5855, 0.5951, 0.5761,
        0.5620, 0.5885, 0.5974, 0.5976, 0.5905, 0.5665, 0.5747, 0.5809, 0.5490,
        0.5743, 0.5682, 0.5655, 0.5703, 0.5731, 0.5911, 0.5749, 0.5595, 0.5738,
        0.5858], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.0582010582010582, middle:0.0, tail0.08333333333333333
3shot of client 1:head:0.10848126232741617, middle:0.203125, tail0.0
3shot of client 2:head:0.07718120805369127, middle:0.05263157894736842, tail0.0
3shot of client 3:head:0.11226611226611227, middle:0.1111111111111111, tail0.0
3shot of client 4:head:0.17827868852459017, middle:0.0, tail0.0
3shot of client 5:head:0.13307240704500978, middle:0.0, tail0.0
3shot of client 6:head:0.09523809523809523, middle:0.0, tail0.0
3shot of client 7:head:0.16666666666666666, middle:0.0, tail0.0
3shot of client 8:head:0.1958997722095672, middle:0.0, tail0.0
3shot of client 9:head:0.01593625498007968, middle:0.0, tail0.0
3shot of client 10:head:0.10893854748603352, middle:0.0, tail0.0
  0%|          | 8/2500 [06:05<30:48:42, 44.51s/it]3shot of client 11:head:0.2022792022792023, middle:0.0, tail0.0
3shot of client 12:head:0.15804597701149425, middle:0.047619047619047616, tail0.0
3shot of client 13:head:0.12345679012345678, middle:0.011764705882352941, tail0.0
3shot of client 14:head:0.11320754716981132, middle:0.031578947368421054, tail0.0
3shot of client 15:head:0.1626984126984127, middle:0.0, tail0.0
3shot of client 16:head:0.08783783783783784, middle:0.058823529411764705, tail0.0
3shot of client 17:head:0.15017064846416384, middle:0.0, tail0.0
3shot of client 18:head:0.19117647058823528, middle:0.0, tail0.0
3shot of client 19:head:0.11447811447811448, middle:0.0375, tail0.0
round 7, local average test acc  0.1028 

round 7, local macro average F1 score  0.0156 

round 7, local weighted average F1 score  0.0545 

round 7, global test acc  0.0242 

round 7, average 3shot acc: [head: 0.1277, middle: 0.0277, tail: 0.0042] 

round 7, global 3shot acc: [head: 0.0896, middle: 0.0000, tail: 0.0000] 

l_head tensor([1.1867, 0.9086, 1.0630, 0.5961, 1.3846, 2.0044, 1.5930, 0.6430, 1.9152,
        0.7753, 0.7405, 2.0482, 0.8106, 0.6923, 2.0459, 1.2615, 0.6756, 0.6895,
        0.5721, 0.8259, 0.5849, 0.7656, 0.8624, 1.0301, 0.9993, 0.7562, 1.0640,
        1.5843, 0.5790, 0.9773, 0.7342, 0.5894, 0.6765, 0.5853, 1.5126, 0.8988,
        1.0921, 0.7014, 1.1282, 0.5692, 0.7241, 0.5826, 0.6075, 0.5750, 0.6142,
        0.8442, 0.5538, 0.5728, 0.7290, 0.5822, 0.5697, 0.5659, 0.5694, 0.5919,
        0.6324, 0.5909, 0.6612, 0.7324, 0.5941, 0.5815, 0.6297, 0.5736, 0.9341,
        0.5898, 0.7421, 0.7328, 0.5895, 0.5862, 0.5951, 0.5866, 0.5830, 0.5957,
        0.5846, 0.5884, 0.7180, 0.5892, 0.5732, 0.6119, 0.5784, 0.5912, 0.5746,
        0.5639, 0.8693, 0.5612, 0.5845, 0.5828, 0.6477, 0.5996, 0.5682, 0.5813,
        0.5977, 0.5729, 0.5865, 0.6029, 0.5559, 0.6503, 0.6713, 0.5698, 0.5996,
        0.5876], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([0.9897, 0.9222, 0.8523, 0.7299, 0.7796, 0.7612, 0.8350, 0.7308, 0.7750,
        0.8386, 0.7927, 0.7704, 0.6952, 0.6822, 0.7091, 0.6814, 0.7168, 0.6474,
        0.6441, 0.6587, 0.7446, 0.6153, 0.6759, 0.6846, 0.6521, 0.6549, 0.6721,
        0.6270, 0.6244, 0.6172, 0.6492, 0.5994, 0.6095, 0.6166, 0.6093, 0.6115,
        0.6169, 0.6041, 0.5876, 0.6035, 0.5904, 0.6137, 0.5867, 0.5917, 0.5938,
        0.6180, 0.5850, 0.6181, 0.6013, 0.6262, 0.5706, 0.5797, 0.5854, 0.6357,
        0.5932, 0.5864, 0.5600, 0.5896, 0.5964, 0.5762, 0.5788, 0.5832, 0.6161,
        0.5707, 0.5671, 0.5709, 0.5798, 0.5891, 0.5715, 0.5692, 0.5986, 0.5868,
        0.5958, 0.5964, 0.5840, 0.5546, 0.6017, 0.5749, 0.5857, 0.5945, 0.5766,
        0.5599, 0.5883, 0.5977, 0.5979, 0.5913, 0.5677, 0.5749, 0.5807, 0.5492,
        0.5772, 0.5682, 0.5646, 0.5701, 0.5721, 0.5919, 0.5742, 0.5595, 0.5735,
        0.5847], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.12698412698412698, middle:0.07446808510638298, tail0.0
3shot of client 1:head:0.05128205128205128, middle:0.109375, tail0.0
3shot of client 2:head:0.31208053691275167, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.012474012474012475, middle:0.09523809523809523, tail0.0
3shot of client 4:head:0.19262295081967212, middle:0.0, tail0.0
3shot of client 5:head:0.10371819960861056, middle:0.0, tail0.0
3shot of client 6:head:0.11564625850340136, middle:0.0, tail0.0
3shot of client 7:head:0.08854166666666667, middle:0.0, tail0.0
3shot of client 8:head:0.14578587699316628, middle:0.0, tail0.0
3shot of client 9:head:0.02390438247011952, middle:0.0, tail0.0
3shot of client 10:head:0.21508379888268156, middle:0.0, tail0.045454545454545456
3shot of client 11:head:0.04843304843304843, middle:0.0, tail0.0
3shot of client 12:head:0.22988505747126436, middle:0.0, tail0.0
3shot of client 13:head:0.30864197530864196, middle:0.0, tail0.0
3shot of client 14:head:0.07547169811320754, middle:0.0, tail0.041666666666666664
3shot of client 15:head:0.0873015873015873, middle:0.03225806451612903, tail0.0
3shot of client 16:head:0.1858108108108108, middle:0.0, tail0.0
3shot of client 17:head:0.13651877133105803, middle:0.0, tail0.0
3shot of client 18:head:0.16544117647058823, middle:0.04285714285714286, tail0.0
3shot of client 19:head:0.19865319865319866, middle:0.075, tail0.0
round 8, local average test acc  0.1122 

round 8, local macro average F1 score  0.0167 

round 8, local weighted average F1 score  0.0671 

round 8, global test acc  0.0242 

round 8, average 3shot acc: [head: 0.1412, middle: 0.0221, tail: 0.0044] 

round 8, global 3shot acc: [head: 0.0896, middle: 0.0000, tail: 0.0000] 

l_head tensor([1.2941, 0.9351, 1.2538, 0.5961, 1.4847, 2.1467, 1.6324, 0.6582, 2.1532,
        0.7888, 0.8020, 2.0460, 0.9253, 0.7093, 2.1586, 1.3845, 0.6849, 0.6977,
        0.5722, 0.8892, 0.5849, 0.7411, 0.9554, 1.1154, 1.0563, 0.7704, 1.0996,
        1.8122, 0.5791, 1.0454, 0.7648, 0.5894, 0.7068, 0.5854, 1.6813, 0.9313,
        1.0711, 0.7105, 1.2460, 0.5692, 0.7316, 0.5827, 0.6075, 0.5751, 0.6005,
        0.9256, 0.5538, 0.5729, 0.7314, 0.5822, 0.5697, 0.5659, 0.5695, 0.5919,
        0.6529, 0.5910, 0.6320, 0.7610, 0.5941, 0.5816, 0.6597, 0.5736, 0.9410,
        0.5898, 0.7017, 0.7264, 0.5895, 0.5862, 0.5952, 0.5866, 0.5831, 0.5958,
        0.5846, 0.5885, 0.6930, 0.5892, 0.5732, 0.6312, 0.5784, 0.5913, 0.5747,
        0.5639, 0.8501, 0.5612, 0.5845, 0.5829, 0.6449, 0.5996, 0.5682, 0.5813,
        0.5977, 0.5729, 0.5865, 0.6029, 0.5559, 0.6376, 0.6616, 0.5698, 0.5997,
        0.5876], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux   0%|          | 9/2500 [06:48<30:27:15, 44.01s/it]  0%|          | 10/2500 [07:31<30:13:07, 43.69s/it]tensor([1.0647, 0.9977, 0.8923, 0.7686, 0.8385, 0.8069, 0.8723, 0.7684, 0.8084,
        0.9009, 0.8317, 0.8046, 0.7316, 0.7095, 0.7422, 0.7173, 0.7438, 0.6745,
        0.6623, 0.6738, 0.7881, 0.6315, 0.6957, 0.7002, 0.6756, 0.6759, 0.6942,
        0.6419, 0.6435, 0.6298, 0.6681, 0.6131, 0.6165, 0.6256, 0.6186, 0.6208,
        0.6266, 0.6110, 0.5918, 0.5993, 0.5945, 0.6246, 0.5871, 0.5981, 0.5928,
        0.6266, 0.5928, 0.6231, 0.6068, 0.6342, 0.5771, 0.5832, 0.5850, 0.6458,
        0.5963, 0.5864, 0.5614, 0.5973, 0.6034, 0.5754, 0.5860, 0.5829, 0.6258,
        0.5707, 0.5658, 0.5718, 0.5792, 0.5878, 0.5728, 0.5705, 0.5996, 0.5903,
        0.5962, 0.5979, 0.5841, 0.5551, 0.6024, 0.5748, 0.5860, 0.5973, 0.5763,
        0.5590, 0.5898, 0.5972, 0.5981, 0.5899, 0.5676, 0.5743, 0.5811, 0.5515,
        0.5769, 0.5695, 0.5649, 0.5698, 0.5723, 0.5943, 0.5743, 0.5601, 0.5742,
        0.5837], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.09523809523809523, middle:0.09574468085106383, tail0.0
3shot of client 1:head:0.2682445759368836, middle:0.0546875, tail0.0
3shot of client 2:head:0.23154362416107382, middle:0.0, tail0.0
3shot of client 3:head:0.13097713097713098, middle:0.1349206349206349, tail0.0
3shot of client 4:head:0.14959016393442623, middle:0.0, tail0.0
3shot of client 5:head:0.14285714285714285, middle:0.032, tail0.0
3shot of client 6:head:0.061224489795918366, middle:0.0, tail0.0
3shot of client 7:head:0.234375, middle:0.021739130434782608, tail0.0
3shot of client 8:head:0.1867881548974943, middle:0.0, tail0.0
3shot of client 9:head:0.09561752988047809, middle:0.0, tail0.0
3shot of client 10:head:0.12569832402234637, middle:0.0, tail0.0
3shot of client 11:head:0.41595441595441596, middle:0.0, tail0.0
3shot of client 12:head:0.16379310344827586, middle:0.047619047619047616, tail0.0
3shot of client 13:head:0.3148148148148148, middle:0.03529411764705882, tail0.0
3shot of client 14:head:0.1320754716981132, middle:0.08421052631578947, tail0.0
3shot of client 15:head:0.11904761904761904, middle:0.016129032258064516, tail0.0
3shot of client 16:head:0.12162162162162163, middle:0.058823529411764705, tail0.0
3shot of client 17:head:0.15358361774744028, middle:0.1388888888888889, tail0.0
3shot of client 18:head:0.3382352941176471, middle:0.014285714285714285, tail0.0
3shot of client 19:head:0.08754208754208755, middle:0.125, tail0.0
round 9, local average test acc  0.1441 

round 9, local macro average F1 score  0.0221 

round 9, local weighted average F1 score  0.0794 

round 9, global test acc  0.0242 

round 9, average 3shot acc: [head: 0.1784, middle: 0.0430, tail: 0.0000] 

round 9, global 3shot acc: [head: 0.0896, middle: 0.0000, tail: 0.0000] 

l_head tensor([1.5449, 0.9505, 1.2483, 0.5961, 1.5695, 2.3262, 1.8116, 0.6709, 2.2854,
        0.7769, 0.8328, 2.2271, 0.9020, 0.7166, 2.3012, 1.4525, 0.7650, 0.7704,
        0.5722, 0.9954, 0.5849, 0.7380, 0.9406, 1.2280, 1.1191, 0.8171, 1.1554,
        1.9727, 0.5791, 1.1587, 0.9297, 0.5894, 0.6846, 0.5854, 1.9156, 1.0399,
        1.1478, 0.6941, 1.3330, 0.5692, 0.7363, 0.5827, 0.6075, 0.5751, 0.6271,
        0.9829, 0.5538, 0.5729, 0.7991, 0.5822, 0.5697, 0.5660, 0.5695, 0.5919,
        0.6814, 0.5910, 0.6406, 0.7877, 0.5942, 0.5816, 0.6426, 0.5737, 1.0221,
        0.5899, 0.6944, 0.8118, 0.5895, 0.5862, 0.5952, 0.5866, 0.5831, 0.5958,
        0.5847, 0.5885, 0.6918, 0.5893, 0.5733, 0.6274, 0.5784, 0.5913, 0.5747,
        0.5640, 0.8876, 0.5613, 0.5845, 0.5829, 0.6530, 0.5997, 0.5682, 0.5813,
        0.5977, 0.5730, 0.5866, 0.6030, 0.5559, 0.6354, 0.6906, 0.5698, 0.5997,
        0.5876], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([1.1211, 1.0747, 0.9416, 0.8198, 0.8997, 0.8507, 0.9273, 0.8239, 0.8523,
        0.9447, 0.8774, 0.8516, 0.7659, 0.7413, 0.7616, 0.7447, 0.7820, 0.6788,
        0.6843, 0.6889, 0.8281, 0.6554, 0.7368, 0.7172, 0.7125, 0.6974, 0.7153,
        0.6573, 0.6612, 0.6397, 0.6859, 0.6155, 0.6279, 0.6387, 0.6313, 0.6358,
        0.6454, 0.6142, 0.5976, 0.6080, 0.5992, 0.6329, 0.5867, 0.6088, 0.6009,
        0.6340, 0.6007, 0.6290, 0.6105, 0.6416, 0.5752, 0.5842, 0.5887, 0.6616,
        0.6031, 0.5896, 0.5614, 0.5997, 0.6074, 0.5735, 0.5843, 0.5864, 0.6398,
        0.5719, 0.5695, 0.5709, 0.5782, 0.5917, 0.5733, 0.5763, 0.6060, 0.5938,
        0.5958, 0.5991, 0.5838, 0.5570, 0.6027, 0.5780, 0.5875, 0.5973, 0.5763,
        0.5594, 0.5897, 0.6020, 0.5974, 0.5894, 0.5683, 0.5743, 0.5817, 0.5499,
        0.5742, 0.5678, 0.5653, 0.5700, 0.5730, 0.5907, 0.5756, 0.5605, 0.5739,
        0.5837], device='cuda:6', grad_fn=<NormBackward1>)
round 10, global test acc  0.0327 

round 10, global 3shot acc: [head: 0.1211, middle: 0.0000, tail: 0.0000] 

3shot of client 0:head:0.2222222222222222, middle:0.0, tail0.0
3shot of client 1:head:0.3175542406311637, middle:0.0078125, tail0.0
3shot of client 2:head:0.22818791946308725, middle:0.0, tail0.0
3shot of client 3:head:0.07692307692307693, middle:0.11904761904761904, tail0.0
3shot of client 4:head:0.17008196721311475, middle:0.09565217391304348, tail0.0
3shot of client 5:head:0.19569471624266144, middle:0.0, tail0.0
3shot of client 6:head:0.1598639455782313, middle:0.0, tail0.05263157894736842
3shot of client 7:head:0.10416666666666667, middle:0.0, tail0.0
3shot of client 8:head:0.10478359908883828, middle:0.05982905982905983, tail0.0
3shot of client 9:head:0.08764940239043825, middle:0.0, tail0.0
3shot of client 10:head:0.07541899441340782, middle:0.06976744186046512, tail0.0
3shot of client 11:head:0.07122507122507123, middle:0.03409090909090909, tail0.0
3shot of client 12:head:0.3045977011494253, middle:0.0, tail0.0
3shot of client 13:head:0.3117283950617284, middle:0.011764705882352941, tail0.0
3shot of client 14:head:0.2183288409703504, middle:0.010526315789473684, tail0.0
3shot of client 15:head:0.1626984126984127, middle:0.016129032258064516, tail0.0
3shot of client 16:head:0.20270270270270271, middle:0.0, tail0.0
3shot of client 17:head:0.20136518771331058, middle:0.0, tail0.0
3shot of client 18:head:0.28308823529411764, middle:0.07142857142857142, tail0.0
3shot of client 19:head:0.265993265993266, middle:0.025, tail0.0
round 10, local average test acc  0.1485 

round 10, local macro average F1 score  0.0235 

round 10, local weighted average F1 score  0.0930 

round 10, global test acc  0.0327 

round 10, average 3shot acc: [head: 0.1882, middle: 0.0261, tail: 0.0026] 

round 10, global 3shot acc: [head: 0.1211, middle: 0.0000, tail: 0.0000] 

l_head   0%|          | 11/2500 [08:22<31:49:53, 46.04s/it]  0%|          | 12/2500 [09:05<31:08:10, 45.05s/it]tensor([1.7282, 1.0531, 1.3307, 0.5961, 1.7787, 2.4695, 1.9236, 0.7105, 2.6147,
        0.7745, 0.8853, 2.3392, 0.9698, 0.7766, 2.4865, 1.5451, 0.7355, 0.7090,
        0.5722, 0.9287, 0.5850, 0.7750, 1.0172, 1.2606, 1.1774, 0.8412, 1.1779,
        2.1053, 0.5791, 1.1475, 0.8057, 0.5894, 0.6994, 0.5854, 2.1245, 1.0571,
        1.2077, 0.6740, 1.4390, 0.5692, 0.7568, 0.5827, 0.6076, 0.5751, 0.6275,
        1.0885, 0.5539, 0.5729, 0.8247, 0.5823, 0.5698, 0.5660, 0.5695, 0.5920,
        0.7183, 0.5910, 0.6650, 0.7958, 0.5942, 0.5816, 0.6666, 0.5737, 1.1644,
        0.5899, 0.7215, 0.7933, 0.5896, 0.5862, 0.5952, 0.5866, 0.5831, 0.5958,
        0.5847, 0.5885, 0.7107, 0.5893, 0.5733, 0.7462, 0.5784, 0.5913, 0.5747,
        0.5640, 0.8913, 0.5613, 0.5845, 0.5829, 0.6798, 0.5997, 0.5682, 0.5813,
        0.5977, 0.5730, 0.5866, 0.6030, 0.5559, 0.6457, 0.6968, 0.5698, 0.5997,
        0.5876], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([1.1921, 1.1495, 0.9885, 0.8655, 0.9694, 0.8984, 0.9653, 0.8609, 0.9210,
        1.0109, 0.9271, 0.9030, 0.7936, 0.7826, 0.7951, 0.7841, 0.8136, 0.6977,
        0.7121, 0.7080, 0.8608, 0.6740, 0.7444, 0.7421, 0.7458, 0.7171, 0.7416,
        0.6803, 0.6757, 0.6591, 0.7090, 0.6243, 0.6423, 0.6580, 0.6527, 0.6379,
        0.6558, 0.6229, 0.6027, 0.6149, 0.6049, 0.6503, 0.5902, 0.6190, 0.6012,
        0.6367, 0.6059, 0.6370, 0.6142, 0.6498, 0.5805, 0.5833, 0.5896, 0.6698,
        0.6071, 0.5914, 0.5620, 0.6049, 0.6083, 0.5778, 0.5885, 0.5884, 0.6494,
        0.5739, 0.5710, 0.5707, 0.5790, 0.5899, 0.5751, 0.5769, 0.6092, 0.5947,
        0.5962, 0.5994, 0.5851, 0.5569, 0.6040, 0.5776, 0.5870, 0.5961, 0.5768,
        0.5588, 0.5911, 0.6010, 0.5983, 0.5900, 0.5667, 0.5750, 0.5816, 0.5501,
        0.5731, 0.5671, 0.5657, 0.5697, 0.5736, 0.5914, 0.5755, 0.5620, 0.5748,
        0.5842], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.21164021164021163, middle:0.0, tail0.0
3shot of client 1:head:0.22682445759368836, middle:0.0078125, tail0.0
3shot of client 2:head:0.29194630872483224, middle:0.0, tail0.0
3shot of client 3:head:0.11850311850311851, middle:0.06349206349206349, tail0.0
3shot of client 4:head:0.1762295081967213, middle:0.0, tail0.034482758620689655
3shot of client 5:head:0.029354207436399216, middle:0.016, tail0.0
3shot of client 6:head:0.1326530612244898, middle:0.0, tail0.0
3shot of client 7:head:0.078125, middle:0.021739130434782608, tail0.0
3shot of client 8:head:0.16400911161731208, middle:0.017094017094017096, tail0.038461538461538464
3shot of client 9:head:0.13147410358565736, middle:0.0, tail0.0
3shot of client 10:head:0.13687150837988826, middle:0.0, tail0.0
3shot of client 11:head:0.05128205128205128, middle:0.0, tail0.0
3shot of client 12:head:0.28735632183908044, middle:0.0, tail0.0
3shot of client 13:head:0.3549382716049383, middle:0.0, tail0.0
3shot of client 14:head:0.23450134770889489, middle:0.0, tail0.0
3shot of client 15:head:0.12698412698412698, middle:0.0, tail0.0
3shot of client 16:head:0.11486486486486487, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.22866894197952217, middle:0.013888888888888888, tail0.0
3shot of client 18:head:0.014705882352941176, middle:0.11428571428571428, tail0.0
3shot of client 19:head:0.18518518518518517, middle:0.0375, tail0.0
round 11, local average test acc  0.1286 

round 11, local macro average F1 score  0.0206 

round 11, local weighted average F1 score  0.0788 

round 11, global test acc  0.0327 

round 11, average 3shot acc: [head: 0.1648, middle: 0.0153, tail: 0.0036] 

round 11, global 3shot acc: [head: 0.1211, middle: 0.0000, tail: 0.0000] 

l_head tensor([1.7009, 1.0617, 1.3509, 0.5962, 1.9530, 2.8172, 2.1054, 0.6678, 2.7038,
        0.7937, 0.8822, 2.5276, 0.9738, 0.7444, 2.5834, 1.6120, 0.7478, 0.7320,
        0.5722, 0.9263, 0.5850, 0.7829, 1.0130, 1.3625, 1.2531, 0.8950, 1.2752,
        2.3073, 0.5791, 1.2606, 0.8145, 0.5895, 0.6899, 0.5854, 2.1397, 1.1425,
        1.3315, 0.7014, 1.4617, 0.5693, 0.7614, 0.5827, 0.6076, 0.5751, 0.6304,
        1.1288, 0.5539, 0.5730, 0.8064, 0.5823, 0.5698, 0.5660, 0.5695, 0.5920,
        0.7496, 0.5910, 0.6704, 0.7978, 0.5942, 0.5816, 0.6508, 0.5737, 1.2526,
        0.5899, 0.6953, 0.8202, 0.5896, 0.5863, 0.5952, 0.5867, 0.5831, 0.5958,
        0.5847, 0.5885, 0.7251, 0.5893, 0.5733, 0.6566, 0.5785, 0.5914, 0.5748,
        0.5640, 0.9132, 0.5613, 0.5846, 0.5829, 0.7141, 0.5997, 0.5683, 0.5814,
        0.5978, 0.5730, 0.5866, 0.6030, 0.5560, 0.6418, 0.7026, 0.5699, 0.5998,
        0.5877], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([1.2609, 1.2189, 1.0347, 0.9139, 1.0260, 0.9479, 1.0193, 0.9132, 0.9715,
        1.0747, 0.9832, 0.9453, 0.8219, 0.8174, 0.8268, 0.8068, 0.8560, 0.7180,
        0.7408, 0.7279, 0.8958, 0.6994, 0.7702, 0.7742, 0.7619, 0.7413, 0.7728,
        0.6887, 0.7032, 0.6701, 0.7431, 0.6406, 0.6558, 0.6691, 0.6672, 0.6468,
        0.6706, 0.6319, 0.6138, 0.6305, 0.6109, 0.6574, 0.5965, 0.6275, 0.6073,
        0.6481, 0.6127, 0.6466, 0.6193, 0.6563, 0.5820, 0.5911, 0.5928, 0.6897,
        0.6099, 0.5938, 0.5626, 0.6072, 0.6102, 0.5777, 0.5950, 0.5962, 0.6583,
        0.5738, 0.5729, 0.5702, 0.5780, 0.5938, 0.5769, 0.5795, 0.6107, 0.5972,
        0.5974, 0.5997, 0.5850, 0.5579, 0.6030, 0.5787, 0.5876, 0.5957, 0.5760,
        0.5593, 0.5898, 0.6066, 0.5978, 0.5911, 0.5680, 0.5725, 0.5817, 0.5492,
        0.5727, 0.5683, 0.5679, 0.5698, 0.5737, 0.5930, 0.5744, 0.5621, 0.5759,
        0.5887], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.2222222222222222, middle:0.010638297872340425, tail0.0
3shot of client 1:head:0.29191321499013806, middle:0.0, tail0.030303030303030304
3shot of client 2:head:0.25838926174496646, middle:0.02631578947368421, tail0.0
3shot of client 3:head:0.2785862785862786, middle:0.11904761904761904, tail0.0
3shot of client 4:head:0.26434426229508196, middle:0.0, tail0.0
3shot of client 5:head:0.08610567514677103, middle:0.008, tail0.0
3shot of client 6:head:0.1564625850340136, middle:0.0, tail0.0
3shot of client 7:head:0.15104166666666666, middle:0.021739130434782608, tail0.0
3shot of client 8:head:0.15034168564920272, middle:0.05128205128205128, tail0.0
3shot of client 9:head:0.12749003984063745, middle:0.058823529411764705, tail0.0
  1%|          | 13/2500 [09:45<30:05:22, 43.56s/it]3shot of client 10:head:0.12290502793296089, middle:0.023255813953488372, tail0.0
3shot of client 11:head:0.35327635327635326, middle:0.0, tail0.0
3shot of client 12:head:0.27586206896551724, middle:0.0, tail0.0
3shot of client 13:head:0.3395061728395062, middle:0.011764705882352941, tail0.0
3shot of client 14:head:0.1105121293800539, middle:0.031578947368421054, tail0.0
3shot of client 15:head:0.13095238095238096, middle:0.0, tail0.0
3shot of client 16:head:0.16554054054054054, middle:0.0, tail0.05555555555555555
3shot of client 17:head:0.17064846416382254, middle:0.027777777777777776, tail0.0
3shot of client 18:head:0.4264705882352941, middle:0.0, tail0.0
3shot of client 19:head:0.14814814814814814, middle:0.0125, tail0.0
round 12, local average test acc  0.1652 

round 12, local macro average F1 score  0.0263 

round 12, local weighted average F1 score  0.1057 

round 12, global test acc  0.0327 

round 12, average 3shot acc: [head: 0.2115, middle: 0.0201, tail: 0.0043] 

round 12, global 3shot acc: [head: 0.1211, middle: 0.0000, tail: 0.0000] 

l_head tensor([1.7387, 1.1305, 1.3736, 0.5962, 2.1217, 2.7912, 2.1540, 0.6761, 2.8879,
        0.8070, 0.9117, 2.6183, 1.0898, 0.7948, 2.7643, 1.6922, 0.7329, 0.8288,
        0.5722, 1.0194, 0.5850, 0.8469, 1.0564, 1.4948, 1.2377, 0.8817, 1.3768,
        2.4263, 0.5791, 1.2293, 0.8162, 0.5895, 0.7251, 0.5854, 2.2178, 1.2440,
        1.3055, 0.6874, 1.5422, 0.5693, 0.7579, 0.5827, 0.6076, 0.5751, 0.6598,
        1.1948, 0.5539, 0.5730, 0.8127, 0.5823, 0.5698, 0.5660, 0.5695, 0.5920,
        0.7396, 0.5910, 0.6852, 0.8364, 0.5942, 0.5816, 0.6852, 0.5737, 1.3682,
        0.5899, 0.7452, 0.8614, 0.5896, 0.5863, 0.5952, 0.5867, 0.5832, 0.5958,
        0.5847, 0.5885, 0.7309, 0.5893, 0.5733, 0.6577, 0.5785, 0.5914, 0.5748,
        0.5640, 0.9657, 0.5613, 0.5846, 0.5829, 0.6910, 0.5997, 0.5683, 0.5814,
        0.5978, 0.5730, 0.5866, 0.6030, 0.5560, 0.6490, 0.7056, 0.5699, 0.5998,
        0.5877], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([1.3690, 1.2809, 1.1029, 0.9687, 1.0976, 0.9885, 1.0842, 0.9701, 1.0272,
        1.1500, 1.0314, 0.9884, 0.8565, 0.8603, 0.8577, 0.8384, 0.8980, 0.7481,
        0.7757, 0.7550, 0.9332, 0.7222, 0.8006, 0.8040, 0.8088, 0.7668, 0.8004,
        0.7011, 0.7242, 0.6981, 0.7644, 0.6580, 0.6699, 0.6876, 0.6791, 0.6578,
        0.6869, 0.6413, 0.6222, 0.6436, 0.6152, 0.6630, 0.6065, 0.6391, 0.6091,
        0.6541, 0.6213, 0.6484, 0.6234, 0.6715, 0.5883, 0.5987, 0.5969, 0.7039,
        0.6181, 0.6000, 0.5617, 0.6157, 0.6110, 0.5786, 0.5951, 0.5947, 0.6764,
        0.5774, 0.5762, 0.5697, 0.5791, 0.5949, 0.5780, 0.5761, 0.6187, 0.5961,
        0.5972, 0.6003, 0.5872, 0.5570, 0.6051, 0.5777, 0.5873, 0.5965, 0.5762,
        0.5600, 0.5903, 0.6075, 0.5984, 0.5935, 0.5680, 0.5724, 0.5829, 0.5504,
        0.5744, 0.5671, 0.5692, 0.5689, 0.5723, 0.5942, 0.5743, 0.5634, 0.5759,
        0.5877], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.1349206349206349, middle:0.0425531914893617, tail0.0
3shot of client 1:head:0.2938856015779093, middle:0.1015625, tail0.0
3shot of client 2:head:0.26174496644295303, middle:0.0, tail0.0
3shot of client 3:head:0.17255717255717257, middle:0.031746031746031744, tail0.0
3shot of client 4:head:0.18032786885245902, middle:0.017391304347826087, tail0.0
3shot of client 5:head:0.15655577299412915, middle:0.056, tail0.0
3shot of client 6:head:0.17006802721088435, middle:0.05333333333333334, tail0.0
3shot of client 7:head:0.1875, middle:0.0, tail0.0
3shot of client 8:head:0.1366742596810934, middle:0.0, tail0.0
3shot of client 9:head:0.15139442231075698, middle:0.0, tail0.0
3shot of client 10:head:0.27932960893854747, middle:0.0, tail0.0
3shot of client 11:head:0.23076923076923078, middle:0.022727272727272728, tail0.0
3shot of client 12:head:0.28448275862068967, middle:0.047619047619047616, tail0.0
3shot of client 13:head:0.13271604938271606, middle:0.058823529411764705, tail0.0
3shot of client 14:head:0.20754716981132076, middle:0.05263157894736842, tail0.0
3shot of client 15:head:0.1349206349206349, middle:0.03225806451612903, tail0.0
3shot of client 16:head:0.1858108108108108, middle:0.0, tail0.0
3shot of client 17:head:0.22866894197952217, middle:0.06944444444444445, tail0.0
3shot of client 18:head:0.4117647058823529, middle:0.02857142857142857, tail0.0
3shot of client 19:head:0.13804713804713806, middle:0.025, tail0.0
round 13, local average test acc  0.1615 

round 13, local macro average F1 score  0.0251 

round 13, local weighted average F1 score  0.0962 

round 13, global test acc  0.0327 

round 13, average 3shot acc: [head: 0.2040, middle: 0.0320, tail: 0.0000] 

round 13, global 3shot acc: [head: 0.1211, middle: 0.0000, tail: 0.0000] 

l_head tensor([1.7692, 1.1146, 1.4817, 0.5962, 2.2553, 2.9243, 2.2573, 0.7076, 2.9868,
        0.8089, 0.9326, 2.7842, 1.1594, 0.7768, 2.8596, 1.7603, 0.7730, 0.8076,
        0.5723, 1.0229, 0.5850, 0.7896, 1.0526, 1.6118, 1.3029, 0.9609, 1.3956,
        2.6269, 0.5791, 1.3235, 0.8456, 0.5895, 0.7144, 0.5854, 2.4272, 1.3662,
        1.3696, 0.7089, 1.6815, 0.5693, 0.7457, 0.5827, 0.6076, 0.5751, 0.6554,
        1.2131, 0.5539, 0.5730, 0.8963, 0.5823, 0.5698, 0.5660, 0.5695, 0.5920,
        0.7951, 0.5910, 0.7155, 0.8513, 0.5942, 0.5816, 0.6790, 0.5737, 1.3852,
        0.5899, 0.7297, 0.9899, 0.5896, 0.5863, 0.5953, 0.5867, 0.5832, 0.5958,
        0.5847, 0.5885, 0.6822, 0.5893, 0.5733, 0.6436, 0.5785, 0.5914, 0.5748,
        0.5640, 1.0122, 0.5613, 0.5846, 0.5829, 0.7479, 0.5997, 0.5683, 0.5814,
        0.5978, 0.5730, 0.5866, 0.6030, 0.5560, 0.6640, 0.7256, 0.5699, 0.5998,
        0.5877], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux   1%|          | 14/2500 [10:26<29:30:02, 42.72s/it]  1%|          | 15/2500 [11:08<29:23:21, 42.58s/it]tensor([1.4261, 1.3459, 1.1491, 1.0202, 1.1682, 1.0407, 1.1365, 1.0241, 1.0959,
        1.2125, 1.0952, 1.0332, 0.8866, 0.8911, 0.8844, 0.8745, 0.9432, 0.7847,
        0.7944, 0.7699, 0.9821, 0.7457, 0.8250, 0.8176, 0.8283, 0.7990, 0.8230,
        0.7187, 0.7473, 0.7235, 0.7860, 0.6793, 0.6825, 0.7084, 0.6969, 0.6679,
        0.7008, 0.6505, 0.6370, 0.6524, 0.6202, 0.6806, 0.6193, 0.6436, 0.6226,
        0.6676, 0.6266, 0.6612, 0.6271, 0.6819, 0.5923, 0.5995, 0.6031, 0.7109,
        0.6241, 0.6035, 0.5651, 0.6188, 0.6121, 0.5805, 0.5967, 0.5961, 0.6882,
        0.5779, 0.5760, 0.5722, 0.5800, 0.5932, 0.5804, 0.5794, 0.6222, 0.6005,
        0.5963, 0.6046, 0.5865, 0.5586, 0.6102, 0.5781, 0.5865, 0.5979, 0.5770,
        0.5597, 0.5930, 0.6105, 0.5969, 0.5945, 0.5698, 0.5719, 0.5841, 0.5506,
        0.5735, 0.5668, 0.5702, 0.5686, 0.5725, 0.5963, 0.5735, 0.5628, 0.5750,
        0.5865], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.12962962962962962, middle:0.010638297872340425, tail0.041666666666666664
3shot of client 1:head:0.2702169625246548, middle:0.0, tail0.0
3shot of client 2:head:0.1040268456375839, middle:0.05263157894736842, tail0.0
3shot of client 3:head:0.09771309771309772, middle:0.1746031746031746, tail0.0
3shot of client 4:head:0.2336065573770492, middle:0.0, tail0.0
3shot of client 5:head:0.0684931506849315, middle:0.064, tail0.0
3shot of client 6:head:0.15306122448979592, middle:0.12, tail0.0
3shot of client 7:head:0.234375, middle:0.0, tail0.0
3shot of client 8:head:0.19134396355353075, middle:0.0, tail0.0
3shot of client 9:head:0.20717131474103587, middle:0.0, tail0.0
3shot of client 10:head:0.20949720670391062, middle:0.0, tail0.0
3shot of client 11:head:0.32763532763532766, middle:0.045454545454545456, tail0.0
3shot of client 12:head:0.32471264367816094, middle:0.0, tail0.0
3shot of client 13:head:0.28703703703703703, middle:0.011764705882352941, tail0.0
3shot of client 14:head:0.261455525606469, middle:0.0, tail0.0
3shot of client 15:head:0.16666666666666666, middle:0.0, tail0.0
3shot of client 16:head:0.1858108108108108, middle:0.0, tail0.05555555555555555
3shot of client 17:head:0.26621160409556316, middle:0.041666666666666664, tail0.0
3shot of client 18:head:0.33455882352941174, middle:0.02857142857142857, tail0.0
3shot of client 19:head:0.15488215488215487, middle:0.025, tail0.0
round 14, local average test acc  0.1661 

round 14, local macro average F1 score  0.0293 

round 14, local weighted average F1 score  0.1109 

round 14, global test acc  0.0327 

round 14, average 3shot acc: [head: 0.2104, middle: 0.0287, tail: 0.0049] 

round 14, global 3shot acc: [head: 0.1211, middle: 0.0000, tail: 0.0000] 

l_head tensor([1.8256, 1.2731, 1.6270, 0.5962, 2.4566, 3.0285, 2.4678, 0.7107, 3.2241,
        0.8572, 0.9988, 2.9072, 1.1691, 0.7761, 2.9930, 1.7458, 0.7569, 0.8275,
        0.5723, 1.0421, 0.5850, 0.8414, 1.1209, 1.7396, 1.3353, 0.9390, 1.4608,
        2.7209, 0.5791, 1.3309, 0.8794, 0.5895, 0.7200, 0.5855, 2.5956, 1.3449,
        1.4068, 0.7075, 1.6793, 0.5693, 0.7629, 0.5828, 0.6076, 0.5752, 0.6673,
        1.3070, 0.5539, 0.5730, 0.8935, 0.5823, 0.5698, 0.5660, 0.5696, 0.5920,
        0.7750, 0.5911, 0.7724, 0.8314, 0.5942, 0.5816, 0.6638, 0.5737, 1.3888,
        0.5899, 0.7419, 0.9187, 0.5896, 0.5863, 0.5953, 0.5867, 0.5832, 0.5959,
        0.5847, 0.5886, 0.7010, 0.5893, 0.5733, 0.6662, 0.5785, 0.5914, 0.5748,
        0.5640, 1.0450, 0.5613, 0.5846, 0.5830, 0.7249, 0.5997, 0.5683, 0.5814,
        0.5978, 0.5730, 0.5866, 0.6030, 0.5560, 0.7050, 0.7798, 0.5699, 0.5998,
        0.5877], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([1.4924, 1.3857, 1.1887, 1.0814, 1.2283, 1.0872, 1.2071, 1.0759, 1.1438,
        1.2854, 1.1422, 1.0876, 0.9255, 0.9318, 0.9181, 0.9125, 0.9939, 0.8218,
        0.8379, 0.7895, 1.0285, 0.7706, 0.8662, 0.8467, 0.8705, 0.8250, 0.8514,
        0.7363, 0.7703, 0.7422, 0.8344, 0.6856, 0.6955, 0.7179, 0.7140, 0.6783,
        0.7117, 0.6635, 0.6330, 0.6719, 0.6297, 0.6971, 0.6249, 0.6559, 0.6283,
        0.6736, 0.6368, 0.6694, 0.6328, 0.6988, 0.5959, 0.6010, 0.6125, 0.7201,
        0.6282, 0.6087, 0.5642, 0.6296, 0.6158, 0.5814, 0.5994, 0.5979, 0.6960,
        0.5803, 0.5779, 0.5726, 0.5819, 0.5976, 0.5808, 0.5799, 0.6219, 0.6001,
        0.5966, 0.6069, 0.5879, 0.5575, 0.6098, 0.5774, 0.5861, 0.5960, 0.5774,
        0.5612, 0.5937, 0.6146, 0.5976, 0.5949, 0.5703, 0.5709, 0.5842, 0.5520,
        0.5734, 0.5675, 0.5710, 0.5698, 0.5728, 0.5967, 0.5724, 0.5633, 0.5749,
        0.5874], device='cuda:6', grad_fn=<NormBackward1>)
round 15, global test acc  0.0418 

round 15, global 3shot acc: [head: 0.1533, middle: 0.0015, tail: 0.0000] 

3shot of client 0:head:0.21428571428571427, middle:0.0, tail0.0
3shot of client 1:head:0.2445759368836292, middle:0.125, tail0.0
3shot of client 2:head:0.29194630872483224, middle:0.0, tail0.0
3shot of client 3:head:0.27442827442827444, middle:0.0, tail0.0
3shot of client 4:head:0.26024590163934425, middle:0.0, tail0.0
3shot of client 5:head:0.19373776908023482, middle:0.016, tail0.0
3shot of client 6:head:0.14285714285714285, middle:0.05333333333333334, tail0.0
3shot of client 7:head:0.16666666666666666, middle:0.021739130434782608, tail0.08333333333333333
3shot of client 8:head:0.07972665148063782, middle:0.05128205128205128, tail0.0
3shot of client 9:head:0.23107569721115537, middle:0.0, tail0.0
3shot of client 10:head:0.24860335195530725, middle:0.0, tail0.0
3shot of client 11:head:0.2222222222222222, middle:0.0, tail0.0
3shot of client 12:head:0.2959770114942529, middle:0.0, tail0.0
3shot of client 13:head:0.25617283950617287, middle:0.09411764705882353, tail0.0
3shot of client 14:head:0.3018867924528302, middle:0.0, tail0.0
3shot of client 15:head:0.11507936507936507, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.16554054054054054, middle:0.0, tail0.0
3shot of client 17:head:0.1296928327645051, middle:0.027777777777777776, tail0.0
3shot of client 18:head:0.35661764705882354, middle:0.0, tail0.0
3shot of client 19:head:0.2962962962962963, middle:0.0, tail0.0
round 15, local average test acc  0.1754 

round 15, local macro average F1 score  0.0260 

round 15, local weighted average F1 score  0.1048 

round 15, global test acc  0.0418 

round 15, average 3shot acc: [head: 0.2244, middle: 0.0227, tail: 0.0042] 

round 15, global 3shot acc: [head: 0.1533, middle: 0.0015, tail: 0.0000] 

l_head   1%|          | 16/2500 [12:00<31:25:42, 45.55s/it]  1%|          | 17/2500 [12:44<31:00:21, 44.95s/it]tensor([1.8525, 1.1745, 1.7054, 0.5962, 2.4981, 3.1913, 2.5212, 0.6997, 3.4123,
        0.8530, 1.0240, 2.9143, 1.2472, 0.8012, 3.2229, 1.8549, 0.7702, 0.8585,
        0.5723, 1.0834, 0.5850, 0.7944, 1.1615, 1.8477, 1.3478, 1.0253, 1.4606,
        2.8699, 0.5792, 1.4135, 0.8606, 0.5895, 0.7433, 0.5855, 2.7380, 1.4166,
        1.4429, 0.7137, 1.7487, 0.5693, 0.7815, 0.5828, 0.6076, 0.5752, 0.6671,
        1.3719, 0.5539, 0.5730, 1.1388, 0.5823, 0.5698, 0.5660, 0.5696, 0.5920,
        0.8328, 0.5911, 0.7271, 0.8398, 0.5942, 0.5817, 0.6828, 0.5737, 1.4387,
        0.5900, 0.7298, 0.9187, 0.5896, 0.5863, 0.5953, 0.5867, 0.5832, 0.5959,
        0.5848, 0.5886, 0.7186, 0.5894, 0.5733, 0.6768, 0.5785, 0.5914, 0.5748,
        0.5640, 1.0559, 0.5614, 0.5846, 0.5830, 0.6946, 0.5997, 0.5683, 0.5814,
        0.5978, 0.5730, 0.5866, 0.6031, 0.5560, 0.6957, 0.7601, 0.5699, 0.5998,
        0.5877], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([1.5643, 1.4642, 1.2370, 1.1372, 1.2777, 1.1348, 1.2662, 1.1179, 1.2049,
        1.3524, 1.2073, 1.1370, 0.9752, 0.9789, 0.9598, 0.9463, 1.0345, 0.8533,
        0.8644, 0.8162, 1.0519, 0.8071, 0.8905, 0.8793, 0.9075, 0.8452, 0.8778,
        0.7537, 0.8018, 0.7681, 0.8519, 0.7030, 0.7108, 0.7392, 0.7239, 0.6923,
        0.7285, 0.6732, 0.6419, 0.6857, 0.6428, 0.7079, 0.6309, 0.6644, 0.6356,
        0.6883, 0.6467, 0.6777, 0.6452, 0.7178, 0.5946, 0.6032, 0.6210, 0.7368,
        0.6375, 0.6113, 0.5675, 0.6449, 0.6200, 0.5844, 0.6102, 0.6035, 0.7085,
        0.5819, 0.5826, 0.5729, 0.5851, 0.5996, 0.5817, 0.5809, 0.6290, 0.6059,
        0.5980, 0.6104, 0.5902, 0.5577, 0.6115, 0.5768, 0.5872, 0.5964, 0.5762,
        0.5616, 0.5959, 0.6168, 0.5975, 0.5949, 0.5753, 0.5722, 0.5865, 0.5540,
        0.5741, 0.5685, 0.5716, 0.5699, 0.5727, 0.6007, 0.5724, 0.5632, 0.5751,
        0.5872], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.19576719576719576, middle:0.031914893617021274, tail0.0
3shot of client 1:head:0.17357001972386588, middle:0.0390625, tail0.0
3shot of client 2:head:0.18456375838926176, middle:0.05263157894736842, tail0.05555555555555555
3shot of client 3:head:0.24532224532224534, middle:0.14285714285714285, tail0.0
3shot of client 4:head:0.2520491803278688, middle:0.0, tail0.0
3shot of client 5:head:0.19960861056751467, middle:0.0, tail0.0
3shot of client 6:head:0.09183673469387756, middle:0.09333333333333334, tail0.0
3shot of client 7:head:0.078125, middle:0.0, tail0.0
3shot of client 8:head:0.17312072892938496, middle:0.017094017094017096, tail0.07692307692307693
3shot of client 9:head:0.10756972111553785, middle:0.058823529411764705, tail0.0
3shot of client 10:head:0.1340782122905028, middle:0.0, tail0.045454545454545456
3shot of client 11:head:0.06267806267806268, middle:0.045454545454545456, tail0.0
3shot of client 12:head:0.21264367816091953, middle:0.011904761904761904, tail0.0
3shot of client 13:head:0.3271604938271605, middle:0.0, tail0.0
3shot of client 14:head:0.1967654986522911, middle:0.0, tail0.0
3shot of client 15:head:0.21031746031746032, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.15878378378378377, middle:0.08823529411764706, tail0.0
3shot of client 17:head:0.1945392491467577, middle:0.013888888888888888, tail0.0
3shot of client 18:head:0.44485294117647056, middle:0.0, tail0.0
3shot of client 19:head:0.1447811447811448, middle:0.0, tail0.0
round 16, local average test acc  0.1509 

round 16, local macro average F1 score  0.0274 

round 16, local weighted average F1 score  0.0972 

round 16, global test acc  0.0418 

round 16, average 3shot acc: [head: 0.1894, middle: 0.0330, tail: 0.0089] 

round 16, global 3shot acc: [head: 0.1533, middle: 0.0015, tail: 0.0000] 

l_head tensor([1.9314, 1.2325, 1.7388, 0.5962, 2.6300, 3.3110, 2.6103, 0.7482, 3.5261,
        0.8850, 1.0329, 3.0399, 1.2908, 0.8430, 3.2857, 1.9595, 0.8243, 0.8612,
        0.5723, 1.0839, 0.5850, 0.8344, 1.1633, 1.9423, 1.3731, 1.0400, 1.5162,
        3.1872, 0.5792, 1.4034, 0.8884, 0.5895, 0.7476, 0.5855, 2.7166, 1.4109,
        1.4960, 0.6957, 1.8582, 0.5693, 0.8011, 0.5828, 0.6076, 0.5752, 0.6796,
        1.4010, 0.5539, 0.5730, 0.9961, 0.5823, 0.5699, 0.5660, 0.5696, 0.5920,
        0.7976, 0.5911, 0.7525, 0.8588, 0.5942, 0.5817, 0.6933, 0.5738, 1.4777,
        0.5900, 0.7590, 0.9798, 0.5896, 0.5863, 0.5953, 0.5867, 0.5832, 0.5959,
        0.5848, 0.5886, 0.6841, 0.5894, 0.5733, 0.7056, 0.5785, 0.5914, 0.5748,
        0.5640, 1.0898, 0.5614, 0.5846, 0.5830, 0.7860, 0.5997, 0.5683, 0.5814,
        0.5978, 0.5730, 0.5867, 0.6031, 0.5560, 0.6956, 0.7785, 0.5699, 0.5998,
        0.5877], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([1.6256, 1.5135, 1.3010, 1.1878, 1.3412, 1.1818, 1.3283, 1.1791, 1.2705,
        1.4148, 1.2629, 1.1817, 1.0159, 1.0286, 1.0081, 0.9859, 1.0741, 0.8956,
        0.8969, 0.8431, 1.0862, 0.8351, 0.9230, 0.9086, 0.9420, 0.8787, 0.9071,
        0.7684, 0.8349, 0.7980, 0.8898, 0.7223, 0.7187, 0.7558, 0.7367, 0.7108,
        0.7449, 0.6885, 0.6611, 0.6965, 0.6561, 0.7248, 0.6407, 0.6741, 0.6446,
        0.7060, 0.6528, 0.6956, 0.6545, 0.7352, 0.6054, 0.6071, 0.6324, 0.7466,
        0.6426, 0.6152, 0.5696, 0.6549, 0.6231, 0.5908, 0.6156, 0.6050, 0.7194,
        0.5816, 0.5830, 0.5752, 0.5855, 0.6007, 0.5864, 0.5822, 0.6372, 0.6143,
        0.5989, 0.6110, 0.5895, 0.5596, 0.6152, 0.5778, 0.5868, 0.5982, 0.5767,
        0.5631, 0.5957, 0.6218, 0.5970, 0.5956, 0.5786, 0.5709, 0.5857, 0.5536,
        0.5739, 0.5666, 0.5757, 0.5697, 0.5730, 0.6009, 0.5737, 0.5626, 0.5750,
        0.5883], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.1746031746031746, middle:0.0, tail0.0
3shot of client 1:head:0.28402366863905326, middle:0.0, tail0.0
3shot of client 2:head:0.2986577181208054, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.26403326403326405, middle:0.1746031746031746, tail0.0
3shot of client 4:head:0.39959016393442626, middle:0.0, tail0.0
3shot of client 5:head:0.2328767123287671, middle:0.008, tail0.0
3shot of client 6:head:0.14625850340136054, middle:0.09333333333333334, tail0.0
3shot of client 7:head:0.17708333333333334, middle:0.06521739130434782, tail0.0
3shot of client 8:head:0.19362186788154898, middle:0.10256410256410256, tail0.0
  1%|          | 18/2500 [13:26<30:18:25, 43.96s/it]3shot of client 9:head:0.23107569721115537, middle:0.014705882352941176, tail0.0
3shot of client 10:head:0.28212290502793297, middle:0.011627906976744186, tail0.0
3shot of client 11:head:0.3190883190883191, middle:0.0, tail0.0
3shot of client 12:head:0.2988505747126437, middle:0.011904761904761904, tail0.0
3shot of client 13:head:0.3765432098765432, middle:0.0, tail0.0
3shot of client 14:head:0.10242587601078167, middle:0.0, tail0.0
3shot of client 15:head:0.25, middle:0.016129032258064516, tail0.0
3shot of client 16:head:0.18243243243243243, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.13993174061433447, middle:0.027777777777777776, tail0.0
3shot of client 18:head:0.10661764705882353, middle:0.1, tail0.0
3shot of client 19:head:0.2053872053872054, middle:0.0, tail0.0
round 17, local average test acc  0.1841 

round 17, local macro average F1 score  0.0328 

round 17, local weighted average F1 score  0.1234 

round 17, global test acc  0.0418 

round 17, average 3shot acc: [head: 0.2333, middle: 0.0327, tail: 0.0000] 

round 17, global 3shot acc: [head: 0.1533, middle: 0.0015, tail: 0.0000] 

l_head tensor([2.0016, 1.3063, 1.8020, 0.5962, 2.7752, 3.4058, 2.7229, 0.7181, 3.7314,
        0.9141, 1.0771, 3.2068, 1.3502, 0.8386, 3.4028, 1.9581, 0.7825, 0.8762,
        0.5723, 1.2582, 0.5850, 0.9183, 1.2455, 2.0408, 1.4665, 0.9807, 1.5545,
        3.3410, 0.5792, 1.5253, 0.9181, 0.5895, 0.7646, 0.5855, 2.9871, 1.5263,
        1.6327, 0.7359, 1.9964, 0.5693, 0.7771, 0.5828, 0.6076, 0.5752, 0.6952,
        1.4812, 0.5540, 0.5730, 1.0468, 0.5823, 0.5699, 0.5661, 0.5696, 0.5920,
        0.8547, 0.5911, 0.8024, 1.0332, 0.5942, 0.5817, 0.6904, 0.5738, 1.4238,
        0.5900, 0.8304, 1.0853, 0.5896, 0.5863, 0.5953, 0.5867, 0.5832, 0.5959,
        0.5848, 0.5886, 0.7102, 0.5894, 0.5733, 0.7121, 0.5785, 0.5914, 0.5748,
        0.5641, 1.1062, 0.5614, 0.5846, 0.5830, 0.7056, 0.5998, 0.5683, 0.5814,
        0.5978, 0.5731, 0.5867, 0.6031, 0.5560, 0.7186, 0.7689, 0.5699, 0.5998,
        0.5877], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([1.6704, 1.5688, 1.3465, 1.2464, 1.4028, 1.2216, 1.3832, 1.2361, 1.3336,
        1.4813, 1.3175, 1.2362, 1.0654, 1.0694, 1.0535, 1.0296, 1.1213, 0.9362,
        0.9269, 0.8639, 1.1257, 0.8639, 0.9502, 0.9557, 0.9636, 0.8978, 0.9407,
        0.7885, 0.8530, 0.8193, 0.9108, 0.7353, 0.7362, 0.7790, 0.7509, 0.7307,
        0.7628, 0.7029, 0.6739, 0.7067, 0.6673, 0.7451, 0.6439, 0.6893, 0.6490,
        0.7195, 0.6586, 0.7039, 0.6647, 0.7531, 0.6117, 0.6180, 0.6386, 0.7435,
        0.6565, 0.6200, 0.5761, 0.6662, 0.6296, 0.5944, 0.6269, 0.6071, 0.7299,
        0.5850, 0.5866, 0.5761, 0.5876, 0.6037, 0.5895, 0.5840, 0.6369, 0.6165,
        0.5988, 0.6117, 0.5903, 0.5592, 0.6162, 0.5753, 0.5868, 0.5987, 0.5775,
        0.5645, 0.5976, 0.6209, 0.5969, 0.5966, 0.5781, 0.5712, 0.5885, 0.5553,
        0.5750, 0.5668, 0.5754, 0.5705, 0.5726, 0.6027, 0.5759, 0.5641, 0.5749,
        0.5873], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.20634920634920634, middle:0.031914893617021274, tail0.0
3shot of client 1:head:0.2978303747534517, middle:0.125, tail0.030303030303030304
3shot of client 2:head:0.26174496644295303, middle:0.0, tail0.0
3shot of client 3:head:0.24116424116424118, middle:0.10317460317460317, tail0.0
3shot of client 4:head:0.2889344262295082, middle:0.0, tail0.0
3shot of client 5:head:0.23874755381604695, middle:0.0, tail0.0
3shot of client 6:head:0.20068027210884354, middle:0.10666666666666667, tail0.0
3shot of client 7:head:0.2708333333333333, middle:0.043478260869565216, tail0.0
3shot of client 8:head:0.22095671981776766, middle:0.008547008547008548, tail0.0
3shot of client 9:head:0.23904382470119523, middle:0.014705882352941176, tail0.0
3shot of client 10:head:0.22346368715083798, middle:0.0, tail0.0
3shot of client 11:head:0.19373219373219372, middle:0.0, tail0.0
3shot of client 12:head:0.25287356321839083, middle:0.0, tail0.0
3shot of client 13:head:0.35185185185185186, middle:0.07058823529411765, tail0.0
3shot of client 14:head:0.09433962264150944, middle:0.0, tail0.0
3shot of client 15:head:0.2222222222222222, middle:0.14516129032258066, tail0.0625
3shot of client 16:head:0.15878378378378377, middle:0.0, tail0.0
3shot of client 17:head:0.18088737201365188, middle:0.027777777777777776, tail0.0
3shot of client 18:head:0.5147058823529411, middle:0.014285714285714285, tail0.0
3shot of client 19:head:0.003367003367003367, middle:0.1375, tail0.0
round 18, local average test acc  0.1858 

round 18, local macro average F1 score  0.0346 

round 18, local weighted average F1 score  0.1250 

round 18, global test acc  0.0418 

round 18, average 3shot acc: [head: 0.2331, middle: 0.0414, tail: 0.0046] 

round 18, global 3shot acc: [head: 0.1533, middle: 0.0015, tail: 0.0000] 

l_head tensor([2.0945, 1.3221, 1.7436, 0.5962, 2.8040, 3.5076, 2.8870, 0.7227, 3.8310,
        0.9213, 1.0916, 3.3828, 1.4007, 0.9046, 3.4012, 2.0646, 0.8046, 0.9296,
        0.5723, 1.1308, 0.5850, 0.8739, 1.2896, 2.1450, 1.5246, 1.0188, 1.5882,
        3.3678, 0.5792, 1.5184, 0.9579, 0.5895, 0.7686, 0.5855, 3.0970, 1.5460,
        1.6894, 0.7326, 2.0536, 0.5693, 0.7849, 0.5828, 0.6076, 0.5752, 0.7010,
        1.5400, 0.5540, 0.5730, 1.1044, 0.5824, 0.5699, 0.5661, 0.5696, 0.5920,
        0.8269, 0.5911, 0.8044, 0.9574, 0.5943, 0.5817, 0.6921, 0.5738, 1.4496,
        0.5900, 0.7698, 1.1984, 0.5896, 0.5863, 0.5953, 0.5867, 0.5832, 0.5959,
        0.5848, 0.5886, 0.7111, 0.5894, 0.5734, 0.7299, 0.5785, 0.5914, 0.5748,
        0.5641, 1.1297, 0.5614, 0.5846, 0.5830, 0.7427, 0.5998, 0.5683, 0.5814,
        0.5978, 0.5731, 0.5867, 0.6031, 0.5560, 0.8135, 0.8034, 0.5699, 0.5998,
        0.5877], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux   1%|          | 19/2500 [14:10<30:20:18, 44.02s/it]  1%|          | 20/2500 [14:53<30:09:28, 43.78s/it]tensor([1.7290, 1.6036, 1.3913, 1.2982, 1.4627, 1.2492, 1.4557, 1.2880, 1.4007,
        1.5472, 1.3671, 1.2856, 1.1194, 1.1061, 1.0853, 1.0660, 1.1607, 0.9886,
        0.9663, 0.9084, 1.1643, 0.9019, 0.9765, 0.9974, 1.0010, 0.9189, 0.9769,
        0.8119, 0.8837, 0.8467, 0.9510, 0.7530, 0.7512, 0.7986, 0.7725, 0.7475,
        0.7798, 0.7197, 0.6808, 0.7298, 0.6789, 0.7544, 0.6496, 0.7051, 0.6515,
        0.7258, 0.6746, 0.7137, 0.6658, 0.7741, 0.6184, 0.6170, 0.6539, 0.7571,
        0.6626, 0.6242, 0.5796, 0.6761, 0.6328, 0.5957, 0.6364, 0.6111, 0.7330,
        0.5882, 0.5848, 0.5783, 0.5907, 0.6065, 0.5929, 0.5859, 0.6420, 0.6229,
        0.6011, 0.6130, 0.5917, 0.5620, 0.6129, 0.5726, 0.5879, 0.5970, 0.5772,
        0.5643, 0.6004, 0.6222, 0.5974, 0.5975, 0.5789, 0.5702, 0.5892, 0.5549,
        0.5742, 0.5663, 0.5750, 0.5711, 0.5727, 0.6037, 0.5746, 0.5643, 0.5737,
        0.5873], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.20634920634920634, middle:0.06382978723404255, tail0.0
3shot of client 1:head:0.23865877712031558, middle:0.09375, tail0.030303030303030304
3shot of client 2:head:0.29194630872483224, middle:0.0, tail0.1111111111111111
3shot of client 3:head:0.14137214137214138, middle:0.19047619047619047, tail0.0
3shot of client 4:head:0.29098360655737704, middle:0.0, tail0.034482758620689655
3shot of client 5:head:0.24070450097847357, middle:0.0, tail0.0
3shot of client 6:head:0.19047619047619047, middle:0.0, tail0.0
3shot of client 7:head:0.20833333333333334, middle:0.0, tail0.0
3shot of client 8:head:0.11161731207289294, middle:0.09401709401709402, tail0.0
3shot of client 9:head:0.24302788844621515, middle:0.04411764705882353, tail0.0
3shot of client 10:head:0.10614525139664804, middle:0.05813953488372093, tail0.0
3shot of client 11:head:0.28774928774928776, middle:0.0, tail0.0
3shot of client 12:head:0.35344827586206895, middle:0.011904761904761904, tail0.0
3shot of client 13:head:0.3950617283950617, middle:0.03529411764705882, tail0.0
3shot of client 14:head:0.32345013477088946, middle:0.0, tail0.08333333333333333
3shot of client 15:head:0.28174603174603174, middle:0.03225806451612903, tail0.0
3shot of client 16:head:0.19932432432432431, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.2696245733788396, middle:0.0, tail0.0
3shot of client 18:head:0.3272058823529412, middle:0.014285714285714285, tail0.058823529411764705
3shot of client 19:head:0.12794612794612795, middle:0.0, tail0.0
round 19, local average test acc  0.1912 

round 19, local macro average F1 score  0.0383 

round 19, local weighted average F1 score  0.1363 

round 19, global test acc  0.0418 

round 19, average 3shot acc: [head: 0.2418, middle: 0.0326, tail: 0.0159] 

round 19, global 3shot acc: [head: 0.1533, middle: 0.0015, tail: 0.0000] 

l_head tensor([2.2428, 1.3706, 1.8331, 0.5962, 2.9509, 3.5917, 3.0137, 0.7235, 3.9200,
        0.9310, 1.1134, 3.4233, 1.4251, 0.8737, 3.5364, 2.1442, 0.8342, 1.0095,
        0.5723, 1.1452, 0.5851, 0.8671, 1.3407, 2.2887, 1.6231, 1.0325, 1.6331,
        3.6330, 0.5792, 1.6234, 0.9378, 0.5895, 0.7930, 0.5855, 3.2327, 1.6349,
        1.7303, 0.7313, 2.0984, 0.5693, 0.8112, 0.5828, 0.6076, 0.5752, 0.7402,
        1.5793, 0.5540, 0.5730, 1.1328, 0.5824, 0.5699, 0.5661, 0.5696, 0.5920,
        0.8884, 0.5911, 0.8423, 0.9377, 0.5943, 0.5817, 0.7286, 0.5738, 1.5132,
        0.5900, 0.7919, 1.1207, 0.5897, 0.5863, 0.5953, 0.5867, 0.5832, 0.5959,
        0.5848, 0.5886, 0.7133, 0.5894, 0.5734, 0.7845, 0.5785, 0.5914, 0.5748,
        0.5641, 1.1536, 0.5614, 0.5846, 0.5830, 0.7335, 0.5998, 0.5683, 0.5814,
        0.5978, 0.5731, 0.5867, 0.6031, 0.5560, 0.7829, 0.7744, 0.5699, 0.5998,
        0.5877], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([1.7899, 1.6465, 1.4276, 1.3455, 1.5213, 1.2803, 1.5007, 1.3297, 1.4449,
        1.5954, 1.4240, 1.3177, 1.1590, 1.1565, 1.1207, 1.1179, 1.1979, 1.0447,
        0.9817, 0.9331, 1.2040, 0.9308, 1.0055, 1.0243, 1.0337, 0.9460, 0.9957,
        0.8340, 0.9083, 0.8810, 0.9964, 0.7740, 0.7693, 0.8212, 0.7791, 0.7646,
        0.8010, 0.7360, 0.6918, 0.7434, 0.6928, 0.7775, 0.6604, 0.7068, 0.6576,
        0.7400, 0.6804, 0.7257, 0.6785, 0.7967, 0.6231, 0.6241, 0.6720, 0.7687,
        0.6664, 0.6344, 0.5862, 0.6801, 0.6363, 0.5995, 0.6458, 0.6152, 0.7375,
        0.5919, 0.5926, 0.5802, 0.5927, 0.6101, 0.5965, 0.5881, 0.6432, 0.6282,
        0.6031, 0.6190, 0.5946, 0.5628, 0.6146, 0.5737, 0.5895, 0.5960, 0.5779,
        0.5647, 0.6038, 0.6228, 0.5992, 0.5999, 0.5770, 0.5707, 0.5899, 0.5555,
        0.5742, 0.5666, 0.5768, 0.5709, 0.5733, 0.6045, 0.5753, 0.5637, 0.5749,
        0.5867], device='cuda:6', grad_fn=<NormBackward1>)
round 20, global test acc  0.0508 

round 20, global 3shot acc: [head: 0.1644, middle: 0.0246, tail: 0.0000] 

3shot of client 0:head:0.15608465608465608, middle:0.10638297872340426, tail0.0
3shot of client 1:head:0.2938856015779093, middle:0.0390625, tail0.030303030303030304
3shot of client 2:head:0.1342281879194631, middle:0.09210526315789473, tail0.05555555555555555
3shot of client 3:head:0.32224532224532226, middle:0.19047619047619047, tail0.0
3shot of client 4:head:0.26434426229508196, middle:0.043478260869565216, tail0.0
3shot of client 5:head:0.20156555772994128, middle:0.008, tail0.0
3shot of client 6:head:0.11904761904761904, middle:0.02666666666666667, tail0.0
3shot of client 7:head:0.20833333333333334, middle:0.021739130434782608, tail0.0
3shot of client 8:head:0.24829157175398633, middle:0.03418803418803419, tail0.0
3shot of client 9:head:0.3426294820717131, middle:0.0, tail0.0
3shot of client 10:head:0.3687150837988827, middle:0.0, tail0.045454545454545456
3shot of client 11:head:0.3076923076923077, middle:0.0, tail0.0
3shot of client 12:head:0.27586206896551724, middle:0.0, tail0.0
3shot of client 13:head:0.2222222222222222, middle:0.08235294117647059, tail0.0
3shot of client 14:head:0.1940700808625337, middle:0.0, tail0.08333333333333333
3shot of client 15:head:0.29365079365079366, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.26013513513513514, middle:0.0, tail0.0
3shot of client 17:head:0.2901023890784983, middle:0.0, tail0.0
3shot of client 18:head:0.4264705882352941, middle:0.014285714285714285, tail0.0
3shot of client 19:head:0.24579124579124578, middle:0.0, tail0.0
round 20, local average test acc  0.2046 

round 20, local macro average F1 score  0.0382 

round 20, local weighted average F1 score  0.1362 

round 20, global test acc  0.0508 

round 20, average 3shot acc: [head: 0.2588, middle: 0.0362, tail: 0.0107] 

round 20, global 3shot acc: [head: 0.1644, middle: 0.0246, tail: 0.0000] 

l_head   1%|          | 21/2500 [15:46<32:04:06, 46.57s/it]  1%|          | 22/2500 [16:28<31:12:36, 45.34s/it]tensor([2.3641, 1.3785, 1.9198, 0.5962, 3.0223, 3.6963, 3.0444, 0.7277, 4.0606,
        0.9704, 1.1421, 3.5879, 1.4458, 0.9218, 3.6703, 2.2590, 0.8332, 1.0185,
        0.5723, 1.1035, 0.5851, 0.8673, 1.4248, 2.3140, 1.5917, 1.0365, 1.6955,
        3.7287, 0.5792, 1.6910, 0.9433, 0.5895, 0.8498, 0.5855, 3.3408, 1.7097,
        1.8371, 0.7526, 2.2482, 0.5693, 0.8330, 0.5828, 0.6076, 0.5752, 0.6994,
        1.7064, 0.5540, 0.5730, 1.2138, 0.5824, 0.5699, 0.5661, 0.5696, 0.5920,
        0.9087, 0.5911, 0.8661, 0.9904, 0.5943, 0.5817, 0.8330, 0.5738, 1.5696,
        0.5900, 0.7853, 1.1161, 0.5897, 0.5863, 0.5953, 0.5867, 0.5832, 0.5959,
        0.5848, 0.5886, 0.7382, 0.5894, 0.5734, 0.7641, 0.5785, 0.5914, 0.5748,
        0.5641, 1.2024, 0.5614, 0.5846, 0.5830, 0.7283, 0.5998, 0.5683, 0.5814,
        0.5978, 0.5731, 0.5867, 0.6031, 0.5561, 0.8315, 0.8011, 0.5699, 0.5998,
        0.5877], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([1.8538, 1.6806, 1.4714, 1.3935, 1.5671, 1.3128, 1.5436, 1.3964, 1.5095,
        1.6607, 1.4835, 1.3645, 1.2050, 1.1936, 1.1653, 1.1429, 1.2526, 1.0711,
        1.0186, 0.9626, 1.2531, 0.9623, 1.0365, 1.0533, 1.0623, 0.9783, 1.0294,
        0.8447, 0.9409, 0.9085, 1.0022, 0.8002, 0.7863, 0.8421, 0.7930, 0.7796,
        0.8201, 0.7530, 0.7050, 0.7600, 0.7024, 0.7962, 0.6694, 0.7192, 0.6693,
        0.7462, 0.6958, 0.7410, 0.6945, 0.8079, 0.6276, 0.6316, 0.6883, 0.7872,
        0.6697, 0.6373, 0.5879, 0.6964, 0.6363, 0.6045, 0.6613, 0.6187, 0.7477,
        0.5921, 0.5950, 0.5792, 0.5981, 0.6113, 0.6013, 0.5890, 0.6558, 0.6304,
        0.6013, 0.6194, 0.5955, 0.5642, 0.6150, 0.5736, 0.5888, 0.5991, 0.5765,
        0.5667, 0.6061, 0.6278, 0.5990, 0.6013, 0.5790, 0.5709, 0.5900, 0.5562,
        0.5732, 0.5666, 0.5777, 0.5717, 0.5739, 0.6069, 0.5763, 0.5649, 0.5741,
        0.5857], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.1693121693121693, middle:0.10638297872340426, tail0.041666666666666664
3shot of client 1:head:0.29980276134122286, middle:0.0625, tail0.0
3shot of client 2:head:0.32550335570469796, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.19750519750519752, middle:0.23015873015873015, tail0.0
3shot of client 4:head:0.319672131147541, middle:0.0, tail0.0
3shot of client 5:head:0.17221135029354206, middle:0.024, tail0.0
3shot of client 6:head:0.11904761904761904, middle:0.10666666666666667, tail0.0
3shot of client 7:head:0.1875, middle:0.0, tail0.0
3shot of client 8:head:0.26651480637813213, middle:0.05128205128205128, tail0.0
3shot of client 9:head:0.15139442231075698, middle:0.058823529411764705, tail0.2
3shot of client 10:head:0.26536312849162014, middle:0.0, tail0.0
3shot of client 11:head:0.36752136752136755, middle:0.011363636363636364, tail0.0
3shot of client 12:head:0.3160919540229885, middle:0.047619047619047616, tail0.0
3shot of client 13:head:0.3117283950617284, middle:0.011764705882352941, tail0.0
3shot of client 14:head:0.3450134770889488, middle:0.05263157894736842, tail0.0
3shot of client 15:head:0.15476190476190477, middle:0.12903225806451613, tail0.0
3shot of client 16:head:0.09797297297297297, middle:0.08823529411764706, tail0.0
3shot of client 17:head:0.20819112627986347, middle:0.041666666666666664, tail0.0
3shot of client 18:head:0.45955882352941174, middle:0.014285714285714285, tail0.11764705882352941
3shot of client 19:head:0.32996632996632996, middle:0.0, tail0.0
round 21, local average test acc  0.2036 

round 21, local macro average F1 score  0.0395 

round 21, local weighted average F1 score  0.1410 

round 21, global test acc  0.0508 

round 21, average 3shot acc: [head: 0.2532, middle: 0.0525, tail: 0.0180] 

round 21, global 3shot acc: [head: 0.1644, middle: 0.0246, tail: 0.0000] 

l_head tensor([2.3943, 1.4272, 1.9095, 0.5962, 3.1982, 3.8235, 3.1083, 0.7470, 4.0883,
        0.9769, 1.1578, 3.7966, 1.4858, 0.9423, 3.7380, 2.2696, 0.9004, 1.0154,
        0.5723, 1.1554, 0.5851, 0.9808, 1.3833, 2.4358, 1.6651, 1.0993, 1.8055,
        3.8185, 0.5792, 1.7295, 1.0478, 0.5895, 0.8993, 0.5855, 3.5075, 1.7452,
        1.8643, 0.7296, 2.3398, 0.5693, 0.8396, 0.5828, 0.6076, 0.5752, 0.7180,
        1.7825, 0.5540, 0.5730, 1.2037, 0.5824, 0.5699, 0.5661, 0.5696, 0.5921,
        0.9206, 0.5911, 0.8542, 1.0668, 0.5943, 0.5817, 0.7339, 0.5738, 1.5910,
        0.5900, 0.7971, 1.1740, 0.5897, 0.5863, 0.5953, 0.5867, 0.5832, 0.5959,
        0.5848, 0.5886, 0.7345, 0.5894, 0.5734, 0.7636, 0.5785, 0.5914, 0.5748,
        0.5641, 1.2769, 0.5614, 0.5846, 0.5830, 0.7547, 0.5998, 0.5683, 0.5814,
        0.5978, 0.5731, 0.5867, 0.6031, 0.5561, 0.8901, 0.7758, 0.5699, 0.5998,
        0.5877], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([1.9072, 1.7454, 1.5254, 1.4551, 1.6173, 1.3524, 1.6049, 1.4429, 1.5634,
        1.7075, 1.5387, 1.4042, 1.2381, 1.2272, 1.2154, 1.1872, 1.2856, 1.0899,
        1.0569, 0.9851, 1.2974, 0.9967, 1.0760, 1.0891, 1.0903, 0.9971, 1.0663,
        0.8646, 0.9587, 0.9339, 1.0289, 0.8234, 0.7971, 0.8646, 0.8149, 0.7972,
        0.8493, 0.7623, 0.7142, 0.7816, 0.7222, 0.8084, 0.6794, 0.7284, 0.6846,
        0.7564, 0.7030, 0.7649, 0.6979, 0.8387, 0.6299, 0.6320, 0.7015, 0.7953,
        0.6764, 0.6427, 0.5882, 0.7036, 0.6390, 0.6060, 0.6721, 0.6207, 0.7494,
        0.5980, 0.5979, 0.5817, 0.6019, 0.6172, 0.6054, 0.5900, 0.6569, 0.6353,
        0.6014, 0.6204, 0.5966, 0.5659, 0.6185, 0.5743, 0.5914, 0.5967, 0.5768,
        0.5698, 0.6115, 0.6332, 0.5995, 0.6035, 0.5830, 0.5711, 0.5907, 0.5587,
        0.5723, 0.5683, 0.5798, 0.5734, 0.5760, 0.6103, 0.5774, 0.5653, 0.5738,
        0.5861], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.12962962962962962, middle:0.0851063829787234, tail0.0
3shot of client 1:head:0.33530571992110453, middle:0.109375, tail0.0
3shot of client 2:head:0.3959731543624161, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.17671517671517672, middle:0.1984126984126984, tail0.0
3shot of client 4:head:0.2581967213114754, middle:0.0, tail0.0
3shot of client 5:head:0.1917808219178082, middle:0.016, tail0.0
3shot of client 6:head:0.18027210884353742, middle:0.05333333333333334, tail0.0
3shot of client 7:head:0.20833333333333334, middle:0.021739130434782608, tail0.0
  1%|          | 23/2500 [17:14<31:09:53, 45.29s/it]3shot of client 8:head:0.2255125284738041, middle:0.008547008547008548, tail0.0
3shot of client 9:head:0.21115537848605578, middle:0.0, tail0.0
3shot of client 10:head:0.06424581005586592, middle:0.0, tail0.0
3shot of client 11:head:0.33618233618233617, middle:0.045454545454545456, tail0.043478260869565216
3shot of client 12:head:0.3103448275862069, middle:0.011904761904761904, tail0.0
3shot of client 13:head:0.36728395061728397, middle:0.0, tail0.0
3shot of client 14:head:0.2830188679245283, middle:0.021052631578947368, tail0.0
3shot of client 15:head:0.09523809523809523, middle:0.14516129032258066, tail0.0
3shot of client 16:head:0.15202702702702703, middle:0.0, tail0.0
3shot of client 17:head:0.15017064846416384, middle:0.0, tail0.0
3shot of client 18:head:0.5514705882352942, middle:0.0, tail0.0
3shot of client 19:head:0.13804713804713806, middle:0.0125, tail0.058823529411764705
round 22, local average test acc  0.1885 

round 22, local macro average F1 score  0.0400 

round 22, local weighted average F1 score  0.1344 

round 22, global test acc  0.0508 

round 22, average 3shot acc: [head: 0.2380, middle: 0.0371, tail: 0.0051] 

round 22, global 3shot acc: [head: 0.1644, middle: 0.0246, tail: 0.0000] 

l_head tensor([2.4923, 1.4859, 1.9991, 0.5962, 3.2996, 3.9200, 3.2582, 0.7617, 4.1810,
        1.0130, 1.2063, 3.8774, 1.5134, 0.9619, 3.9230, 2.4217, 0.9408, 1.0223,
        0.5723, 1.1953, 0.5851, 0.9279, 1.4209, 2.5125, 1.7119, 1.1167, 1.8176,
        3.9583, 0.5792, 1.7705, 1.0104, 0.5895, 0.8644, 0.5855, 3.5410, 1.8284,
        1.8559, 0.7848, 2.4705, 0.5693, 0.8908, 0.5828, 0.6076, 0.5752, 0.7511,
        1.8033, 0.5540, 0.5730, 1.2142, 0.5824, 0.5699, 0.5661, 0.5696, 0.5921,
        0.9390, 0.5911, 0.8217, 1.0347, 0.5943, 0.5817, 0.7706, 0.5738, 1.5734,
        0.5900, 0.8107, 1.2702, 0.5897, 0.5863, 0.5953, 0.5867, 0.5832, 0.5959,
        0.5848, 0.5886, 0.7507, 0.5894, 0.5734, 0.7747, 0.5786, 0.5914, 0.5748,
        0.5641, 1.3296, 0.5614, 0.5846, 0.5830, 0.7665, 0.5998, 0.5683, 0.5814,
        0.5978, 0.5731, 0.5867, 0.6031, 0.5561, 0.8966, 0.8251, 0.5699, 0.5998,
        0.5877], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux tensor([1.9528, 1.7905, 1.5595, 1.5064, 1.6689, 1.3844, 1.6394, 1.4785, 1.6197,
        1.7571, 1.5939, 1.4493, 1.2739, 1.2683, 1.2496, 1.2174, 1.3343, 1.1281,
        1.0837, 1.0169, 1.3275, 1.0222, 1.1079, 1.1292, 1.1168, 1.0294, 1.0918,
        0.8901, 0.9737, 0.9598, 1.0700, 0.8476, 0.8165, 0.8845, 0.8323, 0.8055,
        0.8643, 0.7749, 0.7322, 0.8000, 0.7276, 0.8309, 0.6918, 0.7415, 0.6970,
        0.7697, 0.7138, 0.7805, 0.7077, 0.8528, 0.6428, 0.6404, 0.7116, 0.8042,
        0.6855, 0.6451, 0.5885, 0.7074, 0.6445, 0.6119, 0.6725, 0.6285, 0.7582,
        0.6025, 0.5999, 0.5816, 0.6061, 0.6195, 0.6072, 0.5925, 0.6662, 0.6341,
        0.6041, 0.6252, 0.5992, 0.5695, 0.6194, 0.5752, 0.5948, 0.5962, 0.5775,
        0.5692, 0.6150, 0.6353, 0.6002, 0.6047, 0.5838, 0.5708, 0.5900, 0.5587,
        0.5729, 0.5687, 0.5819, 0.5735, 0.5775, 0.6101, 0.5783, 0.5645, 0.5737,
        0.5870], device='cuda:6', grad_fn=<NormBackward1>)
3shot of client 0:head:0.1693121693121693, middle:0.1276595744680851, tail0.0
3shot of client 1:head:0.34122287968441817, middle:0.1171875, tail0.030303030303030304
3shot of client 2:head:0.39932885906040266, middle:0.02631578947368421, tail0.0
3shot of client 3:head:0.21205821205821207, middle:0.0873015873015873, tail0.0
3shot of client 4:head:0.20901639344262296, middle:0.0, tail0.0
3shot of client 5:head:0.21135029354207435, middle:0.0, tail0.0
3shot of client 6:head:0.20408163265306123, middle:0.02666666666666667, tail0.0
3shot of client 7:head:0.13020833333333334, middle:0.06521739130434782, tail0.08333333333333333
3shot of client 8:head:0.15945330296127563, middle:0.017094017094017096, tail0.0
3shot of client 9:head:0.17928286852589642, middle:0.014705882352941176, tail0.0
3shot of client 10:head:0.18994413407821228, middle:0.03488372093023256, tail0.0
3shot of client 11:head:0.18803418803418803, middle:0.011363636363636364, tail0.043478260869565216
3shot of client 12:head:0.3649425287356322, middle:0.0, tail0.0
3shot of client 13:head:0.24691358024691357, middle:0.011764705882352941, tail0.0
3shot of client 14:head:0.12668463611859837, middle:0.031578947368421054, tail0.041666666666666664
3shot of client 15:head:0.1111111111111111, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.2195945945945946, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.2696245733788396, middle:0.013888888888888888, tail0.0
3shot of client 18:head:0.40441176470588236, middle:0.014285714285714285, tail0.0
3shot of client 19:head:0.26262626262626265, middle:0.0, tail0.058823529411764705
round 23, local average test acc  0.1822 

round 23, local macro average F1 score  0.0366 

round 23, local weighted average F1 score  0.1304 

round 23, global test acc  0.0508 

round 23, average 3shot acc: [head: 0.2300, middle: 0.0340, tail: 0.0129] 

round 23, global 3shot acc: [head: 0.1644, middle: 0.0246, tail: 0.0000] 

l_head tensor([2.4962, 1.5195, 2.0736, 0.5962, 3.4060, 4.0151, 3.3308, 0.7298, 4.4129,
        0.9988, 1.2571, 4.0159, 1.5955, 0.9559, 4.0328, 2.4004, 0.9306, 1.0764,
        0.5723, 1.2525, 0.5851, 0.9721, 1.5102, 2.6743, 1.7378, 1.1791, 1.8178,
        4.1272, 0.5792, 1.7844, 1.1055, 0.5895, 0.8782, 0.5855, 3.6627, 1.8360,
        2.0308, 0.7727, 2.5815, 0.5694, 0.8918, 0.5828, 0.6077, 0.5752, 0.7416,
        1.8129, 0.5540, 0.5730, 1.3973, 0.5824, 0.5699, 0.5661, 0.5696, 0.5921,
        0.9625, 0.5911, 0.9498, 1.0343, 0.5943, 0.5817, 0.7665, 0.5738, 1.6629,
        0.5900, 0.8281, 1.2808, 0.5897, 0.5863, 0.5953, 0.5867, 0.5832, 0.5959,
        0.5848, 0.5886, 0.7553, 0.5894, 0.5734, 0.7811, 0.5786, 0.5914, 0.5748,
        0.5641, 1.3334, 0.5614, 0.5846, 0.5830, 0.7962, 0.5998, 0.5683, 0.5814,
        0.5978, 0.5731, 0.5867, 0.6031, 0.5561, 0.8972, 0.7920, 0.5699, 0.5998,
        0.5877], device='cuda:6', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:6', grad_fn=<NormBackward1>)
g_aux   1%|          | 24/2500 [17:59<31:04:20, 45.18s/it]  1%|          | 25/2500 [18:43<30:52:17, 44.90s/it]
nohup: ignoring input
/data/zikai/aaPFL/pfedlt/util/etf_methods.py:130: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  sparse_etf = torch.tensor(sparse_etf, requires_grad=True)
./temp/fl_acc_cifar10_resnet18_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N40_10_seed3407_p1_dirichlet1.0_IF0.01_LossCE.txt
Files already downloaded and verified
[5000, 2997, 1796, 1077, 645, 387, 232, 139, 83, 50]
12406
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[257, 284, 401, 688, 137, 360, 251, 282, 255, 443, 163, 390, 288, 184, 530, 169, 295, 376, 627, 386, 189, 195, 730, 261, 348, 298, 518, 126, 167, 240, 210, 195, 351, 229, 96, 224, 390, 483, 166, 224]
training set distribution:
[[127  47  21  36  13   3   0   9   1   0]
 [ 75  21 102  15   5  36  26   3   1   0]
 [150  95 109  11   0  16   6  14   0   0]
 [336  82 146  42  45  18  11   3   5   0]
 [ 57   4  53   7  12   0   1   2   1   0]
 [ 86 182  12  25   5  43   0   5   2   0]
 [119  56  48  14   1   1   5   1   3   3]
 [ 86  38  56  60  25   0  11   6   0   0]
 [111   1  39  64  28   5   5   1   1   0]
 [112 248  14   3  53   6   0   2   4   1]
 [ 29 100   0   8  11   1   3   9   1   1]
 [125 133  12  82  22   0   8   3   0   5]
 [172  78   3   3  11   7  13   0   0   1]
 [  5 159   4   1   8   1   5   1   0   0]
 [  7 275 188  29   5  15   1   5   1   4]
 [ 16  43  45  29   8   1  14   3   8   2]
 [160  63  38   0   7  14   6   5   2   0]
 [ 37  27 263  39   2   1   2   0   2   3]
 [401  90  28  56   8   8  32   0   1   3]
 [287   4  23  51  10   7   0   1   1   2]
 [  5  85  49  22   9  11   5   3   0   0]
 [  8  83  21  15   6  36   9  11   5   1]
 [347 225  56  40  47   4   1   7   3   0]
 [ 87  54  99   2   8   1   5   2   3   0]
 [242   1  14   6  45  18  12   2   8   0]
 [217  16  15   0  40   6   1   3   0   0]
 [413  41   5  22   2  25   3   3   4   0]
 [ 62  24   6   8  13   1   3   1   8   0]
 [ 61  12  14  37  19  15   0   5   0   4]
 [ 87  37  51  40   8   0  14   0   0   3]
 [ 43  37  36  22  53   7   6   2   4   0]
 [ 73 107   0   0   5   1   1   5   3   0]
 [ 80  74  39 132  18   2   2   0   4   0]
 [ 48  33 105  30   9   0   0   3   0   1]
 [ 14  22  13  16  12   2   0   5   5   7]
 [148  11   0  32  13  12   2   2   0   4]
 [305  17  16   9  22   5  12   2   1   1]
 [224 151  15  35  24  24   3   3   0   4]
 [ 26  82   1  17  11  21   1   6   1   0]
 [ 12 139  37  17   2  13   3   1   0   0]]
Total size of training set
12406
local test distribution:
[[102  37  16  29  10   2   0   7   0   0]
 [ 60  16  82  12   4  29  20   2   0   0]
 [120  76  87   8   0  12   4  11   0   0]
 [270  66 117  33  36  14   8   2   4   0]
 [ 45   3  42   5   9   0   0   1   0   0]
 [ 69 146   9  20   4  34   0   4   1   0]
 [ 95  45  38  11   0   0   4   0   2   2]
 [ 69  30  45  48  20   0   8   4   0   0]
 [ 89   0  31  51  22   4   4   0   0   0]
 [ 90 199  11   2  42   4   0   1   3   0]
 [ 23  80   0   6   8   0   2   7   0   0]
 [100 107   9  66  17   0   6   2   0   4]
 [138  62   2   2   8   5  10   0   0   0]
 [  4 128   3   0   6   0   4   0   0   0]
 [  5 221 151  23   4  12   0   4   0   3]
 [ 12  34  36  23   6   0  11   2   6   1]
 [128  50  30   0   5  11   4   4   1   0]
 [ 29  21 211  31   1   0   1   0   1   2]
 [323  72  22  45   6   6  25   0   0   2]
 [231   3  18  41   8   5   0   0   0   1]
 [  4  68  39  17   7   8   4   2   0   0]
 [  6  66  16  12   4  29   7   8   4   0]
 [279 181  45  32  37   3   0   5   2   0]
 [ 70  43  79   1   6   0   4   1   2   0]
 [195   0  11   4  36  14   9   1   6   0]
 [174  12  12   0  32   4   0   2   0   0]
 [332  33   4  17   1  20   2   2   3   0]
 [ 49  19   4   6  10   0   2   0   6   0]
 [ 49   9  11  29  15  12   0   4   0   3]
 [ 70  29  41  32   6   0  11   0   0   2]
 [ 34  29  29  17  42   5   4   1   3   0]
 [ 58  86   0   0   4   0   0   4   2   0]
 [ 64  59  31 106  14   1   1   0   3   0]
 [ 38  26  84  24   7   0   0   2   0   0]
 [ 11  17  10  12   9   1   0   4   4   5]
 [119   8   0  25  10   9   1   1   0   3]
 [245  13  12   7  17   4   9   1   0   0]
 [180 121  12  28  19  19   2   2   0   3]
 [ 20  66   0  13   8  16   0   4   0   0]
 [  9 112  29  13   1  10   2   0   0   0]]
Total size of testing set
9823
[4008 2393 1429  851  501  293  169   95   53   31]
40
Step 0, Loss 1.1313602924346924
Step 100, Loss 0.10807156562805176
Step 200, Loss -0.550817608833313
Step 300, Loss -0.9710581302642822
Step 400, Loss -1.2392072677612305
Step 500, Loss -1.4102344512939453
Step 600, Loss -1.5181916952133179
Step 700, Loss -1.5853404998779297
Step 800, Loss -1.6266037225723267
Step 900, Loss -1.650447130203247
Step 1000, Loss -1.6643906831741333
Step 1100, Loss -1.671715497970581
Step 1200, Loss -1.6754032373428345
Step 1300, Loss -1.6776376962661743
Step 1400, Loss -1.6788241863250732
Step 1500, Loss -1.6796735525131226
Step 1600, Loss -1.679692029953003
Step 1700, Loss -1.6800647974014282
Step 1800, Loss -1.6796319484710693
Step 1900, Loss -1.6800460815429688
Step 2000, Loss -1.6799345016479492
Step 2100, Loss -1.680234432220459
Step 2200, Loss -1.6802860498428345
Step 2300, Loss -1.6806066036224365
Step 2400, Loss -1.6806436777114868
Step 2500, Loss -1.6803910732269287
Step 2600, Loss -1.6802269220352173
Step 2700, Loss -1.680507779121399
Step 2800, Loss -1.6804423332214355
Step 2900, Loss -1.6803381443023682
Step 3000, Loss -1.6805980205535889
Step 3100, Loss -1.6804019212722778
Step 3200, Loss -1.6803581714630127
Step 3300, Loss -1.6801745891571045
Step 3400, Loss -1.6801562309265137
Step 3500, Loss -1.680593729019165
Step 3600, Loss -1.6802812814712524
Step 3700, Loss -1.680240511894226
Step 3800, Loss -1.6805001497268677
Step 3900, Loss -1.6802374124526978
Step 4000, Loss -1.6803677082061768
Step 4100, Loss -1.6800178289413452
Step 4200, Loss -1.6805474758148193
Step 4300, Loss -1.6808089017868042
Step 4400, Loss -1.680326223373413
Step 4500, Loss -1.6807705163955688
Step 4600, Loss -1.680830478668213
Step 4700, Loss -1.680709958076477
Step 4800, Loss -1.6804721355438232
Step 4900, Loss -1.680476427078247
Step 5000, Loss -1.6804327964782715
Step 5100, Loss -1.680461049079895
Step 5200, Loss -1.6800885200500488
Step 5300, Loss -1.6806012392044067
Step 5400, Loss -1.6804640293121338
Step 5500, Loss -1.6806814670562744
Step 5600, Loss -1.6807876825332642
Step 5700, Loss -1.680604338645935
Step 5800, Loss -1.6804903745651245
Step 5900, Loss -1.6808359622955322
Step 6000, Loss -1.6805201768875122
Step 6100, Loss -1.6806066036224365
Step 6200, Loss -1.6806612014770508
Step 6300, Loss -1.6804790496826172
Step 6400, Loss -1.6807231903076172
Step 6500, Loss -1.6804648637771606
Step 6600, Loss -1.6804742813110352
Step 6700, Loss -1.6801085472106934
Step 6800, Loss -1.6803733110427856
Step 6900, Loss -1.6804777383804321
Step 7000, Loss -1.6805349588394165
Step 7100, Loss -1.68053138256073
Step 7200, Loss -1.6806800365447998
Step 7300, Loss -1.6806468963623047
Step 7400, Loss -1.6807388067245483
Step 7500, Loss -1.6806998252868652
Step 7600, Loss -1.6803783178329468
Step 7700, Loss -1.6804043054580688
Step 7800, Loss -1.6805976629257202
Step 7900, Loss -1.6808120012283325
Step 8000, Loss -1.6808124780654907
Step 8100, Loss -1.6806854009628296
Step 8200, Loss -1.6808228492736816
Step 8300, Loss -1.6805869340896606
Step 8400, Loss -1.680582880973816
Step 8500, Loss -1.6808747053146362
Step 8600, Loss -1.6808792352676392
Step 8700, Loss -1.680612564086914
Step 8800, Loss -1.680761456489563
Step 8900, Loss -1.6804240942001343
Step 9000, Loss -1.6807701587677002
Step 9100, Loss -1.680649757385254
Step 9200, Loss -1.6807372570037842
Step 9300, Loss -1.6808165311813354
Step 9400, Loss -1.6807852983474731
Step 9500, Loss -1.6805026531219482
Step 9600, Loss -1.6805976629257202
Step 9700, Loss -1.6806230545043945
Step 9800, Loss -1.6804046630859375
Step 9900, Loss -1.6809147596359253
Angle Mean: 96.37908935546875, Angle Variance: 0.00539291650056839
Norm Mean: 0.1005556583404541, Norm Variance: 1.5518777374268211e-09
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [01:58<16:28:47, 118.89s/it]
nohup: ignoring input
./temp/fl_acc_cifar100_resnet34_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N20_100_seed3407_p1_dirichlet0.5_IF0.01_LossCE.txt
Files already downloaded and verified
[500, 477, 455, 434, 415, 396, 378, 361, 344, 328, 314, 299, 286, 273, 260, 248, 237, 226, 216, 206, 197, 188, 179, 171, 163, 156, 149, 142, 135, 129, 123, 118, 112, 107, 102, 98, 93, 89, 85, 81, 77, 74, 70, 67, 64, 61, 58, 56, 53, 51, 48, 46, 44, 42, 40, 38, 36, 35, 33, 32, 30, 29, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 15, 14, 13, 13, 12, 12, 11, 11, 10, 10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5]
10847
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[573, 766, 469, 733, 726, 766, 466, 320, 676, 410, 554, 546, 535, 512, 586, 396, 460, 448, 431, 474]
training set distribution:
[[  8   5  18   0  32  55  32   1  64   2   4  41   7   3  47  19   2   3
    0   6   0   3   5  14   6   4   9  50   0  11   3   0   2   0  38  12
   11   1  19   0   1   0   0   0   1  10   0   0   3   0   0   0   0   0
    1   0   2   2   0   0   1   0   2   0   2   4   0   0   0   0   0   0
    0   0   1   0   0   1   0   0   0   0   2   0   0   0   1   0   0   0
    0   0   0   0   0   1   1   0   0   0]
 [ 99   7  26  25  22   2  54  80   2  28  22  33   7  19 105   0   1   3
    4  13   2  26   9   3   0   4   4   4  37   0  18   1   2   6   5  16
    4   0  15  13   1   0   0   0   3   2   0   0   0   0   2   2   3   9
    1   0   2   0   2   1   0   0   3   0   0   0   0   0   0   7   0   0
    0   0   0   0   0   0   0   0   0   0   0   1   0   2   1   0   0   0
    0   2   0   1   0   0   0   0   0   0]
 [ 14  60   9  13   3  40   0   8   0   6  24  11  75  13  14   6  11   2
    2   7   0   0   0   0   0  10   0   4   0   3   7  10  11   3   5   0
    8   6   1   0   1   8   1   1   5   0   5   2   4   8   0   1   3   0
    2   1   1   1   3   3   2   2   0   0   0   0   0   0   0   0   2   0
    0   1   4   0   6   1   0   0   4   0   3   0   3   0   1   0   1   2
    0   0   0   0   0   0   0   1   0   0]
 [ 23  89  56   2  47   1   7   8  48  33   0  49   1  29   5  32   2  17
   76   5  13  10   0  12   0   0   2   0   9  19  16   2   0  18   2   0
    6   0   0   2   2   1  26   5  10   2   0   1   0   0   4   1   0   1
    1   0   0   0   0   1   3   0   0   8   3   2   0   1   3   0   1   0
    0   4   0   0   0   0   0   0   0   0   0   1   0   1   0   1   3   0
    3   0   1   0   2   0   0   0   0   0]
 [  9  95  66   3  48   7  41  15  36  24  65   1   2   1   0   2   4   8
    0   6  29   0   2  53   7   2  24  19  10  14   0   3   0  25   2   5
    0  30   3   0   4   0   4   7   7   4   0   0   8   4   3   1   0   0
    2   0   0   4   0   0   0   0   1   0   4   0   0   0   0   0   1   3
    1   0   0   1   0   0   2   1   0   0   1   0   0   0   1   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 22  45  14  67   2   2  54  10  18  22  47  12  10  71  16   1  52   4
    7   1  31  36  16   8  25  30   7   0   8   0   3   0   6   6   6  27
    0   0   0   0   4   0   0   0   2   5   4   5   9   1   5   3   3   0
    1   0   6  14   1   1   0   0   1   0   1   3   0   0   0   0   0   4
    1   2   0   0   0   1   0   1   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [  5   0   1  11  50   1  31  30  22  10   1   1   8   4   2   0   2   6
   31   0  15  46   1   7   9   1  18   0   0  10   5   0   7   2  24   2
    6   2   5  18   4   3   3   0   0   0   2   4   3   8   0   3   1   1
    0   2   4   3   0   0   0   6   0   2   0   2   0   2   0   2   3   0
    0   0   0   0   0   2   1   3   0   0   0   0   0   0   1   0   3   0
    0   0   0   2   0   0   1   0   0   1]
 [  0  19   5  26  11  14   5  14   2  11   1  12  20   2   7   6   0   0
    3   0  21   0   3   0   1   1  14   0   2  12   1   9   3   0   4   6
    1   1   5   0   2  10   1   4   1   2   6   0   2   2   1   4   3   1
    0  16   3   0   0   0   1   0   1   1   0   1   0   3   2   0   1   0
    0   1   1   2   0   1   1   2   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [ 44  21  72  58  46  20   1   1  52   0  37  46  14   5  10  11  17   8
    1   1   1   1   8  16  15  40   0   0   0  12   1  10   1   0   0   3
    9   0   5   3   6   5   6   2   7   0   0   5   0   0   2   1   0   0
    7  11   3   0   1   1   2   0   0   0   3   0   4   0   0   1   5   0
    1   0   0   0   0   0   1   0   2   1   0   0   0   0   2   2   0   1
    0   1   0   0   0   0   1   0   0   2]
 [  0  16   3   2  33  70   1  22   1   5  45   9   5   6   3   7   0  14
    7   5   8   5   2   0   1   4   2   5   0   0   1  12   1   7   0   2
    1   2  15  18   0   2   0   0   7  10   3   0   1   2   2   0   5   0
    1   0   7   0   2   0   0   1   0   0   0   0   1   0   0   0   3   1
    0   3   0   3   1   0   0   0   0   0   3   0   2   2   0   2   0   1
    0   1   0   1   0   1   0   0   0   2]
 [  0   0   0  28  16   3  89  14  43   6   9   7   0  12   0   2  62   0
    8  74   2   2   0  26   2   1   8   2   6   0   1   0   2   2   1   2
    5   1   1   0   8   2   0   1   4   7   0  18   0   2   1   0   0  13
    4   0   4   1   0   3   3   0   0   3   3   0   8   0   2   1   0   0
    9   1   2   3   0   1   4   0   1   0   0   1   0   2   0   0   0   0
    0   0   1   0   1   1   0   0   2   0]
 [ 90   0  30  51   5   0   4   3   1   5   1   1   8  11  23  84   0  23
    4   6   0   2   9   0   0   3   0   7   7  17   5   2  21   5   0   3
    0   2   0   2   0   0   0  10   0   1  13   3   0   7   1   2   3   1
    5   0   0   0   6   3   1   1   3   0   5  11   0  12   0   1   0   4
    1   0   4   0   0   0   0   0   1   0   0   3   0   0   0   1   0   1
    2   0   0   0   0   1   1   1   2   0]
 [  9  41   0  22   1  13   6   1   0  53  13   6  47  19   4   2   2  13
   10  15   3   0   0   0  67   8   7   2  37   0  35   0   0  11   0   4
    4   1   2   0   0   8   3   4   2   0   0   0   3   0   5   3   2   8
    5   1   0   5   1   0   1   0   3   0   2   0   0   0   7   0   0   2
    0   0   0   1   3   0   1   0   2   0   1   0   1   0   0   0   0   0
    0   1   0   0   1   0   1   0   0   0]
 [ 14  17   3  80   2  97  18   3   0  17   3   1  13  20   0   1   3   6
    0   0   1  24  40   6   2   1   2   8   0   7   5   1   0   2   1   0
    1   0   5   1  12   4   0  19   6   4   1   5   0   8   0   6   6   0
    2   3   0   0   1   5   0   1   1   6   0   0   0   0   0   1   1   2
    0   0   0   1   3   0   0   2   0   3   0   2   1   0   0   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 30  43   0  19   2   1  17 114   1  68   2   0   6   2   4   9   7  28
    0  11   2   0   7   2  11  12   5  14   9  12   3   2  10   7   0   2
    8   2   0   6  14   4   1   0   0   0  13   1   4   0   8   5   4   0
    6   0   0   4   0   0   2   7   7   2   0   1   2   0   2   3   0   2
    1   0   0   1   0   1   0   2   1   1   0   0   2   2   2   0   0   1
    0   0   0   0   0   1   0   0   1   0]
 [  3   5  43   6  25   7   1  18   0   8   2   2   7   0   0   1   0   0
   37  11   7   0   6   1   3   0  19   0   0   8   0  35  25   0   1  10
    4   0   1  11   6   0   0   4   4   8   5   0  11   9   2   3   0   2
    0   1   1   0   2   2   8   0   4   1   0   0   0   3   1   1   1   0
    0   2   1   2   0   1   0   0   0   3   0   0   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   0   0]
 [ 19   2  21  13   2   0   8  10   1   3  15  15   4  12  17  10  27  40
    1   2   6   1  62  18   2  11  21   7   6   1   0   1   1   1   2   4
   24  15   1   0   2   0   4   1   0   0   2  10   0   0   1   3   4   5
    0   3   0   0   0   0   0   3   0   0   1   0   2   0   0   0   0   0
    0   0   1   0   1   2   3   1   0   0   0   1   1   0   0   0   0   0
    0   1   0   0   2   0   0   0   0   0]
 [  7   5   3   5  21  54   9   0  10   9  20  45  36  35   3  12  23   8
    1   7   0  24   0   4   6  20   6  10   1   0   0   2   0   0   5   0
    0  22   0   6   1   0   0   1   0   0   4   0   3   0   1   0   1   0
    0   0   0   1   0   0   0   6   0   0   1   0   0   0   0   0   0   0
    1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   1
    1   1   1   1   0   0   0   1   0   0]
 [ 87   7  18   0  21   1   0   8   3   2   0   1   6   7   0  10   3  41
    4  35   2   7   7   0   1   2   0  10   3   1  17   2  20   0   0   0
    1   3   0   0   5  20  20   1   5   2   0   2   0   0   9   3   1   1
    2   0   1   0   1  11   1   1   0   3   0   0   3   1   0   3   1   0
    0   1   1   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   1   0   0   0   0]
 [ 17   0  67   3  26   8   0   1  40  16   3   6  10   2   0  33  19   2
   20   1  54   1   2   1   5   2   1   0   0   2   2  26   0  12   6   0
    0   1   7   1   4   7   1   7   0   4   0   0   2   0   1   5   5   0
    0   0   2   0  13   1   5   1   1   0   0   0   3   0   4   0   0   0
    2   0   0   1   0   1   0   0   0   3   0   1   0   0   0   1   0   0
    0   0   1   1   0   0   0   0   0   0]]
Total size of training set
10847
local test distribution:
[[  7   4  16   0  29  50  29   0  59   1   3  37   6   2  43  17   1   2
    0   5   0   2   4  12   5   3   8  46   0  10   2   0   1   0  35  11
   10   0  17   0   0   0   0   0   0   9   0   0   2   0   0   0   0   0
    0   0   1   1   0   0   0   0   1   0   1   3   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 91   6  23  23  20   1  49  73   1  25  20  30   6  17  96   0   0   2
    3  11   1  23   8   2   0   3   3   3  34   0  16   0   1   5   4  14
    3   0  13  11   0   0   0   0   2   1   0   0   0   0   1   1   2   8
    0   0   1   0   1   0   0   0   2   0   0   0   0   0   0   6   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0
    0   1   0   0   0   0   0   0   0   0]
 [ 12  55   8  11   2  36   0   7   0   5  22  10  69  11  12   5  10   1
    1   6   0   0   0   0   0   9   0   3   0   2   6   9  10   2   4   0
    7   5   0   0   0   7   0   0   4   0   4   1   3   7   0   0   2   0
    1   0   0   0   2   2   1   1   0   0   0   0   0   0   0   0   1   0
    0   0   3   0   5   0   0   0   3   0   2   0   2   0   0   0   0   1
    0   0   0   0   0   0   0   0   0   0]
 [ 21  82  51   1  43   0   6   7  44  30   0  45   0  26   4  29   1  15
   70   4  11   9   0  11   0   0   1   0   8  17  14   1   0  16   1   0
    5   0   0   1   1   0  23   4   9   1   0   0   0   0   3   0   0   0
    0   0   0   0   0   0   2   0   0   7   2   1   0   0   2   0   0   0
    0   3   0   0   0   0   0   0   0   0   0   0   0   0   0   0   2   0
    2   0   0   0   1   0   0   0   0   0]
 [  8  87  60   2  44   6  37  13  33  22  59   0   1   0   0   1   3   7
    0   5  26   0   1  48   6   1  22  17   9  12   0   2   0  23   1   4
    0  27   2   0   3   0   3   6   6   3   0   0   7   3   2   0   0   0
    1   0   0   3   0   0   0   0   0   0   3   0   0   0   0   0   0   2
    0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 20  41  12  61   1   1  49   9  16  20  43  11   9  65  14   0  47   3
    6   0  28  33  14   7  23  27   6   0   7   0   2   0   5   5   5  24
    0   0   0   0   3   0   0   0   1   4   3   4   8   0   4   2   2   0
    0   0   5  12   0   0   0   0   0   0   0   2   0   0   0   0   0   3
    0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  4   0   0  10  46   0  28  27  20   9   0   0   7   3   1   0   1   5
   28   0  13  42   0   6   8   0  16   0   0   9   4   0   6   1  22   1
    5   1   4  16   3   2   2   0   0   0   1   3   2   7   0   2   0   0
    0   1   3   2   0   0   0   5   0   1   0   1   0   1   0   1   2   0
    0   0   0   0   0   1   0   2   0   0   0   0   0   0   0   0   2   0
    0   0   0   1   0   0   0   0   0   0]
 [  0  17   4  23  10  12   4  12   1  10   0  11  18   1   6   5   0   0
    2   0  19   0   2   0   0   0  12   0   1  11   0   8   2   0   3   5
    0   0   4   0   1   9   0   3   0   1   5   0   1   1   0   3   2   0
    0  14   2   0   0   0   0   0   0   0   0   0   0   2   1   0   0   0
    0   0   0   1   0   0   0   1   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 40  19  66  53  42  18   0   0  47   0  34  42  12   4   9  10  15   7
    0   0   0   0   7  14  13  36   0   0   0  11   0   9   0   0   0   2
    8   0   4   2   5   4   5   1   6   0   0   4   0   0   1   0   0   0
    6  10   2   0   0   0   1   0   0   0   2   0   3   0   0   0   4   0
    0   0   0   0   0   0   0   0   1   0   0   0   0   0   1   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0  14   2   1  30  64   0  20   0   4  41   8   4   5   2   6   0  12
    6   4   7   4   1   0   0   3   1   4   0   0   0  11   0   6   0   1
    0   1  13  16   0   1   0   0   6   9   2   0   0   1   1   0   4   0
    0   0   6   0   1   0   0   0   0   0   0   0   0   0   0   0   2   0
    0   2   0   2   0   0   0   0   0   0   2   0   1   1   0   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0   0   0  25  14   2  82  12  39   5   8   6   0  11   0   1  57   0
    7  68   1   1   0  23   1   0   7   1   5   0   0   0   1   1   0   1
    4   0   0   0   7   1   0   0   3   6   0  16   0   1   0   0   0  11
    3   0   3   0   0   2   2   0   0   2   2   0   7   0   1   0   0   0
    8   0   1   2   0   0   3   0   0   0   0   0   0   1   0   0   0   0
    0   0   0   0   0   0   0   0   1   0]
 [ 82   0  27  47   4   0   3   2   0   4   0   0   7  10  21  77   0  21
    3   5   0   1   8   0   0   2   0   6   6  15   4   1  19   4   0   2
    0   1   0   1   0   0   0   9   0   0  11   2   0   6   0   1   2   0
    4   0   0   0   5   2   0   0   2   0   4  10   0  11   0   0   0   3
    0   0   3   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   1   0]
 [  8  37   0  20   0  11   5   0   0  48  11   5  43  17   3   1   1  11
    9  13   2   0   0   0  61   7   6   1  34   0  32   0   0  10   0   3
    3   0   1   0   0   7   2   3   1   0   0   0   2   0   4   2   1   7
    4   0   0   4   0   0   0   0   2   0   1   0   0   0   6   0   0   1
    0   0   0   0   2   0   0   0   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 12  15   2  73   1  89  16   2   0  15   2   0  11  18   0   0   2   5
    0   0   0  22  36   5   1   0   1   7   0   6   4   0   0   1   0   0
    0   0   4   0  11   3   0  17   5   3   0   4   0   7   0   5   5   0
    1   2   0   0   0   4   0   0   0   5   0   0   0   0   0   0   0   1
    0   0   0   0   2   0   0   1   0   2   0   1   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 27  39   0  17   1   0  15 105   0  62   1   0   5   1   3   8   6  25
    0  10   1   0   6   1  10  11   4  12   8  11   2   1   9   6   0   1
    7   1   0   5  12   3   0   0   0   0  11   0   3   0   7   4   3   0
    5   0   0   3   0   0   1   6   6   1   0   0   1   0   1   2   0   1
    0   0   0   0   0   0   0   1   0   0   0   0   1   1   1   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  2   4  39   5  23   6   0  16   0   7   1   1   6   0   0   0   0   0
   34  10   6   0   5   0   2   0  17   0   0   7   0  32  23   0   0   9
    3   0   0  10   5   0   0   3   3   7   4   0  10   8   1   2   0   1
    0   0   0   0   1   1   7   0   3   0   0   0   0   2   0   0   0   0
    0   1   0   1   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 17   1  19  11   1   0   7   9   0   2  13  13   3  11  15   9  24  36
    0   1   5   0  57  16   1  10  19   6   5   0   0   0   0   0   1   3
   22  13   0   0   1   0   3   0   0   0   1   9   0   0   0   2   3   4
    0   2   0   0   0   0   0   2   0   0   0   0   1   0   0   0   0   0
    0   0   0   0   0   1   2   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   1   0   0   0   0   0]
 [  6   4   2   4  19  49   8   0   9   8  18  41  33  32   2  11  21   7
    0   6   0  22   0   3   5  18   5   9   0   0   0   1   0   0   4   0
    0  20   0   5   0   0   0   0   0   0   3   0   2   0   0   0   0   0
    0   0   0   0   0   0   0   5   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 80   6  16   0  19   0   0   7   2   1   0   0   5   6   0   9   2  37
    3  32   1   6   6   0   0   1   0   9   2   0  15   1  18   0   0   0
    0   2   0   0   4  18  18   0   4   1   0   1   0   0   8   2   0   0
    1   0   0   0   0  10   0   0   0   2   0   0   2   0   0   2   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 15   0  61   2  23   7   0   0  36  14   2   5   9   1   0  30  17   1
   18   0  49   0   1   0   4   1   0   0   0   1   1  23   0  11   5   0
    0   0   6   0   3   6   0   6   0   3   0   0   1   0   0   4   4   0
    0   0   1   0  11   0   4   0   0   0   0   0   2   0   3   0   0   0
    1   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]]
Total size of testing set
9199
[452 431 408 389 372 352 338 321 307 292 278 265 254 241 231 219 208 197
 190 180 170 165 156 148 140 132 128 124 119 112 102  99  95  91  85  81
  77  71  68  67  59  61  56  52  50  48  45  44  41  41  32  30  30  31
  26  29  24  25  21  21  18  19  16  18  15  17  16  16  14  11   9  11
   9   7   7   6   9   2   6   5   5   6   5   3   4   4   2   2   4   1
   3   1   0   1   2   0   0   0   2   2]
20
默认inference性能:
0.3702 {'head': 0.630370370370347, 'middle': 0.4207692307692146, 'tail': 0.19276595744680441}
class means作为features的预测准确率
0.7
裁剪后的class means作为features的预测准确率
0.7
裁剪后inference性能:
0.5191 {'head': 0.7481481481481342, 'middle': 0.5234615384615284, 'tail': 0.22670212765957207}
Average variance at zero_positions: 1.487407251472481
Average variance at non-zero_positions: 2.589312605410582
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [03:39<30:25:31, 219.50s/it]  0%|          | 2/500 [07:06<29:21:18, 212.21s/it]3shot of client 0:head:0.6904761904761905, middle:0.5957446808510638, tail0.7083333333333334
3shot of client 1:head:0.7534516765285996, middle:0.6171875, tail0.5454545454545454
3shot of client 2:head:0.738255033557047, middle:0.5526315789473685, tail0.4444444444444444
3shot of client 3:head:0.7546777546777547, middle:0.6825396825396826, tail0.16666666666666666
3shot of client 4:head:0.7725409836065574, middle:0.5826086956521739, tail0.3448275862068966
3shot of client 5:head:0.7416829745596869, middle:0.544, tail0.3125
3shot of client 6:head:0.6802721088435374, middle:0.6133333333333333, tail0.2631578947368421
3shot of client 7:head:0.6354166666666666, middle:0.6086956521739131, tail0.5
3shot of client 8:head:0.7380410022779044, middle:0.5213675213675214, tail0.5
3shot of client 9:head:0.701195219123506, middle:0.5588235294117647, tail0.4
3shot of client 10:head:0.7681564245810056, middle:0.36046511627906974, tail0.4090909090909091
3shot of client 11:head:0.7293447293447294, middle:0.6022727272727273, tail0.391304347826087
3shot of client 12:head:0.7729885057471264, middle:0.5238095238095238, tail0.42857142857142855
3shot of client 13:head:0.7685185185185185, middle:0.5529411764705883, tail0.45
3shot of client 14:head:0.7466307277628033, middle:0.5789473684210527, tail0.4583333333333333
3shot of client 15:head:0.6150793650793651, middle:0.6774193548387096, tail0.1875
3shot of client 16:head:0.6452702702702703, middle:0.6911764705882353, tail0.16666666666666666
3shot of client 17:head:0.6928327645051194, middle:0.7638888888888888, tail0.7647058823529411
3shot of client 18:head:0.7316176470588235, middle:0.6285714285714286, tail0.35294117647058826
3shot of client 19:head:0.7643097643097643, middle:0.525, tail0.5294117647058824
round 0, local average test acc  0.6820 

round 0, local macro average F1 score  0.5002 

round 0, local weighted average F1 score  0.6819 

round 0, global test acc  0.3640 

round 0, average 3shot acc: [head: 0.7220, middle: 0.5891, tail: 0.4162] 

round 0, global 3shot acc: [head: 0.6281, middle: 0.4150, tail: 0.1840] 

l_head tensor([ 3.4233,  7.4620, 10.9543,  0.6213, 10.6723, 11.0114, 10.1284,  3.6394,
        10.9746,  5.3068,  6.5743, 11.4488,  7.5184,  6.4377, 10.5619,  9.9120,
         4.5325,  4.8185,  0.6333,  7.8818,  0.6461,  5.8061,  6.9633,  8.6508,
         7.0411,  6.8268,  9.0352, 12.3356,  0.6393,  8.7168,  6.3066,  0.6382,
         5.2423,  0.6449, 11.4378,  9.3991,  7.5608,  4.6916, 10.0996,  0.6526,
         3.6544,  0.6321,  0.6369,  0.6411,  4.5601,  8.9781,  0.6230,  0.6418,
         5.9846,  0.6444,  0.6247,  0.6295,  0.6384,  0.6252,  3.9923,  0.6232,
         4.4278,  5.1016,  0.6317,  0.6197,  3.6346,  0.6451,  5.2080,  0.6394,
         4.7994,  7.0812,  0.6404,  0.6302,  0.6418,  0.6374,  0.6355,  0.6148,
         0.6185,  0.6191,  3.7550,  0.6358,  0.6463,  4.2040,  0.6427,  0.6267,
         0.6305,  0.6310,  5.5983,  0.6401,  0.6332,  0.6371,  4.0119,  0.6384,
         0.6394,  0.6411,  0.6336,  0.6363,  0.6392,  0.6244,  0.6359,  3.9747,
         4.1908,  0.6269,  0.6364,  0.6418], device='cuda:2',
       grad_fn=<NormBackward1>)
g_aux tensor([3.2139, 6.1866, 6.3626, 6.7497, 6.4173, 5.3392, 6.0212, 6.1742, 6.0775,
        5.8684, 5.6975, 5.7724, 5.7925, 5.8911, 5.9403, 6.6412, 5.5440, 6.1990,
        5.3353, 5.8090, 5.2991, 5.4688, 5.2179, 5.0142, 5.1674, 5.0583, 4.8798,
        5.5909, 5.4475, 5.4013, 5.4062, 5.2508, 5.6729, 5.0079, 4.9198, 5.2752,
        4.7798, 4.9941, 5.0962, 4.7755, 4.9638, 4.9239, 5.0496, 4.9521, 4.7019,
        4.5616, 4.9172, 4.4634, 4.4641, 4.6298, 4.8510, 4.5197, 4.3983, 3.6739,
        4.2879, 4.2071, 4.1656, 3.6355, 4.4652, 4.5608, 3.7787, 3.8159, 3.8621,
        4.2769, 4.5303, 4.8162, 4.2529, 4.3740, 3.7075, 4.0979, 3.4561, 3.6505,
        4.1850, 3.6706, 4.0057, 3.6748, 3.2600, 3.8382, 3.5492, 3.5929, 3.6811,
        3.7210, 3.0991, 3.1911, 3.4537, 3.5241, 3.5323, 3.5498, 3.2355, 3.4305,
        3.5819, 3.2199, 3.0032, 3.3499, 2.8465, 3.5137, 3.2158, 3.0958, 3.3940,
        2.9288], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.6798941798941799, middle:0.5851063829787234, tail0.7083333333333334
3shot of client 1:head:0.757396449704142, middle:0.625, tail0.5454545454545454
3shot of client 2:head:0.738255033557047, middle:0.5394736842105263, tail0.4444444444444444
3shot of client 3:head:0.7505197505197505, middle:0.6825396825396826, tail0.23333333333333334
3shot of client 4:head:0.7725409836065574, middle:0.5652173913043478, tail0.3448275862068966
3shot of client 5:head:0.7436399217221135, middle:0.56, tail0.34375
3shot of client 6:head:0.6768707482993197, middle:0.5733333333333334, tail0.2631578947368421
3shot of client 7:head:0.6354166666666666, middle:0.5869565217391305, tail0.5
3shot of client 8:head:0.7403189066059226, middle:0.5042735042735043, tail0.5
3shot of client 9:head:0.7290836653386454, middle:0.5588235294117647, tail0.3333333333333333
3shot of client 10:head:0.776536312849162, middle:0.3488372093023256, tail0.4090909090909091
3shot of client 11:head:0.7094017094017094, middle:0.6022727272727273, tail0.391304347826087
3shot of client 12:head:0.7931034482758621, middle:0.5119047619047619, tail0.42857142857142855
3shot of client 13:head:0.7746913580246914, middle:0.5529411764705883, tail0.4
3shot of client 14:head:0.7520215633423181, middle:0.5684210526315789, tail0.4583333333333333
3shot of client 15:head:0.6031746031746031, middle:0.6774193548387096, tail0.1875
3shot of client 16:head:0.6317567567567568, middle:0.7205882352941176, tail0.16666666666666666
3shot of client 17:head:0.689419795221843, middle:0.75, tail0.7058823529411765
3shot of client 18:head:0.7316176470588235, middle:0.6, tail0.4117647058823529
3shot of client 19:head:0.7474747474747475, middle:0.55, tail0.5294117647058824
round 1, local average test acc  0.6805 

round 1, local macro average F1 score  0.5001 

round 1, local weighted average F1 score  0.6799 

round 1, global test acc  0.3634 

round 1, average 3shot acc: [head: 0.7217, middle: 0.5832, tail: 0.4153] 

round 1, global 3shot acc: [head: 0.6307, middle: 0.4150, tail: 0.1813] 

l_head tensor([ 3.4236,  7.4620, 11.0018,  0.6213, 10.6723, 11.0114, 10.1284,  3.6394,
        10.9745,  5.3068,  6.5743, 11.4104,  7.5184,  6.4377, 10.5619,  9.9120,
         4.5325,  4.8185,  0.6333,  7.8818,  0.6461,  5.8061,  6.9633,  8.6508,
         7.0411,  6.8268,  9.0352, 12.3355,  0.6393,  8.7169,  6.3067,  0.6382,
         5.2423,  0.6449, 11.4378,  9.3991,  7.5608,  4.6916, 10.0996,  0.6526,
         3.6544,  0.6321,  0.6369,  0.6411,  4.5601,  8.9781,  0.6230,  0.6418,
         5.9846,  0.6444,  0.6247,  0.6295,  0.6384,  0.6252,  3.9923,  0.6232,
         4.4278,  5.1016,  0.6317,  0.6197,  3.6346,  0.6451,  5.2080,  0.6394,
         4.7994,  7.0812,  0.6404,  0.6302,  0.6418,  0.6374,  0.6355,  0.6148,
         0.6185,  0.6191,  3.7550,  0.6358,  0.6463,  4.2040,  0.6427,  0.6267,
         0.6305,  0.6310,  5.5983,  0.6401,  0.6332,  0.6371,  4.0119,  0.6384,
         0.6394,  0.6411,  0.6336,  0.6363,  0.6392,  0.6244,  0.6359,  3.9747,
         4.1908,  0.6269,  0.6364,  0.6418], device='cuda:2',
       grad_fn=<NormBackward1>)
g_aux tensor([3.2160, 6.1930, 6.3609, 6.7739, 6.4068, 5.3479, 6.0238, 6.1583, 6.0760,
        5.8591, 5.7030, 5.7758, 5.7897, 5.8905, 5.9317, 6.6468, 5.5445, 6.1976,
        5.3428, 5.8237, 5.3012, 5.4809, 5.2155, 5.0142, 5.1709, 5.0580, 4.8783,
        5.5898, 5.4511, 5.4012, 5.4156, 5.2360, 5.6797, 5.0119, 4.9198, 5.2728,
        4.7797, 4.9951, 5.0958, 4.7795, 4.9595, 4.9195, 5.0495, 4.9520, 4.7018,
        4.5615, 4.9172, 4.4634, 4.4608, 4.6331, 4.8511, 4.5220, 4.3965, 3.6781,
        4.2861, 4.2074, 4.1637, 3.6355, 4.4885, 4.5642, 3.7823, 3.8143, 3.8618,
        4.2769, 4.5305, 4.8162, 4.2584, 4.3740, 3.7139, 4.0983, 3.4601, 3.6471,
        4.1850, 3.6706, 4.0114, 3.6775, 3.2539, 3.8382, 3.5493, 3.5921, 3.6811,
        3.7172, 3.0984, 3.1935, 3.4537, 3.5340, 3.5278, 3.5497, 3.2343, 3.4325,
        3.5824, 3.2201, 3.0027, 3.3499, 2.8465, 3.5168, 3.2158, 3.0958, 3.3940,
        2.9288], device='cuda:2', grad_fn=<NormBackward1>)
  1%|          | 3/500 [10:23<28:18:47, 205.09s/it]  1%|          | 4/500 [13:52<28:27:49, 206.59s/it]3shot of client 0:head:0.6851851851851852, middle:0.5531914893617021, tail0.7083333333333334
3shot of client 1:head:0.7514792899408284, middle:0.6328125, tail0.5454545454545454
3shot of client 2:head:0.7281879194630873, middle:0.5263157894736842, tail0.4444444444444444
3shot of client 3:head:0.7484407484407485, middle:0.6746031746031746, tail0.23333333333333334
3shot of client 4:head:0.7725409836065574, middle:0.5652173913043478, tail0.3448275862068966
3shot of client 5:head:0.7397260273972602, middle:0.544, tail0.34375
3shot of client 6:head:0.7006802721088435, middle:0.6133333333333333, tail0.21052631578947367
3shot of client 7:head:0.6458333333333334, middle:0.6304347826086957, tail0.5
3shot of client 8:head:0.7334851936218679, middle:0.5299145299145299, tail0.5
3shot of client 9:head:0.6972111553784861, middle:0.5588235294117647, tail0.4
3shot of client 10:head:0.7569832402234636, middle:0.36046511627906974, tail0.4090909090909091
3shot of client 11:head:0.7122507122507122, middle:0.6022727272727273, tail0.391304347826087
3shot of client 12:head:0.7873563218390804, middle:0.4880952380952381, tail0.42857142857142855
3shot of client 13:head:0.7901234567901234, middle:0.5647058823529412, tail0.45
3shot of client 14:head:0.7277628032345014, middle:0.5789473684210527, tail0.5
3shot of client 15:head:0.6071428571428571, middle:0.6774193548387096, tail0.1875
3shot of client 16:head:0.6418918918918919, middle:0.7058823529411765, tail0.16666666666666666
3shot of client 17:head:0.689419795221843, middle:0.7777777777777778, tail0.7647058823529411
3shot of client 18:head:0.7352941176470589, middle:0.6571428571428571, tail0.35294117647058826
3shot of client 19:head:0.7542087542087542, middle:0.5875, tail0.5882352941176471
round 2, local average test acc  0.6815 

round 2, local macro average F1 score  0.5012 

round 2, local weighted average F1 score  0.6782 

round 2, global test acc  0.3639 

round 2, average 3shot acc: [head: 0.7203, middle: 0.5914, tail: 0.4235] 

round 2, global 3shot acc: [head: 0.6344, middle: 0.4154, tail: 0.1800] 

l_head tensor([ 3.4239,  7.4620, 11.0018,  0.6213, 10.6723, 11.0096, 10.1284,  3.6394,
        10.9467,  5.3067,  6.5743, 11.4103,  7.5184,  6.4377, 10.5639,  9.9120,
         4.5326,  4.8185,  0.6333,  7.8818,  0.6461,  5.8061,  6.9633,  8.6508,
         7.0634,  6.8268,  9.0352, 12.3526,  0.6393,  8.7169,  6.3084,  0.6382,
         5.2423,  0.6449, 11.4379,  9.3991,  7.5608,  4.6919, 10.0996,  0.6526,
         3.6544,  0.6321,  0.6369,  0.6411,  4.5601,  8.9781,  0.6230,  0.6418,
         5.9846,  0.6444,  0.6247,  0.6295,  0.6384,  0.6252,  3.9923,  0.6232,
         4.4278,  5.1016,  0.6317,  0.6197,  3.6346,  0.6451,  5.2080,  0.6394,
         4.7994,  7.0812,  0.6404,  0.6302,  0.6418,  0.6374,  0.6355,  0.6148,
         0.6185,  0.6191,  3.7550,  0.6358,  0.6463,  4.2040,  0.6427,  0.6267,
         0.6305,  0.6310,  5.5983,  0.6401,  0.6332,  0.6371,  4.0119,  0.6384,
         0.6394,  0.6411,  0.6336,  0.6363,  0.6392,  0.6244,  0.6359,  3.9747,
         4.1908,  0.6269,  0.6364,  0.6418], device='cuda:2',
       grad_fn=<NormBackward1>)
g_aux tensor([3.2196, 6.1999, 6.3547, 6.7660, 6.3947, 5.3520, 6.0179, 6.1556, 6.0811,
        5.8503, 5.6956, 5.7733, 5.7893, 5.8962, 5.9371, 6.6517, 5.5419, 6.2054,
        5.3605, 5.8307, 5.3042, 5.4870, 5.2283, 5.0139, 5.1714, 5.0534, 4.8911,
        5.5839, 5.4675, 5.4094, 5.4157, 5.2337, 5.7053, 5.0218, 4.9455, 5.2669,
        4.7652, 4.9954, 5.0999, 4.7845, 4.9595, 4.9203, 5.0554, 4.9590, 4.6898,
        4.5708, 4.9179, 4.4514, 4.4598, 4.6420, 4.8513, 4.5165, 4.3961, 3.6816,
        4.2924, 4.2069, 4.1637, 3.6345, 4.4935, 4.5831, 3.7924, 3.8135, 3.8591,
        4.2768, 4.5361, 4.8162, 4.2585, 4.3833, 3.7165, 4.0983, 3.4601, 3.6472,
        4.1816, 3.6706, 4.0113, 3.6775, 3.2544, 3.8383, 3.5494, 3.5920, 3.6744,
        3.7171, 3.1075, 3.1948, 3.4597, 3.5313, 3.5278, 3.5497, 3.2343, 3.4325,
        3.5824, 3.2200, 3.0026, 3.3499, 2.8465, 3.5170, 3.2158, 3.0958, 3.3940,
        2.9257], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.7037037037037037, middle:0.5531914893617021, tail0.625
3shot of client 1:head:0.7652859960552268, middle:0.625, tail0.5454545454545454
3shot of client 2:head:0.7214765100671141, middle:0.5657894736842105, tail0.5
3shot of client 3:head:0.7505197505197505, middle:0.6666666666666666, tail0.23333333333333334
3shot of client 4:head:0.7786885245901639, middle:0.5565217391304348, tail0.3448275862068966
3shot of client 5:head:0.7377690802348337, middle:0.552, tail0.3125
3shot of client 6:head:0.7040816326530612, middle:0.6133333333333333, tail0.21052631578947367
3shot of client 7:head:0.6510416666666666, middle:0.5869565217391305, tail0.5
3shot of client 8:head:0.7471526195899773, middle:0.5128205128205128, tail0.46153846153846156
3shot of client 9:head:0.7091633466135459, middle:0.5441176470588235, tail0.3333333333333333
3shot of client 10:head:0.7569832402234636, middle:0.3953488372093023, tail0.4090909090909091
3shot of client 11:head:0.6866096866096866, middle:0.6022727272727273, tail0.391304347826087
3shot of client 12:head:0.7787356321839081, middle:0.5119047619047619, tail0.42857142857142855
3shot of client 13:head:0.7746913580246914, middle:0.5529411764705883, tail0.45
3shot of client 14:head:0.7493261455525606, middle:0.5684210526315789, tail0.5
3shot of client 15:head:0.6150793650793651, middle:0.6935483870967742, tail0.1875
3shot of client 16:head:0.6452702702702703, middle:0.7058823529411765, tail0.16666666666666666
3shot of client 17:head:0.6791808873720137, middle:0.7916666666666666, tail0.7647058823529411
3shot of client 18:head:0.75, middle:0.6714285714285714, tail0.35294117647058826
3shot of client 19:head:0.7542087542087542, middle:0.5875, tail0.5882352941176471
round 3, local average test acc  0.6834 

round 3, local macro average F1 score  0.4994 

round 3, local weighted average F1 score  0.6802 

round 3, global test acc  0.3642 

round 3, average 3shot acc: [head: 0.7229, middle: 0.5929, tail: 0.4153] 

round 3, global 3shot acc: [head: 0.6356, middle: 0.4204, tail: 0.1772] 

l_head tensor([ 3.4241,  7.4620, 10.9627,  0.6213, 10.6788, 11.0096, 10.1283,  3.6394,
        10.9467,  5.3067,  6.5743, 11.4574,  7.5184,  6.4377, 10.6117,  9.9120,
         4.5326,  4.8185,  0.6333,  7.8818,  0.6461,  5.8061,  6.9633,  8.6508,
         7.0634,  6.8268,  9.0352, 12.3127,  0.6393,  8.7169,  6.3090,  0.6382,
         5.2423,  0.6449, 11.4379,  9.3986,  7.5590,  4.6919, 10.0996,  0.6526,
         3.6544,  0.6321,  0.6369,  0.6411,  4.5601,  8.9781,  0.6230,  0.6418,
         5.9846,  0.6444,  0.6247,  0.6295,  0.6384,  0.6252,  3.9923,  0.6232,
         4.4278,  5.1016,  0.6317,  0.6197,  3.6346,  0.6451,  5.2080,  0.6394,
         4.7994,  7.0812,  0.6404,  0.6302,  0.6418,  0.6374,  0.6355,  0.6148,
         0.6185,  0.6191,  3.7550,  0.6358,  0.6463,  4.2040,  0.6427,  0.6267,
         0.6305,  0.6310,  5.5983,  0.6401,  0.6332,  0.6371,  4.0119,  0.6384,
         0.6394,  0.6411,  0.6336,  0.6363,  0.6392,  0.6244,  0.6359,  3.9747,
         4.1908,  0.6269,  0.6364,  0.6418], device='cuda:2',
       grad_fn=<NormBackward1>)
g_aux tensor([3.2215, 6.1949, 6.3609, 6.7653, 6.3975, 5.3575, 6.0162, 6.1563, 6.0851,
        5.8500, 5.6967, 5.7709, 5.7833, 5.8924, 5.9359, 6.6326, 5.5409, 6.2146,
        5.3635, 5.8437, 5.3134, 5.4871, 5.2325, 5.0143, 5.1698, 5.0457, 4.8882,
        5.5788, 5.4674, 5.4087, 5.4164, 5.2381, 5.7230, 5.0208, 4.9480, 5.2685,
        4.7664, 4.9968, 5.1077, 4.7899, 4.9593, 4.9201, 5.0562, 4.9579, 4.6898,
        4.5744, 4.9187, 4.4515, 4.4598, 4.6404, 4.8560, 4.5165, 4.3848, 3.6815,
        4.2924, 4.2069, 4.1637, 3.6325, 4.4957, 4.5857, 3.7924, 3.8135, 3.8605,
        4.2767, 4.5361, 4.8163, 4.2511, 4.3838, 3.7172, 4.1022, 3.4601, 3.6557,
        4.1791, 3.6706, 4.0112, 3.6775, 3.2541, 3.8382, 3.5493, 3.5920, 3.6829,
        3.7171, 3.1075, 3.1973, 3.4597, 3.5313, 3.5278, 3.5491, 3.2351, 3.4360,
        3.5824, 3.2201, 3.0087, 3.3494, 2.8465, 3.5170, 3.2158, 3.0958, 3.3937,
        2.9256], device='cuda:2', grad_fn=<NormBackward1>)
  1%|          | 5/500 [17:15<28:13:46, 205.31s/it]  1%|          | 6/500 [20:31<27:45:11, 202.25s/it]3shot of client 0:head:0.6798941798941799, middle:0.5531914893617021, tail0.625
3shot of client 1:head:0.757396449704142, middle:0.6328125, tail0.5454545454545454
3shot of client 2:head:0.7181208053691275, middle:0.5657894736842105, tail0.5
3shot of client 3:head:0.7546777546777547, middle:0.6666666666666666, tail0.26666666666666666
3shot of client 4:head:0.7602459016393442, middle:0.5739130434782609, tail0.3103448275862069
3shot of client 5:head:0.7397260273972602, middle:0.552, tail0.25
3shot of client 6:head:0.6904761904761905, middle:0.6133333333333333, tail0.2631578947368421
3shot of client 7:head:0.640625, middle:0.6086956521739131, tail0.5
3shot of client 8:head:0.7403189066059226, middle:0.5042735042735043, tail0.46153846153846156
3shot of client 9:head:0.7131474103585658, middle:0.5441176470588235, tail0.3333333333333333
3shot of client 10:head:0.7597765363128491, middle:0.3953488372093023, tail0.36363636363636365
3shot of client 11:head:0.7065527065527065, middle:0.5909090909090909, tail0.391304347826087
3shot of client 12:head:0.7844827586206896, middle:0.5357142857142857, tail0.42857142857142855
3shot of client 13:head:0.7654320987654321, middle:0.5411764705882353, tail0.5
3shot of client 14:head:0.7520215633423181, middle:0.5684210526315789, tail0.4583333333333333
3shot of client 15:head:0.6150793650793651, middle:0.6774193548387096, tail0.1875
3shot of client 16:head:0.6486486486486487, middle:0.7058823529411765, tail0.16666666666666666
3shot of client 17:head:0.6825938566552902, middle:0.7638888888888888, tail0.7647058823529411
3shot of client 18:head:0.7389705882352942, middle:0.6857142857142857, tail0.35294117647058826
3shot of client 19:head:0.7609427609427609, middle:0.575, tail0.5882352941176471
round 4, local average test acc  0.6813 

round 4, local macro average F1 score  0.4896 

round 4, local weighted average F1 score  0.6799 

round 4, global test acc  0.3638 

round 4, average 3shot acc: [head: 0.7205, middle: 0.5927, tail: 0.4129] 

round 4, global 3shot acc: [head: 0.6352, middle: 0.4169, tail: 0.1785] 

l_head tensor([ 3.4243,  7.4620, 10.9627,  0.6213, 10.6571, 10.9896, 10.1283,  3.6394,
        10.9699,  5.3067,  6.5744, 11.4779,  7.5184,  6.4377, 10.5836,  9.9120,
         4.5326,  4.8185,  0.6333,  7.8818,  0.6461,  5.8061,  6.9633,  8.6508,
         7.0634,  6.8268,  9.0352, 12.3127,  0.6393,  8.7169,  6.3090,  0.6382,
         5.2423,  0.6449, 11.4380,  9.3986,  7.5588,  4.6919, 10.1602,  0.6526,
         3.6544,  0.6321,  0.6369,  0.6411,  4.5601,  8.9550,  0.6230,  0.6418,
         5.9846,  0.6444,  0.6247,  0.6295,  0.6384,  0.6252,  3.9923,  0.6232,
         4.4278,  5.1016,  0.6317,  0.6197,  3.6346,  0.6451,  5.2080,  0.6394,
         4.7994,  7.0812,  0.6404,  0.6302,  0.6418,  0.6374,  0.6355,  0.6148,
         0.6185,  0.6191,  3.7550,  0.6358,  0.6463,  4.2040,  0.6427,  0.6267,
         0.6305,  0.6310,  5.5983,  0.6401,  0.6332,  0.6371,  4.0119,  0.6384,
         0.6394,  0.6411,  0.6336,  0.6363,  0.6392,  0.6244,  0.6359,  3.9747,
         4.1908,  0.6269,  0.6364,  0.6418], device='cuda:2',
       grad_fn=<NormBackward1>)
g_aux tensor([3.2228, 6.1962, 6.3560, 6.7610, 6.3918, 5.3546, 6.0168, 6.1697, 6.0847,
        5.8468, 5.6941, 5.7677, 5.7828, 5.8847, 5.9364, 6.6355, 5.5375, 6.2177,
        5.3691, 5.8432, 5.3154, 5.4909, 5.2357, 5.0143, 5.1757, 5.0392, 4.8838,
        5.5680, 5.4695, 5.3983, 5.4156, 5.2409, 5.7277, 5.0227, 4.9397, 5.2686,
        4.7681, 4.9971, 5.1104, 4.7944, 4.9593, 4.9211, 5.0530, 4.9579, 4.6898,
        4.5780, 4.9215, 4.4505, 4.4598, 4.6404, 4.8623, 4.5161, 4.3872, 3.6815,
        4.2924, 4.2068, 4.1637, 3.6391, 4.4956, 4.5890, 3.7932, 3.8085, 3.8605,
        4.2604, 4.5360, 4.8163, 4.2511, 4.3834, 3.7172, 4.0987, 3.4602, 3.6601,
        4.1791, 3.6654, 4.0115, 3.6756, 3.2596, 3.8382, 3.5493, 3.5927, 3.6829,
        3.7171, 3.1076, 3.1988, 3.4597, 3.5337, 3.5278, 3.5491, 3.2353, 3.4360,
        3.5863, 3.2201, 3.0087, 3.3494, 2.8465, 3.5170, 3.2224, 3.0980, 3.3937,
        2.9256], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.6772486772486772, middle:0.5851063829787234, tail0.6666666666666666
3shot of client 1:head:0.7652859960552268, middle:0.6171875, tail0.5454545454545454
3shot of client 2:head:0.7348993288590604, middle:0.5394736842105263, tail0.5
3shot of client 3:head:0.7525987525987526, middle:0.6746031746031746, tail0.23333333333333334
3shot of client 4:head:0.764344262295082, middle:0.5739130434782609, tail0.3103448275862069
3shot of client 5:head:0.7416829745596869, middle:0.544, tail0.3125
3shot of client 6:head:0.6870748299319728, middle:0.64, tail0.2631578947368421
3shot of client 7:head:0.6458333333333334, middle:0.6304347826086957, tail0.5
3shot of client 8:head:0.7312072892938497, middle:0.5470085470085471, tail0.46153846153846156
3shot of client 9:head:0.6932270916334662, middle:0.5441176470588235, tail0.4666666666666667
3shot of client 10:head:0.729050279329609, middle:0.38372093023255816, tail0.4090909090909091
3shot of client 11:head:0.7008547008547008, middle:0.5909090909090909, tail0.391304347826087
3shot of client 12:head:0.7787356321839081, middle:0.5476190476190477, tail0.42857142857142855
3shot of client 13:head:0.7746913580246914, middle:0.5764705882352941, tail0.5
3shot of client 14:head:0.7574123989218329, middle:0.5684210526315789, tail0.4583333333333333
3shot of client 15:head:0.5952380952380952, middle:0.6935483870967742, tail0.1875
3shot of client 16:head:0.6418918918918919, middle:0.7058823529411765, tail0.16666666666666666
3shot of client 17:head:0.6757679180887372, middle:0.7638888888888888, tail0.7647058823529411
3shot of client 18:head:0.7463235294117647, middle:0.6714285714285714, tail0.35294117647058826
3shot of client 19:head:0.7441077441077442, middle:0.5875, tail0.47058823529411764
round 5, local average test acc  0.6802 

round 5, local macro average F1 score  0.4976 

round 5, local weighted average F1 score  0.6800 

round 5, global test acc  0.3646 

round 5, average 3shot acc: [head: 0.7169, middle: 0.5993, tail: 0.4195] 

round 5, global 3shot acc: [head: 0.6367, middle: 0.4142, tail: 0.1809] 

l_head tensor([ 3.4245,  7.4620, 10.9627,  0.6213, 10.6571, 10.9649, 10.1282,  3.6394,
        10.9990,  5.3067,  6.5744, 11.4471,  7.5184,  6.4377, 10.5837,  9.9120,
         4.5326,  4.8185,  0.6333,  7.8819,  0.6461,  5.8763,  6.9633,  8.6509,
         7.0634,  6.8268,  9.0352, 12.3126,  0.6393,  8.7169,  6.3091,  0.6382,
         5.2423,  0.6449, 11.4380,  9.3987,  7.5588,  4.6919, 10.1602,  0.6526,
         3.6544,  0.6321,  0.6369,  0.6411,  4.5601,  8.9550,  0.6230,  0.6418,
         5.9846,  0.6444,  0.6247,  0.6295,  0.6384,  0.6252,  3.9923,  0.6232,
         4.4278,  5.1016,  0.6317,  0.6197,  3.6346,  0.6451,  5.2080,  0.6394,
         4.7994,  7.0812,  0.6404,  0.6302,  0.6418,  0.6374,  0.6355,  0.6148,
         0.6185,  0.6191,  3.7550,  0.6358,  0.6463,  4.2040,  0.6427,  0.6267,
         0.6305,  0.6310,  5.5983,  0.6401,  0.6332,  0.6371,  4.0119,  0.6384,
         0.6394,  0.6411,  0.6336,  0.6363,  0.6392,  0.6244,  0.6359,  3.9747,
         4.1908,  0.6269,  0.6364,  0.6418], device='cuda:2',
       grad_fn=<NormBackward1>)
g_aux tensor([3.2243, 6.2003, 6.3598, 6.7562, 6.3745, 5.3549, 6.0460, 6.1744, 6.0816,
        5.8497, 5.6952, 5.7638, 5.7860, 5.8895, 5.9350, 6.6355, 5.5314, 6.2152,
        5.3723, 5.8405, 5.3215, 5.5024, 5.2376, 5.0123, 5.1773, 5.0438, 4.8850,
        5.5621, 5.4789, 5.4020, 5.4256, 5.2422, 5.7250, 5.0252, 4.9460, 5.2678,
        4.7623, 5.0028, 5.1108, 4.7988, 4.9531, 4.9212, 5.0596, 4.9557, 4.6922,
        4.5790, 4.9215, 4.4561, 4.4598, 4.6433, 4.8560, 4.5188, 4.3706, 3.6814,
        4.2873, 4.2081, 4.1637, 3.6390, 4.4950, 4.6016, 3.7910, 3.8031, 3.8640,
        4.2619, 4.5360, 4.8190, 4.2510, 4.3838, 3.7172, 4.0985, 3.4571, 3.6623,
        4.1791, 3.6624, 4.0115, 3.6755, 3.2597, 3.8496, 3.5438, 3.5927, 3.6829,
        3.7171, 3.1077, 3.2017, 3.4597, 3.5337, 3.5278, 3.5478, 3.2400, 3.4360,
        3.5863, 3.2201, 3.0087, 3.3494, 2.8465, 3.5137, 3.2224, 3.0980, 3.3945,
        2.9256], device='cuda:2', grad_fn=<NormBackward1>)
  1%|▏         | 7/500 [24:00<28:00:43, 204.55s/it]
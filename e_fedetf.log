nohup: ignoring input
./temp/fl_acc_cifar100_resnet34_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N20_100_seed3407_p1_dirichlet0.5_IF0.02_LossCE.txt
Files already downloaded and verified
[500, 480, 462, 444, 426, 410, 394, 379, 364, 350, 336, 323, 311, 299, 287, 276, 265, 255, 245, 235, 226, 218, 209, 201, 193, 186, 178, 172, 165, 158, 152, 146, 141, 135, 130, 125, 120, 115, 111, 107, 102, 98, 95, 91, 87, 84, 81, 78, 75, 72, 69, 66, 64, 61, 59, 56, 54, 52, 50, 48, 46, 44, 43, 41, 39, 38, 36, 35, 34, 32, 31, 30, 29, 27, 26, 25, 24, 23, 22, 22, 21, 20, 19, 18, 18, 17, 16, 16, 15, 14, 14, 13, 13, 12, 12, 11, 11, 10, 10, 10]
12608
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[557, 682, 644, 784, 649, 592, 581, 632, 626, 509, 613, 1030, 437, 665, 576, 487, 584, 708, 637, 615]
training set distribution:
[[  8   5   0  64  84   6   8  12  13  13   5   0   0  18   8  17   2   4
    6   0  13   0   1  18   0   5   5   3   0   3  21  17   1   1   1  16
    3   0   5   1   4  17   6  14  15   3   2   0   0  10   8   1   1  14
    9   1   1   0   1   2   0   0   0   1   2   1   2   0   1  16   0   3
    0   1   0   5   0   0   3   0   1   2   0   0   0   0   4   0   0   1
    0   0   2   1   3   0   0   5   1   6]
 [ 99   7   6   4  20  53  54  18  40   1   1   2   0  27   8   1   0  31
   11  16   6  17   0  36  24   0   0  20   6   5  10  28   6   0   8  25
    0   2   4   6   0   0   0   0   1   2   7   2   4   5   2   1   1   1
    2   0   6   4   0   1   1   0   0   6   4   0   3   1   2   0   0   0
    0   1   0   2   0   7   0   0   1   1   0   1   2   1   0   0   1   1
    0   0   3   0   1   0   2   0   0   0]
 [ 14  60  19  16   7 102  21  28  18  13   3   0   0   0   0  15  15   5
   30   1  22  16  11   9   3   1  24   0  23   6   7   4   1   2   4   5
    0   4   0  21   1   0   0   0   0   2  35   0   2   0   1  11  10   0
    1   1   0   8  12   0   5   4   0   0   1   3   0   0   0   1   0   0
    1   0   0   1   0   0   1   1   6   0   0   0   1   0   0   0   0   3
    0   0   2   0   0   0   0   0   0   0]
 [ 23  90 124  38   6   4  31   0  17  29   3   8  49   0   7   3   9  37
    2  20   0  11   2   4   2   1  28   0   3  21  10  17   1  12   0   3
   14   5  27   2   0   2   6   7   0  28   2   2   1   0   6   0   1   3
    1   2   0   2   0   1   2   0   9   1   1   2   1   1   0   2   2   1
    0   4   0   0   5   5   1   2   0   1   0   1   3   0   0   0   3   0
    1   1   0   3   0   0   0   1   4   0]
 [  9  95  11   2   8   0  11  13  37  40  10   0  43  20  18   3  10  31
    5   1   0   0   9   0   8   0   0  32  21   3   1  13   2   1  21  15
   47   1   0   1   9   4   1  16   1   1   1   2   0   0   0   4   0   3
    6   1   2   5   1   2  11   1   3   1   2   0   5   0   2   0   6   0
    0   0   0   2   0   1   0   4   2   0   0   0   1   1   1   0   0   0
    0   0   1   2   2   0   0   0   0   0]
 [ 22  45   0  29   1  79  18   0   6   5   5  11   5   5   9   9   5   0
    5  57  10   2  58   7  27   1   2   0   9   8   1   4   0   4   2   0
   10  15   0   1   1   3  11   4   5   1   0   1   2   0   8  11   3  12
    1   5   4   0   3   3   0   0   0   0   3   8   0   0   0   0   0   1
    1   1   1   2   7   0   0   4   0   0   0   0   1   0   1   0   0   0
    0   0   0   0   5   1   0   1   0   0]
 [  5   0  29  42  39  21   0  25   7   8   0  56   2   4   8  33   1   7
   24  83  20   5   0   0   1   0   8  10   0   1   0   1  17   0   3   9
    0   3   3   0  18  20   0   1   0   0   2   5   0   0   3   0   0   0
    4   0   7   4   4  16   5   0   0   0   0   3   0   0   0   0   2   0
    0   1   1   1   0   0   1   0   0   2   0   0   0   1   1   0   0   1
    1   0   0   1   0   1   0   0   0   0]
 [  0  19  30  11   1   4   4  21  14  34  21  60  39   0   0   1   6   2
   22   0  22  13   6   9   1  57   1  12   2   0   3   4  34   6   1   0
   11   8   0   7   4  12   7   0   0  12   0   2  28   5   1   3  15   0
    1   5   6   6   1   2   0   0   4   0   0   0   2   5   1   1   0   5
    2   1   0   0   0   0   0   3   2   0   3   0   0   0   0   2   0   1
    1   0   0   0   0   0   3   0   0   0]
 [ 44  21  13  68  65  11   3  12  15   2   0   5  40   5   0  26  10   4
   24  18  42   2   0   0   1   0   9   1  30   0   0   0   7   1   0   0
    4   2   0   0   0   0   6   1   3   4   7   4   8   1   0   1   3   3
    0   0   2  14   0   0   0  26   2   0   4   2   1   3   9   4   1   9
    1   0   6   0   1   1   0   1   0   0   2   0   0   1   2   1   1   0
    2   1   0   0   1   2   0   0   0   0]
 [  0  17  20  10  51  16   0  31  14   0  13   3   2   0   0   3   0   0
    3   0   3   0   2  30  31  23  14  33   6   1   0   0   5   1   0  23
    0   8   1  13  14  10   5   3   3   1   0   0   4   1   0   5  10   0
    0   0   1   2   7   0   7   1   3   0   1   1   2   7   2   0   1   7
    0   1   0   0   0   1   1   5   5   2   1   1   0   5   3   4   0   0
    0   2   0   0   0   0   0   0   3   0]
 [  0   0  21   3  46  45   0  29  34  35  29   0  12  47   9  10  24  33
    4   2   2  12   0   0   0  13   5   8   5  10  28   4   0   0   7   9
    1   6   4   1   9   1   3   7   0  10   1   0   0   5   0   1   6  12
    0   0   6   0   1   0   4   7   3   3   3   4   0   2   2   1   0   0
    0   5   2   2   0   1   0   0   0   1   2   0   1   3   0   0   1   3
    1   0   0   0   0   0   1   1   0   0]
 [ 90   0  49  11  20   0  27 122   0  13 120   6  11  94  62  34  14   1
    2   0   5  71   4   1   2  13   0  13  25   1   0   0  12   1  32   0
    0  31   7   7   9   1  13   5   1   0   1  10   0   0  33   0   0   0
    2   3   1   0   0   6   3   2   1   1   0   1   1   3   2   2   2   0
    0   1   0   0   0   1  10   1   0   0   1   0   0   0   0   3   1   2
    1   1   2   0   0   2   0   0   0   0]
 [  9  42   6   8  11   8   0   0   3   2  14  24   0   7   0   8   9  29
    0   0   0   9  18   7  21   0   5   8   4  37   1   7   4   5   0   1
    0   0   2   0   8   3   5   0   0   1   0  12   4   5   0  18   0   0
    1   1  13   2   4   1   0   0   6   0   2   0   2   0   5   0   0   1
    7   3   0   2   2   0   0   1   0   3   0   9   0   0   0   0   0   0
    0   0   0   1   0   0   3   0   0   3]
 [ 14  17  59   3   5  32 117   7  77   9   9   2   3   1  69   8  16   2
   11   0  15   9  26   0  21   6   0   0   7   0   2   5  12   0   1  12
    3   1   1   0   0   1   1   0   2   1   3   2   7   0   0   2   0   4
   11   0   2   0   0   0   0   0   0   5   1   4   0   1   0   2   0   0
    0   2   5   2   4   1   0   0   0   7   5   4   0   0   1   1   1   0
    0   1   0   0   0   0   0   0   0   0]
 [ 30  43   9   3   2   0  56   0   2  20   0   6  48  20  20  10   3   8
    6   8  20   1  20   4  12   0  21  10   1   6   5   0  17  14   2   0
   17   0   1   0   0   7   3   0   3   5   9   7   0  30   3   4   6   0
    2   4   0   0   3   4   6   0   2   0   2   0   3   1   0   1   6   0
    0   1   0   1   1   2   2   0   0   0   0   1   3   2   2   0   2   0
    0   2   1   0   0   0   0   0   0   0]
 [  3   5  12  70  23   8   1  11   0   6  22   1   9   0  14   0  33  25
    2   3   0  13   0   3   0   1   0   4   8   2   1   5  10  74   5   0
    0  10  27   0   0   9   4   1   1   1   0   9   0   0   0   0   3   2
    0   0   0   0   1   6   0   2   0   7   3   0   1   0   4   0   0   0
    1   2   5   1   1   2   0   0   1   1   0   0   0   1   0   0   1   2
    0   0   0   4   0   0   0   0   0   0]
 [ 19   2  14   2  11   5   4  22  10  15   3  39   0   1  31   1  15   7
   82   3   0   8   0  45   0   7  14   0   6   6  39   0   1   2   8   4
    1   9   0   5   3   0   0   0  24  11   0  17   0   2   1   0   1   6
   14  12   2   3   2   3   1   1   0   6   4   3   1   0   1   1   2   0
    0   2   2   1   0   0   1   0   0   0   1   1   1   0   1   0   0   0
    6   1   0   0   0   3   0   2   0   0]
 [  7   5  27   0  16   0  21   2   1   4  35  38  34  46   5  82  49   9
    5   4   0  28   1  27   3   6  14  17   5  28  18  23  10   2  29   0
    2   0   3   0   3   1  12   7  19   0   2   1   2   5   2   3   4   1
    2   1   0   2   9   0   1   0   0   2   1   4   4   0   0   0   2   2
    0   1   3   0   1   0   0   0   0   0   0   0   2   1   0   0   0   0
    0   1   1   0   0   0   0   0   0   0]
 [ 87   7  13  49   0   3  11   2   0   1  38  29  12   4  13  10   2  12
    1   0  46   1  19   0  29  52  24   1   2  12   3  13   0   8   6   3
    0  10  21   0  18   0   0  15   0   1   0   2  11   2   1   1   0   0
    0   2   0   0   0   0   0   0   3   5   3   2   7   3   1   0   0   0
    0   0   0   1   1   1   2   0   2   0   4   0   0   0   0   0   0   0
    0   3   0   0   0   0   1   0   1   0]
 [ 17   0   0  11  10  13   7  24  56 100   5  33   2   0   6   2  42   8
    0  19   0   0  32   1   7   0   4   0   2   8   2   1   1   1   0   0
    7   0   5  42   1   7  12  10   9   0   9   0   2   1   0   0   0   0
    2  18   1   0   1   1   0   0   7   3   2   0   1   8   2   1   7   1
   16   0   1   2   1   0   0   0   1   0   0   0   3   1   0   5   4   0
    1   0   1   0   0   2   1   0   1   1]]
Total size of training set
12608
local test distribution:
[[ 6  3  0 50 66  4  6  9 10 10  3  0  0 14  6 13  1  3  4  0 10  0  0 14
   0  3  3  2  0  2 16 13  0  0  0 12  2  0  3  0  3 13  4 11 11  2  1  0
   0  7  6  0  0 11  7  0  0  0  0  1  0  0  0  0  1  0  1  0  0 12  0  2
   0  0  0  3  0  0  2  0  0  1  0  0  0  0  3  0  0  0  0  0  1  0  2  0
   0  3  0  4]
 [78  5  4  3 15 42 42 14 31  0  0  1  0 21  6  0  0 24  8 12  4 13  0 28
  19  0  0 15  4  3  7 22  4  0  6 19  0  1  3  4  0  0  0  0  0  1  5  1
   3  3  1  0  0  0  1  0  4  3  0  0  0  0  0  4  3  0  2  0  1  0  0  0
   0  0  0  1  0  5  0  0  0  0  0  0  1  0  0  0  0  0  0  0  2  0  0  0
   1  0  0  0]
 [11 47 15 12  5 80 16 22 14 10  2  0  0  0  0 11 11  3 23  0 17 12  8  7
   2  0 19  0 18  4  5  3  0  1  3  3  0  3  0 16  0  0  0  0  0  1 27  0
   1  0  0  8  7  0  0  0  0  6  9  0  3  3  0  0  0  2  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0  2  0  0  1  0  0  0
   0  0  0  0]
 [18 71 98 30  4  3 24  0 13 23  2  6 38  0  5  2  7 29  1 15  0  8  1  3
   1  0 22  0  2 16  7 13  0  9  0  2 11  3 21  1  0  1  4  5  0 22  1  1
   0  0  4  0  0  2  0  1  0  1  0  0  1  0  7  0  0  1  0  0  0  1  1  0
   0  3  0  0  3  3  0  1  0  0  0  0  2  0  0  0  2  0  0  0  0  2  0  0
   0  0  3  0]
 [ 7 75  8  1  6  0  8 10 29 31  7  0 34 15 14  2  7 24  3  0  0  0  7  0
   6  0  0 25 16  2  0 10  1  0 16 11 37  0  0  0  7  3  0 12  0  0  0  1
   0  0  0  3  0  2  4  0  1  3  0  1  8  0  2  0  1  0  3  0  1  0  4  0
   0  0  0  1  0  0  0  3  1  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0
   0  0  0  0]
 [17 35  0 23  0 62 14  0  4  3  3  8  3  3  7  7  3  0  3 45  7  1 46  5
  21  0  1  0  7  6  0  3  0  3  1  0  7 11  0  0  0  2  8  3  3  0  0  0
   1  0  6  8  2  9  0  3  3  0  2  2  0  0  0  0  2  6  0  0  0  0  0  0
   0  0  0  1  5  0  0  3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  3  0
   0  0  0  0]
 [ 3  0 23 33 30 16  0 19  5  6  0 44  1  3  6 26  0  5 19 65 15  3  0  0
   0  0  6  7  0  0  0  0 13  0  2  7  0  2  2  0 14 15  0  0  0  0  1  3
   0  0  2  0  0  0  3  0  5  3  3 12  3  0  0  0  0  2  0  0  0  0  1  0
   0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0 15 23  8  0  3  3 16 11 26 16 47 30  0  0  0  4  1 17  0 17 10  4  7
   0 45  0  9  1  0  2  3 26  4  0  0  8  6  0  5  3  9  5  0  0  9  0  1
  22  3  0  2 11  0  0  3  4  4  0  1  0  0  3  0  0  0  1  3  0  0  0  3
   1  0  0  0  0  0  0  2  1  0  2  0  0  0  0  1  0  0  0  0  0  0  0  0
   2  0  0  0]
 [34 16 10 53 51  8  2  9 11  1  0  3 31  3  0 20  7  3 19 14 33  1  0  0
   0  0  7  0 23  0  0  0  5  0  0  0  3  1  0  0  0  0  4  0  2  3  5  3
   6  0  0  0  2  2  0  0  1 11  0  0  0 20  1  0  3  1  0  2  7  3  0  7
   0  0  4  0  0  0  0  0  0  0  1  0  0  0  1  0  0  0  1  0  0  0  0  1
   0  0  0  0]
 [ 0 13 15  7 40 12  0 24 11  0 10  2  1  0  0  2  0  0  2  0  2  0  1 23
  24 18 11 26  4  0  0  0  3  0  0 18  0  6  0 10 11  7  3  2  2  0  0  0
   3  0  0  3  7  0  0  0  0  1  5  0  5  0  2  0  0  0  1  5  1  0  0  5
   0  0  0  0  0  0  0  3  3  1  0  0  0  3  2  3  0  0  0  1  0  0  0  0
   0  0  2  0]
 [ 0  0 16  2 36 35  0 23 26 27 23  0  9 37  7  7 19 26  3  1  1  9  0  0
   0 10  3  6  3  7 22  3  0  0  5  7  0  4  3  0  7  0  2  5  0  7  0  0
   0  3  0  0  4  9  0  0  4  0  0  0  3  5  2  2  2  3  0  1  1  0  0  0
   0  3  1  1  0  0  0  0  0  0  1  0  0  2  0  0  0  2  0  0  0  0  0  0
   0  0  0  0]
 [71  0 38  8 15  0 21 96  0 10 95  4  8 74 49 26 11  0  1  0  3 56  3  0
   1 10  0 10 19  0  0  0  9  0 25  0  0 24  5  5  7  0 10  3  0  0  0  7
   0  0 26  0  0  0  1  2  0  0  0  4  2  1  0  0  0  0  0  2  1  1  1  0
   0  0  0  0  0  0  7  0  0  0  0  0  0  0  0  2  0  1  0  0  1  0  0  1
   0  0  0  0]
 [ 7 33  4  6  8  6  0  0  2  1 11 19  0  5  0  6  7 23  0  0  0  7 14  5
  16  0  3  6  3 29  0  5  3  3  0  0  0  0  1  0  6  2  3  0  0  0  0  9
   3  3  0 14  0  0  0  0 10  1  3  0  0  0  4  0  1  0  1  0  3  0  0  0
   5  2  0  1  1  0  0  0  0  2  0  7  0  0  0  0  0  0  0  0  0  0  0  0
   2  0  0  2]
 [11 13 46  2  3 25 92  5 61  7  7  1  2  0 54  6 12  1  8  0 11  7 20  0
  16  4  0  0  5  0  1  3  9  0  0  9  2  0  0  0  0  0  0  0  1  0  2  1
   5  0  0  1  0  3  8  0  1  0  0  0  0  0  0  3  0  3  0  0  0  1  0  0
   0  1  3  1  3  0  0  0  0  5  3  3  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [23 34  7  2  1  0 44  0  1 15  0  4 38 15 15  7  2  6  4  6 15  0 15  3
   9  0 16  7  0  4  3  0 13 11  1  0 13  0  0  0  0  5  2  0  2  3  7  5
   0 23  2  3  4  0  1  3  0  0  2  3  4  0  1  0  1  0  2  0  0  0  4  0
   0  0  0  0  0  1  1  0  0  0  0  0  2  1  1  0  1  0  0  1  0  0  0  0
   0  0  0  0]
 [ 2  3  9 55 18  6  0  8  0  4 17  0  7  0 11  0 26 19  1  2  0 10  0  2
   0  0  0  3  6  1  0  3  7 58  3  0  0  7 21  0  0  7  3  0  0  0  0  7
   0  0  0  0  2  1  0  0  0  0  0  4  0  1  0  5  2  0  0  0  3  0  0  0
   0  1  3  0  0  1  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  3  0  0
   0  0  0  0]
 [15  1 11  1  8  3  3 17  7 11  2 30  0  0 24  0 11  5 65  2  0  6  0 35
   0  5 11  0  4  4 30  0  0  1  6  3  0  7  0  3  2  0  0  0 19  8  0 13
   0  1  0  0  0  4 11  9  1  2  1  2  0  0  0  4  3  2  0  0  0  0  1  0
   0  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  4  0  0  0  0  2
   0  1  0  0]
 [ 5  3 21  0 12  0 16  1  0  3 27 30 26 36  3 65 38  7  3  3  0 22  0 21
   2  4 11 13  3 22 14 18  7  1 23  0  1  0  2  0  2  0  9  5 15  0  1  0
   1  3  1  2  3  0  1  0  0  1  7  0  0  0  0  1  0  3  3  0  0  0  1  1
   0  0  2  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [69  5 10 38  0  2  8  1  0  0 30 23  9  3 10  7  1  9  0  0 36  0 15  0
  23 41 19  0  1  9  2 10  0  6  4  2  0  7 16  0 14  0  0 11  0  0  0  1
   8  1  0  0  0  0  0  1  0  0  0  0  0  0  2  3  2  1  5  2  0  0  0  0
   0  0  0  0  0  0  1  0  1  0  3  0  0  0  0  0  0  0  0  2  0  0  0  0
   0  0  0  0]
 [13  0  0  8  7 10  5 19 44 79  3 26  1  0  4  1 33  6  0 15  0  0 25  0
   5  0  3  0  1  6  1  0  0  0  0  0  5  0  3 33  0  5  9  7  7  0  7  0
   1  0  0  0  0  0  1 14  0  0  0  0  0  0  5  2  1  0  0  6  1  0  5  0
  12  0  0  1  0  0  0  0  0  0  0  0  2  0  0  3  3  0  0  0  0  0  0  1
   0  0  0  0]]
Total size of testing set
9261
[390 372 358 342 325 317 304 293 280 267 258 248 238 229 221 208 200 194
 184 180 171 165 159 153 145 140 135 129 120 115 110 109 100  97  95  93
  89  82  80  77  76  69  66  64  62  56  57  53  54  47  48  44  42  43
  38  36  34  36  32  30  29  30  29  24  22  24  19  21  19  18  18  18
  18  11  14  10  12  10  11  12  10  10  10  10   8   6   7   9   6   6
   5   4   5   6   6   5   5   4   5   6]
20
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [04:23<36:30:20, 263.37s/it]  0%|          | 2/500 [08:40<35:53:40, 259.48s/it]3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.005221932114882507, middle:0.010638297872340425, tail0.0
3shot of client 2:head:0.002777777777777778, middle:0.0, tail0.0
3shot of client 3:head:0.0022727272727272726, middle:0.008849557522123894, tail0.0
3shot of client 4:head:0.002785515320334262, middle:0.0, tail0.0
3shot of client 5:head:0.009146341463414634, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.005714285714285714, middle:0.0, tail0.0
3shot of client 8:head:0.005780346820809248, middle:0.010752688172043012, tail0.0
3shot of client 9:head:0.010714285714285714, middle:0.0, tail0.0
3shot of client 10:head:0.04105571847507331, middle:0.0, tail0.0
3shot of client 11:head:0.0016638935108153079, middle:0.0, tail0.0
3shot of client 12:head:0.004098360655737705, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.003125, middle:0.0, tail0.0
3shot of client 15:head:0.0037593984962406013, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.012048192771084338, tail0.0
3shot of client 17:head:0.002457002457002457, middle:0.0, tail0.0
3shot of client 18:head:0.0027397260273972603, middle:0.011627906976744186, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 0, local average test acc  0.0044 

round 0, local macro average F1 score  0.0026 

round 0, local weighted average F1 score  0.0040 

round 0, global test acc  0.2784 

round 0, average 3shot acc: [head: 0.0052, middle: 0.0027, tail: 0.0000] 

round 0, global 3shot acc: [head: 0.6842, middle: 0.2135, tail: 0.0003] 

l_head tensor([1.5424, 1.6181, 0.5749, 2.9352, 3.1130, 1.6952, 1.7791, 1.8781, 2.0039,
        1.9265, 1.6470, 0.5738, 0.5521, 1.7769, 1.9111, 2.3426, 1.2813, 1.5722,
        1.9082, 0.5818, 1.3137, 0.5849, 0.9315, 1.8966, 0.5560, 1.6461, 1.8644,
        1.5622, 0.5829, 1.3861, 2.4546, 2.3998, 1.1072, 1.0017, 1.0043, 2.0727,
        1.7248, 0.5827, 1.8615, 1.0476, 1.9732, 1.9837, 1.9697, 2.5760, 2.2877,
        1.5798, 1.1718, 0.5710, 0.5623, 1.8924, 2.0545, 1.1500, 1.2441, 2.0653,
        1.8960, 1.1828, 1.0020, 0.5621, 1.0465, 1.1814, 0.5629, 0.5794, 0.5788,
        1.0644, 1.2291, 1.0043, 1.4658, 0.5789, 1.0847, 2.3309, 0.5911, 1.4710,
        0.5623, 1.0144, 0.5751, 1.9194, 0.5843, 0.5705, 1.5855, 0.5868, 1.0502,
        1.1877, 0.5813, 0.5740, 0.5814, 0.5789, 1.6624, 0.5828, 0.5673, 1.0785,
        0.5717, 0.5570, 1.3183, 1.1270, 1.4369, 0.5794, 0.5753, 1.8475, 1.2459,
        1.8621], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.1841, 1.2663, 1.5035, 1.5062, 1.4869, 1.3485, 1.4048, 1.2403, 1.3361,
        1.2840, 1.3502, 1.1325, 1.1978, 1.0266, 1.2552, 1.2761, 1.3193, 1.3122,
        1.3250, 1.0945, 0.9914, 1.2327, 1.1410, 1.1009, 1.1054, 1.0110, 1.1591,
        1.0732, 1.3089, 1.2044, 1.0390, 1.1894, 1.1162, 0.9620, 1.0423, 0.8988,
        0.9451, 1.0922, 0.8904, 0.9101, 0.9976, 0.9711, 1.0007, 1.0695, 0.8268,
        0.8706, 0.8810, 0.8743, 0.9164, 0.8421, 0.7070, 0.8574, 0.7769, 0.8312,
        0.8965, 0.7200, 0.9093, 0.8254, 0.7865, 0.7061, 0.7885, 0.6878, 0.7470,
        0.7425, 0.7013, 0.6464, 0.7200, 0.7011, 0.7455, 0.7166, 0.6535, 0.6702,
        0.6260, 0.6923, 0.6273, 0.7352, 0.7100, 0.6103, 0.6244, 0.6461, 0.6267,
        0.6440, 0.6217, 0.5821, 0.6561, 0.6329, 0.6177, 0.6240, 0.6121, 0.5990,
        0.5963, 0.5919, 0.6170, 0.5635, 0.5911, 0.5784, 0.5745, 0.5967, 0.5761,
        0.5955], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.010443864229765013, middle:0.010638297872340425, tail0.0
3shot of client 2:head:0.005555555555555556, middle:0.0, tail0.047619047619047616
3shot of client 3:head:0.0, middle:0.0, tail0.0
3shot of client 4:head:0.008356545961002786, middle:0.010638297872340425, tail0.0
3shot of client 5:head:0.012195121951219513, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.005714285714285714, middle:0.0, tail0.0
3shot of client 8:head:0.005780346820809248, middle:0.0, tail0.0
3shot of client 9:head:0.0035714285714285713, middle:0.0, tail0.0
3shot of client 10:head:0.04398826979472141, middle:0.0, tail0.0
3shot of client 11:head:0.004991680532445923, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.003125, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.003125, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.005479452054794521, middle:0.0, tail0.043478260869565216
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 1, local average test acc  0.0047 

round 1, local macro average F1 score  0.0042 

round 1, local weighted average F1 score  0.0044 

round 1, global test acc  0.3043 

round 1, average 3shot acc: [head: 0.0056, middle: 0.0011, tail: 0.0046] 

round 1, global 3shot acc: [head: 0.7003, middle: 0.2800, tail: 0.0011] 

l_head tensor([1.6611, 1.9700, 0.5749, 3.5770, 3.6550, 1.8682, 2.1919, 2.3738, 2.2178,
        2.5739, 2.0151, 0.5738, 0.5521, 2.1704, 2.2426, 2.5459, 1.6047, 1.8174,
        2.2278, 0.5818, 1.5766, 0.5849, 1.2618, 2.2405, 0.5560, 1.9396, 2.3310,
        1.9185, 0.5829, 1.7323, 2.8405, 3.0542, 1.5608, 1.3003, 1.4300, 2.3961,
        2.2352, 0.5827, 2.4049, 1.5005, 2.3455, 2.2762, 2.3017, 3.0144, 3.0240,
        1.9881, 1.5580, 0.5710, 0.5623, 2.6007, 2.7797, 1.4703, 1.1949, 2.2830,
        2.3328, 1.4833, 1.3830, 0.5621, 1.3489, 1.5687, 0.5629, 0.5794, 0.5788,
        1.2325, 1.6416, 1.3085, 1.7740, 0.5789, 1.3620, 3.1761, 0.5911, 1.5513,
        0.5623, 1.2854, 0.5751, 2.2828, 0.5843, 0.5705, 2.1022, 0.5868, 1.4666,
        1.5736, 0.5813, 0.5740, 0.5814, 0.5789, 2.2595, 0.5828, 0.5673, 1.4498,
        0.5717, 0.5570, 1.6903, 1.5013, 2.1898, 0.5794, 0.5753, 2.3363, 1.4341,
        2.6527], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.3610, 1.5295, 1.8569, 1.8128, 1.7836, 1.5612, 1.6957, 1.4766, 1.5740,
        1.4733, 1.6718, 1.4654, 1.5028, 1.2708, 1.5419, 1.4719, 1.5346, 1.5659,
        1.5512, 1.3969, 1.1207, 1.4232, 1.3746, 1.3255, 1.2594, 1.2312, 1.5063,
        1.2815, 1.5023, 1.3931, 1.2438, 1.4679, 1.4779, 1.1662, 1.3347, 1.2418,
        1.1204, 1.2989, 1.2457, 1.1649, 1.3110, 1.1471, 1.3365, 1.4208, 1.0894,
        1.0956, 1.1279, 1.0875, 1.1404, 1.0949, 0.8534, 1.1146, 0.9710, 1.0078,
        1.1375, 0.8755, 1.1574, 1.0704, 0.9623, 0.9027, 0.9236, 0.8291, 0.9742,
        0.8982, 0.8647, 0.7544, 0.8962, 0.8875, 0.9704, 0.8773, 0.7860, 0.8081,
        0.6896, 0.8142, 0.7120, 0.9115, 0.8646, 0.7399, 0.6933, 0.7225, 0.6955,
        0.7494, 0.7301, 0.6458, 0.7562, 0.7200, 0.7026, 0.6780, 0.6771, 0.6663,
        0.6383, 0.6216, 0.6880, 0.6026, 0.6620, 0.6237, 0.6319, 0.6320, 0.5932,
        0.6114], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.007832898172323759, middle:0.02127659574468085, tail0.0
3shot of client 2:head:0.002777777777777778, middle:0.0, tail0.0
3shot of client 3:head:0.0, middle:0.008849557522123894, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.009146341463414634, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.05
3shot of client 7:head:0.005714285714285714, middle:0.0, tail0.0
3shot of client 8:head:0.005780346820809248, middle:0.0, tail0.0
3shot of client 9:head:0.0035714285714285713, middle:0.0, tail0.0
3shot of client 10:head:0.03519061583577713, middle:0.0, tail0.0
3shot of client 11:head:0.0016638935108153079, middle:0.014184397163120567, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.002702702702702703, middle:0.0, tail0.0
3shot of client 14:head:0.003125, middle:0.0, tail0.0
3shot of client 15:head:0.0037593984962406013, middle:0.0, tail0.058823529411764705
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.004914004914004914, middle:0.0, tail0.0
  1%|          | 3/500 [12:52<35:24:03, 256.43s/it]  1%|          | 4/500 [16:54<34:31:26, 250.58s/it]3shot of client 18:head:0.005479452054794521, middle:0.0, tail0.0
3shot of client 19:head:0.0029411764705882353, middle:0.0, tail0.0
round 2, local average test acc  0.0043 

round 2, local macro average F1 score  0.0027 

round 2, local weighted average F1 score  0.0032 

round 2, global test acc  0.3128 

round 2, average 3shot acc: [head: 0.0047, middle: 0.0022, tail: 0.0054] 

round 2, global 3shot acc: [head: 0.6994, middle: 0.3071, tail: 0.0021] 

l_head tensor([1.6608, 2.2433, 0.5749, 3.8589, 4.1931, 2.0373, 2.5446, 2.6583, 2.2737,
        2.8180, 2.1985, 0.5738, 0.5521, 2.6396, 2.5441, 2.8457, 1.7032, 2.1688,
        2.5585, 0.5818, 1.9754, 0.5849, 1.4462, 2.4690, 0.5560, 2.1246, 2.7164,
        2.2199, 0.5829, 1.9034, 2.8883, 3.2635, 1.6249, 1.4980, 1.9136, 2.6998,
        2.4645, 0.5827, 2.5966, 1.6174, 2.5539, 2.4429, 2.6642, 3.4800, 3.4701,
        2.4151, 1.6804, 0.5710, 0.5623, 2.7036, 3.1021, 1.7437, 1.6440, 2.3257,
        2.6541, 1.6073, 1.3784, 0.5621, 1.6662, 1.7281, 0.5629, 0.5794, 0.5788,
        1.4344, 1.8353, 1.6555, 2.0591, 0.5789, 1.4655, 3.7166, 0.5911, 1.7862,
        0.5623, 1.3355, 0.5751, 2.8172, 0.5843, 0.5705, 2.2879, 0.5868, 1.6983,
        1.8765, 0.5813, 0.5740, 0.5814, 0.5789, 2.3374, 0.5828, 0.5673, 1.7634,
        0.5717, 0.5570, 1.8828, 1.5388, 2.3346, 0.5794, 0.5753, 2.7170, 1.6000,
        2.9223], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.4654, 1.6762, 2.0485, 1.9627, 1.9901, 1.6271, 1.8739, 1.6272, 1.6741,
        1.6037, 1.8656, 1.6243, 1.6545, 1.3730, 1.6822, 1.5964, 1.6693, 1.6853,
        1.6655, 1.4969, 1.2175, 1.4851, 1.5189, 1.4233, 1.3944, 1.3702, 1.6141,
        1.3927, 1.6862, 1.4494, 1.3539, 1.6217, 1.5961, 1.2795, 1.5149, 1.3996,
        1.2557, 1.4288, 1.4176, 1.2852, 1.4426, 1.3024, 1.5344, 1.5398, 1.2569,
        1.2775, 1.2542, 1.2834, 1.2243, 1.1314, 0.9897, 1.2645, 1.0680, 1.1065,
        1.2930, 0.9775, 1.2798, 1.1596, 1.0837, 1.0317, 0.9979, 0.9682, 1.0581,
        1.0710, 0.9541, 0.8441, 0.9829, 0.9944, 1.1085, 1.0428, 0.9115, 0.9276,
        0.7301, 0.9029, 0.7847, 1.0248, 1.0000, 0.8200, 0.7696, 0.7951, 0.7639,
        0.8368, 0.8409, 0.6938, 0.8256, 0.8001, 0.7869, 0.7636, 0.7398, 0.7035,
        0.6871, 0.6746, 0.7617, 0.6589, 0.7385, 0.6939, 0.6821, 0.6588, 0.6199,
        0.6298], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.005221932114882507, middle:0.0, tail0.0
3shot of client 2:head:0.008333333333333333, middle:0.0, tail0.0
3shot of client 3:head:0.0022727272727272726, middle:0.0, tail0.0
3shot of client 4:head:0.005571030640668524, middle:0.0, tail0.0
3shot of client 5:head:0.009146341463414634, middle:0.012195121951219513, tail0.0
3shot of client 6:head:0.006024096385542169, middle:0.0, tail0.0
3shot of client 7:head:0.002857142857142857, middle:0.010869565217391304, tail0.0
3shot of client 8:head:0.008670520231213872, middle:0.0, tail0.0
3shot of client 9:head:0.0035714285714285713, middle:0.014492753623188406, tail0.0
3shot of client 10:head:0.03812316715542522, middle:0.0, tail0.0
3shot of client 11:head:0.004991680532445923, middle:0.0070921985815602835, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.005405405405405406, middle:0.0, tail0.0
3shot of client 14:head:0.003125, middle:0.012658227848101266, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.058823529411764705
3shot of client 16:head:0.003125, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.005479452054794521, middle:0.0, tail0.043478260869565216
3shot of client 19:head:0.0029411764705882353, middle:0.0, tail0.0
round 3, local average test acc  0.0052 

round 3, local macro average F1 score  0.0043 

round 3, local weighted average F1 score  0.0045 

round 3, global test acc  0.3183 

round 3, average 3shot acc: [head: 0.0057, middle: 0.0029, tail: 0.0051] 

round 3, global 3shot acc: [head: 0.6981, middle: 0.3248, tail: 0.0032] 

l_head tensor([1.7942, 2.3606, 0.5749, 4.3797, 4.4436, 2.3868, 2.6421, 2.8334, 2.5116,
        3.0325, 2.4278, 0.5738, 0.5521, 2.6345, 2.6738, 2.8874, 1.8016, 2.2728,
        2.8523, 0.5818, 2.0378, 0.5849, 1.5886, 2.5333, 0.5560, 2.1418, 3.0386,
        2.4796, 0.5829, 1.9693, 3.0640, 3.3530, 1.7796, 1.6257, 1.9596, 2.9437,
        2.6684, 0.5827, 2.9680, 1.6621, 2.8510, 2.6140, 3.0753, 3.7902, 3.6451,
        2.7298, 1.9209, 0.5710, 0.5623, 2.6590, 3.4438, 1.7416, 1.6538, 2.4053,
        2.8394, 1.8905, 1.5144, 0.5621, 1.8738, 1.9108, 0.5629, 0.5794, 0.5788,
        1.5792, 2.1399, 1.7398, 2.2149, 0.5789, 1.6626, 3.9436, 0.5911, 1.8001,
        0.5623, 1.5973, 0.5751, 2.9854, 0.5843, 0.5705, 2.6137, 0.5868, 1.8113,
        2.1462, 0.5813, 0.5740, 0.5814, 0.5789, 2.5026, 0.5828, 0.5673, 1.7874,
        0.5717, 0.5570, 2.2451, 1.6101, 2.4815, 0.5794, 0.5753, 3.0305, 1.7976,
        3.0233], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.5802, 1.8283, 2.2071, 2.0643, 2.1461, 1.7319, 1.9654, 1.7583, 1.8361,
        1.6644, 1.9975, 1.7695, 1.8035, 1.4575, 1.7717, 1.6977, 1.7893, 1.7642,
        1.7796, 1.5786, 1.3557, 1.6035, 1.6413, 1.5105, 1.5140, 1.4719, 1.7331,
        1.4771, 1.7788, 1.5229, 1.4339, 1.7064, 1.7172, 1.3620, 1.6124, 1.5598,
        1.3638, 1.5399, 1.5037, 1.3440, 1.5415, 1.3584, 1.6399, 1.6906, 1.3873,
        1.3968, 1.3650, 1.3291, 1.3510, 1.2326, 1.0528, 1.4125, 1.1533, 1.1930,
        1.3644, 1.0384, 1.4029, 1.2424, 1.2014, 1.1313, 1.0700, 1.0455, 1.1705,
        1.1925, 1.0146, 0.9094, 1.0839, 1.0893, 1.2311, 1.1909, 0.9792, 0.9971,
        0.7885, 0.9542, 0.8731, 1.0955, 1.1091, 0.9063, 0.8393, 0.8480, 0.8184,
        0.9392, 0.9452, 0.7572, 0.8979, 0.8482, 0.8628, 0.8218, 0.7951, 0.7665,
        0.7371, 0.7132, 0.8187, 0.7176, 0.8049, 0.7514, 0.7325, 0.6859, 0.6572,
        0.6566], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.012658227848101266, tail0.0
3shot of client 1:head:0.005221932114882507, middle:0.0, tail0.0
3shot of client 2:head:0.008333333333333333, middle:0.010416666666666666, tail0.0
3shot of client 3:head:0.00909090909090909, middle:0.0, tail0.0
3shot of client 4:head:0.005571030640668524, middle:0.0, tail0.0
3shot of client 5:head:0.006097560975609756, middle:0.012195121951219513, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.002857142857142857, middle:0.0, tail0.0
3shot of client 8:head:0.011560693641618497, middle:0.0, tail0.0
3shot of client 9:head:0.0035714285714285713, middle:0.0, tail0.0
3shot of client 10:head:0.03812316715542522, middle:0.0, tail0.0
3shot of client 11:head:0.004991680532445923, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.01694915254237288, tail0.0
3shot of client 13:head:0.002702702702702703, middle:0.0, tail0.0
3shot of client 14:head:0.003125, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.058823529411764705
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.002457002457002457, middle:0.010638297872340425, tail0.0
3shot of client 18:head:0.005479452054794521, middle:0.0, tail0.0
3shot of client 19:head:0.0029411764705882353, middle:0.0, tail0.0
round 4, local average test acc  0.0050 

round 4, local macro average F1 score  0.0031 

round 4, local weighted average F1 score  0.0044 

round 4, global test acc  0.3243 

round 4, average 3shot acc: [head: 0.0056, middle: 0.0031, tail: 0.0029] 

round 4, global 3shot acc: [head: 0.7003, middle: 0.3416, tail: 0.0034] 

l_head   1%|          | 5/500 [20:55<33:57:57, 247.03s/it]  1%|          | 6/500 [25:02<33:54:36, 247.12s/it]tensor([1.7668, 2.5250, 0.5749, 4.5129, 4.7315, 2.4626, 2.7925, 2.9389, 2.5707,
        3.1309, 2.5262, 0.5738, 0.5521, 2.8128, 2.9598, 3.0646, 1.9782, 2.3247,
        3.0920, 0.5818, 2.0695, 0.5849, 1.7936, 2.6684, 0.5560, 2.2334, 3.2097,
        2.5328, 0.5829, 2.0733, 3.4730, 3.5605, 1.8612, 1.7829, 2.1027, 3.0600,
        2.7973, 0.5827, 3.2884, 1.8779, 2.9443, 2.5985, 3.3480, 3.9810, 3.9351,
        2.9062, 2.1034, 0.5710, 0.5623, 2.7976, 3.6683, 1.8292, 1.6541, 2.4951,
        2.9988, 1.9749, 1.5019, 0.5621, 2.0199, 2.0633, 0.5629, 0.5794, 0.5788,
        1.6915, 2.3369, 1.9504, 2.2885, 0.5789, 1.7302, 4.1745, 0.5911, 2.0158,
        0.5623, 1.6168, 0.5751, 3.2015, 0.5843, 0.5705, 2.7894, 0.5868, 1.8957,
        2.2112, 0.5813, 0.5740, 0.5814, 0.5789, 2.5666, 0.5828, 0.5673, 1.8985,
        0.5717, 0.5570, 2.3483, 1.8876, 2.7252, 0.5794, 0.5753, 3.2390, 1.7942,
        3.0416], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.6189, 1.8835, 2.2260, 2.1483, 2.1866, 1.7556, 2.0392, 1.8102, 1.9275,
        1.7409, 2.0591, 1.8966, 1.8462, 1.5200, 1.8602, 1.7661, 1.8431, 1.7732,
        1.8281, 1.6761, 1.4142, 1.6174, 1.6922, 1.5582, 1.5951, 1.5230, 1.8332,
        1.5381, 1.8305, 1.6128, 1.4998, 1.7316, 1.7652, 1.4273, 1.6999, 1.6518,
        1.4709, 1.5599, 1.6130, 1.3955, 1.5961, 1.3893, 1.7663, 1.7436, 1.4705,
        1.5212, 1.4551, 1.4519, 1.4089, 1.3425, 1.1133, 1.5262, 1.2390, 1.2430,
        1.4613, 1.1143, 1.4800, 1.3197, 1.3145, 1.1752, 1.1468, 1.1368, 1.2370,
        1.2516, 1.0464, 0.9669, 1.1316, 1.1423, 1.3216, 1.2593, 1.0655, 1.0444,
        0.8419, 1.0143, 0.9270, 1.1649, 1.1756, 0.9722, 0.8945, 0.9239, 0.8681,
        0.9575, 0.9991, 0.8223, 0.9505, 0.8874, 0.9344, 0.8963, 0.8379, 0.8104,
        0.7757, 0.7535, 0.8417, 0.7706, 0.8584, 0.7850, 0.7894, 0.7134, 0.6859,
        0.6809], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.005221932114882507, middle:0.010638297872340425, tail0.0
3shot of client 2:head:0.002777777777777778, middle:0.0, tail0.0
3shot of client 3:head:0.0022727272727272726, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.009146341463414634, middle:0.0, tail0.0
3shot of client 6:head:0.006024096385542169, middle:0.0, tail0.0
3shot of client 7:head:0.002857142857142857, middle:0.0, tail0.0
3shot of client 8:head:0.008670520231213872, middle:0.010752688172043012, tail0.0
3shot of client 9:head:0.0, middle:0.0, tail0.0
3shot of client 10:head:0.03812316715542522, middle:0.0, tail0.0
3shot of client 11:head:0.0016638935108153079, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.005405405405405406, middle:0.0, tail0.0
3shot of client 14:head:0.00625, middle:0.0, tail0.0
3shot of client 15:head:0.0037593984962406013, middle:0.0, tail0.058823529411764705
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.005479452054794521, middle:0.011627906976744186, tail0.0
3shot of client 19:head:0.0029411764705882353, middle:0.0, tail0.0
round 5, local average test acc  0.0043 

round 5, local macro average F1 score  0.0019 

round 5, local weighted average F1 score  0.0033 

round 5, global test acc  0.3293 

round 5, average 3shot acc: [head: 0.0050, middle: 0.0017, tail: 0.0029] 

round 5, global 3shot acc: [head: 0.6984, middle: 0.3581, tail: 0.0047] 

l_head tensor([1.9821, 2.6654, 0.5749, 4.7340, 4.6398, 2.5404, 2.8101, 3.0597, 2.6116,
        3.2203, 2.5929, 0.5738, 0.5521, 2.8681, 2.9972, 2.9900, 1.9960, 2.4727,
        3.2978, 0.5818, 2.0723, 0.5849, 1.7927, 2.6645, 0.5560, 2.2480, 3.4228,
        2.7052, 0.5829, 2.2135, 3.4736, 3.6124, 1.9371, 1.7940, 2.1368, 3.2144,
        3.0085, 0.5827, 3.5426, 1.8556, 3.1177, 2.6618, 3.4908, 4.0792, 4.0788,
        3.0793, 2.2151, 0.5710, 0.5623, 3.0815, 3.8506, 1.9320, 1.7055, 2.6202,
        3.0025, 2.0876, 1.5869, 0.5621, 2.1120, 2.1717, 0.5629, 0.5794, 0.5788,
        1.8287, 2.3487, 2.0777, 2.3361, 0.5789, 1.7032, 4.2451, 0.5911, 2.1124,
        0.5623, 1.8189, 0.5751, 3.3345, 0.5843, 0.5705, 2.9620, 0.5868, 2.0478,
        2.4204, 0.5813, 0.5740, 0.5814, 0.5789, 2.6482, 0.5828, 0.5673, 2.0652,
        0.5717, 0.5570, 2.4123, 1.9482, 2.7247, 0.5794, 0.5753, 3.3856, 1.9101,
        3.3071], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.6891, 1.9387, 2.2637, 2.1833, 2.2334, 1.8193, 2.0994, 1.8680, 1.9838,
        1.8024, 2.1674, 1.9655, 1.8733, 1.6000, 1.8877, 1.7984, 1.8762, 1.8494,
        1.9094, 1.7325, 1.4843, 1.6483, 1.7470, 1.5892, 1.6369, 1.5818, 1.8768,
        1.6042, 1.8516, 1.6383, 1.5378, 1.7383, 1.8453, 1.4572, 1.7980, 1.7430,
        1.5163, 1.6358, 1.6929, 1.4515, 1.6423, 1.4353, 1.7796, 1.8119, 1.5359,
        1.5808, 1.5291, 1.5165, 1.4561, 1.3611, 1.1767, 1.5895, 1.3144, 1.3385,
        1.4990, 1.1346, 1.5493, 1.3430, 1.3898, 1.2428, 1.2247, 1.1744, 1.2909,
        1.3394, 1.0776, 1.0197, 1.2118, 1.1985, 1.3769, 1.3269, 1.1234, 1.0967,
        0.8770, 1.0402, 0.9849, 1.2331, 1.2446, 1.0513, 0.9306, 0.9997, 0.9085,
        1.0015, 1.0551, 0.8520, 0.9775, 0.9164, 0.9807, 0.9447, 0.8788, 0.8413,
        0.8200, 0.7809, 0.8858, 0.8072, 0.9342, 0.8255, 0.8295, 0.7334, 0.7128,
        0.7104], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0033112582781456954, middle:0.0, tail0.0
3shot of client 1:head:0.005221932114882507, middle:0.02127659574468085, tail0.0
3shot of client 2:head:0.008333333333333333, middle:0.0, tail0.0
3shot of client 3:head:0.0, middle:0.0, tail0.0
3shot of client 4:head:0.002785515320334262, middle:0.02127659574468085, tail0.0
3shot of client 5:head:0.003048780487804878, middle:0.0, tail0.0
3shot of client 6:head:0.0030120481927710845, middle:0.0, tail0.0
3shot of client 7:head:0.002857142857142857, middle:0.0, tail0.0
3shot of client 8:head:0.008670520231213872, middle:0.0, tail0.0
3shot of client 9:head:0.0, middle:0.0, tail0.0
3shot of client 10:head:0.04105571847507331, middle:0.0, tail0.0
3shot of client 11:head:0.004991680532445923, middle:0.0, tail0.0
3shot of client 12:head:0.00819672131147541, middle:0.0, tail0.0
3shot of client 13:head:0.002702702702702703, middle:0.0, tail0.0
3shot of client 14:head:0.009375, middle:0.012658227848101266, tail0.0
3shot of client 15:head:0.007518796992481203, middle:0.0, tail0.058823529411764705
3shot of client 16:head:0.003125, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.010958904109589041, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 6, local average test acc  0.0054 

round 6, local macro average F1 score  0.0033 

round 6, local weighted average F1 score  0.0051 

round 6, global test acc  0.3305 

round 6, average 3shot acc: [head: 0.0063, middle: 0.0028, tail: 0.0029] 

round 6, global 3shot acc: [head: 0.6955, middle: 0.3619, tail: 0.0071] 

l_head tensor([1.9797, 2.7754, 0.5749, 4.8136, 4.7423, 2.5525, 2.8201, 3.0755, 2.7079,
        3.3225, 2.6248, 0.5738, 0.5521, 3.0390, 3.1316, 3.3393, 2.0511, 2.4503,
        3.3638, 0.5818, 2.1195, 0.5849, 1.9008, 2.7464, 0.5560, 2.3020, 3.4467,
        2.9608, 0.5829, 2.2226, 3.4921, 3.7619, 2.0418, 1.8959, 2.1472, 3.2298,
        3.1746, 0.5827, 3.5957, 1.8608, 3.1978, 2.7164, 3.6405, 4.1989, 4.2571,
        3.1031, 2.4468, 0.5710, 0.5623, 3.0438, 3.8193, 2.0615, 1.8090, 2.5886,
        3.1206, 2.1857, 1.6554, 0.5621, 2.2155, 2.2407, 0.5629, 0.5794, 0.5788,
        1.9411, 2.4501, 2.0427, 2.4619, 0.5789, 1.8248, 4.3737, 0.5911, 2.2621,
        0.5623, 1.9973, 0.5751, 3.4551, 0.5843, 0.5705, 3.1121, 0.5868, 2.0889,
        2.5433, 0.5813, 0.5740, 0.5814, 0.5789, 2.6272, 0.5828, 0.5673, 2.0858,
        0.5717, 0.5570, 2.5639, 2.0181, 2.7806, 0.5794, 0.5753, 3.5003, 1.9957,
        3.4468], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux   1%|▏         | 7/500 [28:58<33:20:34, 243.48s/it]  2%|▏         | 8/500 [32:48<32:41:36, 239.22s/it]  2%|▏         | 9/500 [36:34<32:04:34, 235.18s/it]tensor([1.7166, 2.0061, 2.3118, 2.2351, 2.2955, 1.8450, 2.1456, 1.8621, 2.0276,
        1.8462, 2.1944, 2.0284, 1.9160, 1.6508, 1.9173, 1.8329, 1.9505, 1.8732,
        1.9470, 1.7473, 1.5112, 1.6657, 1.7858, 1.6263, 1.6604, 1.6396, 1.9460,
        1.6259, 1.8871, 1.6585, 1.5794, 1.7822, 1.8848, 1.5164, 1.8387, 1.8010,
        1.5762, 1.6301, 1.6930, 1.4906, 1.6847, 1.4733, 1.8763, 1.8649, 1.5980,
        1.6329, 1.6020, 1.5534, 1.5026, 1.4030, 1.2002, 1.6459, 1.3519, 1.3859,
        1.5572, 1.1736, 1.6021, 1.4296, 1.4446, 1.2923, 1.2519, 1.2567, 1.3465,
        1.4078, 1.1299, 1.0549, 1.2813, 1.2665, 1.4426, 1.3687, 1.1392, 1.1445,
        0.9196, 1.0978, 1.0396, 1.2799, 1.3022, 1.0818, 0.9527, 1.0421, 0.9712,
        1.0499, 1.0998, 0.9129, 1.0005, 0.9672, 1.0600, 0.9758, 0.9049, 0.8698,
        0.8501, 0.8134, 0.9326, 0.8412, 0.9654, 0.8620, 0.8729, 0.7541, 0.7398,
        0.7408], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0033112582781456954, middle:0.0, tail0.0
3shot of client 1:head:0.007832898172323759, middle:0.0, tail0.0
3shot of client 2:head:0.002777777777777778, middle:0.0, tail0.0
3shot of client 3:head:0.0022727272727272726, middle:0.008849557522123894, tail0.0
3shot of client 4:head:0.0, middle:0.010638297872340425, tail0.0
3shot of client 5:head:0.003048780487804878, middle:0.0, tail0.0
3shot of client 6:head:0.0030120481927710845, middle:0.0, tail0.0
3shot of client 7:head:0.005714285714285714, middle:0.0, tail0.0
3shot of client 8:head:0.005780346820809248, middle:0.0, tail0.0
3shot of client 9:head:0.010714285714285714, middle:0.0, tail0.0
3shot of client 10:head:0.04105571847507331, middle:0.0, tail0.0
3shot of client 11:head:0.0016638935108153079, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.008108108108108109, middle:0.0, tail0.0
3shot of client 14:head:0.00625, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.058823529411764705
3shot of client 16:head:0.003125, middle:0.012048192771084338, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.0027397260273972603, middle:0.0, tail0.0
3shot of client 19:head:0.0029411764705882353, middle:0.0, tail0.0
round 7, local average test acc  0.0046 

round 7, local macro average F1 score  0.0026 

round 7, local weighted average F1 score  0.0035 

round 7, global test acc  0.3328 

round 7, average 3shot acc: [head: 0.0055, middle: 0.0016, tail: 0.0029] 

round 7, global 3shot acc: [head: 0.6952, middle: 0.3681, tail: 0.0084] 

l_head tensor([1.9808, 2.8521, 0.5749, 4.9238, 4.8334, 2.6166, 2.8517, 3.1554, 2.7322,
        3.3973, 2.6933, 0.5738, 0.5521, 3.1090, 3.2011, 3.2691, 2.1328, 2.4686,
        3.5191, 0.5818, 2.1092, 0.5849, 2.0064, 2.8033, 0.5560, 2.4673, 3.5615,
        2.9763, 0.5829, 2.3112, 3.5798, 3.8731, 2.0397, 1.8831, 2.1665, 3.3696,
        3.2816, 0.5827, 3.6522, 1.9527, 3.2994, 2.7364, 3.6516, 4.2701, 4.2222,
        3.2086, 2.5715, 0.5710, 0.5623, 3.0236, 3.9975, 2.1325, 1.8086, 2.6662,
        3.1847, 2.2429, 1.6519, 0.5621, 2.3818, 2.2974, 0.5629, 0.5794, 0.5788,
        2.1346, 2.5138, 2.1367, 2.5827, 0.5789, 1.9878, 4.5092, 0.5911, 2.1889,
        0.5623, 1.9594, 0.5751, 3.5747, 0.5843, 0.5705, 3.2271, 0.5868, 2.1939,
        2.5703, 0.5813, 0.5740, 0.5814, 0.5789, 2.7204, 0.5828, 0.5672, 2.1821,
        0.5717, 0.5570, 2.6409, 2.0646, 2.8375, 0.5794, 0.5753, 3.5384, 2.1258,
        3.4971], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.7635, 2.0251, 2.3182, 2.3061, 2.3616, 1.8536, 2.1813, 1.9121, 2.0511,
        1.8643, 2.2250, 2.0769, 1.9559, 1.6841, 1.9692, 1.8807, 1.9903, 1.9160,
        1.9858, 1.7916, 1.5466, 1.7034, 1.8088, 1.6613, 1.6851, 1.6848, 1.9786,
        1.6677, 1.9428, 1.6837, 1.6361, 1.8209, 1.8969, 1.5494, 1.8835, 1.8732,
        1.6003, 1.6940, 1.7386, 1.5191, 1.7373, 1.5338, 1.8985, 1.9350, 1.6496,
        1.6800, 1.6720, 1.6076, 1.5370, 1.4563, 1.2598, 1.6890, 1.3635, 1.4058,
        1.5956, 1.2331, 1.6109, 1.4817, 1.5033, 1.3641, 1.2640, 1.3004, 1.4086,
        1.4778, 1.1459, 1.0905, 1.3272, 1.3026, 1.4693, 1.4141, 1.1859, 1.1895,
        0.9505, 1.1595, 1.0408, 1.3369, 1.3580, 1.1227, 1.0044, 1.0794, 0.9931,
        1.0929, 1.1359, 0.9394, 1.0417, 0.9723, 1.0925, 1.0215, 0.9580, 0.9056,
        0.8880, 0.8458, 0.9655, 0.8518, 1.0029, 0.9006, 0.9093, 0.7904, 0.7750,
        0.7658], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.005221932114882507, middle:0.0, tail0.0
3shot of client 2:head:0.002777777777777778, middle:0.0, tail0.0
3shot of client 3:head:0.0022727272727272726, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.003048780487804878, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.005714285714285714, middle:0.0, tail0.0
3shot of client 8:head:0.008670520231213872, middle:0.010752688172043012, tail0.0
3shot of client 9:head:0.007142857142857143, middle:0.0, tail0.0
3shot of client 10:head:0.04105571847507331, middle:0.0, tail0.0
3shot of client 11:head:0.0033277870216306157, middle:0.0, tail0.0
3shot of client 12:head:0.004098360655737705, middle:0.0, tail0.0
3shot of client 13:head:0.005405405405405406, middle:0.0, tail0.0
3shot of client 14:head:0.00625, middle:0.02531645569620253, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.058823529411764705
3shot of client 16:head:0.003125, middle:0.012048192771084338, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.0027397260273972603, middle:0.0, tail0.0
3shot of client 19:head:0.0029411764705882353, middle:0.0, tail0.0
round 8, local average test acc  0.0045 

round 8, local macro average F1 score  0.0022 

round 8, local weighted average F1 score  0.0035 

round 8, global test acc  0.3337 

round 8, average 3shot acc: [head: 0.0052, middle: 0.0024, tail: 0.0029] 

round 8, global 3shot acc: [head: 0.6942, middle: 0.3690, tail: 0.0108] 

l_head tensor([1.9647, 2.8912, 0.5749, 5.0090, 4.9144, 2.5913, 2.9287, 3.1847, 2.7908,
        3.4588, 2.6989, 0.5738, 0.5521, 3.1283, 3.2360, 3.2615, 2.2747, 2.4797,
        3.5663, 0.5818, 2.0840, 0.5849, 2.1352, 2.8109, 0.5560, 2.5080, 3.6776,
        2.9943, 0.5829, 2.4275, 3.6013, 3.8741, 2.0466, 1.9380, 2.1512, 3.3624,
        3.4102, 0.5827, 3.6863, 1.9570, 3.3499, 2.8096, 3.7179, 4.3925, 4.2003,
        3.2081, 2.6801, 0.5710, 0.5623, 3.1221, 4.0503, 2.1043, 1.8029, 2.7005,
        3.2379, 2.3283, 1.6795, 0.5621, 2.4133, 2.3662, 0.5629, 0.5794, 0.5788,
        2.0986, 2.5759, 2.2059, 2.6866, 0.5789, 1.9879, 4.6318, 0.5911, 2.2993,
        0.5623, 2.0939, 0.5751, 3.6134, 0.5843, 0.5705, 3.2968, 0.5868, 2.2309,
        2.6703, 0.5813, 0.5740, 0.5814, 0.5789, 2.7264, 0.5828, 0.5672, 2.1852,
        0.5717, 0.5570, 2.7009, 2.1744, 2.9094, 0.5794, 0.5753, 3.5992, 2.1098,
        3.6510], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8191, 2.0740, 2.3772, 2.3570, 2.3854, 1.8634, 2.2211, 1.9729, 2.0685,
        1.8968, 2.2428, 2.1325, 1.9766, 1.7093, 1.9694, 1.9228, 2.0326, 1.9312,
        2.0530, 1.8609, 1.5961, 1.7246, 1.8526, 1.6592, 1.7447, 1.7135, 2.0091,
        1.6799, 1.9619, 1.7033, 1.6509, 1.8224, 1.9323, 1.5855, 1.8912, 1.9037,
        1.6642, 1.7200, 1.7527, 1.5506, 1.7647, 1.5596, 1.9133, 1.9811, 1.7035,
        1.7275, 1.7198, 1.6676, 1.5834, 1.4870, 1.2763, 1.7413, 1.4373, 1.4602,
        1.6518, 1.2631, 1.6526, 1.5348, 1.5425, 1.3964, 1.2900, 1.3480, 1.4557,
        1.5216, 1.1734, 1.1393, 1.3771, 1.3509, 1.5445, 1.4584, 1.2325, 1.2164,
        0.9829, 1.1985, 1.0911, 1.3640, 1.4395, 1.1857, 1.0405, 1.1103, 1.0273,
        1.1355, 1.1884, 0.9586, 1.0701, 1.0113, 1.1193, 1.0694, 0.9830, 0.9246,
        0.9106, 0.8699, 0.9780, 0.8856, 1.0426, 0.9160, 0.9348, 0.8154, 0.8108,
        0.7877], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.012658227848101266, tail0.0
3shot of client 1:head:0.007832898172323759, middle:0.0, tail0.0
  2%|▏         | 10/500 [40:22<31:41:16, 232.81s/it]  2%|▏         | 11/500 [44:10<31:26:16, 231.44s/it]3shot of client 2:head:0.005555555555555556, middle:0.010416666666666666, tail0.0
3shot of client 3:head:0.0, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.003048780487804878, middle:0.0, tail0.0
3shot of client 6:head:0.0030120481927710845, middle:0.0, tail0.0
3shot of client 7:head:0.002857142857142857, middle:0.0, tail0.0
3shot of client 8:head:0.005780346820809248, middle:0.0, tail0.0
3shot of client 9:head:0.0035714285714285713, middle:0.0, tail0.0
3shot of client 10:head:0.04105571847507331, middle:0.0, tail0.0
3shot of client 11:head:0.0016638935108153079, middle:0.0070921985815602835, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.002702702702702703, middle:0.0, tail0.0
3shot of client 14:head:0.00625, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.003125, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.0027397260273972603, middle:0.0, tail0.0
3shot of client 19:head:0.0029411764705882353, middle:0.0, tail0.0
round 9, local average test acc  0.0038 

round 9, local macro average F1 score  0.0018 

round 9, local weighted average F1 score  0.0022 

round 9, global test acc  0.3365 

round 9, average 3shot acc: [head: 0.0046, middle: 0.0015, tail: 0.0000] 

round 9, global 3shot acc: [head: 0.6942, middle: 0.3784, tail: 0.0105] 

l_head tensor([1.9567, 2.9579, 0.5749, 5.1482, 4.9527, 2.5935, 2.9132, 3.2670, 2.8694,
        3.5020, 2.7695, 0.5738, 0.5521, 3.1666, 3.2556, 3.3749, 2.2426, 2.5415,
        3.6229, 0.5818, 2.1412, 0.5849, 2.1529, 2.8426, 0.5560, 2.5555, 3.6677,
        3.0816, 0.5829, 2.4823, 3.7819, 3.9743, 2.0896, 2.0232, 2.1625, 3.3741,
        3.4697, 0.5827, 3.7633, 1.9648, 3.4571, 2.8479, 3.6072, 4.4777, 4.2133,
        3.2983, 2.8293, 0.5710, 0.5623, 3.1076, 4.0916, 2.1745, 1.8479, 2.6942,
        3.3073, 2.4291, 1.6795, 0.5621, 2.5046, 2.3857, 0.5629, 0.5794, 0.5788,
        2.1268, 2.6626, 2.3626, 2.7745, 0.5789, 1.9822, 4.6325, 0.5911, 2.3626,
        0.5623, 2.0338, 0.5751, 3.7193, 0.5843, 0.5705, 3.3339, 0.5868, 2.3445,
        2.7358, 0.5813, 0.5740, 0.5814, 0.5789, 2.8541, 0.5828, 0.5672, 2.3531,
        0.5717, 0.5570, 2.7606, 2.2712, 2.9234, 0.5794, 0.5753, 3.6830, 2.1641,
        3.6979], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8718, 2.1030, 2.3874, 2.3700, 2.4181, 1.9017, 2.2639, 2.0056, 2.0918,
        1.9091, 2.2652, 2.1866, 1.9898, 1.7367, 2.0058, 1.9462, 2.0256, 1.9616,
        2.0923, 1.8777, 1.6274, 1.7570, 1.9024, 1.6928, 1.8115, 1.7531, 2.0200,
        1.6887, 1.9789, 1.7509, 1.7029, 1.8388, 1.9435, 1.6201, 1.9148, 1.9416,
        1.6992, 1.7234, 1.7937, 1.5852, 1.7815, 1.5978, 1.9200, 2.0337, 1.7361,
        1.7663, 1.7462, 1.6906, 1.5954, 1.5299, 1.3039, 1.7882, 1.4432, 1.5071,
        1.6808, 1.3085, 1.6708, 1.5598, 1.5913, 1.4621, 1.3314, 1.3786, 1.4957,
        1.5650, 1.1819, 1.1737, 1.4171, 1.3971, 1.5644, 1.4857, 1.2715, 1.2492,
        1.0140, 1.2213, 1.1395, 1.3992, 1.4681, 1.2273, 1.0767, 1.1469, 1.0603,
        1.1663, 1.2251, 1.0095, 1.0888, 1.0393, 1.1565, 1.0982, 1.0188, 0.9493,
        0.9483, 0.8975, 1.0142, 0.9165, 1.0836, 0.9432, 0.9625, 0.8400, 0.8348,
        0.8135], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0033112582781456954, middle:0.0, tail0.0
3shot of client 1:head:0.005221932114882507, middle:0.0, tail0.0
3shot of client 2:head:0.002777777777777778, middle:0.0, tail0.0
3shot of client 3:head:0.0022727272727272726, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.003048780487804878, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.002857142857142857, middle:0.0, tail0.0
3shot of client 8:head:0.014450867052023121, middle:0.0, tail0.0
3shot of client 9:head:0.0035714285714285713, middle:0.0, tail0.0
3shot of client 10:head:0.04105571847507331, middle:0.0, tail0.0
3shot of client 11:head:0.0033277870216306157, middle:0.014184397163120567, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.002702702702702703, middle:0.010309278350515464, tail0.0
3shot of client 14:head:0.003125, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.00625, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.0027397260273972603, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 10, local average test acc  0.0039 

round 10, local macro average F1 score  0.0015 

round 10, local weighted average F1 score  0.0024 

round 10, global test acc  0.3391 

round 10, average 3shot acc: [head: 0.0048, middle: 0.0012, tail: 0.0000] 

round 10, global 3shot acc: [head: 0.6919, middle: 0.3871, tail: 0.0121] 

l_head tensor([1.9580, 3.0501, 0.5749, 5.2022, 5.0928, 2.6064, 2.9602, 3.2381, 2.7886,
        3.5289, 2.7716, 0.5738, 0.5521, 3.1985, 3.2226, 3.3356, 2.2694, 2.5341,
        3.7172, 0.5818, 2.1781, 0.5849, 2.2815, 2.8137, 0.5560, 2.5461, 3.7941,
        3.1547, 0.5829, 2.4671, 3.8468, 3.9695, 2.1470, 2.0478, 2.2015, 3.4295,
        3.5434, 0.5827, 3.7989, 2.0526, 3.5760, 2.8966, 3.6916, 4.5851, 4.3097,
        3.2944, 2.8592, 0.5710, 0.5623, 3.1693, 4.1855, 2.2318, 1.8364, 2.7089,
        3.3636, 2.4921, 1.6887, 0.5621, 2.5212, 2.3924, 0.5629, 0.5794, 0.5788,
        2.1651, 2.8156, 2.3566, 2.8408, 0.5789, 1.9862, 4.7727, 0.5911, 2.3571,
        0.5623, 2.1076, 0.5751, 3.7415, 0.5843, 0.5705, 3.3101, 0.5868, 2.3440,
        2.8355, 0.5813, 0.5740, 0.5814, 0.5789, 2.9037, 0.5828, 0.5672, 2.3413,
        0.5717, 0.5570, 2.8712, 2.3260, 2.9900, 0.5794, 0.5753, 3.7881, 2.2455,
        3.8571], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8902, 2.1259, 2.4027, 2.3895, 2.4308, 1.9205, 2.2645, 2.0011, 2.1149,
        1.9499, 2.2876, 2.1971, 2.0227, 1.7799, 2.0268, 1.9758, 2.0466, 1.9803,
        2.1049, 1.9009, 1.6466, 1.7806, 1.9278, 1.7159, 1.8509, 1.7746, 2.0719,
        1.7059, 1.9917, 1.7710, 1.7157, 1.8556, 1.9778, 1.6472, 1.9360, 1.9987,
        1.7142, 1.7408, 1.8130, 1.6101, 1.8135, 1.6193, 1.9300, 2.0459, 1.7761,
        1.7964, 1.7683, 1.7209, 1.6368, 1.5593, 1.3386, 1.8051, 1.4987, 1.5477,
        1.7296, 1.3449, 1.6991, 1.6037, 1.6197, 1.4832, 1.3696, 1.4229, 1.5090,
        1.6010, 1.2240, 1.2204, 1.4481, 1.4220, 1.5973, 1.5217, 1.2980, 1.2716,
        1.0418, 1.2491, 1.1688, 1.4400, 1.4975, 1.2559, 1.0913, 1.1892, 1.0958,
        1.1942, 1.2678, 1.0298, 1.1284, 1.0598, 1.1948, 1.1256, 1.0427, 0.9792,
        0.9713, 0.9257, 1.0536, 0.9411, 1.1087, 0.9668, 0.9860, 0.8608, 0.8642,
        0.8364], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.005221932114882507, middle:0.010638297872340425, tail0.0
3shot of client 2:head:0.005555555555555556, middle:0.010416666666666666, tail0.0
3shot of client 3:head:0.013636363636363636, middle:0.0, tail0.03571428571428571
3shot of client 4:head:0.005571030640668524, middle:0.0, tail0.0
3shot of client 5:head:0.003048780487804878, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.002857142857142857, middle:0.0, tail0.0
3shot of client 8:head:0.005780346820809248, middle:0.0, tail0.0
3shot of client 9:head:0.0035714285714285713, middle:0.0, tail0.0
3shot of client 10:head:0.04398826979472141, middle:0.0, tail0.0
3shot of client 11:head:0.004991680532445923, middle:0.0, tail0.0
3shot of client 12:head:0.004098360655737705, middle:0.0, tail0.0
3shot of client 13:head:0.005405405405405406, middle:0.0, tail0.0
3shot of client 14:head:0.003125, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.009375, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.0027397260273972603, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 11, local average test acc  0.0048 

round 11, local macro average F1 score  0.0026 

  2%|▏         | 12/500 [47:55<31:06:48, 229.53s/it]  3%|▎         | 13/500 [51:40<30:51:04, 228.06s/it]round 11, local weighted average F1 score  0.0042 

round 11, global test acc  0.3387 

round 11, average 3shot acc: [head: 0.0059, middle: 0.0011, tail: 0.0018] 

round 11, global 3shot acc: [head: 0.6887, middle: 0.3881, tail: 0.0129] 

l_head tensor([1.9904, 3.1292, 0.5749, 5.3147, 5.1662, 2.6467, 2.9414, 3.3077, 2.8544,
        3.5738, 2.8277, 0.5738, 0.5521, 3.2191, 3.3302, 3.4057, 2.2663, 2.5802,
        3.7657, 0.5818, 2.1723, 0.5849, 2.3255, 2.8784, 0.5560, 2.5466, 3.8986,
        3.1523, 0.5829, 2.5212, 3.8286, 4.0200, 2.1738, 2.0506, 2.2042, 3.4779,
        3.6655, 0.5827, 3.8269, 2.1066, 3.5922, 2.9311, 3.7649, 4.6164, 4.3577,
        3.3619, 2.9207, 0.5710, 0.5623, 3.2529, 4.2323, 2.2408, 1.8384, 2.7857,
        3.4181, 2.4887, 1.6913, 0.5621, 2.5540, 2.4277, 0.5629, 0.5794, 0.5788,
        2.2949, 2.9101, 2.4047, 2.9003, 0.5789, 2.0069, 4.8681, 0.5911, 2.3685,
        0.5623, 2.1728, 0.5751, 3.8106, 0.5843, 0.5705, 3.3844, 0.5868, 2.4172,
        2.8293, 0.5813, 0.5740, 0.5814, 0.5790, 2.8992, 0.5828, 0.5672, 2.4396,
        0.5717, 0.5570, 2.9450, 2.2688, 3.0228, 0.5794, 0.5753, 3.8017, 2.3163,
        3.9331], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8936, 2.1159, 2.4272, 2.4341, 2.4581, 1.9410, 2.2768, 2.0027, 2.1641,
        1.9547, 2.3089, 2.2145, 2.0570, 1.8044, 2.0430, 1.9856, 2.0729, 2.0124,
        2.1200, 1.9266, 1.6756, 1.7909, 1.9695, 1.7511, 1.8569, 1.7593, 2.0703,
        1.7402, 2.0080, 1.7947, 1.7379, 1.8899, 2.0127, 1.6602, 1.9609, 2.0232,
        1.7224, 1.7458, 1.8375, 1.6434, 1.8136, 1.6388, 1.9739, 2.0639, 1.7887,
        1.8420, 1.8272, 1.7403, 1.6592, 1.5860, 1.3684, 1.8348, 1.4939, 1.5650,
        1.7645, 1.4033, 1.7274, 1.6382, 1.6341, 1.5392, 1.3884, 1.4534, 1.5566,
        1.6424, 1.2503, 1.2402, 1.4859, 1.4579, 1.6217, 1.5502, 1.3343, 1.3116,
        1.0730, 1.2905, 1.1930, 1.4702, 1.5342, 1.2880, 1.1145, 1.2126, 1.1273,
        1.2248, 1.2995, 1.0612, 1.1522, 1.0843, 1.2169, 1.1697, 1.0664, 1.0048,
        0.9858, 0.9493, 1.0528, 0.9630, 1.1497, 0.9958, 1.0121, 0.8771, 0.8855,
        0.8618], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0033112582781456954, middle:0.0, tail0.05263157894736842
3shot of client 1:head:0.005221932114882507, middle:0.0, tail0.0
3shot of client 2:head:0.005555555555555556, middle:0.0, tail0.0
3shot of client 3:head:0.0, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.003048780487804878, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.002857142857142857, middle:0.0, tail0.0
3shot of client 8:head:0.008670520231213872, middle:0.0, tail0.0
3shot of client 9:head:0.0035714285714285713, middle:0.014492753623188406, tail0.0
3shot of client 10:head:0.03812316715542522, middle:0.0, tail0.0
3shot of client 11:head:0.0033277870216306157, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.002702702702702703, middle:0.010309278350515464, tail0.041666666666666664
3shot of client 14:head:0.003125, middle:0.0, tail0.0
3shot of client 15:head:0.0037593984962406013, middle:0.0, tail0.058823529411764705
3shot of client 16:head:0.00625, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.005479452054794521, middle:0.011627906976744186, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 12, local average test acc  0.0043 

round 12, local macro average F1 score  0.0043 

round 12, local weighted average F1 score  0.0032 

round 12, global test acc  0.3417 

round 12, average 3shot acc: [head: 0.0048, middle: 0.0018, tail: 0.0077] 

round 12, global 3shot acc: [head: 0.6877, middle: 0.3968, tail: 0.0145] 

l_head tensor([2.0022, 3.1700, 0.5749, 5.4040, 5.1911, 2.6427, 2.9536, 3.3001, 2.9007,
        3.6281, 2.8704, 0.5738, 0.5521, 3.2869, 3.3782, 3.4381, 2.2756, 2.6401,
        3.8521, 0.5818, 2.2287, 0.5849, 2.3398, 2.9154, 0.5560, 2.5748, 3.9593,
        3.2418, 0.5829, 2.5667, 3.8148, 4.0023, 2.1811, 2.0753, 2.2251, 3.5908,
        3.6653, 0.5827, 3.8219, 2.1233, 3.5979, 2.9725, 3.7709, 4.6652, 4.3869,
        3.3960, 3.0250, 0.5710, 0.5623, 3.3112, 4.3100, 2.3289, 1.8865, 2.7780,
        3.4870, 2.5481, 1.7119, 0.5621, 2.5365, 2.4186, 0.5629, 0.5794, 0.5788,
        2.3045, 2.9391, 2.5017, 3.0084, 0.5789, 2.0135, 4.8981, 0.5911, 2.3948,
        0.5623, 2.2584, 0.5751, 3.8311, 0.5843, 0.5705, 3.3901, 0.5868, 2.4063,
        2.8508, 0.5813, 0.5740, 0.5814, 0.5790, 2.9105, 0.5828, 0.5672, 2.4261,
        0.5717, 0.5570, 2.9573, 2.3964, 3.0380, 0.5794, 0.5753, 3.8227, 2.2982,
        4.0206], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.9201, 2.1296, 2.4556, 2.4358, 2.4365, 1.9683, 2.2990, 2.0127, 2.1866,
        1.9867, 2.3469, 2.2265, 2.0879, 1.8203, 2.0556, 2.0042, 2.0708, 2.0169,
        2.1225, 1.9366, 1.6955, 1.8195, 1.9867, 1.7615, 1.8646, 1.7913, 2.0949,
        1.7623, 2.0245, 1.8067, 1.7476, 1.9034, 2.0172, 1.6675, 1.9807, 2.0583,
        1.7671, 1.7739, 1.8799, 1.6504, 1.8537, 1.6471, 1.9822, 2.0858, 1.7936,
        1.8595, 1.8805, 1.7898, 1.6768, 1.6118, 1.3667, 1.8533, 1.5204, 1.5995,
        1.7797, 1.4219, 1.7469, 1.6546, 1.6581, 1.5566, 1.4112, 1.4886, 1.6008,
        1.7017, 1.2812, 1.2554, 1.5138, 1.4928, 1.6507, 1.5812, 1.3769, 1.3310,
        1.1022, 1.3247, 1.2235, 1.4939, 1.5618, 1.3077, 1.1326, 1.2429, 1.1332,
        1.2513, 1.3240, 1.0898, 1.1715, 1.0986, 1.2492, 1.2052, 1.0922, 1.0399,
        1.0075, 0.9759, 1.0843, 0.9983, 1.1772, 1.0064, 1.0370, 0.8977, 0.9077,
        0.8820], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.05263157894736842
3shot of client 1:head:0.005221932114882507, middle:0.0, tail0.0
3shot of client 2:head:0.002777777777777778, middle:0.0, tail0.0
3shot of client 3:head:0.004545454545454545, middle:0.0, tail0.03571428571428571
3shot of client 4:head:0.008356545961002786, middle:0.010638297872340425, tail0.0
3shot of client 5:head:0.003048780487804878, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.002857142857142857, middle:0.0, tail0.0
3shot of client 8:head:0.002890173410404624, middle:0.0, tail0.0
3shot of client 9:head:0.0035714285714285713, middle:0.014492753623188406, tail0.0
3shot of client 10:head:0.0469208211143695, middle:0.0, tail0.0
3shot of client 11:head:0.0016638935108153079, middle:0.0, tail0.0
3shot of client 12:head:0.004098360655737705, middle:0.0, tail0.0
3shot of client 13:head:0.005405405405405406, middle:0.010309278350515464, tail0.041666666666666664
3shot of client 14:head:0.003125, middle:0.0, tail0.0
3shot of client 15:head:0.0037593984962406013, middle:0.0, tail0.0
3shot of client 16:head:0.003125, middle:0.0, tail0.0
3shot of client 17:head:0.002457002457002457, middle:0.0, tail0.0
3shot of client 18:head:0.0027397260273972603, middle:0.011627906976744186, tail0.0
3shot of client 19:head:0.0, middle:0.011235955056179775, tail0.0
round 13, local average test acc  0.0049 

round 13, local macro average F1 score  0.0050 

round 13, local weighted average F1 score  0.0045 

round 13, global test acc  0.3425 

round 13, average 3shot acc: [head: 0.0053, middle: 0.0029, tail: 0.0065] 

round 13, global 3shot acc: [head: 0.6852, middle: 0.3981, tail: 0.0176] 

l_head   3%|▎         | 14/500 [55:21<30:30:53, 226.04s/it]  3%|▎         | 15/500 [58:59<30:05:49, 223.40s/it]tensor([2.0083, 3.1926, 0.5749, 5.5024, 5.3174, 2.7085, 3.0038, 3.2796, 2.9426,
        3.6738, 2.8699, 0.5738, 0.5521, 3.3765, 3.3611, 3.5010, 2.2955, 2.5983,
        3.8439, 0.5818, 2.2375, 0.5849, 2.3679, 2.9046, 0.5560, 2.6125, 4.0320,
        3.2619, 0.5829, 2.5695, 3.8642, 4.0200, 2.1502, 2.1008, 2.2003, 3.5888,
        3.7711, 0.5827, 3.8944, 2.1096, 3.6379, 2.9371, 3.8646, 4.7225, 4.4459,
        3.4316, 3.1542, 0.5710, 0.5623, 3.3193, 4.3366, 2.4080, 1.9057, 2.7850,
        3.5015, 2.5750, 1.7650, 0.5621, 2.5994, 2.4874, 0.5629, 0.5794, 0.5788,
        2.3639, 2.9792, 2.5216, 3.1014, 0.5789, 2.0044, 4.9664, 0.5911, 2.4031,
        0.5623, 2.3140, 0.5751, 3.8720, 0.5843, 0.5705, 3.4551, 0.5868, 2.4776,
        2.9052, 0.5813, 0.5740, 0.5814, 0.5790, 2.9989, 0.5828, 0.5672, 2.4296,
        0.5717, 0.5570, 3.0735, 2.4645, 3.0414, 0.5794, 0.5753, 3.8630, 2.3911,
        4.1305], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.9464, 2.1606, 2.4994, 2.4607, 2.4651, 1.9805, 2.3209, 2.0336, 2.2215,
        1.9921, 2.3641, 2.2617, 2.0978, 1.8556, 2.0955, 2.0408, 2.1022, 2.0349,
        2.1603, 1.9617, 1.6901, 1.8262, 2.0149, 1.7755, 1.8912, 1.8035, 2.1393,
        1.7833, 2.0355, 1.8263, 1.7473, 1.9259, 2.0426, 1.6980, 1.9913, 2.0828,
        1.8151, 1.7951, 1.8956, 1.6784, 1.8834, 1.6682, 1.9962, 2.1122, 1.8238,
        1.8868, 1.8999, 1.8027, 1.7072, 1.6339, 1.3885, 1.8872, 1.5332, 1.6242,
        1.8140, 1.4117, 1.7572, 1.6756, 1.6918, 1.5862, 1.4439, 1.5142, 1.6379,
        1.7404, 1.3156, 1.3046, 1.5182, 1.5139, 1.6779, 1.5970, 1.3931, 1.3536,
        1.1141, 1.3538, 1.2418, 1.5071, 1.5922, 1.3164, 1.1570, 1.2963, 1.1464,
        1.2858, 1.3760, 1.1114, 1.1903, 1.1340, 1.2798, 1.2612, 1.1139, 1.0716,
        1.0218, 1.0013, 1.1161, 1.0154, 1.1992, 1.0271, 1.0539, 0.9173, 0.9366,
        0.9066], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.005221932114882507, middle:0.0, tail0.0
3shot of client 2:head:0.005555555555555556, middle:0.0, tail0.0
3shot of client 3:head:0.004545454545454545, middle:0.0, tail0.0
3shot of client 4:head:0.008356545961002786, middle:0.0, tail0.0
3shot of client 5:head:0.003048780487804878, middle:0.0, tail0.0
3shot of client 6:head:0.0030120481927710845, middle:0.0, tail0.0
3shot of client 7:head:0.005714285714285714, middle:0.0, tail0.0
3shot of client 8:head:0.008670520231213872, middle:0.0, tail0.0
3shot of client 9:head:0.0035714285714285713, middle:0.0, tail0.0
3shot of client 10:head:0.03812316715542522, middle:0.0, tail0.0
3shot of client 11:head:0.0016638935108153079, middle:0.0070921985815602835, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.002702702702702703, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.003125, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.0027397260273972603, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.011235955056179775, tail0.0
round 14, local average test acc  0.0038 

round 14, local macro average F1 score  0.0017 

round 14, local weighted average F1 score  0.0026 

round 14, global test acc  0.3444 

round 14, average 3shot acc: [head: 0.0048, middle: 0.0009, tail: 0.0000] 

round 14, global 3shot acc: [head: 0.6842, middle: 0.4013, tail: 0.0208] 

l_head tensor([2.0555, 3.2858, 0.5749, 5.4788, 5.2945, 2.7074, 3.0377, 3.3414, 2.9939,
        3.6886, 2.9025, 0.5738, 0.5521, 3.3985, 3.3845, 3.5004, 2.3049, 2.6456,
        3.9265, 0.5818, 2.2090, 0.5849, 2.4196, 2.9193, 0.5560, 2.6243, 4.0958,
        3.3276, 0.5829, 2.6217, 3.7884, 4.1159, 2.2373, 2.1481, 2.2561, 3.5893,
        3.8077, 0.5827, 3.9588, 2.1597, 3.6697, 3.0170, 3.8851, 4.8293, 4.3665,
        3.4217, 3.1410, 0.5710, 0.5623, 3.3458, 4.4012, 2.3973, 1.8869, 2.7641,
        3.5162, 2.6305, 1.7956, 0.5621, 2.6058, 2.4431, 0.5629, 0.5794, 0.5788,
        2.3503, 3.0073, 2.4638, 3.1213, 0.5789, 2.0641, 5.0301, 0.5911, 2.4676,
        0.5623, 2.3939, 0.5751, 3.9069, 0.5843, 0.5705, 3.5492, 0.5868, 2.4883,
        2.9643, 0.5813, 0.5740, 0.5814, 0.5790, 3.0212, 0.5828, 0.5672, 2.4770,
        0.5717, 0.5570, 3.1620, 2.5021, 3.1302, 0.5794, 0.5753, 3.9356, 2.4229,
        4.1880], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.9744, 2.2025, 2.5040, 2.4714, 2.4832, 2.0017, 2.3793, 2.0352, 2.2434,
        2.0062, 2.3798, 2.2919, 2.1037, 1.8742, 2.1166, 2.0660, 2.1130, 2.0444,
        2.1675, 1.9754, 1.6935, 1.8309, 2.0195, 1.8173, 1.8928, 1.8203, 2.1429,
        1.7737, 2.0581, 1.8369, 1.7684, 1.9282, 2.0462, 1.7116, 2.0038, 2.1186,
        1.8326, 1.8151, 1.9072, 1.6998, 1.8917, 1.6855, 2.0098, 2.1048, 1.8392,
        1.9080, 1.9168, 1.8169, 1.7134, 1.6594, 1.4114, 1.9115, 1.5482, 1.6512,
        1.8490, 1.4402, 1.7905, 1.6920, 1.7269, 1.6059, 1.4481, 1.5442, 1.6638,
        1.7757, 1.3457, 1.3277, 1.5458, 1.5306, 1.7099, 1.6099, 1.4110, 1.3724,
        1.1281, 1.3698, 1.2684, 1.5486, 1.6178, 1.3506, 1.1784, 1.3110, 1.1620,
        1.3139, 1.3987, 1.1339, 1.2310, 1.1627, 1.3008, 1.2971, 1.1357, 1.0943,
        1.0413, 1.0144, 1.1391, 1.0341, 1.2229, 1.0504, 1.0815, 0.9360, 0.9638,
        0.9279], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.05263157894736842
3shot of client 1:head:0.005221932114882507, middle:0.0, tail0.0
3shot of client 2:head:0.002777777777777778, middle:0.0, tail0.0
3shot of client 3:head:0.0, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.003048780487804878, middle:0.0, tail0.0
3shot of client 6:head:0.0030120481927710845, middle:0.0, tail0.0
3shot of client 7:head:0.005714285714285714, middle:0.0, tail0.0
3shot of client 8:head:0.005780346820809248, middle:0.0, tail0.0
3shot of client 9:head:0.0035714285714285713, middle:0.0, tail0.0
3shot of client 10:head:0.04105571847507331, middle:0.0, tail0.0
3shot of client 11:head:0.0016638935108153079, middle:0.0, tail0.0
3shot of client 12:head:0.004098360655737705, middle:0.0, tail0.0
3shot of client 13:head:0.005405405405405406, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0037593984962406013, middle:0.0, tail0.0
3shot of client 16:head:0.00625, middle:0.0, tail0.0
3shot of client 17:head:0.004914004914004914, middle:0.0, tail0.0
3shot of client 18:head:0.005479452054794521, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 15, local average test acc  0.0040 

round 15, local macro average F1 score  0.0018 

round 15, local weighted average F1 score  0.0030 

round 15, global test acc  0.3474 

round 15, average 3shot acc: [head: 0.0051, middle: 0.0000, tail: 0.0026] 

round 15, global 3shot acc: [head: 0.6881, middle: 0.4048, tail: 0.0226] 

l_head tensor([2.0533, 3.2752, 0.5749, 5.5590, 5.2934, 2.7237, 3.0329, 3.3953, 2.9961,
        3.7587, 2.8559, 0.5738, 0.5521, 3.4303, 3.4128, 3.4909, 2.3720, 2.6613,
        4.0061, 0.5818, 2.2622, 0.5849, 2.4758, 2.9633, 0.5560, 2.6589, 4.1059,
        3.3428, 0.5829, 2.6812, 3.8501, 4.1289, 2.2197, 2.1464, 2.3110, 3.6461,
        3.8138, 0.5827, 3.9928, 2.1825, 3.6986, 3.0655, 3.9256, 4.8632, 4.4677,
        3.4208, 3.2405, 0.5710, 0.5623, 3.3246, 4.4217, 2.4135, 1.9156, 2.8277,
        3.5459, 2.6660, 1.7940, 0.5621, 2.6414, 2.4893, 0.5629, 0.5794, 0.5788,
        2.4497, 3.0526, 2.5707, 3.1837, 0.5789, 2.0544, 5.0776, 0.5911, 2.4817,
        0.5623, 2.3690, 0.5751, 3.9843, 0.5843, 0.5705, 3.5848, 0.5868, 2.4894,
        2.9720, 0.5813, 0.5740, 0.5814, 0.5790, 3.0300, 0.5828, 0.5672, 2.4792,
        0.5717, 0.5570, 3.1229, 2.5428, 3.1357, 0.5794, 0.5753, 4.0184, 2.4497,
        4.1982], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux   3%|▎         | 16/500 [1:02:35<29:44:24, 221.21s/it]  3%|▎         | 17/500 [1:06:14<29:36:20, 220.66s/it]
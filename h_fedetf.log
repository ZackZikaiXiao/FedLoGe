nohup: ignoring input
./temp/fl_acc_cifar100_resnet34_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N20_100_seed3407_p1_dirichlet1.0_IF0.01_LossCE.txt
Files already downloaded and verified
[500, 477, 455, 434, 415, 396, 378, 361, 344, 328, 314, 299, 286, 273, 260, 248, 237, 226, 216, 206, 197, 188, 179, 171, 163, 156, 149, 142, 135, 129, 123, 118, 112, 107, 102, 98, 93, 89, 85, 81, 77, 74, 70, 67, 64, 61, 58, 56, 53, 51, 48, 46, 44, 42, 40, 38, 36, 35, 33, 32, 30, 29, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 15, 14, 13, 13, 12, 12, 11, 11, 10, 10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5]
10847
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[496, 625, 562, 489, 532, 550, 584, 692, 545, 549, 522, 470, 575, 454, 619, 636, 549, 522, 377, 499]
training set distribution:
[[17 44  1 16 45 16  7  2  3 13  6  1 13 16 32  6  2  3 13 19  6 25  3  0
  20  5 11 35 12  4  4  0  6  5  0  6  3  3  4  0  0  1  2  5  0  1  3  1
   2  5  4  0  0  4  1  5  1  2  3  5  0  0  0  0  1  0  1  0  4  0  0  1
   1  0  0  0  2  1  0  0  0  4  2  1  0  0  1  0  1  0  0  1  1  0  0  1
   0  0  1  0]
 [37 35  4 11 50 16 31 29 24 48  1 40 18  1 12 42 15  2  3  4 14  9 12  2
   0 24  8  1  3  6  0  8  8 10  1  7  1  2  1  2  2  0  4  2  6  8  3  5
   0  0  2  1  1  6  1  3  3  4  0  0  1  0  0  2  3  0  1  2  7  2  0  2
   0  0  2  0  0  0  1  1  0  0  0  3  0  1  0  0  0  0  0  1  2  0  0  0
   1  0  0  0]
 [72 22 35 20  2  1  7 29  0  6  6  6 38  2 44  8 17 26  4  8  3  3 18  3
   3 13 15  1 21  4  1  9 10  3  1  7  1  1  2  7  0  5  1  3  1  8  0  0
   6  1  0  1  4  1  6  3  0  1  2  3  0  0  2  4  2  2  0  0  2  1  0  1
   0  2  0  0  0  0  1  0  5  2  0  0  0  1  0  1  0  3  2  0  3  1  0  0
   0  0  1  1]
 [59 40  5 11  0  8 18  0  6  7 19  0  1  1  6 14  9  2  2  2 34 30 33 11
  31  4 16  0  4  2  3  1 17  1 22  4  2  6  0  0 10  1  0  4  5  2  4  0
   1  6  1  0  0  0  0  1  2  0  0  1  1  2  0  5  1  0  3  0  0  0  2  0
   0  0  0  0  0  0  0  0  0  0  0  1  0  1  0  0  0  0  2  0  0  0  0  0
   0  2  0  0]
 [21 21 33  3  1 20  1 23 15 31 73  9 47  4  2 21  2  5  8 14  7  3  7  2
   5  0 11  7  3  4  4  0  9  2  3 11  4  0  2  8  2  1 12  7  0  1  3  1
   4  4  0  1  6  1  4  4  0  2  0  7  1  0  1  0  1  1  1  1  0  0  1  3
   0  0  2  1  1  2  0  0  2  0  1  1  0  1  0  0  3  1  0  0  0  0  0  0
   0  0  0  1]
 [ 9  1 42  5  1 39  1  6 56 26 14  1 15  1 37  4 20  4  2  0  8  3  5  5
   0  7  7  1 17  8 19 20  0 15  6 14  0  0  0  6 14 19  2  4  7  3  2  4
   5  3  2  6  1  4  1  7  1  3  2  0  0  0  2  1  2  0  5  3  0  1  2  4
   2  1  1  0  2  0  0  1  0  0  0  0  0  0  1  5  0  0  1  0  0  0  0  0
   1  0  0  0]
 [25 32  9 15 42  7 91 17 16  6  0  8 21 15 13 19 18 24  9  1  7  2  2  3
  31  1  2  2 12 15  9  3 14  0  1  2  0  2 12  5  0  9  1  3  1  4  1  1
   4  7  3  0  2  2  0  0  1  0  1  2  2  6  0  4  1  0  0  0  3  3  0  0
   1  2  0  1  1  0  0  1  1  1  0  0  1  0  0  0  0  0  0  0  0  0  1  0
   0  0  0  0]
 [10 22 38 26 10 22 75 38 23 16  6  8  0 32 16 18 20  0  4 19 33 35  2 23
  23  3  6 14  3  8 10 15  1  8  2  1  6  8 23  1  6  5  7  4  7  0  7  0
   0  0  0  0  1  7  0  1  0  0  0  0  1  0  2  1  0  0  2  0  0  0  1  0
   0  0  0  1  0  6  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  2  0  0
   0  2  0  0]
 [24  6 21  2 11  8  0 25 32  3  1 27 22 59  6 32  9 13 47 14 10  0  4 17
  16  9  3  0  4  3  4  7  5  3  3  1 11  5  5  1  4  0  2  7  2  3  0  0
   5  3  3  8  0  0  0  0  2  3  0  1  1  6  4  3  0  2  0  1  0  0  1  0
   1  0  0  0  0  0  0  0  0  1  0  2  1  0  0  0  0  0  0  2  0  0  3  0
   0  0  1  0]
 [62 20 21  9 10 86  9 17 23  3  7  6  5 16  7  1  3 15  0  4  3  4 30  8
   2  4  3 12  0 22 10 12  6  2 14  1  0  4  3  7 16  0  0  2  0  8  7  1
   1  2 11  0  0  0  2  2  0  3  0  3  2  2  0  0  2  1  0  2  0  1  0  0
   3  1  0  1  0  0  0  0  0  2  0  0  0  1  0  0  0  2  0  0  0  0  0  0
   0  0  0  0]
 [23 56 14 32 72 38  7  3  0 13  9 19  1  7  3 18  5 16  5  5 36  2  7  0
   0  6  4  0  6  0 10 11  0 12  1  8  3  5  3  6  0  0  0  1  4  1  1  5
   1  1  1  5  3  1  2  2  0  0  0  6  1  1  0  0  4  2  0  0  0  0  3  0
   0  0  1  0  0  0  0  0  0  1  0  0  1  3  1  0  0  1  0  1  0  0  1  0
   1  0  0  0]
 [ 9 64 31 76  2  0  9  3 11 21 15  6  2 20  2  0  1  0 16  8  1  4  0  0
   4  3 17 13  2  0 22  1  8  1  2  0  0 10  3  3  1  2  7  8  1  6  1  3
   2  3  3  0  0  0  4  2  8  2  0  0  8  0  0  1  2  1  1  1  0  1  0  0
   1  0  0  0  1  0  2  3  0  0  0  1  0  1  0  0  0  0  0  0  0  1  0  2
   0  0  0  0]
 [10 15 59  8 44  1  8 70  2  1  2 38 19 20  3 14  0  6  9 37 14  4  3  1
   1 10 10  2  0  5 10  4  1  8  2  9  2 21  1  9  2  9  0  2  7  2  7  2
   5  4  3  4  7  0  2  0  1  1  6  3  1  1  0  0  1  1  0  1  0  5  0  1
   0  0  0  1  0  2  1  0  0  0  4  0  2  0  1  0  1  0  0  0  0  0  1  1
   0  0  0  0]
 [18 24 53  4  7  1 13 21 28  3  2 22 12 14  5 25  8  3  1 12  2  4 14 21
   3  0  2 15  4  6  0 11  2  1  5  1  8  7  5  0  3  0  0  3  3  0  0  3
   0  1  0  4  3  6  1  0  0  0  1  0  5  1  2  0  2  1  3  7  0  3  0  0
   0  5  0  2  1  0  0  0  2  0  0  0  0  0  0  1  1  0  0  1  0  1  0  0
   1  0  0  0]
 [ 1  5  2 43 54 13 45 26 33 18  0 14  0 11  4  3 32 45 24 13  7  5  5  4
   1 19 11 22 22  7  1  0  8 17  2 11  5  1  2  6  3  6  0  1  4  2  1  4
   2  1  2  3  7  1  0  5 11  0  5  0  1  0  0  1  0  1  2  1  0  0  0  1
   0  0  2  1  0  1  2  0  0  0  1  0  1  0  0  0  2  0  0  0  0  0  0  0
   1  0  1  0]
 [26  8  8  4  7  2 14 11 19 80 54 45 31 11 22  7  7  6 25  2  0  1  6 36
  14 31  0  4  6  6  1  5  3  7 11  0  8  5  4  4  0  3 11  4  1  4  1  5
   3  3  0  1  0  4  3  2  2  5  0  0  1  1 10  1  0  4  0  1  2  0  0  1
   1  5  3  4  4  0  0  1  1  0  1  0  0  0  0  1  0  0  0  0  0  1  0  0
   0  0  0  0]
 [57 21  3 84  9  7  0  5  1  0 21 13 23  3  3  1  0  9 41 39  2 33  3 19
   0  6  5  0  2  0  3  1  5  3  1 12  2  2  1  5  2  8 14  2  9  1  7 19
   1  0  4  1  1  5  0  0  0  6  5  0  0  0  3  0  1  1  3  0  0  0  2  0
   0  0  0  1  0  0  2  2  1  0  0  0  2  0  1  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 9 15 16 22  9 32  0 27 11 28 60 26  6 35  3 10 40 13  1  1  4 10 16  1
   3  9  1  1  6  2 11  4  4  6  6  1  6  2  1  1  0  0  0  2  6  0  0  0
   5  1  3  9  1  0  3  1  0  2  3  1  0  1  0  0  1  1  0  1  1  1  5  1
   5  0  3  1  1  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  3]
 [ 5 17 57 11  6 13  7  5  3  2  3  8  6  2 28  3 22  1  0  0  3 10  8  3
   1  0  0  3  0 26  1  3  1  1 19  0  9  0  2  9  2  2  6  1  0  5  1  2
   0  5  4  1  6  0  8  0  1  0  2  0  0  6  1  0  0  6  1  1  0  2  1  1
   2  0  0  1  0  1  1  0  0  0  0  0  1  0  3  0  0  0  2  1  0  0  0  1
   0  1  0  0]
 [ 6  9  3 32 33 66 35  4 38  3 15  2  6  3 12  2  7 33  2  4  3  1  1 12
   5  2 17  9  8  1  0  3  4  2  0  2 22  5 11  1 10  3  1  2  0  2  9  0
   6  1  2  1  1  0  2  0  3  1  3  0  4  2  0  3  1  0  0  0  2  0  1  2
   0  0  1  0  1  0  3  3  0  0  2  1  0  0  0  0  0  0  0  0  0  0  0  1
   0  0  1  0]]
Total size of training set
10847
local test distribution:
[[15 40  0 14 41 14  6  1  2 11  5  0 11 14 29  5  1  2 11 17  5 23  2  0
  18  4 10 32 11  3  3  0  5  4  0  5  2  2  3  0  0  0  1  4  0  0  2  0
   1  4  3  0  0  3  0  4  0  1  2  4  0  0  0  0  0  0  0  0  3  0  0  0
   0  0  0  0  1  0  0  0  0  3  1  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [34 32  3 10 46 14 28 26 22 44  0 36 16  0 11 38 13  1  2  3 12  8 11  1
   0 22  7  0  2  5  0  7  7  9  0  6  0  1  0  1  1  0  3  1  5  7  2  4
   0  0  1  0  0  5  0  2  2  3  0  0  0  0  0  1  2  0  0  1  6  1  0  1
   0  0  1  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  1  0  0  0
   0  0  0  0]
 [66 20 32 18  1  0  6 26  0  5  5  5 35  1 40  7 15 23  3  7  2  2 16  2
   2 11 13  0 19  3  0  8  9  2  0  6  0  0  1  6  0  4  0  2  0  7  0  0
   5  0  0  0  3  0  5  2  0  0  1  2  0  0  1  3  1  1  0  0  1  0  0  0
   0  1  0  0  0  0  0  0  4  1  0  0  0  0  0  0  0  2  1  0  2  0  0  0
   0  0  0  0]
 [54 36  4 10  0  7 16  0  5  6 17  0  0  0  5 12  8  1  1  1 31 27 30 10
  28  3 14  0  3  1  2  0 15  0 20  3  1  5  0  0  9  0  0  3  4  1  3  0
   0  5  0  0  0  0  0  0  1  0  0  0  0  1  0  4  0  0  2  0  0  0  1  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0
   0  1  0  0]
 [19 19 30  2  0 18  0 21 13 28 67  8 43  3  1 19  1  4  7 12  6  2  6  1
   4  0 10  6  2  3  3  0  8  1  2 10  3  0  1  7  1  0 11  6  0  0  2  0
   3  3  0  0  5  0  3  3  0  1  0  6  0  0  0  0  0  0  0  0  0  0  0  2
   0  0  1  0  0  1  0  0  1  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0
   0  0  0  0]
 [ 8  0 38  4  0 35  0  5 51 23 12  0 13  0 34  3 18  3  1  0  7  2  4  4
   0  6  6  0 15  7 17 18  0 13  5 12  0  0  0  5 12 17  1  3  6  2  1  3
   4  2  1  5  0  3  0  6  0  2  1  0  0  0  1  0  1  0  4  2  0  0  1  3
   1  0  0  0  1  0  0  0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0
   0  0  0  0]
 [23 29  8 13 38  6 83 15 14  5  0  7 19 13 11 17 16 22  8  0  6  1  1  2
  28  0  1  1 11 13  8  2 12  0  0  1  0  1 11  4  0  8  0  2  0  3  0  0
   3  6  2  0  1  1  0  0  0  0  0  1  1  5  0  3  0  0  0  0  2  2  0  0
   0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 9 20 35 23  9 20 69 35 21 14  5  7  0 29 14 16 18  0  3 17 30 32  1 21
  21  2  5 12  2  7  9 13  0  7  1  0  5  7 21  0  5  4  6  3  6  0  6  0
   0  0  0  0  0  6  0  0  0  0  0  0  0  0  1  0  0  0  1  0  0  0  0  0
   0  0  0  0  0  5  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0
   0  1  0  0]
 [22  5 19  1 10  7  0 23 29  2  0 24 20 54  5 29  8 11 43 12  9  0  3 15
  14  8  2  0  3  2  3  6  4  2  2  0 10  4  4  0  3  0  1  6  1  2  0  0
   4  2  2  7  0  0  0  0  1  2  0  0  0  5  3  2  0  1  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  1  0  0  2  0
   0  0  0  0]
 [57 18 19  8  9 79  8 15 21  2  6  5  4 14  6  0  2 13  0  3  2  3 27  7
   1  3  2 11  0 20  9 11  5  1 12  0  0  3  2  6 14  0  0  1  0  7  6  0
   0  1 10  0  0  0  1  1  0  2  0  2  1  1  0  0  1  0  0  1  0  0  0  0
   2  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  1  0  0  0  0  0  0
   0  0  0  0]
 [21 51 12 29 66 35  6  2  0 11  8 17  0  6  2 16  4 14  4  4 33  1  6  0
   0  5  3  0  5  0  9 10  0 11  0  7  2  4  2  5  0  0  0  0  3  0  0  4
   0  0  0  4  2  0  1  1  0  0  0  5  0  0  0  0  3  1  0  0  0  0  2  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 8 59 28 70  1  0  8  2 10 19 13  5  1 18  1  0  0  0 14  7  0  3  0  0
   3  2 15 11  1  0 20  0  7  0  1  0  0  9  2  2  0  1  6  7  0  5  0  2
   1  2  2  0  0  0  3  1  7  1  0  0  7  0  0  0  1  0  0  0  0  0  0  0
   0  0  0  0  0  0  1  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1
   0  0  0  0]
 [ 9 13 54  7 40  0  7 64  1  0  1 35 17 18  2 12  0  5  8 34 12  3  2  0
   0  9  9  1  0  4  9  3  0  7  1  8  1 19  0  8  1  8  0  1  6  1  6  1
   4  3  2  3  6  0  1  0  0  0  5  2  0  0  0  0  0  0  0  0  0  4  0  0
   0  0  0  0  0  1  0  0  0  0  3  0  1  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [16 22 48  3  6  0 11 19 25  2  1 20 11 12  4 23  7  2  0 11  1  3 12 19
   2  0  1 13  3  5  0 10  1  0  4  0  7  6  4  0  2  0  0  2  2  0  0  2
   0  0  0  3  2  5  0  0  0  0  0  0  4  0  1  0  1  0  2  6  0  2  0  0
   0  4  0  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  4  1 39 49 11 41 23 30 16  0 12  0 10  3  2 29 41 22 11  6  4  4  3
   0 17 10 20 20  6  0  0  7 15  1 10  4  0  1  5  2  5  0  0  3  1  0  3
   1  0  1  2  6  0  0  4 10  0  4  0  0  0  0  0  0  0  1  0  0  0  0  0
   0  0  1  0  0  0  1  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0
   0  0  0  0]
 [23  7  7  3  6  1 12 10 17 73 49 41 28 10 20  6  6  5 23  1  0  0  5 33
  12 28  0  3  5  5  0  4  2  6 10  0  7  4  3  3  0  2 10  3  0  3  0  4
   2  2  0  0  0  3  2  1  1  4  0  0  0  0  9  0  0  3  0  0  1  0  0  0
   0  4  2  3  3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [52 19  2 77  8  6  0  4  0  0 19 11 21  2  2  0  0  8 37 35  1 30  2 17
   0  5  4  0  1  0  2  0  4  2  0 11  1  1  0  4  1  7 12  1  8  0  6 17
   0  0  3  0  0  4  0  0  0  5  4  0  0  0  2  0  0  0  2  0  0  0  1  0
   0  0  0  0  0  0  1  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 8 13 14 20  8 29  0 24 10 25 55 23  5 32  2  9 36 11  0  0  3  9 14  0
   2  8  0  0  5  1 10  3  3  5  5  0  5  1  0  0  0  0  0  1  5  0  0  0
   4  0  2  8  0  0  2  0  0  1  2  0  0  0  0  0  0  0  0  0  0  0  4  0
   4  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  2]
 [ 4 15 52 10  5 11  6  4  2  1  2  7  5  1 25  2 20  0  0  0  2  9  7  2
   0  0  0  2  0 23  0  2  0  0 17  0  8  0  1  8  1  1  5  0  0  4  0  1
   0  4  3  0  5  0  7  0  0  0  1  0  0  5  0  0  0  5  0  0  0  1  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  1  0  0  0  0  0
   0  0  0  0]
 [ 5  8  2 29 30 60 32  3 35  2 13  1  5  2 11  1  6 30  1  3  2  0  0 11
   4  1 15  8  7  0  0  2  3  1  0  1 20  4 10  0  9  2  0  1  0  1  8  0
   5  0  1  0  0  0  1  0  2  0  2  0  3  1  0  2  0  0  0  0  1  0  0  1
   0  0  0  0  0  0  2  2  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]]
Total size of testing set
9097
[453 430 408 390 373 353 339 322 308 289 278 264 254 239 228 217 208 196
 188 178 170 162 153 148 139 134 127 120 115 108 104  99  92  86  81  80
  76  71  66  64  61  59  56  47  49  44  42  41  37  34  33  32  30  30
  26  25  24  22  22  22  16  18  18  15  10  11  12  10  14  10   9   7
   8  10   7   4   5   7   5   5   6   5   5   3   2   2   2   4   3   3
   3   1   3   1   2   1   0   2   0   2]
20
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [04:01<33:26:21, 241.25s/it]  0%|          | 2/500 [07:54<32:44:52, 236.73s/it]3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.0049382716049382715, middle:0.0, tail0.0
3shot of client 2:head:0.005698005698005698, middle:0.0, tail0.0
3shot of client 3:head:0.01935483870967742, middle:0.0, tail0.0
3shot of client 4:head:0.011904761904761904, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.0021929824561403508, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.005571030640668524, middle:0.0, tail0.0
3shot of client 10:head:0.005970149253731343, middle:0.012048192771084338, tail0.0
3shot of client 11:head:0.006802721088435374, middle:0.0, tail0.0
3shot of client 12:head:0.0027624309392265192, middle:0.0, tail0.0
3shot of client 13:head:0.0034965034965034965, middle:0.0, tail0.0
3shot of client 14:head:0.0025252525252525255, middle:0.00980392156862745, tail0.04
3shot of client 15:head:0.0024509803921568627, middle:0.0, tail0.0
3shot of client 16:head:0.002793296089385475, middle:0.0, tail0.0
3shot of client 17:head:0.005988023952095809, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 0, local average test acc  0.0034 

round 0, local macro average F1 score  0.0030 

round 0, local weighted average F1 score  0.0048 

round 0, global test acc  0.2947 

round 0, average 3shot acc: [head: 0.0041, middle: 0.0011, tail: 0.0020] 

round 0, global 3shot acc: [head: 0.7304, middle: 0.3548, tail: 0.0183] 

l_head tensor([1.4792, 2.4045, 1.1272, 2.6458, 2.8311, 1.8157, 1.7687, 1.2074, 1.6160,
        1.2355, 1.6887, 1.0355, 2.0918, 1.9775, 2.1848, 1.4568, 1.4004, 1.5090,
        1.7714, 2.1844, 0.8151, 2.0111, 1.1198, 0.5809, 1.7910, 1.6518, 1.8497,
        2.6581, 1.6010, 1.4673, 1.2654, 0.5787, 2.0401, 1.4860, 0.5745, 1.8240,
        1.4985, 1.4843, 1.7148, 0.5895, 0.5737, 0.8754, 1.4843, 1.7438, 0.6174,
        0.8332, 1.6337, 1.0960, 1.3970, 1.9337, 1.8288, 0.5796, 0.5653, 1.6717,
        1.0353, 2.1584, 0.8192, 1.4096, 1.7762, 1.5663, 0.5628, 0.5794, 0.5791,
        0.5744, 0.9658, 0.5825, 1.0722, 0.5789, 1.8310, 0.5746, 0.5908, 1.0914,
        1.1459, 0.5769, 0.5737, 0.5887, 1.3263, 1.1715, 0.5627, 0.5872, 0.5776,
        1.8311, 1.3877, 0.8912, 0.5807, 0.5788, 1.3244, 0.6438, 1.1087, 0.5891,
        0.5722, 1.1504, 1.0169, 0.5840, 0.5777, 1.0535, 0.5753, 0.5656, 1.2039,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.3043, 1.6654, 1.8130, 1.7141, 1.5327, 1.4236, 1.3467, 1.3063, 1.3935,
        1.2677, 1.4332, 1.6379, 1.3407, 1.3517, 1.3665, 1.4415, 1.3202, 1.2336,
        1.2837, 1.3061, 1.0630, 1.3069, 1.4109, 0.9972, 1.0932, 1.3246, 1.3015,
        1.0830, 1.1869, 1.1452, 1.0515, 1.2005, 1.3652, 1.2229, 1.1743, 1.1721,
        1.0754, 1.1496, 1.1198, 1.0842, 0.9610, 0.9630, 0.9052, 1.1834, 0.9361,
        0.9504, 0.8727, 0.9157, 1.0857, 1.0321, 0.7643, 0.8574, 0.8339, 0.8104,
        0.9268, 0.7060, 0.7801, 0.7561, 0.8106, 0.6996, 0.7950, 0.7608, 0.6807,
        0.6938, 0.6566, 0.6253, 0.6620, 0.6868, 0.6007, 0.6864, 0.6870, 0.6746,
        0.6422, 0.6465, 0.6141, 0.6660, 0.6233, 0.5905, 0.6133, 0.6159, 0.5969,
        0.6049, 0.5952, 0.5824, 0.6069, 0.5984, 0.5949, 0.6040, 0.5892, 0.5884,
        0.5919, 0.5987, 0.5703, 0.5436, 0.5890, 0.5763, 0.5694, 0.6009, 0.5858,
        0.5962], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.003215434083601286, middle:0.0, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.0
3shot of client 2:head:0.011396011396011397, middle:0.010869565217391304, tail0.0
3shot of client 3:head:0.00967741935483871, middle:0.0, tail0.0
3shot of client 4:head:0.008928571428571428, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.002652519893899204, middle:0.01098901098901099, tail0.0
3shot of client 7:head:0.0021929824561403508, middle:0.0, tail0.0
3shot of client 8:head:0.005681818181818182, middle:0.011627906976744186, tail0.0
3shot of client 9:head:0.011142061281337047, middle:0.0, tail0.0
3shot of client 10:head:0.0029850746268656717, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0027624309392265192, middle:0.0, tail0.043478260869565216
3shot of client 13:head:0.0034965034965034965, middle:0.0, tail0.0
3shot of client 14:head:0.0025252525252525255, middle:0.00980392156862745, tail0.0
3shot of client 15:head:0.004901960784313725, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.008982035928143712, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.003194888178913738, middle:0.0, tail0.0
round 1, local average test acc  0.0037 

round 1, local macro average F1 score  0.0036 

round 1, local weighted average F1 score  0.0049 

round 1, global test acc  0.3102 

round 1, average 3shot acc: [head: 0.0042, middle: 0.0022, tail: 0.0022] 

round 1, global 3shot acc: [head: 0.7330, middle: 0.3832, tail: 0.0344] 

l_head tensor([1.9413, 2.5620, 1.2839, 3.2898, 3.3804, 2.1320, 1.8742, 1.6866, 1.5516,
        1.7396, 2.2504, 1.3051, 2.4505, 2.7585, 2.4214, 1.8042, 1.2585, 1.7528,
        2.1725, 2.5452, 1.1548, 2.4322, 1.1686, 0.5809, 1.7997, 1.7437, 2.1731,
        3.1304, 1.9853, 1.5758, 1.5402, 0.5787, 2.2065, 1.8563, 0.5745, 2.5041,
        1.9540, 2.1310, 2.1934, 0.5895, 0.5737, 0.8643, 1.8824, 2.4125, 0.6174,
        1.1776, 2.1390, 1.6085, 1.7277, 2.2255, 2.4521, 0.5796, 0.5653, 1.8779,
        1.2004, 2.6423, 1.3099, 1.6638, 2.0285, 1.8967, 0.5628, 0.5794, 0.5791,
        0.5744, 1.4446, 0.5825, 1.5484, 0.5789, 2.4081, 0.5746, 0.5908, 1.2450,
        1.5631, 0.5769, 0.5737, 0.5887, 1.7139, 1.4587, 0.5627, 0.5872, 0.5776,
        2.1756, 1.8097, 1.3648, 0.5807, 0.5788, 1.5294, 0.6438, 1.4143, 0.5891,
        0.5722, 1.5687, 1.2770, 0.5840, 0.5777, 1.3963, 0.5753, 0.5656, 1.3718,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.5465, 1.9686, 2.2702, 2.0536, 1.8090, 1.6734, 1.5747, 1.5065, 1.6027,
        1.5087, 1.7401, 2.0437, 1.6214, 1.5657, 1.5674, 1.6663, 1.5999, 1.5054,
        1.4794, 1.5226, 1.2534, 1.5035, 1.6365, 1.1684, 1.3031, 1.6270, 1.5890,
        1.2953, 1.3382, 1.3554, 1.1909, 1.4586, 1.5891, 1.3798, 1.4667, 1.4878,
        1.2958, 1.3560, 1.3517, 1.3209, 1.1994, 1.1398, 1.1576, 1.5707, 1.1966,
        1.1916, 1.1210, 1.1746, 1.3158, 1.1694, 0.9620, 1.1371, 0.9748, 0.9967,
        1.1126, 0.8594, 1.0120, 0.9814, 1.0712, 0.8794, 0.9042, 0.9931, 0.8081,
        0.8883, 0.7660, 0.7434, 0.7970, 0.8102, 0.7317, 0.8472, 0.8538, 0.8034,
        0.7029, 0.7037, 0.7017, 0.8069, 0.7151, 0.6267, 0.6621, 0.6696, 0.6438,
        0.6769, 0.6499, 0.6449, 0.6668, 0.6363, 0.6465, 0.6274, 0.6200, 0.6076,
        0.6224, 0.6301, 0.5977, 0.5592, 0.6275, 0.6028, 0.5787, 0.6346, 0.6008,
        0.6178], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.0
3shot of client 2:head:0.011396011396011397, middle:0.0, tail0.0
3shot of client 3:head:0.012903225806451613, middle:0.0, tail0.0
3shot of client 4:head:0.002976190476190476, middle:0.0, tail0.0
3shot of client 5:head:0.0029154518950437317, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.005681818181818182, middle:0.011627906976744186, tail0.0
3shot of client 9:head:0.013927576601671309, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.003401360544217687, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.006993006993006993, middle:0.014285714285714285, tail0.0
3shot of client 14:head:0.0025252525252525255, middle:0.0196078431372549, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.008888888888888889, middle:0.0, tail0.0
  1%|          | 3/500 [11:37<31:46:06, 230.11s/it]  1%|          | 4/500 [15:01<30:19:29, 220.10s/it]3shot of client 19:head:0.0, middle:0.0, tail0.0
round 2, local average test acc  0.0031 

round 2, local macro average F1 score  0.0024 

round 2, local weighted average F1 score  0.0039 

round 2, global test acc  0.3194 

round 2, average 3shot acc: [head: 0.0036, middle: 0.0023, tail: 0.0000] 

round 2, global 3shot acc: [head: 0.7341, middle: 0.4048, tail: 0.0417] 

l_head tensor([1.9791, 2.6845, 1.4552, 3.6588, 3.6020, 2.2754, 2.2403, 1.7586, 1.6906,
        1.9160, 2.4023, 1.7850, 2.8162, 2.9042, 2.7321, 1.7786, 1.3368, 1.8888,
        2.3858, 2.5832, 1.3162, 2.5486, 1.3461, 0.5809, 1.9626, 2.0275, 2.5347,
        3.4332, 2.1101, 1.7545, 1.6210, 0.5787, 2.2999, 2.1416, 0.5745, 2.7249,
        2.0623, 2.7015, 2.2756, 0.5895, 0.5737, 1.2304, 2.1223, 2.7957, 0.6174,
        1.3261, 2.6296, 1.7454, 1.8253, 2.3150, 2.9595, 0.5796, 0.5653, 2.4724,
        1.3719, 2.9643, 1.2536, 1.8601, 2.3029, 2.0366, 0.5628, 0.5794, 0.5791,
        0.5744, 1.7566, 0.5825, 1.7186, 0.5789, 2.6567, 0.5746, 0.5908, 1.4045,
        1.6072, 0.5769, 0.5737, 0.5887, 1.9727, 1.5966, 0.5627, 0.5872, 0.5776,
        2.3849, 2.1879, 1.4060, 0.5807, 0.5788, 1.7433, 0.6438, 1.6348, 0.5891,
        0.5722, 1.6578, 1.4593, 0.5840, 0.5777, 1.7170, 0.5753, 0.5656, 1.6230,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.6319, 2.0827, 2.3764, 2.2056, 2.0169, 1.8523, 1.7244, 1.6760, 1.7072,
        1.6243, 1.9112, 2.2876, 1.7761, 1.7615, 1.6942, 1.7661, 1.6991, 1.6114,
        1.5800, 1.5783, 1.3096, 1.5707, 1.7720, 1.2933, 1.4136, 1.7404, 1.7774,
        1.4234, 1.4385, 1.5037, 1.2555, 1.5686, 1.6800, 1.5153, 1.6491, 1.6853,
        1.4462, 1.5140, 1.4869, 1.4293, 1.3588, 1.2303, 1.3198, 1.7946, 1.3548,
        1.3393, 1.3474, 1.2873, 1.3941, 1.3445, 1.0486, 1.3011, 1.1873, 1.1268,
        1.2492, 0.9654, 1.1310, 1.1102, 1.2100, 0.9670, 1.0238, 1.1207, 0.9790,
        1.0162, 0.8082, 0.8689, 0.9181, 0.9405, 0.8300, 0.9732, 1.0095, 0.8807,
        0.7800, 0.7892, 0.7684, 0.9281, 0.8008, 0.6891, 0.7466, 0.7333, 0.6922,
        0.7366, 0.7134, 0.6890, 0.7193, 0.6818, 0.7005, 0.6711, 0.6646, 0.6394,
        0.6595, 0.6775, 0.6177, 0.5810, 0.6763, 0.6466, 0.6134, 0.6653, 0.6234,
        0.6423], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.01282051282051282, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.0
3shot of client 2:head:0.011396011396011397, middle:0.0, tail0.0
3shot of client 3:head:0.012903225806451613, middle:0.011904761904761904, tail0.0
3shot of client 4:head:0.005952380952380952, middle:0.0, tail0.0
3shot of client 5:head:0.0058309037900874635, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.0021929824561403508, middle:0.0, tail0.0
3shot of client 8:head:0.002840909090909091, middle:0.0, tail0.0
3shot of client 9:head:0.005571030640668524, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0055248618784530384, middle:0.0, tail0.0
3shot of client 13:head:0.006993006993006993, middle:0.0, tail0.0
3shot of client 14:head:0.0025252525252525255, middle:0.00980392156862745, tail0.0
3shot of client 15:head:0.0, middle:0.009433962264150943, tail0.0
3shot of client 16:head:0.0, middle:0.011904761904761904, tail0.0
3shot of client 17:head:0.0029940119760479044, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 3, local average test acc  0.0030 

round 3, local macro average F1 score  0.0022 

round 3, local weighted average F1 score  0.0039 

round 3, global test acc  0.3251 

round 3, average 3shot acc: [head: 0.0032, middle: 0.0028, tail: 0.0000] 

round 3, global 3shot acc: [head: 0.7315, middle: 0.4092, tail: 0.0527] 

l_head tensor([1.9909, 2.8934, 1.6842, 3.8296, 3.6540, 2.3194, 2.3083, 1.8624, 1.7576,
        2.0907, 2.5390, 1.8367, 2.8869, 3.2305, 2.9752, 1.9436, 1.5727, 2.1154,
        2.5695, 2.6828, 1.2926, 2.7324, 1.5724, 0.5809, 2.1283, 2.0194, 2.8486,
        3.3656, 2.1476, 1.9648, 1.9908, 0.5787, 2.3996, 2.2640, 0.5745, 3.0507,
        2.3505, 2.6361, 2.6434, 0.5895, 0.5737, 1.2163, 2.3517, 3.0173, 0.6174,
        1.5517, 2.8215, 1.7008, 1.9255, 2.5754, 3.3343, 0.5796, 0.5653, 2.3989,
        1.5205, 3.1134, 1.3301, 2.0269, 2.4944, 2.1864, 0.5628, 0.5794, 0.5791,
        0.5744, 1.9703, 0.5825, 1.8162, 0.5789, 2.7088, 0.5746, 0.5908, 1.4876,
        1.7755, 0.5769, 0.5737, 0.5887, 1.9415, 1.8456, 0.5627, 0.5872, 0.5776,
        2.6904, 2.4055, 1.5152, 0.5807, 0.5788, 1.8393, 0.6438, 1.8332, 0.5891,
        0.5722, 1.8767, 1.6253, 0.5840, 0.5777, 1.7352, 0.5753, 0.5656, 1.7807,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.7225, 2.1510, 2.4563, 2.2885, 2.1286, 1.9325, 1.7908, 1.7664, 1.8252,
        1.7165, 2.0240, 2.4059, 1.8556, 1.8731, 1.8158, 1.8949, 1.7903, 1.6820,
        1.6621, 1.7257, 1.4018, 1.6555, 1.8385, 1.3318, 1.4823, 1.8293, 1.8399,
        1.4832, 1.5468, 1.5524, 1.3207, 1.6746, 1.7291, 1.5810, 1.8025, 1.8593,
        1.5466, 1.6227, 1.6299, 1.4816, 1.4025, 1.2798, 1.4605, 1.9218, 1.4896,
        1.4879, 1.3848, 1.3900, 1.5112, 1.4268, 1.1320, 1.4087, 1.2224, 1.1936,
        1.3479, 1.0606, 1.2380, 1.1781, 1.3566, 1.0638, 1.1143, 1.2427, 1.0552,
        1.1041, 0.8914, 0.9161, 1.0199, 1.0327, 0.9303, 1.0565, 1.1153, 0.9164,
        0.8454, 0.8706, 0.8212, 1.0011, 0.8914, 0.7408, 0.8186, 0.7950, 0.7534,
        0.8128, 0.7629, 0.7728, 0.7671, 0.7297, 0.7607, 0.7074, 0.6992, 0.6644,
        0.7103, 0.7257, 0.6602, 0.6123, 0.7304, 0.6901, 0.6413, 0.6877, 0.6568,
        0.6797], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.0024691358024691358, middle:0.0, tail0.0
3shot of client 2:head:0.011396011396011397, middle:0.0, tail0.0
3shot of client 3:head:0.012903225806451613, middle:0.0, tail0.0
3shot of client 4:head:0.002976190476190476, middle:0.0, tail0.0
3shot of client 5:head:0.0029154518950437317, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.0021929824561403508, middle:0.008403361344537815, tail0.0
3shot of client 8:head:0.002840909090909091, middle:0.0, tail0.0
3shot of client 9:head:0.008356545961002786, middle:0.0, tail0.0
3shot of client 10:head:0.008955223880597015, middle:0.0, tail0.0
3shot of client 11:head:0.006802721088435374, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.0034965034965034965, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.00980392156862745, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0125, tail0.0
round 4, local average test acc  0.0028 

round 4, local macro average F1 score  0.0019 

round 4, local weighted average F1 score  0.0031 

round 4, global test acc  0.3294 

round 4, average 3shot acc: [head: 0.0033, middle: 0.0015, tail: 0.0000] 

round 4, global 3shot acc: [head: 0.7304, middle: 0.4184, tail: 0.0575] 

l_head   1%|          | 5/500 [18:21<29:14:40, 212.69s/it]  1%|          | 6/500 [21:35<28:18:57, 206.35s/it]tensor([2.1851, 3.0085, 1.5814, 3.9765, 3.7798, 2.4582, 2.5204, 1.9932, 1.7575,
        2.1433, 2.5042, 2.0039, 2.9843, 3.4106, 3.0108, 1.9415, 1.5920, 2.0290,
        2.8687, 2.7097, 1.3997, 2.9334, 1.6623, 0.5809, 2.2579, 2.0584, 2.8573,
        3.3822, 2.3206, 2.0088, 2.0313, 0.5787, 2.4618, 2.4470, 0.5745, 3.1336,
        2.5327, 2.7382, 2.7291, 0.5895, 0.5737, 1.2152, 2.5104, 3.0282, 0.6174,
        1.7367, 3.0240, 1.8814, 2.1342, 2.7369, 3.3957, 0.5796, 0.5653, 2.3879,
        1.5575, 3.5281, 1.3288, 2.0764, 2.7500, 2.2384, 0.5628, 0.5794, 0.5791,
        0.5744, 2.0841, 0.5825, 2.0795, 0.5789, 3.0179, 0.5746, 0.5908, 1.6186,
        1.8938, 0.5769, 0.5737, 0.5887, 2.2548, 2.0177, 0.5627, 0.5872, 0.5776,
        2.8075, 2.3935, 1.6049, 0.5807, 0.5788, 1.9864, 0.6438, 2.1403, 0.5891,
        0.5722, 1.8105, 1.7649, 0.5840, 0.5777, 1.9691, 0.5753, 0.5656, 1.8978,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8120, 2.2059, 2.5406, 2.3428, 2.1563, 2.0064, 1.8387, 1.7899, 1.8663,
        1.8122, 2.1284, 2.5239, 1.9186, 1.9099, 1.8748, 1.9576, 1.8067, 1.7482,
        1.7187, 1.7588, 1.4631, 1.7051, 1.9124, 1.3725, 1.5639, 1.8923, 1.8922,
        1.5549, 1.6209, 1.5782, 1.4202, 1.6715, 1.7735, 1.5670, 1.9100, 2.0088,
        1.6200, 1.6765, 1.6735, 1.5388, 1.4826, 1.3570, 1.5345, 2.0292, 1.6047,
        1.5977, 1.4475, 1.4721, 1.5720, 1.4846, 1.1894, 1.4919, 1.2910, 1.2811,
        1.4607, 1.1020, 1.3019, 1.2865, 1.4529, 1.1175, 1.1543, 1.3567, 1.0849,
        1.2194, 0.9531, 0.9991, 1.1232, 1.1072, 1.0066, 1.1078, 1.1548, 1.0038,
        0.8856, 0.9294, 0.8795, 1.0736, 0.9692, 0.7977, 0.8685, 0.8528, 0.7943,
        0.8553, 0.8072, 0.8503, 0.8105, 0.7763, 0.8244, 0.7413, 0.7402, 0.6899,
        0.7463, 0.7543, 0.6919, 0.6553, 0.7622, 0.7319, 0.6796, 0.7226, 0.6865,
        0.7062], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.003215434083601286, middle:0.0, tail0.0
3shot of client 1:head:0.0024691358024691358, middle:0.0, tail0.0
3shot of client 2:head:0.017094017094017096, middle:0.0, tail0.0
3shot of client 3:head:0.012903225806451613, middle:0.0, tail0.0
3shot of client 4:head:0.005952380952380952, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.002652519893899204, middle:0.01098901098901099, tail0.0
3shot of client 7:head:0.0043859649122807015, middle:0.0, tail0.0
3shot of client 8:head:0.002840909090909091, middle:0.011627906976744186, tail0.0
3shot of client 9:head:0.005571030640668524, middle:0.0, tail0.0
3shot of client 10:head:0.0029850746268656717, middle:0.0, tail0.0
3shot of client 11:head:0.003401360544217687, middle:0.0, tail0.0
3shot of client 12:head:0.0055248618784530384, middle:0.0, tail0.0
3shot of client 13:head:0.0034965034965034965, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0196078431372549, tail0.0
3shot of client 15:head:0.0, middle:0.009433962264150943, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.003194888178913738, middle:0.0125, tail0.0
round 5, local average test acc  0.0035 

round 5, local macro average F1 score  0.0031 

round 5, local weighted average F1 score  0.0042 

round 5, global test acc  0.3299 

round 5, average 3shot acc: [head: 0.0038, middle: 0.0032, tail: 0.0000] 

round 5, global 3shot acc: [head: 0.7222, middle: 0.4212, tail: 0.0617] 

l_head tensor([2.1917, 3.1563, 1.7320, 4.2649, 3.9844, 2.4931, 2.6485, 2.0185, 1.8185,
        2.1358, 2.6164, 2.1730, 3.0422, 3.5250, 3.1392, 2.0258, 1.6285, 2.1661,
        2.9757, 2.6886, 1.3890, 3.1252, 1.7292, 0.5809, 2.3354, 2.0434, 3.0159,
        3.4615, 2.3406, 2.0089, 2.0148, 0.5787, 2.6050, 2.5261, 0.5745, 3.2561,
        2.5992, 2.7562, 2.7303, 0.5895, 0.5737, 1.2030, 2.5498, 3.1643, 0.6174,
        1.9032, 3.1807, 1.9598, 2.1771, 2.8099, 3.5570, 0.5796, 0.5653, 2.4125,
        1.6828, 3.7705, 1.3287, 2.2419, 2.9435, 2.2515, 0.5628, 0.5794, 0.5791,
        0.5744, 2.2018, 0.5825, 1.9941, 0.5789, 2.9405, 0.5746, 0.5908, 1.8981,
        1.9571, 0.5769, 0.5737, 0.5887, 2.2811, 1.9550, 0.5627, 0.5872, 0.5776,
        2.9999, 2.5240, 1.6405, 0.5807, 0.5788, 2.0030, 0.6438, 2.0696, 0.5891,
        0.5722, 1.9427, 1.8762, 0.5840, 0.5777, 2.0224, 0.5753, 0.5656, 1.9893,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8717, 2.3002, 2.5488, 2.4411, 2.2266, 2.0495, 1.9205, 1.8330, 1.8920,
        1.8363, 2.1239, 2.6331, 1.9686, 2.0116, 1.9200, 2.0501, 1.8849, 1.7791,
        1.7781, 1.8335, 1.5006, 1.7860, 1.9882, 1.4217, 1.6399, 1.9330, 1.9286,
        1.6388, 1.6469, 1.6190, 1.4388, 1.7204, 1.8584, 1.6231, 1.9695, 2.0693,
        1.6532, 1.7164, 1.6855, 1.5901, 1.5109, 1.4026, 1.6026, 2.1268, 1.6672,
        1.6642, 1.5864, 1.5561, 1.6064, 1.5470, 1.2816, 1.5334, 1.3793, 1.3216,
        1.5159, 1.1625, 1.3348, 1.3453, 1.5629, 1.1336, 1.2290, 1.4008, 1.1795,
        1.2397, 0.9881, 1.0466, 1.1901, 1.1856, 1.0532, 1.1954, 1.2162, 1.0640,
        0.9231, 0.9693, 0.9435, 1.1530, 1.0310, 0.8446, 0.9570, 0.9163, 0.8334,
        0.9126, 0.8441, 0.8767, 0.8581, 0.8238, 0.8787, 0.7799, 0.7728, 0.7331,
        0.7654, 0.7978, 0.7280, 0.6740, 0.7852, 0.7669, 0.7114, 0.7604, 0.7223,
        0.7437], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.0024691358024691358, middle:0.0, tail0.0
3shot of client 2:head:0.017094017094017096, middle:0.010869565217391304, tail0.0
3shot of client 3:head:0.012903225806451613, middle:0.0, tail0.0
3shot of client 4:head:0.005952380952380952, middle:0.0, tail0.0
3shot of client 5:head:0.0029154518950437317, middle:0.0, tail0.0
3shot of client 6:head:0.002652519893899204, middle:0.0, tail0.0
3shot of client 7:head:0.0043859649122807015, middle:0.008403361344537815, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.011142061281337047, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.047619047619047616
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.006993006993006993, middle:0.0, tail0.0
3shot of client 14:head:0.007575757575757576, middle:0.00980392156862745, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.005988023952095809, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.01639344262295082, tail0.0
3shot of client 19:head:0.006389776357827476, middle:0.0125, tail0.0
round 6, local average test acc  0.0040 

round 6, local macro average F1 score  0.0035 

round 6, local weighted average F1 score  0.0052 

round 6, global test acc  0.3324 

round 6, average 3shot acc: [head: 0.0043, middle: 0.0029, tail: 0.0024] 

round 6, global 3shot acc: [head: 0.7215, middle: 0.4268, tail: 0.0644] 

l_head tensor([2.1990, 2.9785, 1.7189, 4.4638, 4.0447, 2.5378, 2.6509, 2.1917, 1.8606,
        2.1549, 2.7318, 2.2682, 3.1422, 3.6542, 3.2253, 2.0499, 1.6301, 2.2016,
        2.8921, 2.7894, 1.3881, 3.1489, 1.6722, 0.5809, 2.4309, 2.1364, 2.9745,
        3.6143, 2.5365, 2.1357, 2.1975, 0.5787, 2.6459, 2.5548, 0.5745, 3.3930,
        2.6554, 2.8664, 2.8508, 0.5895, 0.5737, 1.2686, 2.6656, 3.2063, 0.6174,
        2.1493, 3.3837, 1.9734, 2.2250, 2.9652, 3.7048, 0.5796, 0.5653, 2.4742,
        1.6713, 3.9382, 1.5273, 2.3328, 3.0047, 2.3260, 0.5628, 0.5794, 0.5791,
        0.5744, 2.2841, 0.5825, 2.1109, 0.5789, 3.0757, 0.5746, 0.5908, 1.8689,
        2.0692, 0.5769, 0.5737, 0.5887, 2.3331, 2.0599, 0.5627, 0.5872, 0.5776,
        3.2096, 2.5848, 1.6966, 0.5807, 0.5788, 1.9069, 0.6438, 2.1638, 0.5891,
        0.5722, 1.9855, 1.9306, 0.5840, 0.5777, 2.1712, 0.5753, 0.5656, 2.1041,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux   1%|▏         | 7/500 [24:49<27:43:09, 202.41s/it]  2%|▏         | 8/500 [28:09<27:33:09, 201.60s/it]  2%|▏         | 9/500 [31:28<27:22:22, 200.70s/it]tensor([1.9490, 2.3178, 2.6166, 2.4927, 2.2755, 2.0990, 1.9777, 1.8770, 1.9463,
        1.8779, 2.1933, 2.6696, 2.0293, 2.0916, 1.9809, 2.1055, 1.9082, 1.8170,
        1.8411, 1.8765, 1.5542, 1.8161, 2.0799, 1.4922, 1.6955, 1.9647, 1.9842,
        1.6842, 1.6566, 1.6781, 1.4923, 1.7476, 1.8745, 1.6914, 2.0283, 2.1646,
        1.6991, 1.7389, 1.7035, 1.6268, 1.5729, 1.4238, 1.6733, 2.2188, 1.7376,
        1.6820, 1.6280, 1.6177, 1.6457, 1.5949, 1.3115, 1.5914, 1.4312, 1.3834,
        1.5822, 1.2535, 1.3870, 1.4138, 1.6556, 1.2302, 1.2779, 1.4584, 1.2537,
        1.3383, 1.0239, 1.0809, 1.2239, 1.2315, 1.1294, 1.2528, 1.2742, 1.0819,
        0.9638, 1.0102, 0.9954, 1.2043, 1.1101, 0.8830, 1.0116, 0.9634, 0.8821,
        0.9515, 0.8751, 0.9070, 0.9199, 0.8709, 0.9154, 0.8172, 0.8116, 0.7664,
        0.8006, 0.8373, 0.7505, 0.6976, 0.8143, 0.7917, 0.7327, 0.8006, 0.7527,
        0.7770], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.01282051282051282, tail0.0
3shot of client 1:head:0.0024691358024691358, middle:0.0, tail0.0
3shot of client 2:head:0.011396011396011397, middle:0.0, tail0.0
3shot of client 3:head:0.012903225806451613, middle:0.0, tail0.0
3shot of client 4:head:0.005952380952380952, middle:0.0, tail0.0
3shot of client 5:head:0.0058309037900874635, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.0043859649122807015, middle:0.008403361344537815, tail0.0
3shot of client 8:head:0.0, middle:0.011627906976744186, tail0.0
3shot of client 9:head:0.008356545961002786, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0055248618784530384, middle:0.0, tail0.0
3shot of client 13:head:0.0034965034965034965, middle:0.0, tail0.0
3shot of client 14:head:0.005050505050505051, middle:0.00980392156862745, tail0.0
3shot of client 15:head:0.004901960784313725, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.011976047904191617, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 7, local average test acc  0.0035 

round 7, local macro average F1 score  0.0024 

round 7, local weighted average F1 score  0.0042 

round 7, global test acc  0.3328 

round 7, average 3shot acc: [head: 0.0041, middle: 0.0021, tail: 0.0000] 

round 7, global 3shot acc: [head: 0.7200, middle: 0.4264, tail: 0.0662] 

l_head tensor([2.2709, 3.1287, 1.7760, 4.5384, 4.1376, 2.6112, 2.6757, 2.1909, 1.8280,
        2.3031, 2.6852, 2.2926, 3.1929, 3.6034, 3.2514, 2.0739, 1.6289, 2.2823,
        2.9298, 2.8392, 1.3778, 3.1263, 1.7091, 0.5809, 2.4537, 2.1756, 3.0429,
        3.6444, 2.6504, 2.0376, 2.3687, 0.5787, 2.7773, 2.6179, 0.5745, 3.6786,
        2.7234, 3.0384, 2.8533, 0.5895, 0.5737, 1.2574, 2.6262, 3.3739, 0.6174,
        2.2425, 3.4312, 1.9923, 2.2847, 3.0067, 3.7551, 0.5796, 0.5653, 2.5304,
        1.7477, 4.0338, 1.4724, 2.3442, 3.0826, 2.3799, 0.5628, 0.5794, 0.5791,
        0.5744, 2.4569, 0.5825, 2.1973, 0.5789, 3.1742, 0.5746, 0.5908, 1.8906,
        2.1376, 0.5769, 0.5737, 0.5887, 2.4274, 2.1097, 0.5627, 0.5872, 0.5776,
        3.3057, 2.6120, 1.7305, 0.5807, 0.5788, 2.0598, 0.6438, 2.1962, 0.5891,
        0.5722, 2.0432, 1.9398, 0.5840, 0.5777, 2.1689, 0.5753, 0.5656, 2.1716,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.9840, 2.3323, 2.6559, 2.5393, 2.3187, 2.1664, 2.0098, 1.9231, 1.9614,
        1.9211, 2.2131, 2.7182, 2.0545, 2.1450, 2.0106, 2.1848, 1.9277, 1.8752,
        1.8985, 1.9010, 1.6036, 1.8391, 2.0855, 1.5181, 1.7031, 1.9913, 1.9926,
        1.7470, 1.6680, 1.7101, 1.5258, 1.7871, 1.9367, 1.7642, 2.0682, 2.2505,
        1.7409, 1.7947, 1.7510, 1.6590, 1.6102, 1.4611, 1.6923, 2.2640, 1.7752,
        1.7542, 1.6257, 1.6753, 1.6770, 1.6512, 1.4039, 1.6874, 1.4914, 1.4334,
        1.6377, 1.2929, 1.4333, 1.4759, 1.7139, 1.2694, 1.3155, 1.5250, 1.3001,
        1.3879, 1.0752, 1.1425, 1.2829, 1.2747, 1.1611, 1.3054, 1.3069, 1.1235,
        1.0183, 1.0483, 1.0378, 1.2552, 1.1561, 0.9170, 1.0616, 0.9750, 0.9006,
        0.9901, 0.9172, 0.9580, 0.9649, 0.9140, 0.9690, 0.8396, 0.8469, 0.7880,
        0.8369, 0.8756, 0.7692, 0.7246, 0.8511, 0.8224, 0.7676, 0.8514, 0.7879,
        0.8027], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.003215434083601286, middle:0.01282051282051282, tail0.0
3shot of client 1:head:0.0049382716049382715, middle:0.0, tail0.0
3shot of client 2:head:0.011396011396011397, middle:0.0, tail0.0
3shot of client 3:head:0.01935483870967742, middle:0.0, tail0.0
3shot of client 4:head:0.002976190476190476, middle:0.0, tail0.045454545454545456
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.002652519893899204, middle:0.02197802197802198, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.008356545961002786, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.01048951048951049, middle:0.0, tail0.0
3shot of client 14:head:0.0025252525252525255, middle:0.0196078431372549, tail0.0
3shot of client 15:head:0.0024509803921568627, middle:0.009433962264150943, tail0.0
3shot of client 16:head:0.002793296089385475, middle:0.0, tail0.0
3shot of client 17:head:0.0029940119760479044, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 8, local average test acc  0.0035 

round 8, local macro average F1 score  0.0036 

round 8, local weighted average F1 score  0.0045 

round 8, global test acc  0.3353 

round 8, average 3shot acc: [head: 0.0037, middle: 0.0032, tail: 0.0023] 

round 8, global 3shot acc: [head: 0.7211, middle: 0.4336, tail: 0.0671] 

l_head tensor([2.2649, 3.1783, 1.7295, 4.6553, 4.1840, 2.6721, 2.7526, 2.2032, 1.8329,
        2.2899, 2.8544, 2.2721, 3.2486, 3.7034, 3.3322, 2.1619, 1.6842, 2.3507,
        2.9584, 2.9221, 1.3738, 3.1255, 1.7949, 0.5809, 2.4630, 2.2038, 3.0921,
        3.7433, 2.6632, 2.2311, 2.3891, 0.5787, 2.7425, 2.6707, 0.5745, 3.7680,
        2.7705, 3.0407, 2.8661, 0.5895, 0.5737, 1.2475, 2.7354, 3.4896, 0.6174,
        2.3457, 3.6258, 2.0951, 2.2845, 2.9771, 3.9226, 0.5796, 0.5653, 2.5056,
        1.8267, 4.0903, 1.5854, 2.3348, 3.2584, 2.3225, 0.5628, 0.5794, 0.5791,
        0.5744, 2.5244, 0.5825, 2.2614, 0.5789, 3.1842, 0.5746, 0.5908, 1.9434,
        2.1491, 0.5769, 0.5737, 0.5887, 2.6025, 2.2060, 0.5627, 0.5872, 0.5776,
        3.4330, 2.6665, 1.8977, 0.5807, 0.5788, 2.0077, 0.6438, 2.4393, 0.5891,
        0.5722, 2.1163, 2.0219, 0.5840, 0.5777, 2.3726, 0.5753, 0.5656, 2.1654,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.0153, 2.3657, 2.6749, 2.5806, 2.3487, 2.1652, 2.0257, 1.9089, 1.9869,
        1.9605, 2.2460, 2.7191, 2.0923, 2.1943, 2.0348, 2.1882, 1.9656, 1.9188,
        1.9012, 1.9332, 1.6604, 1.8644, 2.1119, 1.5259, 1.7229, 1.9969, 2.0571,
        1.7454, 1.7016, 1.7077, 1.5704, 1.8221, 1.9729, 1.7859, 2.1098, 2.3345,
        1.7859, 1.8103, 1.7760, 1.6705, 1.6405, 1.4899, 1.7579, 2.3124, 1.8311,
        1.8406, 1.6951, 1.7035, 1.6947, 1.7057, 1.4477, 1.7075, 1.5381, 1.4657,
        1.6979, 1.3396, 1.4526, 1.5366, 1.7890, 1.3100, 1.3416, 1.5833, 1.3246,
        1.4263, 1.1331, 1.1964, 1.3302, 1.3150, 1.2187, 1.3459, 1.3479, 1.1479,
        1.0436, 1.0892, 1.0887, 1.3134, 1.2134, 0.9547, 1.1056, 1.0045, 0.9564,
        1.0272, 0.9459, 0.9937, 1.0004, 0.9460, 0.9958, 0.8711, 0.8728, 0.8229,
        0.8777, 0.9054, 0.8097, 0.7478, 0.8889, 0.8448, 0.7826, 0.8788, 0.8118,
        0.8334], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.0024691358024691358, middle:0.0, tail0.0
3shot of client 2:head:0.011396011396011397, middle:0.0, tail0.0
3shot of client 3:head:0.012903225806451613, middle:0.0, tail0.0
  2%|▏         | 10/500 [34:49<27:21:01, 200.94s/it]  2%|▏         | 11/500 [38:21<27:45:11, 204.32s/it]3shot of client 4:head:0.002976190476190476, middle:0.0, tail0.0
3shot of client 5:head:0.0029154518950437317, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.01098901098901099, tail0.0
3shot of client 7:head:0.006578947368421052, middle:0.0, tail0.0
3shot of client 8:head:0.002840909090909091, middle:0.0, tail0.0
3shot of client 9:head:0.008356545961002786, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.01282051282051282, tail0.0
3shot of client 12:head:0.0055248618784530384, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.05555555555555555
3shot of client 14:head:0.0, middle:0.00980392156862745, tail0.0
3shot of client 15:head:0.0024509803921568627, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.0044444444444444444, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 9, local average test acc  0.0028 

round 9, local macro average F1 score  0.0021 

round 9, local weighted average F1 score  0.0029 

round 9, global test acc  0.3377 

round 9, average 3shot acc: [head: 0.0031, middle: 0.0017, tail: 0.0028] 

round 9, global 3shot acc: [head: 0.7211, middle: 0.4360, tail: 0.0708] 

l_head tensor([2.3006, 3.2634, 1.7866, 4.7166, 4.1476, 2.7368, 2.7944, 2.2738, 1.8421,
        2.3095, 2.8688, 2.3115, 3.3194, 3.8356, 3.4102, 2.1927, 1.6956, 2.4258,
        2.9859, 2.8801, 1.3749, 3.1769, 1.8198, 0.5809, 2.4450, 2.2195, 3.1465,
        3.7623, 2.6642, 2.1331, 2.4482, 0.5787, 2.8415, 2.6537, 0.5745, 3.8284,
        2.8939, 3.0971, 2.8826, 0.5895, 0.5737, 1.3597, 2.7751, 3.4134, 0.6174,
        2.4148, 3.7538, 2.1179, 2.2845, 2.9691, 3.9526, 0.5796, 0.5653, 2.5533,
        1.8375, 4.2897, 1.7045, 2.4812, 3.3916, 2.3161, 0.5628, 0.5794, 0.5791,
        0.5744, 2.5304, 0.5825, 2.3567, 0.5789, 3.2651, 0.5746, 0.5908, 1.9256,
        2.1334, 0.5769, 0.5737, 0.5887, 2.6334, 2.2181, 0.5627, 0.5872, 0.5776,
        3.5225, 2.7364, 1.9472, 0.5807, 0.5788, 2.0335, 0.6438, 2.5140, 0.5891,
        0.5722, 2.2123, 2.0409, 0.5840, 0.5777, 2.4048, 0.5753, 0.5656, 2.1653,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.0253, 2.4109, 2.7230, 2.6510, 2.4163, 2.2115, 2.0576, 2.0003, 2.0396,
        1.9924, 2.2751, 2.7199, 2.1380, 2.2321, 2.0308, 2.1816, 1.9833, 1.9337,
        1.9344, 1.9547, 1.6518, 1.9023, 2.1322, 1.5484, 1.7693, 2.0472, 2.0884,
        1.7758, 1.7100, 1.7383, 1.5977, 1.8482, 1.9677, 1.7886, 2.1218, 2.3763,
        1.7998, 1.8325, 1.7936, 1.6767, 1.6656, 1.5051, 1.7929, 2.3694, 1.8550,
        1.8809, 1.7425, 1.7633, 1.7400, 1.7249, 1.4547, 1.7625, 1.5758, 1.4947,
        1.7568, 1.3813, 1.4816, 1.6045, 1.8549, 1.3357, 1.3779, 1.6299, 1.3657,
        1.4845, 1.1367, 1.2325, 1.3826, 1.3496, 1.2693, 1.3672, 1.4028, 1.1863,
        1.0942, 1.1101, 1.1185, 1.3559, 1.2493, 0.9788, 1.1471, 1.0340, 0.9729,
        1.0710, 0.9702, 1.0366, 1.0187, 0.9753, 1.0341, 0.8995, 0.9131, 0.8430,
        0.9009, 0.9390, 0.8254, 0.7691, 0.9244, 0.8848, 0.8029, 0.9080, 0.8364,
        0.8655], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.006430868167202572, middle:0.0, tail0.0
3shot of client 1:head:0.0024691358024691358, middle:0.0, tail0.0
3shot of client 2:head:0.008547008547008548, middle:0.0, tail0.0
3shot of client 3:head:0.01935483870967742, middle:0.0, tail0.0
3shot of client 4:head:0.008928571428571428, middle:0.0, tail0.0
3shot of client 5:head:0.0058309037900874635, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.008771929824561403, middle:0.008403361344537815, tail0.0
3shot of client 8:head:0.002840909090909091, middle:0.011627906976744186, tail0.0
3shot of client 9:head:0.008356545961002786, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.003401360544217687, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.00980392156862745, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.002793296089385475, middle:0.0, tail0.0
3shot of client 17:head:0.0029940119760479044, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 10, local average test acc  0.0033 

round 10, local macro average F1 score  0.0030 

round 10, local weighted average F1 score  0.0045 

round 10, global test acc  0.3372 

round 10, average 3shot acc: [head: 0.0040, middle: 0.0015, tail: 0.0000] 

round 10, global 3shot acc: [head: 0.7167, middle: 0.4384, tail: 0.0710] 

l_head tensor([2.4006, 3.3225, 1.8292, 4.7178, 4.2265, 2.7557, 2.7592, 2.2611, 1.8461,
        2.3481, 2.8294, 2.4456, 3.3742, 3.8106, 3.4613, 2.1815, 1.7456, 2.4258,
        3.0126, 2.9000, 1.3814, 3.2006, 1.8918, 0.5809, 2.4859, 2.2408, 3.0966,
        3.8265, 2.7784, 2.1454, 2.4425, 0.5787, 2.8346, 2.6843, 0.5745, 3.9036,
        2.9585, 3.1907, 2.8832, 0.5895, 0.5737, 1.3424, 2.8261, 3.5354, 0.6174,
        2.4964, 3.8851, 2.1183, 2.2844, 3.0487, 4.0002, 0.5796, 0.5653, 2.6812,
        1.8967, 4.3709, 1.6697, 2.4163, 3.4837, 2.3314, 0.5628, 0.5794, 0.5791,
        0.5744, 2.6544, 0.5825, 2.4210, 0.5789, 3.2824, 0.5746, 0.5908, 2.1060,
        2.1968, 0.5769, 0.5737, 0.5887, 2.6969, 2.3851, 0.5627, 0.5872, 0.5776,
        3.5956, 2.8049, 2.0067, 0.5807, 0.5788, 2.1147, 0.6438, 2.6258, 0.5891,
        0.5722, 2.2888, 2.1644, 0.5840, 0.5777, 2.4570, 0.5753, 0.5656, 2.2321,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.0626, 2.4235, 2.7402, 2.6584, 2.4417, 2.2471, 2.0532, 2.0130, 2.0446,
        2.0192, 2.3094, 2.7618, 2.1552, 2.2608, 2.0892, 2.2112, 2.0149, 1.9385,
        1.9437, 1.9761, 1.6900, 1.9569, 2.1975, 1.5769, 1.8112, 2.0697, 2.0901,
        1.8114, 1.7184, 1.7453, 1.6558, 1.8799, 2.0083, 1.7959, 2.1227, 2.4433,
        1.8105, 1.8257, 1.8182, 1.7076, 1.6980, 1.5319, 1.8315, 2.3866, 1.8908,
        1.9271, 1.7867, 1.8048, 1.7703, 1.7623, 1.4971, 1.7915, 1.6322, 1.5451,
        1.7874, 1.4180, 1.5148, 1.6076, 1.8743, 1.3665, 1.4206, 1.6717, 1.4281,
        1.5317, 1.1783, 1.2763, 1.4344, 1.4048, 1.3054, 1.4087, 1.4311, 1.2117,
        1.1089, 1.1120, 1.1643, 1.3964, 1.2855, 1.0215, 1.2024, 1.0547, 1.0056,
        1.1178, 0.9923, 1.0517, 1.0431, 1.0161, 1.0585, 0.9331, 0.9386, 0.8648,
        0.9295, 0.9870, 0.8497, 0.7928, 0.9620, 0.8892, 0.8224, 0.9318, 0.8598,
        0.8957], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.0024691358024691358, middle:0.0, tail0.0
3shot of client 2:head:0.011396011396011397, middle:0.0, tail0.0
3shot of client 3:head:0.012903225806451613, middle:0.0, tail0.0
3shot of client 4:head:0.008928571428571428, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.002652519893899204, middle:0.0, tail0.0
3shot of client 7:head:0.0043859649122807015, middle:0.0, tail0.0
3shot of client 8:head:0.002840909090909091, middle:0.0, tail0.0
3shot of client 9:head:0.008356545961002786, middle:0.011627906976744186, tail0.0
3shot of client 10:head:0.0029850746268656717, middle:0.0, tail0.0
3shot of client 11:head:0.006802721088435374, middle:0.0, tail0.0
3shot of client 12:head:0.0055248618784530384, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.00980392156862745, tail0.0
3shot of client 15:head:0.0024509803921568627, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.0029940119760479044, middle:0.0, tail0.047619047619047616
3shot of client 18:head:0.0044444444444444444, middle:0.01639344262295082, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 11, local average test acc  0.0035 

round 11, local macro average F1 score  0.0034 

round 11, local weighted average F1 score  0.0042 

round 11, global test acc  0.3390 

  2%|▏         | 12/500 [42:03<28:24:13, 209.54s/it]  3%|▎         | 13/500 [46:02<29:34:22, 218.61s/it]round 11, average 3shot acc: [head: 0.0040, middle: 0.0019, tail: 0.0024] 

round 11, global 3shot acc: [head: 0.7174, middle: 0.4364, tail: 0.0754] 

l_head tensor([2.4135, 3.3769, 1.8318, 4.8473, 4.1939, 2.8039, 2.8369, 2.3050, 1.8596,
        2.3057, 2.9231, 2.5225, 3.3605, 3.9933, 3.4238, 2.2240, 1.7616, 2.5420,
        2.9472, 2.9829, 1.4432, 3.1351, 1.9295, 0.5809, 2.5347, 2.3261, 3.1377,
        3.8594, 2.7837, 2.2200, 2.5480, 0.5787, 2.7804, 2.6733, 0.5745, 4.0029,
        2.9777, 3.2445, 2.9325, 0.5895, 0.5737, 1.3309, 2.8344, 3.5223, 0.6174,
        2.5864, 3.9858, 2.1043, 2.3463, 3.0374, 4.0627, 0.5796, 0.5653, 2.7532,
        1.9012, 4.4214, 1.7411, 2.4343, 3.4981, 2.3958, 0.5628, 0.5794, 0.5791,
        0.5744, 2.7638, 0.5825, 2.4782, 0.5789, 3.4202, 0.5746, 0.5908, 2.1038,
        2.2539, 0.5769, 0.5737, 0.5887, 2.7630, 2.4133, 0.5627, 0.5872, 0.5776,
        3.6678, 2.8300, 2.1685, 0.5807, 0.5788, 2.1850, 0.6438, 2.6473, 0.5891,
        0.5722, 2.3059, 2.2107, 0.5840, 0.5777, 2.6571, 0.5753, 0.5656, 2.2599,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.1046, 2.4486, 2.7699, 2.6994, 2.4705, 2.2746, 2.0909, 2.0049, 2.0839,
        2.0495, 2.3357, 2.7808, 2.1490, 2.2671, 2.0854, 2.2733, 2.0645, 1.9506,
        1.9479, 1.9837, 1.7134, 1.9570, 2.2460, 1.6116, 1.8529, 2.1173, 2.1235,
        1.8148, 1.7456, 1.7766, 1.6707, 1.8742, 2.0492, 1.7936, 2.1504, 2.4703,
        1.8610, 1.8786, 1.8338, 1.7372, 1.7409, 1.5609, 1.8706, 2.4080, 1.9232,
        1.9513, 1.8143, 1.8416, 1.7948, 1.7887, 1.5247, 1.8264, 1.6590, 1.5974,
        1.8323, 1.4381, 1.5345, 1.6539, 1.9214, 1.4029, 1.4534, 1.6995, 1.4736,
        1.5824, 1.2211, 1.3131, 1.4671, 1.4354, 1.3545, 1.4480, 1.4543, 1.2449,
        1.1270, 1.1506, 1.1898, 1.4370, 1.3269, 1.0508, 1.2310, 1.0744, 1.0301,
        1.1576, 1.0149, 1.1154, 1.0852, 1.0444, 1.0926, 0.9658, 0.9583, 0.8983,
        0.9591, 1.0177, 0.8761, 0.8162, 1.0052, 0.9065, 0.8407, 0.9625, 0.8944,
        0.9241], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.0
3shot of client 2:head:0.011396011396011397, middle:0.0, tail0.0
3shot of client 3:head:0.012903225806451613, middle:0.0, tail0.0
3shot of client 4:head:0.008928571428571428, middle:0.012048192771084338, tail0.0
3shot of client 5:head:0.0058309037900874635, middle:0.0, tail0.0
3shot of client 6:head:0.002652519893899204, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.005681818181818182, middle:0.0, tail0.0
3shot of client 9:head:0.008356545961002786, middle:0.0, tail0.0
3shot of client 10:head:0.0029850746268656717, middle:0.0, tail0.0
3shot of client 11:head:0.003401360544217687, middle:0.0, tail0.0
3shot of client 12:head:0.0027624309392265192, middle:0.0, tail0.0
3shot of client 13:head:0.0034965034965034965, middle:0.014285714285714285, tail0.0
3shot of client 14:head:0.0, middle:0.00980392156862745, tail0.0
3shot of client 15:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 16:head:0.002793296089385475, middle:0.0, tail0.0
3shot of client 17:head:0.005988023952095809, middle:0.0125, tail0.0
3shot of client 18:head:0.0044444444444444444, middle:0.0, tail0.0
3shot of client 19:head:0.006389776357827476, middle:0.0, tail0.0
round 12, local average test acc  0.0041 

round 12, local macro average F1 score  0.0031 

round 12, local weighted average F1 score  0.0054 

round 12, global test acc  0.3409 

round 12, average 3shot acc: [head: 0.0048, middle: 0.0024, tail: 0.0000] 

round 12, global 3shot acc: [head: 0.7141, middle: 0.4416, tail: 0.0785] 

l_head tensor([2.3854, 3.4560, 1.8598, 4.9362, 4.2630, 2.8420, 2.8284, 2.3472, 1.9629,
        2.4590, 2.8332, 2.5172, 3.3346, 3.9707, 3.4226, 2.2915, 1.8527, 2.5991,
        3.0410, 3.0076, 1.4494, 3.1515, 1.9323, 0.5809, 2.5085, 2.3423, 3.2151,
        3.9047, 2.8440, 2.2362, 2.6054, 0.5787, 2.8432, 2.6759, 0.5745, 4.0335,
        2.9267, 3.1691, 2.9367, 0.5895, 0.5737, 1.4241, 2.9330, 3.5943, 0.6174,
        2.6414, 4.0364, 2.2246, 2.2824, 3.0938, 4.2124, 0.5796, 0.5653, 2.8440,
        1.8673, 4.4653, 1.7410, 2.4694, 3.5470, 2.3791, 0.5628, 0.5794, 0.5791,
        0.5744, 2.7649, 0.5825, 2.5575, 0.5789, 3.5214, 0.5746, 0.5908, 2.2538,
        2.2718, 0.5769, 0.5737, 0.5887, 2.8293, 2.4155, 0.5627, 0.5872, 0.5776,
        3.8058, 2.8760, 2.1353, 0.5807, 0.5788, 2.1684, 0.6438, 2.6182, 0.5891,
        0.5722, 2.2990, 2.2731, 0.5840, 0.5777, 2.5533, 0.5753, 0.5656, 2.2943,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.1274, 2.4745, 2.8323, 2.7178, 2.5026, 2.2990, 2.1131, 2.0396, 2.0955,
        2.0674, 2.3607, 2.8085, 2.1780, 2.3151, 2.1243, 2.2797, 2.0495, 1.9920,
        1.9595, 2.0331, 1.7303, 1.9824, 2.2554, 1.6232, 1.8960, 2.1288, 2.1325,
        1.8323, 1.7802, 1.7878, 1.6877, 1.8983, 2.0467, 1.8059, 2.1788, 2.4830,
        1.8564, 1.9010, 1.8554, 1.7641, 1.7711, 1.5851, 1.8895, 2.4581, 1.9532,
        1.9762, 1.8840, 1.8889, 1.7972, 1.8047, 1.5676, 1.8596, 1.6887, 1.6218,
        1.8727, 1.4581, 1.5466, 1.6889, 1.9649, 1.4429, 1.4580, 1.7285, 1.5095,
        1.6051, 1.2459, 1.3228, 1.5173, 1.4783, 1.3784, 1.4687, 1.4943, 1.2842,
        1.1597, 1.1777, 1.2166, 1.4807, 1.3678, 1.0872, 1.2750, 1.0906, 1.0687,
        1.1870, 1.0574, 1.1397, 1.1193, 1.0671, 1.1498, 0.9852, 0.9857, 0.9325,
        0.9747, 1.0334, 0.9118, 0.8331, 1.0537, 0.9343, 0.8606, 0.9886, 0.9243,
        0.9525], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.0024691358024691358, middle:0.0, tail0.0
3shot of client 2:head:0.008547008547008548, middle:0.0, tail0.0
3shot of client 3:head:0.012903225806451613, middle:0.0, tail0.0
3shot of client 4:head:0.005952380952380952, middle:0.0, tail0.0
3shot of client 5:head:0.008746355685131196, middle:0.0, tail0.0
3shot of client 6:head:0.002652519893899204, middle:0.0, tail0.0
3shot of client 7:head:0.006578947368421052, middle:0.0, tail0.0
3shot of client 8:head:0.005681818181818182, middle:0.0, tail0.0
3shot of client 9:head:0.008356545961002786, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0027624309392265192, middle:0.0, tail0.0
3shot of client 13:head:0.0034965034965034965, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0196078431372549, tail0.0
3shot of client 15:head:0.0024509803921568627, middle:0.0, tail0.038461538461538464
3shot of client 16:head:0.0, middle:0.011904761904761904, tail0.0
3shot of client 17:head:0.0029940119760479044, middle:0.0, tail0.0
3shot of client 18:head:0.008888888888888889, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 13, local average test acc  0.0035 

round 13, local macro average F1 score  0.0028 

round 13, local weighted average F1 score  0.0041 

round 13, global test acc  0.3412 

round 13, average 3shot acc: [head: 0.0041, middle: 0.0016, tail: 0.0019] 

round 13, global 3shot acc: [head: 0.7159, middle: 0.4420, tail: 0.0779] 

l_head tensor([2.3674, 3.4786, 1.7919, 5.0153, 4.2145, 2.7853, 2.8502, 2.3794, 1.9623,
        2.4100, 2.9206, 2.5704, 3.3595, 3.9710, 3.4347, 2.3286, 1.8529, 2.6299,
        3.0678, 3.0355, 1.4362, 3.2166, 1.9289, 0.5809, 2.5464, 2.3474, 3.1739,
        3.9076, 2.9038, 2.3063, 2.5642, 0.5787, 2.8324, 2.7164, 0.5745, 4.1288,
        3.0254, 3.1991, 2.9960, 0.5895, 0.5737, 1.3664, 2.9777, 3.6613, 0.6174,
        2.7655, 4.0914, 2.2194, 2.3577, 3.0879, 4.2076, 0.5796, 0.5653, 2.8282,
        1.9761, 4.5249, 1.7365, 2.4919, 3.6670, 2.4025, 0.5628, 0.5794, 0.5791,
        0.5744, 2.7607, 0.5825, 2.5843, 0.5789, 3.5151, 0.5746, 0.5908, 2.2811,
        2.3939, 0.5769, 0.5737, 0.5887, 2.7887, 2.4634, 0.5627, 0.5872, 0.5776,
        3.8352, 2.9072, 2.1994, 0.5807, 0.5788, 2.1721, 0.6438, 2.6407, 0.5891,
        0.5722, 2.2988, 2.3220, 0.5840, 0.5777, 2.6284, 0.5753, 0.5656, 2.3336,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux   3%|▎         | 14/500 [50:07<30:34:12, 226.45s/it]  3%|▎         | 15/500 [53:59<30:45:24, 228.30s/it]  3%|▎         | 16/500 [57:35<30:09:46, 224.35s/it]tensor([2.1277, 2.5162, 2.8280, 2.7085, 2.5497, 2.3241, 2.0995, 2.0745, 2.0952,
        2.0771, 2.3960, 2.8301, 2.1920, 2.3483, 2.1322, 2.2850, 2.0845, 2.0039,
        1.9837, 2.0766, 1.7692, 2.0136, 2.3094, 1.6558, 1.9348, 2.1727, 2.1591,
        1.8681, 1.7868, 1.7904, 1.7094, 1.9173, 2.0938, 1.8153, 2.1948, 2.5348,
        1.8594, 1.9189, 1.8655, 1.7797, 1.7815, 1.6047, 1.9087, 2.4814, 1.9627,
        1.9994, 1.8914, 1.9111, 1.8158, 1.8198, 1.5728, 1.9002, 1.7015, 1.6371,
        1.9067, 1.4772, 1.5657, 1.7162, 1.9966, 1.4765, 1.4797, 1.7442, 1.5234,
        1.6397, 1.2552, 1.3607, 1.5319, 1.5126, 1.4161, 1.4991, 1.5365, 1.3033,
        1.1817, 1.2052, 1.2155, 1.5179, 1.3924, 1.1282, 1.3037, 1.1196, 1.0855,
        1.2113, 1.0748, 1.1783, 1.1423, 1.1032, 1.1891, 1.0117, 1.0102, 0.9467,
        1.0006, 1.0645, 0.9345, 0.8550, 1.0684, 0.9511, 0.8825, 1.0287, 0.9536,
        0.9783], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.006430868167202572, middle:0.0, tail0.0
3shot of client 1:head:0.0024691358024691358, middle:0.0, tail0.0
3shot of client 2:head:0.008547008547008548, middle:0.010869565217391304, tail0.0
3shot of client 3:head:0.012903225806451613, middle:0.011904761904761904, tail0.0
3shot of client 4:head:0.005952380952380952, middle:0.0, tail0.0
3shot of client 5:head:0.011661807580174927, middle:0.0, tail0.0
3shot of client 6:head:0.002652519893899204, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.008403361344537815, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.011142061281337047, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.012048192771084338, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.006993006993006993, middle:0.0, tail0.0
3shot of client 14:head:0.005050505050505051, middle:0.00980392156862745, tail0.0
3shot of client 15:head:0.0024509803921568627, middle:0.0, tail0.0
3shot of client 16:head:0.002793296089385475, middle:0.0, tail0.0
3shot of client 17:head:0.005988023952095809, middle:0.0, tail0.0
3shot of client 18:head:0.008888888888888889, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 14, local average test acc  0.0041 

round 14, local macro average F1 score  0.0029 

round 14, local weighted average F1 score  0.0052 

round 14, global test acc  0.3422 

round 14, average 3shot acc: [head: 0.0047, middle: 0.0027, tail: 0.0000] 

round 14, global 3shot acc: [head: 0.7152, middle: 0.4432, tail: 0.0798] 

l_head tensor([2.3811, 3.4531, 1.8236, 5.1841, 4.2292, 2.7687, 2.9905, 2.4114, 1.9681,
        2.4113, 2.9487, 2.5892, 3.3653, 4.1122, 3.4783, 2.3001, 1.8219, 2.6146,
        3.0836, 3.1068, 1.4411, 3.2185, 1.9823, 0.5809, 2.5788, 2.3262, 3.1700,
        3.9545, 2.8933, 2.3063, 2.6794, 0.5787, 2.9166, 2.7275, 0.5745, 4.2493,
        2.9792, 3.3343, 2.9584, 0.5895, 0.5737, 1.4435, 2.9973, 3.7177, 0.6174,
        2.8543, 4.1337, 2.2151, 2.4175, 3.0951, 4.2781, 0.5796, 0.5653, 2.8163,
        1.9729, 4.5444, 1.7340, 2.5066, 3.6910, 2.4438, 0.5628, 0.5794, 0.5791,
        0.5744, 2.7835, 0.5825, 2.6375, 0.5789, 3.4875, 0.5746, 0.5908, 2.2791,
        2.3157, 0.5769, 0.5737, 0.5887, 2.8082, 2.4878, 0.5627, 0.5872, 0.5776,
        3.8428, 2.9765, 2.1785, 0.5807, 0.5788, 2.2604, 0.6438, 2.6771, 0.5891,
        0.5722, 2.3565, 2.3251, 0.5840, 0.5777, 2.6554, 0.5753, 0.5656, 2.3981,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.1462, 2.5156, 2.8169, 2.7187, 2.5431, 2.3058, 2.0996, 2.0632, 2.1119,
        2.0913, 2.4192, 2.8602, 2.2123, 2.3548, 2.1665, 2.3127, 2.0758, 2.0066,
        2.0093, 2.1012, 1.8051, 2.0615, 2.3263, 1.6591, 1.9447, 2.1614, 2.1768,
        1.8963, 1.8193, 1.8135, 1.7395, 1.9284, 2.0980, 1.8269, 2.2182, 2.5788,
        1.8766, 1.9388, 1.8622, 1.7974, 1.7938, 1.6231, 1.9270, 2.4978, 1.9915,
        2.0291, 1.9629, 1.9288, 1.8216, 1.8409, 1.5845, 1.9400, 1.7146, 1.6818,
        1.9354, 1.5315, 1.5855, 1.7477, 2.0387, 1.5196, 1.5145, 1.7701, 1.5423,
        1.6854, 1.3059, 1.3941, 1.5668, 1.5283, 1.4261, 1.5296, 1.5549, 1.3403,
        1.1886, 1.2381, 1.2436, 1.5433, 1.4135, 1.1585, 1.3124, 1.1628, 1.1103,
        1.2376, 1.1066, 1.1985, 1.1691, 1.1379, 1.2173, 1.0314, 1.0283, 0.9640,
        1.0287, 1.0899, 0.9754, 0.8605, 1.0983, 0.9690, 0.9076, 1.0522, 0.9818,
        0.9989], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.003215434083601286, middle:0.0, tail0.0
3shot of client 1:head:0.0024691358024691358, middle:0.0, tail0.0
3shot of client 2:head:0.014245014245014245, middle:0.0, tail0.0
3shot of client 3:head:0.016129032258064516, middle:0.011904761904761904, tail0.0
3shot of client 4:head:0.005952380952380952, middle:0.0, tail0.0
3shot of client 5:head:0.011661807580174927, middle:0.0, tail0.0
3shot of client 6:head:0.002652519893899204, middle:0.0, tail0.043478260869565216
3shot of client 7:head:0.0021929824561403508, middle:0.008403361344537815, tail0.0
3shot of client 8:head:0.005681818181818182, middle:0.0, tail0.0
3shot of client 9:head:0.008356545961002786, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.01282051282051282, tail0.0
3shot of client 12:head:0.0027624309392265192, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.007575757575757576, middle:0.00980392156862745, tail0.0
3shot of client 15:head:0.004901960784313725, middle:0.0, tail0.0
3shot of client 16:head:0.002793296089385475, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0125, tail0.0
3shot of client 18:head:0.0044444444444444444, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 15, local average test acc  0.0042 

round 15, local macro average F1 score  0.0041 

round 15, local weighted average F1 score  0.0052 

round 15, global test acc  0.3418 

round 15, average 3shot acc: [head: 0.0048, middle: 0.0028, tail: 0.0022] 

round 15, global 3shot acc: [head: 0.7144, middle: 0.4400, tail: 0.0810] 

l_head tensor([2.3867, 3.4577, 1.9483, 5.2087, 4.2883, 2.7631, 2.9131, 2.4106, 1.9674,
        2.4458, 2.9613, 2.7305, 3.3723, 4.0743, 3.5211, 2.2949, 1.8458, 2.6326,
        3.1551, 3.1710, 1.5297, 3.1728, 1.9915, 0.5809, 2.5779, 2.3986, 3.1595,
        3.9998, 2.8764, 2.2889, 2.6635, 0.5787, 2.8856, 2.7049, 0.5745, 4.2414,
        2.9864, 3.2759, 3.0304, 0.5895, 0.5737, 1.4433, 3.0177, 3.7285, 0.6174,
        2.9561, 4.1669, 2.2070, 2.4169, 3.0884, 4.3316, 0.5796, 0.5653, 2.8750,
        1.9530, 4.5243, 1.7907, 2.5287, 3.8013, 2.5164, 0.5628, 0.5794, 0.5791,
        0.5744, 2.7408, 0.5825, 2.7135, 0.5789, 3.6083, 0.5746, 0.5908, 2.3220,
        2.4226, 0.5769, 0.5737, 0.5887, 2.8256, 2.5956, 0.5627, 0.5872, 0.5776,
        3.9268, 3.0033, 2.2162, 0.5807, 0.5788, 2.2602, 0.6438, 2.6895, 0.5891,
        0.5722, 2.3569, 2.3295, 0.5840, 0.5777, 2.6537, 0.5753, 0.5656, 2.4839,
        0.5717], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.1708, 2.5222, 2.8700, 2.7257, 2.5752, 2.3035, 2.0907, 2.0962, 2.1569,
        2.0883, 2.4496, 2.8802, 2.2044, 2.3900, 2.1826, 2.3112, 2.1065, 2.0010,
        2.0206, 2.1086, 1.8310, 2.0719, 2.3210, 1.6767, 1.9565, 2.1579, 2.1856,
        1.8993, 1.8048, 1.8042, 1.7506, 1.9507, 2.1152, 1.8361, 2.2627, 2.5942,
        1.8947, 1.9557, 1.9068, 1.8009, 1.8078, 1.6269, 1.9413, 2.5017, 2.0253,
        2.0122, 1.9648, 1.9589, 1.8412, 1.8427, 1.6248, 1.9660, 1.7281, 1.6928,
        1.9448, 1.5416, 1.6022, 1.7673, 2.0736, 1.5498, 1.5553, 1.8027, 1.5772,
        1.7159, 1.3348, 1.4325, 1.5892, 1.5591, 1.4665, 1.5535, 1.5762, 1.3483,
        1.1971, 1.2841, 1.2632, 1.5820, 1.4445, 1.1818, 1.3432, 1.2012, 1.1243,
        1.2750, 1.1252, 1.2374, 1.2030, 1.1650, 1.2386, 1.0541, 1.0544, 0.9819,
        1.0444, 1.1207, 0.9992, 0.8821, 1.1218, 0.9780, 0.9239, 1.0804, 1.0109,
        1.0300], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.0
  3%|▎         | 17/500 [1:01:00<29:20:01, 218.64s/it]  4%|▎         | 18/500 [1:05:00<30:07:25, 224.99s/it]
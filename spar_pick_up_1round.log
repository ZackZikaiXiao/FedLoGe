nohup: ignoring input
./temp/fl_acc_cifar100_resnet34_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N20_100_seed3407_p1_dirichlet0.5_IF0.01_LossCE.txt
Files already downloaded and verified
[500, 477, 455, 434, 415, 396, 378, 361, 344, 328, 314, 299, 286, 273, 260, 248, 237, 226, 216, 206, 197, 188, 179, 171, 163, 156, 149, 142, 135, 129, 123, 118, 112, 107, 102, 98, 93, 89, 85, 81, 77, 74, 70, 67, 64, 61, 58, 56, 53, 51, 48, 46, 44, 42, 40, 38, 36, 35, 33, 32, 30, 29, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 15, 14, 13, 13, 12, 12, 11, 11, 10, 10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5]
10847
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[573, 766, 469, 733, 726, 766, 466, 320, 676, 410, 554, 546, 535, 512, 586, 396, 460, 448, 431, 474]
training set distribution:
[[  8   5  18   0  32  55  32   1  64   2   4  41   7   3  47  19   2   3
    0   6   0   3   5  14   6   4   9  50   0  11   3   0   2   0  38  12
   11   1  19   0   1   0   0   0   1  10   0   0   3   0   0   0   0   0
    1   0   2   2   0   0   1   0   2   0   2   4   0   0   0   0   0   0
    0   0   1   0   0   1   0   0   0   0   2   0   0   0   1   0   0   0
    0   0   0   0   0   1   1   0   0   0]
 [ 99   7  26  25  22   2  54  80   2  28  22  33   7  19 105   0   1   3
    4  13   2  26   9   3   0   4   4   4  37   0  18   1   2   6   5  16
    4   0  15  13   1   0   0   0   3   2   0   0   0   0   2   2   3   9
    1   0   2   0   2   1   0   0   3   0   0   0   0   0   0   7   0   0
    0   0   0   0   0   0   0   0   0   0   0   1   0   2   1   0   0   0
    0   2   0   1   0   0   0   0   0   0]
 [ 14  60   9  13   3  40   0   8   0   6  24  11  75  13  14   6  11   2
    2   7   0   0   0   0   0  10   0   4   0   3   7  10  11   3   5   0
    8   6   1   0   1   8   1   1   5   0   5   2   4   8   0   1   3   0
    2   1   1   1   3   3   2   2   0   0   0   0   0   0   0   0   2   0
    0   1   4   0   6   1   0   0   4   0   3   0   3   0   1   0   1   2
    0   0   0   0   0   0   0   1   0   0]
 [ 23  89  56   2  47   1   7   8  48  33   0  49   1  29   5  32   2  17
   76   5  13  10   0  12   0   0   2   0   9  19  16   2   0  18   2   0
    6   0   0   2   2   1  26   5  10   2   0   1   0   0   4   1   0   1
    1   0   0   0   0   1   3   0   0   8   3   2   0   1   3   0   1   0
    0   4   0   0   0   0   0   0   0   0   0   1   0   1   0   1   3   0
    3   0   1   0   2   0   0   0   0   0]
 [  9  95  66   3  48   7  41  15  36  24  65   1   2   1   0   2   4   8
    0   6  29   0   2  53   7   2  24  19  10  14   0   3   0  25   2   5
    0  30   3   0   4   0   4   7   7   4   0   0   8   4   3   1   0   0
    2   0   0   4   0   0   0   0   1   0   4   0   0   0   0   0   1   3
    1   0   0   1   0   0   2   1   0   0   1   0   0   0   1   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 22  45  14  67   2   2  54  10  18  22  47  12  10  71  16   1  52   4
    7   1  31  36  16   8  25  30   7   0   8   0   3   0   6   6   6  27
    0   0   0   0   4   0   0   0   2   5   4   5   9   1   5   3   3   0
    1   0   6  14   1   1   0   0   1   0   1   3   0   0   0   0   0   4
    1   2   0   0   0   1   0   1   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [  5   0   1  11  50   1  31  30  22  10   1   1   8   4   2   0   2   6
   31   0  15  46   1   7   9   1  18   0   0  10   5   0   7   2  24   2
    6   2   5  18   4   3   3   0   0   0   2   4   3   8   0   3   1   1
    0   2   4   3   0   0   0   6   0   2   0   2   0   2   0   2   3   0
    0   0   0   0   0   2   1   3   0   0   0   0   0   0   1   0   3   0
    0   0   0   2   0   0   1   0   0   1]
 [  0  19   5  26  11  14   5  14   2  11   1  12  20   2   7   6   0   0
    3   0  21   0   3   0   1   1  14   0   2  12   1   9   3   0   4   6
    1   1   5   0   2  10   1   4   1   2   6   0   2   2   1   4   3   1
    0  16   3   0   0   0   1   0   1   1   0   1   0   3   2   0   1   0
    0   1   1   2   0   1   1   2   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [ 44  21  72  58  46  20   1   1  52   0  37  46  14   5  10  11  17   8
    1   1   1   1   8  16  15  40   0   0   0  12   1  10   1   0   0   3
    9   0   5   3   6   5   6   2   7   0   0   5   0   0   2   1   0   0
    7  11   3   0   1   1   2   0   0   0   3   0   4   0   0   1   5   0
    1   0   0   0   0   0   1   0   2   1   0   0   0   0   2   2   0   1
    0   1   0   0   0   0   1   0   0   2]
 [  0  16   3   2  33  70   1  22   1   5  45   9   5   6   3   7   0  14
    7   5   8   5   2   0   1   4   2   5   0   0   1  12   1   7   0   2
    1   2  15  18   0   2   0   0   7  10   3   0   1   2   2   0   5   0
    1   0   7   0   2   0   0   1   0   0   0   0   1   0   0   0   3   1
    0   3   0   3   1   0   0   0   0   0   3   0   2   2   0   2   0   1
    0   1   0   1   0   1   0   0   0   2]
 [  0   0   0  28  16   3  89  14  43   6   9   7   0  12   0   2  62   0
    8  74   2   2   0  26   2   1   8   2   6   0   1   0   2   2   1   2
    5   1   1   0   8   2   0   1   4   7   0  18   0   2   1   0   0  13
    4   0   4   1   0   3   3   0   0   3   3   0   8   0   2   1   0   0
    9   1   2   3   0   1   4   0   1   0   0   1   0   2   0   0   0   0
    0   0   1   0   1   1   0   0   2   0]
 [ 90   0  30  51   5   0   4   3   1   5   1   1   8  11  23  84   0  23
    4   6   0   2   9   0   0   3   0   7   7  17   5   2  21   5   0   3
    0   2   0   2   0   0   0  10   0   1  13   3   0   7   1   2   3   1
    5   0   0   0   6   3   1   1   3   0   5  11   0  12   0   1   0   4
    1   0   4   0   0   0   0   0   1   0   0   3   0   0   0   1   0   1
    2   0   0   0   0   1   1   1   2   0]
 [  9  41   0  22   1  13   6   1   0  53  13   6  47  19   4   2   2  13
   10  15   3   0   0   0  67   8   7   2  37   0  35   0   0  11   0   4
    4   1   2   0   0   8   3   4   2   0   0   0   3   0   5   3   2   8
    5   1   0   5   1   0   1   0   3   0   2   0   0   0   7   0   0   2
    0   0   0   1   3   0   1   0   2   0   1   0   1   0   0   0   0   0
    0   1   0   0   1   0   1   0   0   0]
 [ 14  17   3  80   2  97  18   3   0  17   3   1  13  20   0   1   3   6
    0   0   1  24  40   6   2   1   2   8   0   7   5   1   0   2   1   0
    1   0   5   1  12   4   0  19   6   4   1   5   0   8   0   6   6   0
    2   3   0   0   1   5   0   1   1   6   0   0   0   0   0   1   1   2
    0   0   0   1   3   0   0   2   0   3   0   2   1   0   0   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 30  43   0  19   2   1  17 114   1  68   2   0   6   2   4   9   7  28
    0  11   2   0   7   2  11  12   5  14   9  12   3   2  10   7   0   2
    8   2   0   6  14   4   1   0   0   0  13   1   4   0   8   5   4   0
    6   0   0   4   0   0   2   7   7   2   0   1   2   0   2   3   0   2
    1   0   0   1   0   1   0   2   1   1   0   0   2   2   2   0   0   1
    0   0   0   0   0   1   0   0   1   0]
 [  3   5  43   6  25   7   1  18   0   8   2   2   7   0   0   1   0   0
   37  11   7   0   6   1   3   0  19   0   0   8   0  35  25   0   1  10
    4   0   1  11   6   0   0   4   4   8   5   0  11   9   2   3   0   2
    0   1   1   0   2   2   8   0   4   1   0   0   0   3   1   1   1   0
    0   2   1   2   0   1   0   0   0   3   0   0   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   0   0]
 [ 19   2  21  13   2   0   8  10   1   3  15  15   4  12  17  10  27  40
    1   2   6   1  62  18   2  11  21   7   6   1   0   1   1   1   2   4
   24  15   1   0   2   0   4   1   0   0   2  10   0   0   1   3   4   5
    0   3   0   0   0   0   0   3   0   0   1   0   2   0   0   0   0   0
    0   0   1   0   1   2   3   1   0   0   0   1   1   0   0   0   0   0
    0   1   0   0   2   0   0   0   0   0]
 [  7   5   3   5  21  54   9   0  10   9  20  45  36  35   3  12  23   8
    1   7   0  24   0   4   6  20   6  10   1   0   0   2   0   0   5   0
    0  22   0   6   1   0   0   1   0   0   4   0   3   0   1   0   1   0
    0   0   0   1   0   0   0   6   0   0   1   0   0   0   0   0   0   0
    1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   1
    1   1   1   1   0   0   0   1   0   0]
 [ 87   7  18   0  21   1   0   8   3   2   0   1   6   7   0  10   3  41
    4  35   2   7   7   0   1   2   0  10   3   1  17   2  20   0   0   0
    1   3   0   0   5  20  20   1   5   2   0   2   0   0   9   3   1   1
    2   0   1   0   1  11   1   1   0   3   0   0   3   1   0   3   1   0
    0   1   1   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   1   0   0   0   0]
 [ 17   0  67   3  26   8   0   1  40  16   3   6  10   2   0  33  19   2
   20   1  54   1   2   1   5   2   1   0   0   2   2  26   0  12   6   0
    0   1   7   1   4   7   1   7   0   4   0   0   2   0   1   5   5   0
    0   0   2   0  13   1   5   1   1   0   0   0   3   0   4   0   0   0
    2   0   0   1   0   1   0   0   0   3   0   1   0   0   0   1   0   0
    0   0   1   1   0   0   0   0   0   0]]
Total size of training set
10847
local test distribution:
[[  7   4  16   0  29  50  29   0  59   1   3  37   6   2  43  17   1   2
    0   5   0   2   4  12   5   3   8  46   0  10   2   0   1   0  35  11
   10   0  17   0   0   0   0   0   0   9   0   0   2   0   0   0   0   0
    0   0   1   1   0   0   0   0   1   0   1   3   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 91   6  23  23  20   1  49  73   1  25  20  30   6  17  96   0   0   2
    3  11   1  23   8   2   0   3   3   3  34   0  16   0   1   5   4  14
    3   0  13  11   0   0   0   0   2   1   0   0   0   0   1   1   2   8
    0   0   1   0   1   0   0   0   2   0   0   0   0   0   0   6   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0
    0   1   0   0   0   0   0   0   0   0]
 [ 12  55   8  11   2  36   0   7   0   5  22  10  69  11  12   5  10   1
    1   6   0   0   0   0   0   9   0   3   0   2   6   9  10   2   4   0
    7   5   0   0   0   7   0   0   4   0   4   1   3   7   0   0   2   0
    1   0   0   0   2   2   1   1   0   0   0   0   0   0   0   0   1   0
    0   0   3   0   5   0   0   0   3   0   2   0   2   0   0   0   0   1
    0   0   0   0   0   0   0   0   0   0]
 [ 21  82  51   1  43   0   6   7  44  30   0  45   0  26   4  29   1  15
   70   4  11   9   0  11   0   0   1   0   8  17  14   1   0  16   1   0
    5   0   0   1   1   0  23   4   9   1   0   0   0   0   3   0   0   0
    0   0   0   0   0   0   2   0   0   7   2   1   0   0   2   0   0   0
    0   3   0   0   0   0   0   0   0   0   0   0   0   0   0   0   2   0
    2   0   0   0   1   0   0   0   0   0]
 [  8  87  60   2  44   6  37  13  33  22  59   0   1   0   0   1   3   7
    0   5  26   0   1  48   6   1  22  17   9  12   0   2   0  23   1   4
    0  27   2   0   3   0   3   6   6   3   0   0   7   3   2   0   0   0
    1   0   0   3   0   0   0   0   0   0   3   0   0   0   0   0   0   2
    0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 20  41  12  61   1   1  49   9  16  20  43  11   9  65  14   0  47   3
    6   0  28  33  14   7  23  27   6   0   7   0   2   0   5   5   5  24
    0   0   0   0   3   0   0   0   1   4   3   4   8   0   4   2   2   0
    0   0   5  12   0   0   0   0   0   0   0   2   0   0   0   0   0   3
    0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  4   0   0  10  46   0  28  27  20   9   0   0   7   3   1   0   1   5
   28   0  13  42   0   6   8   0  16   0   0   9   4   0   6   1  22   1
    5   1   4  16   3   2   2   0   0   0   1   3   2   7   0   2   0   0
    0   1   3   2   0   0   0   5   0   1   0   1   0   1   0   1   2   0
    0   0   0   0   0   1   0   2   0   0   0   0   0   0   0   0   2   0
    0   0   0   1   0   0   0   0   0   0]
 [  0  17   4  23  10  12   4  12   1  10   0  11  18   1   6   5   0   0
    2   0  19   0   2   0   0   0  12   0   1  11   0   8   2   0   3   5
    0   0   4   0   1   9   0   3   0   1   5   0   1   1   0   3   2   0
    0  14   2   0   0   0   0   0   0   0   0   0   0   2   1   0   0   0
    0   0   0   1   0   0   0   1   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 40  19  66  53  42  18   0   0  47   0  34  42  12   4   9  10  15   7
    0   0   0   0   7  14  13  36   0   0   0  11   0   9   0   0   0   2
    8   0   4   2   5   4   5   1   6   0   0   4   0   0   1   0   0   0
    6  10   2   0   0   0   1   0   0   0   2   0   3   0   0   0   4   0
    0   0   0   0   0   0   0   0   1   0   0   0   0   0   1   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0  14   2   1  30  64   0  20   0   4  41   8   4   5   2   6   0  12
    6   4   7   4   1   0   0   3   1   4   0   0   0  11   0   6   0   1
    0   1  13  16   0   1   0   0   6   9   2   0   0   1   1   0   4   0
    0   0   6   0   1   0   0   0   0   0   0   0   0   0   0   0   2   0
    0   2   0   2   0   0   0   0   0   0   2   0   1   1   0   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0   0   0  25  14   2  82  12  39   5   8   6   0  11   0   1  57   0
    7  68   1   1   0  23   1   0   7   1   5   0   0   0   1   1   0   1
    4   0   0   0   7   1   0   0   3   6   0  16   0   1   0   0   0  11
    3   0   3   0   0   2   2   0   0   2   2   0   7   0   1   0   0   0
    8   0   1   2   0   0   3   0   0   0   0   0   0   1   0   0   0   0
    0   0   0   0   0   0   0   0   1   0]
 [ 82   0  27  47   4   0   3   2   0   4   0   0   7  10  21  77   0  21
    3   5   0   1   8   0   0   2   0   6   6  15   4   1  19   4   0   2
    0   1   0   1   0   0   0   9   0   0  11   2   0   6   0   1   2   0
    4   0   0   0   5   2   0   0   2   0   4  10   0  11   0   0   0   3
    0   0   3   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   1   0]
 [  8  37   0  20   0  11   5   0   0  48  11   5  43  17   3   1   1  11
    9  13   2   0   0   0  61   7   6   1  34   0  32   0   0  10   0   3
    3   0   1   0   0   7   2   3   1   0   0   0   2   0   4   2   1   7
    4   0   0   4   0   0   0   0   2   0   1   0   0   0   6   0   0   1
    0   0   0   0   2   0   0   0   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 12  15   2  73   1  89  16   2   0  15   2   0  11  18   0   0   2   5
    0   0   0  22  36   5   1   0   1   7   0   6   4   0   0   1   0   0
    0   0   4   0  11   3   0  17   5   3   0   4   0   7   0   5   5   0
    1   2   0   0   0   4   0   0   0   5   0   0   0   0   0   0   0   1
    0   0   0   0   2   0   0   1   0   2   0   1   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 27  39   0  17   1   0  15 105   0  62   1   0   5   1   3   8   6  25
    0  10   1   0   6   1  10  11   4  12   8  11   2   1   9   6   0   1
    7   1   0   5  12   3   0   0   0   0  11   0   3   0   7   4   3   0
    5   0   0   3   0   0   1   6   6   1   0   0   1   0   1   2   0   1
    0   0   0   0   0   0   0   1   0   0   0   0   1   1   1   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  2   4  39   5  23   6   0  16   0   7   1   1   6   0   0   0   0   0
   34  10   6   0   5   0   2   0  17   0   0   7   0  32  23   0   0   9
    3   0   0  10   5   0   0   3   3   7   4   0  10   8   1   2   0   1
    0   0   0   0   1   1   7   0   3   0   0   0   0   2   0   0   0   0
    0   1   0   1   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 17   1  19  11   1   0   7   9   0   2  13  13   3  11  15   9  24  36
    0   1   5   0  57  16   1  10  19   6   5   0   0   0   0   0   1   3
   22  13   0   0   1   0   3   0   0   0   1   9   0   0   0   2   3   4
    0   2   0   0   0   0   0   2   0   0   0   0   1   0   0   0   0   0
    0   0   0   0   0   1   2   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   1   0   0   0   0   0]
 [  6   4   2   4  19  49   8   0   9   8  18  41  33  32   2  11  21   7
    0   6   0  22   0   3   5  18   5   9   0   0   0   1   0   0   4   0
    0  20   0   5   0   0   0   0   0   0   3   0   2   0   0   0   0   0
    0   0   0   0   0   0   0   5   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 80   6  16   0  19   0   0   7   2   1   0   0   5   6   0   9   2  37
    3  32   1   6   6   0   0   1   0   9   2   0  15   1  18   0   0   0
    0   2   0   0   4  18  18   0   4   1   0   1   0   0   8   2   0   0
    1   0   0   0   0  10   0   0   0   2   0   0   2   0   0   2   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 15   0  61   2  23   7   0   0  36  14   2   5   9   1   0  30  17   1
   18   0  49   0   1   0   4   1   0   0   0   1   1  23   0  11   5   0
    0   0   6   0   3   6   0   6   0   3   0   0   1   0   0   4   4   0
    0   0   1   0  11   0   4   0   0   0   0   0   2   0   3   0   0   0
    1   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]]
Total size of testing set
9199
[452 431 408 389 372 352 338 321 307 292 278 265 254 241 231 219 208 197
 190 180 170 165 156 148 140 132 128 124 119 112 102  99  95  91  85  81
  77  71  68  67  59  61  56  52  50  48  45  44  41  41  32  30  30  31
  26  29  24  25  21  21  18  19  16  18  15  17  16  16  14  11   9  11
   9   7   7   6   9   2   6   5   5   6   5   3   4   4   2   2   4   1
   3   1   0   1   2   0   0   0   2   2]
20
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [05:00<41:38:56, 300.47s/it]  0%|          | 2/500 [09:52<40:51:44, 295.39s/it]3shot of client 0:head:0.6825396825396826, middle:0.6702127659574468, tail0.7083333333333334
3shot of client 1:head:0.7435897435897436, middle:0.65625, tail0.5454545454545454
3shot of client 2:head:0.7449664429530202, middle:0.7105263157894737, tail0.5
3shot of client 3:head:0.7463617463617463, middle:0.7301587301587301, tail0.26666666666666666
3shot of client 4:head:0.7909836065573771, middle:0.6608695652173913, tail0.41379310344827586
3shot of client 5:head:0.7729941291585127, middle:0.648, tail0.53125
3shot of client 6:head:0.7278911564625851, middle:0.72, tail0.42105263157894735
3shot of client 7:head:0.6875, middle:0.5869565217391305, tail0.5833333333333334
3shot of client 8:head:0.7699316628701595, middle:0.5897435897435898, tail0.5
3shot of client 9:head:0.7290836653386454, middle:0.6617647058823529, tail0.4666666666666667
3shot of client 10:head:0.776536312849162, middle:0.4883720930232558, tail0.36363636363636365
3shot of client 11:head:0.7236467236467237, middle:0.6363636363636364, tail0.5217391304347826
3shot of client 12:head:0.7988505747126436, middle:0.5952380952380952, tail0.5238095238095238
3shot of client 13:head:0.7932098765432098, middle:0.5529411764705883, tail0.55
3shot of client 14:head:0.7601078167115903, middle:0.5894736842105263, tail0.4583333333333333
3shot of client 15:head:0.6309523809523809, middle:0.7903225806451613, tail0.3125
3shot of client 16:head:0.6756756756756757, middle:0.6764705882352942, tail0.3888888888888889
3shot of client 17:head:0.7508532423208191, middle:0.7222222222222222, tail0.7647058823529411
3shot of client 18:head:0.8235294117647058, middle:0.6571428571428571, tail0.29411764705882354
3shot of client 19:head:0.734006734006734, middle:0.55, tail0.6470588235294118
round 0, local average test acc  0.7122 

round 0, local macro average F1 score  0.5463 

round 0, local weighted average F1 score  0.7205 

round 0, global test acc  0.4077 

round 0, average 3shot acc: [head: 0.7432, middle: 0.6447, tail: 0.4881] 

round 0, global 3shot acc: [head: 0.7233, middle: 0.4819, tail: 0.1853] 

l_head tensor([11.1815, 12.4957, 21.5742,  0.5946, 21.1891, 21.3746, 21.5776,  8.1143,
        23.5224, 11.4618, 14.4621, 26.3088, 15.0333, 12.0032, 23.5803, 20.2538,
         7.8738, 11.3924,  0.5704, 17.1663,  0.5836, 12.2525, 14.5913, 17.5590,
        14.9858, 15.6025, 19.3172, 27.1199,  0.5774, 19.7627, 14.4807,  0.5877,
        14.1493,  0.5839, 27.0420, 24.3332, 19.1277, 12.6835, 26.3838,  0.5672,
        10.5877,  0.5809,  0.6059,  0.5731, 14.4198, 25.3605,  0.5519,  0.5713,
        16.9508,  0.5806,  0.5681,  0.5644,  0.5679,  0.5902, 13.0257,  0.5893,
        12.4456, 12.9049,  0.5925,  0.5800,  8.7892,  0.5717, 14.9140,  0.5880,
        16.1803, 22.4970,  0.5878,  0.5847,  0.5935,  0.5852,  0.5815,  0.5941,
         0.5830,  0.5867, 13.1721,  0.5874,  0.5715, 13.4830,  0.5766,  0.5893,
         0.5730,  0.5622, 17.9308,  0.5596,  0.5828,  0.5813, 13.2003,  0.5983,
         0.5665,  0.5797,  0.5960,  0.5712,  0.5850,  0.6013,  0.5539, 13.2637,
        13.8201,  0.5679,  0.5980,  0.5859], device='cuda:3',
       grad_fn=<NormBackward1>)
g_aux tensor([7.8386, 8.5398, 9.0072, 9.0613, 9.2946, 8.2411, 9.1327, 8.6899, 8.1850,
        8.3037, 8.9932, 9.5970, 8.2351, 8.9721, 8.8256, 8.5412, 8.5711, 8.3130,
        8.9692, 8.7460, 7.2391, 7.8699, 8.5693, 7.8451, 8.0764, 8.4771, 7.9883,
        7.7851, 7.8553, 7.2948, 7.5462, 8.3559, 7.9154, 7.3841, 7.5016, 8.7464,
        7.0037, 7.4301, 7.4584, 7.1083, 6.9659, 6.4788, 7.2412, 7.2841, 6.6878,
        7.7188, 8.0086, 7.3617, 6.7279, 6.9225, 7.3523, 6.7165, 7.7138, 6.5521,
        6.7388, 7.0559, 6.0474, 6.5770, 6.8691, 7.1839, 6.2853, 7.2557, 6.5632,
        7.8656, 6.7518, 6.7212, 6.2638, 6.1855, 6.2482, 6.2531, 6.1724, 5.7631,
        6.1778, 6.2231, 7.2314, 6.2645, 5.7594, 6.2095, 6.0655, 5.8346, 6.1369,
        6.0774, 5.3379, 6.6466, 5.9907, 5.9275, 6.1669, 6.1145, 5.9378, 5.7797,
        6.0997, 5.5555, 5.7665, 5.4451, 5.9574, 6.1135, 5.5306, 5.5674, 6.2064,
        5.5785], device='cuda:3', grad_fn=<NormBackward1>)
3shot of client 0:head:0.6746031746031746, middle:0.6702127659574468, tail0.7083333333333334
3shot of client 1:head:0.7534516765285996, middle:0.6640625, tail0.5757575757575758
3shot of client 2:head:0.7550335570469798, middle:0.7236842105263158, tail0.6111111111111112
3shot of client 3:head:0.7484407484407485, middle:0.7380952380952381, tail0.23333333333333334
3shot of client 4:head:0.7848360655737705, middle:0.6782608695652174, tail0.41379310344827586
3shot of client 5:head:0.7710371819960861, middle:0.624, tail0.53125
3shot of client 6:head:0.7380952380952381, middle:0.72, tail0.3684210526315789
3shot of client 7:head:0.6666666666666666, middle:0.5652173913043478, tail0.5833333333333334
3shot of client 8:head:0.7562642369020501, middle:0.5897435897435898, tail0.5
3shot of client 9:head:0.7330677290836654, middle:0.6764705882352942, tail0.4666666666666667
3shot of client 10:head:0.7793296089385475, middle:0.5, tail0.36363636363636365
3shot of client 11:head:0.7264957264957265, middle:0.6363636363636364, tail0.5652173913043478
3shot of client 12:head:0.7988505747126436, middle:0.5833333333333334, tail0.5238095238095238
3shot of client 13:head:0.8148148148148148, middle:0.5529411764705883, tail0.55
3shot of client 14:head:0.7574123989218329, middle:0.5684210526315789, tail0.5
3shot of client 15:head:0.626984126984127, middle:0.7419354838709677, tail0.3125
3shot of client 16:head:0.6655405405405406, middle:0.6764705882352942, tail0.3888888888888889
3shot of client 17:head:0.7406143344709898, middle:0.75, tail0.7647058823529411
3shot of client 18:head:0.8272058823529411, middle:0.7, tail0.29411764705882354
3shot of client 19:head:0.7373737373737373, middle:0.575, tail0.7058823529411765
round 1, local average test acc  0.7128 

round 1, local macro average F1 score  0.5518 

round 1, local weighted average F1 score  0.7226 

round 1, global test acc  0.4055 

round 1, average 3shot acc: [head: 0.7428, middle: 0.6467, tail: 0.4980] 

round 1, global 3shot acc: [head: 0.7178, middle: 0.4935, tail: 0.1774] 

l_head tensor([11.1815, 12.4957, 21.5742,  0.5946, 21.1891, 21.3746, 21.5776,  8.1143,
        23.5224, 11.4618, 14.4621, 26.3088, 15.0333, 12.0032, 23.5803, 20.2538,
         7.8738, 11.3924,  0.5704, 17.1663,  0.5836, 12.2525, 14.5913, 17.5590,
        14.9858, 15.6025, 19.3172, 27.2393,  0.5774, 19.7627, 14.4807,  0.5877,
        14.1493,  0.5839, 27.0380, 24.3332, 19.1277, 12.6835, 26.3316,  0.5672,
        10.5877,  0.5809,  0.6059,  0.5731, 14.4198, 25.3605,  0.5519,  0.5713,
        16.9508,  0.5806,  0.5681,  0.5644,  0.5679,  0.5902, 13.0257,  0.5893,
        12.4456, 12.9065,  0.5925,  0.5800,  8.7892,  0.5717, 14.9140,  0.5880,
        16.1803, 22.4970,  0.5878,  0.5847,  0.5935,  0.5852,  0.5815,  0.5941,
         0.5830,  0.5867, 13.1721,  0.5874,  0.5715, 13.6323,  0.5766,  0.5893,
         0.5730,  0.5622, 17.9308,  0.5596,  0.5828,  0.5813, 13.2003,  0.5983,
         0.5665,  0.5797,  0.5960,  0.5712,  0.5850,  0.6013,  0.5539, 13.2637,
        13.8201,  0.5679,  0.5980,  0.5859], device='cuda:3',
       grad_fn=<NormBackward1>)
g_aux tensor([7.8386, 8.5398, 9.0072, 9.0531, 9.3001, 8.2468, 9.1290, 8.6745, 8.1753,
        8.3037, 9.0042, 9.5970, 8.2351, 8.9721, 8.8186, 8.5420, 8.5711, 8.3130,
        8.9852, 8.7531, 7.2391, 7.8699, 8.5693, 7.8427, 8.0877, 8.4771, 7.9883,
        7.8131, 7.8553, 7.2948, 7.5462, 8.3469, 7.9051, 7.3876, 7.5016, 8.7464,
        7.0037, 7.4301, 7.4423, 7.1144, 6.9659, 6.4788, 7.2484, 7.2952, 6.6878,
        7.7188, 8.0086, 7.3638, 6.7279, 6.9225, 7.3523, 6.7165, 7.7138, 6.5521,
        6.7388, 7.0559, 6.0474, 6.5770, 6.8691, 7.1839, 6.3004, 7.2557, 6.5632,
        7.8656, 6.7518, 6.7212, 6.2638, 6.1855, 6.2482, 6.2531, 6.1724, 5.7631,
        6.1778, 6.2231, 7.2314, 6.2645, 5.7594, 6.2095, 6.0655, 5.8346, 6.1369,
        6.0773, 5.3379, 6.6466, 5.9907, 5.9275, 6.1669, 6.1003, 5.9378, 5.7797,
        6.0997, 5.5555, 5.7665, 5.4451, 5.9574, 6.1135, 5.5306, 5.5674, 6.2064,
        5.5785], device='cuda:3', grad_fn=<NormBackward1>)
  1%|          | 3/500 [14:46<40:43:40, 295.01s/it]
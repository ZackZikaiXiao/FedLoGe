nohup: ignoring input
./temp/fl_acc_cifar100_resnet34_cons_frac0.3_iidFalse_iter500_ep5_lr0.03_N40_100_seed3407_p1_dirichlet0.5_IF0.01_LossCE.txt
Files already downloaded and verified
[500, 477, 455, 434, 415, 396, 378, 361, 344, 328, 314, 299, 286, 273, 260, 248, 237, 226, 216, 206, 197, 188, 179, 171, 163, 156, 149, 142, 135, 129, 123, 118, 112, 107, 102, 98, 93, 89, 85, 81, 77, 74, 70, 67, 64, 61, 58, 56, 53, 51, 48, 46, 44, 42, 40, 38, 36, 35, 33, 32, 30, 29, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 15, 14, 13, 13, 12, 12, 11, 11, 10, 10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5]
10847
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[264, 285, 233, 378, 283, 185, 318, 263, 231, 256, 187, 218, 317, 207, 306, 213, 270, 263, 406, 383, 297, 368, 255, 297, 233, 224, 202, 230, 330, 325, 196, 315, 186, 299, 265, 199, 289, 305, 244, 322]
training set distribution:
[[ 0  0 27 14  2  9 15 24 24  0  4  0  0  5  9 11  4  0  0  1  3  4  0  3
   0 14  4 27  2  0  6  7  3  9  1  0  0  0  0  2  2  0  0  2  2  0  1  0
   2  1  0  1  0  1  1  0  1  1  1  0  0  0  1  0  0  0  0  2  0  3  0  1
   0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0
   1  0  1  2]
 [70  0 40  1 21  0  6  0 19 29  0  2 12  0 21  1  0  2  3  2  1  1  5  1
   0  2  2  1  1  0  0  2  1  1  0  0  2  2  0  1  0  0  0  0  0  5  0  0
   0  9  0  5  1  0  0  0  0  0  0  7  0  0  0  1  0  0  1  0  0  1  0  0
   0  0  0  0  0  0  0  0  1  0  0  2  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [11  2 10  9  4  7  1  0 20  0  4  6  3  0  3  3  3 14  6  3 11  5  1  3
   0 12 15  0  0  1  4  1  0  2  0  2  5  1  0  2  0  9  0  2  2  8  0  0
   0  5  0  0  3  0  0  2  0  0  4  1  0  0  0  0  4  1  3  1  0  0  0  1
   0  2  0  4  0  2  1  0  0  0  1  0  0  0  1  0  0  0  0  0  1  0  0  0
   0  0  1  0]
 [ 0  7 12 54  6  1 76 52  2 13  2 12 10  0  4  2  0  0  7  0 10 10  2  0
   3  4  3  0  0  1  0  7  5  5  2  0  2  2 22  2  0  1  4  0  0  0  0  0
   0  4  4  0  6  2  1  3  0  0  0  2  1  0  0  0  1  2  0  1  1  1  0  1
   0  0  0  0  0  1  0  0  0  0  1  0  0  0  1  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [12 27 41  0 13  1  1  6  5  0  0 27  5 12 14 10  0  3  0  0 20  0  4  0
   1  1  0  0  9  1 11 10  0  0  0  1  1 14  0  1  0  0  3  2  2  4  0  4
   0  0  1  0  0  1  0  3  1  0  1  0  1  0  0  0  0  2  0  3  0  0  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  1  0
   0  0  0  0]
 [ 0  1  0 14  3  1 37  2 10  2  0  5  0  0 10  5  0  2  0 17  3  0  0  7
   4  3  0  1  2  5  0  0  1  0  0  0  2  2  7  0  8  5  2  0  1  2  0  0
   1  0  3  0  1  3  0  0  2  0  1  0  0  0  1  0  1  0  2  0  0  0  0  0
   1  0  0  0  0  1  0  0  2  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0
   0  0  1  0]
 [11 28  9 11  0  6 16 51 12  0 45  3  8  0 17  6  1  0  0  0  1 17  0  1
   2  6  0  9  4  0  3  0  1  0 10  5  0  0  0  9  0  0  3  1  7  0  0  1
   0  4  3  0  3  0  0  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  1  0 46  1 13 10  5  5  5 14  9  2 16  4 27  0  2  0  0  0  0  1  5
   8  0  4  1  3  2  3  3 12  0  6  5  2  0  0  4  4  1  1  0  0  5  7  1
   0  0  3  2  3  0  1  2  0  1  0  0  0  0  0  2  0  0  0  0  0  3  1  0
   0  0  1  0  0  0  0  0  0  0  0  1  2  0  0  0  0  0  0  0  2  0  0  0
   0  0  1  0]
 [ 0  0  0  0  0 43  2  1  3  2 12  2 12  5 21  0  0  4  3 19  8  1  3  7
   2  0  4  3  1  0  1  1  0  1  0 14  5  0  0 15  1  7  4  2  0  0  1  0
   0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  2  5  0  2  0  0  2
   0  0  0  2  1  0  0  0  1  1  0  1  1  0  0  1  0  0  0  1  0  0  0  0
   0  0  0  0]
 [ 1  0  3  8 24 21  1 11 15  0  1  5  3  0  5  0 45  1  5  4  7  1  0  1
   2  3 13  0  4  0  0  0  2  1  8  0  2  4  2  1  1  0  0  6 11  1  1  3
   4  0  1  1  0  1 10  0  2  1  0  0  0  0  2  0  0  0  0  0  2  0  0  0
   0  0  1  0  1  0  0  0  0  0  0  0  0  2  0  0  0  0  1  0  0  0  0  0
   0  0  0  0]
 [14 21  7  0  1  4  3  5  0  6  2  0  1  2  0 14  0  6  6  7  2 17  5  7
   7  0  7  0 10  2  0  0  0  0  0  1  0  0  1  0  2  3  0  4  2  0  0  1
   1  0  1  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  2  1  1  1  1
   0  0  2  2  0  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0
   0  0  0  0]
 [ 0 44  0  6  6  0  4  2  1  2  8  3 21  0  3  1 24  1  0  1  8  7  1  0
   7  1  0  9  0  0  1  6  1  3  1  0  0  1  0  0  6  5  1  0  5  0  0  0
   2  2  0  0  0  0  0  0  1  4  0  1  1  0  1  1  0  0  0  0  1  4  0  0
   4  0  1  0  1  0  0  0  0  1  0  0  0  0  1  0  0  0  0  1  0  0  0  0
   1  0  0  0]
 [24  3  9  4 10 10 37  6  3 49  7  1  0  0  3  2 10  5  1  1 15  3  0 21
   0  3  0 16  6  2  3  0  0  0  3  4  0  0  1  6  2  0  0  1  3  0  4  1
   4  0  1  1  3  1  2  2  0  1  1  0  3  0  3  0  0  1  0  1  2  1  0  1
   1  1  0  0  0  0  1  0  0  0  0  0  0  0  0  4  0  0  1  0  0  1  0  0
   0  0  1  0]
 [ 4  5  3  0  0  1  0  2 13  0  0 21  0  0  4  0 13  0 19  1  3  3  4  1
  23  9  5  9  7  0  5  1  2  0  5  0  0  4  5  2  3  0  2  1  2  0  0  0
   0  1  0  0  3  2  2  0  2  0  1  0  0  5  0  2  0  1  0  0  0  0  0  0
   0  1  0  0  0  0  0  1  1  1  1  0  0  0  0  0  1  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0 50 13  1  0 31  1  6 19  0  0  0  2 12 22  1  0  0 32  0 12  0 10  0
   0  0 13  0  5  1  0 15  4  5  3  8  2  3  4  0  0  1  8  0  0  1  0  0
   1  0  2  0  0  0  0  0  2  2  2  0  0  0  0  0  0  2  1  1  0  0  0  0
   0  0  0  2  1  0  0  0  1  1  1  0  0  0  0  0  1  1  0  0  0  0  0  0
   0  0  0  0]
 [ 0  3  7  4 11 29  3  0 13 23  0  0  2  1  2  8  3  1  3  6  5  3  3  1
   0  2  0  0  4  4  9  3  0  4  4  0  0  0  0  2  0  9  1  2  0  0  1  8
   4  1  0  3  1  0  2  0  3  1  0  1  0  1  1  1  0  2  0  0  0  0  1  0
   1  0  0  0  0  0  1  0  0  0  0  0  0  2  0  0  0  1  0  0  0  0  0  0
   1  1  0  0]
 [12 42  0  0  0 10  0  2  4 25  4  0 28 28  5  3  0  2  1  7  2  3  6  8
   0  2  2 15  2  1  0  0  1  1  0  2  0  6  2  2  7  0  0  7  2  1  0  0
   3  0  1  1  0  0  2  0  0  0  1  1  1  2  0  0  1  1  0  0  0  0  3  0
   0  1  1  0  1  0  0  1  0  0  0  0  0  1  0  0  0  0  1  2  0  0  0  0
   0  0  0  0]
 [ 3  8  2  0 59  0  9  2 14 32  1  0  1  1  0  0  6  1  6  3  0  5  1  0
   4 25  1  8  4  1  1  0  4  2 14  0  1  4  0  0  0  0  3  5  0  0  1  0
   1  0  2  0  0  2  6  0  4  0  0  1  0  0  3  0  0  0  2  0  0  0  1  2
   0  0  0  0  0  0  0  0  1  0  0  0  0  0  2  0  0  0  0  0  0  2  0  0
   0  2  0  0]
 [19 75 32  4  0  2  6 13  1  4 21 22 11 21 43  0  6  0  4  6  2 18  0  2
   4  4  0  0  1  7 17  0  6  1 10  1  0 14  3  0  0  6  3  0  1  0  0  2
   1  0  3  0  1  0  1  0  0  0  0  0  1  0  1  0  0  0  0  0  0  0  1  1
   0  0  0  0  0  0  0  0  1  0  2  0  0  0  0  0  0  0  0  0  0  0  1  0
   0  0  0  0]
 [26  3 37 60  0 19  0  5  0  2  0 19  2  3  2 38  3  1 15  2  0 24  9 10
   0  2  0  0  7  4  2 10 23  4  0  2  0  1  0  1  1  4 10  0  1  1  3  0
   0  0  1  3  1  0  0  2  3  0  0  0  0  0  0  0  0  0  1  3  0  0  2  0
   0  0  1  0  2  0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  0  0  0  3
   1  0  0  1]
 [22  4  7 39 20 21  1 11 15  3  0  0  2  1  0  6 49  2  0  7  2  3 17  2
   5  2  0  2  2  3  1  0  0  1  0  0  6  0  0  5  3  0  1  0  0  2  9  0
   0  2  0  0  1  0  0  0  2  0  0  0  0  3  0  1  0  0  0  3  1  0  2  0
   0  0  0  0  0  1  0  3  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  0 28  0  5  0  1 37  0 22 35 18 25  7  0 12  0 17  8  1  1  0  3 13
   0  5  1  2 28 26  0  0  2  8  1  0  2  0  1  3  0  0  1  4  0  4  0  8
   0  0  0  0  1 11  0  0  1  4  0  6  0  1  0  0  0  0  0  0  0  0  1  0
   0  1  0  0  0  3  4  0  0  0  0  1  2  1  1  1  0  0  0  0  0  0  0  0
   0  0  0  0]
 [21 14  2  1 16  1 24 23  3  9  5  2  3  0  0  5 17  0  1  2  0  1  2  0
   2  1 10  0  1  0  3  7  5  8  0 23  0  0  0  1  1  6  3  2  0  0  0 11
   0  2  0  2  0  0  0  1  1  0  6  1  1  0  0  0  0  1  2  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [12  5 35 10 12 11  4  7 14  7  9  0 12 13  9  6  0 21  4  2  3  0  0  6
   0 10  0  0  0 11  3  0  5  0  2  2  0  6  7  0  0  0  6  1  4  4  1  5
   1  0  2  0  0  2  0  1  0  0  3  0  1  0  0  4  0  0  0  0  2  0  0  4
   1  0  3  1  1  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   1  0  0  0]
 [10  0  4  8 40  5  3  0  2  5 16  0  3  1  0  0 12  1  8  4  7  7  1  1
   7  4  2  0  0  0 15 14  0  0  5  0  3  4  2  0  5  1  1  0  3  1  1  0
   1  0  0  3  0  0  1  0  3  2  0  1  0  1  4  0  5  0  0  0  0  1  0  1
   2  0  0  0  0  0  0  1  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [30  0  5  4  5  1  4  1  1  9  6 12 10 24  0 14  1  5  2  1  1  4  4 15
   4  4  3  0  0  3  4  3  3  0  0  0  0  4  1  1  0  0  0  6  0  0  1  1
   1  0  2  0  2  1  0  0  0  1  0  5  0  1  0  0  0  0  0  4  2  1  0  0
   0  0  1  0  1  0  0  0  0  0  0  0  0  0  0  0  1  1  0  1  1  0  0  0
   0  1  0  0]
 [13 31 23  0  1  4  1  0  0  1  7  2  5  0  1 10  1  0  1  0  5  5  0  5
   3  0 26  0  0  2  3  0  0  6  0  6  0  0  3  2  0  0  0  3  6  3  1  4
   0  1  0  1  0  2  1  0  0  0  2  0  0  0  0  0  0  0  1  0  3  0  1  0
   0  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0  1  0  1  0  1  0  0  0
   0  0  0  1]
 [ 4  0  2 13  1  7 18  8  9 14  8  0  0  0  7  0  0  5 13 19  0 11 15  5
   1 14  2  0  1  2 12  0  0  1  0  4  1  0  1  5  0  0  2  0  0  0  1  0
   0  3  1  1  0  0  0  0  1  2  0  0  0  0  1  2  1  1  1  0  0  1  0  0
   1  0  1  0  0  1  0  0  0  0  2  1  1  0  0  0  0  1  0  0  0  0  0  0
   0  1  0  0]
 [32 10  0  1 13 15  3 16  3  0  8  2 50 10  9  0 13 11  0  2 17  5  1 12
   4  0  0  1  2  2  0  2 14  0  0  4  0  6  1  6  6  0  0  3  0  0  9  0
   6  2  2  2  1  0  0  1  0  1  3  0  0  3  1  4  2  2  0  0  0  1  0  0
   0  0  0  1  0  0  0  3  0  0  0  0  0  0  0  0  0  0  0  1  0  1  0  0
   0  0  0  0]
 [47  7  1  7  0 43 10  0  9 20 27 11  2 18  0  1  0  1  1 33  5  1  0  2
  20  6  0  0  3  1  0  1  0 11  5  0  5  0  1  0  1  1  0  0  0  0  0  0
   0  2  3  1  4  0  3  1  1  1  0  0  0  0  1  1  0  0  1  0  1  0  1  3
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 1  8  4  3  0  5  0 12  0  1  6 11  1  5 14  4  9  3  9  0  0  0  9  1
   1  0  0  5  0  1  3  1  0  0  1  0 26  1  0  2 10  0  3  2  0 11  3  3
   1  0  0  1  2  1  0  1  0  0  0  2  0  0  0  0  0  1  0  0  0  0  1  0
   2  0  0  1  0  0  0  0  0  0  1  0  0  1  0  0  0  0  0  0  0  0  0  2
   0  0  0  0]
 [26  0  5  2 14  0  7 20 48  1 50  7  2  0  6 22  2  4  6  0  4 11  6  1
   1  0  1  1  2  0  0  1  9  1  1  7  0  3  0  0  0  3  0  2  2  0  0  0
   1  4  0  0  1  0  0  3  0  4  0  0  6  1  0  2  0  4  2  0  0  0  1  0
   1  0  0  0  1  1  0  0  0  0  1  0  0  1  0  0  1  0  2  0  0  0  0  0
   0  0  0  0]
 [ 1  0 24  4  2  0  7  0  1 16  0  1 11  0  1 13  0  4  2  7  2  0  9  2
   2  0  8  0  0  1  1  1  0  0  0  0  0  1  0  0  4  5  3  1  0  7  4  0
   1  2  0  8  2  0  2  3  0  1  1  0  0  4  0  0  1  0  0  1  0  0  0  0
   0  4  0  1  1  0  0  0  1  5  0  0  2  0  0  0  0  0  0  0  0  0  1  0
   0  0  0  0]
 [27  0  4 32 33 18 25  1  5  0  0  2  2  1  2  9  0  1  4  5  8  4 25 16
   5  0 10  0  3 12  1  3  1  6  1  1  0  0  1  0  1  2  1  0  0  0  3  0
   3  0  0  1  0  0  0  3  2  0  0  0  6  3  0  0  0  0  0  0  0  0  1  0
   0  0  0  1  0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0
   0  0  0  1]
 [29  1  1  1  4 38  7 23  7  5  2 14  3  9  3  1  7 15  1  0  0  4  0  0
   4  8  6  5  0 10  0  1  1  8  3  0  5  0  0  0  2  0  0  4  1  0  0  1
   2  0  4  0  3  0  0  0  0  8  0  0  0  0  4  0  0  1  0  0  0  0  0  0
   0  2  0  0  1  0  0  1  1  0  1  0  0  0  0  0  1  0  0  0  1  0  0  1
   0  0  0  0]
 [ 4  6 29  1  0  7  9  4  0  0  0 13  9  2  0  1  5  6  0 15  7  0  1  0
   6  0  0  7  1  6  4  0  2  0  0  3  2  3  1  1  0  0  0  2  1  0  2  0
  12  4  4  4  1  2  0  3  2  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  2  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  1  1  0
   0  0  0  0]
 [ 4 45  5 29 16  1  1  2 17 10  7  8  3  0 10  1  1 14 21  0  1  0 15 10
   4  0  4  2  2  0  0  5  0  0  8  0  2  0  8  0  0  1  0  0  4  0  2  2
   0  0  2  4  0  2  0  2  0  0  1  1  0  1  0  1  0  0  1  0  0  0  0  0
   0  0  2  0  1  2  0  1  0  0  0  0  1  0  0  0  0  2  0  0  0  0  0  0
   0  0  0  0]
 [ 5  7 16 23 40  0 17  0  4  2  0 18  1 11  1 11  0 41  0  0  3  9 15  0
   0  6  0 16  0 11  2  6  0  5  1  0 14  1  0  0  1  1  0  0  0  0  1  0
   0  0  2  0  0  0  0  0  0  0  0  0  1  2  0  0  2  0  0  0  3  2  0  0
   2  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 5 16  3  7  0  6  5  1  4  1  0  3  0 56  0  0  2 14  0  7  1  0  0  1
  15  0  3  0 17  1  4  6  4  4  7  2  2  2 10  1  1  0  1  1  2  1  0  0
   0  0  0  0  0  8  5  4  2  0  0  2  0  0  3  0  0  0  0  0  0  0  0  0
   0  0  0  0  1  0  0  0  1  1  0  0  0  1  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  3  5 13 32  5  3  0 19  8  3 38 19  9  5  0  0 16 24 21 17  1  1  1
  12  3  0  2  1  5  1  1  0  9  0  1  1  0  1  4  5  3  3  1  0  0  1  0
   0  2  0  1  0  0  0  0  0  0  3  0  6  0  0  3  6  0  0  0  0  0  1  0
   0  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  1  0
   0  0  0  0]]
Total size of training set
10847
local test distribution:
[[ 0  0 24 12  1  8 13 22 22  0  3  0  0  4  8 10  3  0  0  0  2  3  0  2
   0 12  3 24  1  0  5  6  2  8  0  0  0  0  0  1  1  0  0  1  1  0  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  2  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0
   0  0  0  1]
 [64  0 36  0 19  0  5  0 17 26  0  1 11  0 19  0  0  1  2  1  0  0  4  0
   0  1  1  0  0  0  0  1  0  0  0  0  1  1  0  0  0  0  0  0  0  4  0  0
   0  8  0  4  0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [10  1  9  8  3  6  0  0 18  0  3  5  2  0  2  2  2 12  5  2 10  4  0  2
   0 11 13  0  0  0  3  0  0  1  0  1  4  0  0  1  0  8  0  1  1  7  0  0
   0  4  0  0  2  0  0  1  0  0  3  0  0  0  0  0  3  0  2  0  0  0  0  0
   0  1  0  3  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  6 11 49  5  0 70 47  1 11  1 11  9  0  3  1  0  0  6  0  9  9  1  0
   2  3  2  0  0  0  0  6  4  4  1  0  1  1 20  1  0  0  3  0  0  0  0  0
   0  3  3  0  5  1  0  2  0  0  0  1  0  0  0  0  0  1  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [11 24 37  0 11  0  0  5  4  0  0 24  4 11 12  9  0  2  0  0 18  0  3  0
   0  0  0  0  8  0 10  9  0  0  0  0  0 12  0  0  0  0  2  1  1  3  0  3
   0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0  1  0  2  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  0  0 12  2  0 34  1  9  1  0  4  0  0  9  4  0  1  0 15  2  0  0  6
   3  2  0  0  1  4  0  0  0  0  0  0  1  1  6  0  7  4  1  0  0  1  0  0
   0  0  2  0  0  2  0  0  1  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0
   0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [10 25  8 10  0  5 14 47 11  0 41  2  7  0 15  5  0  0  0  0  0 15  0  0
   1  5  0  8  3  0  2  0  0  0  9  4  0  0  0  8  0  0  2  0  6  0  0  0
   0  3  2  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  0  0 42  0 11  9  4  4  4 12  8  1 14  3 24  0  1  0  0  0  0  0  4
   7  0  3  0  2  1  2  2 11  0  5  4  1  0  0  3  3  0  0  0  0  4  6  0
   0  0  2  1  2  0  0  1  0  0  0  0  0  0  0  1  0  0  0  0  0  2  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  1  0  0  0
   0  0  0  0]
 [ 0  0  0  0  0 39  1  0  2  1 11  1 11  4 19  0  0  3  2 17  7  0  2  6
   1  0  3  2  0  0  0  0  0  0  0 12  4  0  0 13  0  6  3  1  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  4  0  1  0  0  1
   0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  0  2  7 22 19  0 10 13  0  0  4  2  0  4  0 41  0  4  3  6  0  0  0
   1  2 11  0  3  0  0  0  1  0  7  0  1  3  1  0  0  0  0  5 10  0  0  2
   3  0  0  0  0  0  9  0  1  0  0  0  0  0  1  0  0  0  0  0  1  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [12 19  6  0  0  3  2  4  0  5  1  0  0  1  0 12  0  5  5  6  1 15  4  6
   6  0  6  0  9  1  0  0  0  0  0  0  0  0  0  0  1  2  0  3  1  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0
   0  0  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0 40  0  5  5  0  3  1  0  1  7  2 19  0  2  0 22  0  0  0  7  6  0  0
   6  0  0  8  0  0  0  5  0  2  0  0  0  0  0  0  5  4  0  0  4  0  0  0
   1  1  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0  0  0  3  0  0
   3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [22  2  8  3  9  9 34  5  2 45  6  0  0  0  2  1  9  4  0  0 13  2  0 19
   0  2  0 14  5  1  2  0  0  0  2  3  0  0  0  5  1  0  0  0  2  0  3  0
   3  0  0  0  2  0  1  1  0  0  0  0  2  0  2  0  0  0  0  0  1  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 3  4  2  0  0  0  0  1 11  0  0 19  0  0  3  0 11  0 17  0  2  2  3  0
  21  8  4  8  6  0  4  0  1  0  4  0  0  3  4  1  2  0  1  0  1  0  0  0
   0  0  0  0  2  1  1  0  1  0  0  0  0  4  0  1  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0 46 11  0  0 28  0  5 17  0  0  0  1 11 20  0  0  0 29  0 11  0  9  0
   0  0 11  0  4  0  0 13  3  4  2  7  1  2  3  0  0  0  7  0  0  0  0  0
   0  0  1  0  0  0  0  0  1  1  1  0  0  0  0  0  0  1  0  0  0  0  0  0
   0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  2  6  3 10 26  2  0 11 21  0  0  1  0  1  7  2  0  2  5  4  2  2  0
   0  1  0  0  3  3  8  2  0  3  3  0  0  0  0  1  0  8  0  1  0  0  0  7
   3  0  0  2  0  0  1  0  2  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [11 38  0  0  0  9  0  1  3 23  3  0 25 25  4  2  0  1  0  6  1  2  5  7
   0  1  1 13  1  0  0  0  0  0  0  1  0  5  1  1  6  0  0  6  1  0  0  0
   2  0  0  0  0  0  1  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  2  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0
   0  0  0  0]
 [ 2  7  1  0 54  0  8  1 12 29  0  0  0  0  0  0  5  0  5  2  0  4  0  0
   3 23  0  7  3  0  0  0  3  1 12  0  0  3  0  0  0  0  2  4  0  0  0  0
   0  0  1  0  0  1  5  0  3  0  0  0  0  0  2  0  0  0  1  0  0  0  0  1
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  1  0  0
   0  1  0  0]
 [17 69 29  3  0  1  5 11  0  3 19 20 10 19 39  0  5  0  3  5  1 16  0  1
   3  3  0  0  0  6 15  0  5  0  9  0  0 12  2  0  0  5  2  0  0  0  0  1
   0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [23  2 34 55  0 17  0  4  0  1  0 17  1  2  1 35  2  0 13  1  0 22  8  9
   0  1  0  0  6  3  1  9 21  3  0  1  0  0  0  0  0  3  9  0  0  0  2  0
   0  0  0  2  0  0  0  1  2  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0
   0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2
   0  0  0  0]
 [20  3  6 35 18 19  0 10 13  2  0  0  1  0  0  5 45  1  0  6  1  2 15  1
   4  1  0  1  1  2  0  0  0  0  0  0  5  0  0  4  2  0  0  0  0  1  8  0
   0  1  0  0  0  0  0  0  1  0  0  0  0  2  0  0  0  0  0  2  0  0  1  0
   0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  0 25  0  4  0  0 34  0 20 32 16 23  6  0 11  0 15  7  0  0  0  2 11
   0  4  0  1 25 23  0  0  1  7  0  0  1  0  0  2  0  0  0  3  0  3  0  7
   0  0  0  0  0 10  0  0  0  3  0  5  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  2  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [19 12  1  0 14  0 22 21  2  8  4  1  2  0  0  4 15  0  0  1  0  0  1  0
   1  0  9  0  0  0  2  6  4  7  0 21  0  0  0  0  0  5  2  1  0  0  0 10
   0  1  0  1  0  0  0  0  0  0  5  0  0  0  0  0  0  0  1  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [11  4 32  9 11 10  3  6 12  6  8  0 11 11  8  5  0 19  3  1  2  0  0  5
   0  9  0  0  0 10  2  0  4  0  1  1  0  5  6  0  0  0  5  0  3  3  0  4
   0  0  1  0  0  1  0  0  0  0  2  0  0  0  0  3  0  0  0  0  1  0  0  3
   0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 9  0  3  7 36  4  2  0  1  4 14  0  2  0  0  0 11  0  7  3  6  6  0  0
   6  3  1  0  0  0 13 12  0  0  4  0  2  3  1  0  4  0  0  0  2  0  0  0
   0  0  0  2  0  0  0  0  2  1  0  0  0  0  3  0  4  0  0  0  0  0  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [27  0  4  3  4  0  3  0  0  8  5 11  9 22  0 12  0  4  1  0  0  3  3 13
   3  3  2  0  0  2  3  2  2  0  0  0  0  3  0  0  0  0  0  5  0  0  0  0
   0  0  1  0  1  0  0  0  0  0  0  4  0  0  0  0  0  0  0  3  1  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [11 28 21  0  0  3  0  0  0  0  6  1  4  0  0  9  0  0  0  0  4  4  0  4
   2  0 23  0  0  1  2  0  0  5  0  5  0  0  2  1  0  0  0  2  5  2  0  3
   0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0  2  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 3  0  1 11  0  6 16  7  8 12  7  0  0  0  6  0  0  4 11 17  0 10 13  4
   0 12  1  0  0  1 11  0  0  0  0  3  0  0  0  4  0  0  1  0  0  0  0  0
   0  2  0  0  0  0  0  0  0  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [29  9  0  0 11 13  2 14  2  0  7  1 46  9  8  0 11 10  0  1 15  4  0 11
   3  0  0  0  1  1  0  1 12  0  0  3  0  5  0  5  5  0  0  2  0  0  8  0
   5  1  1  1  0  0  0  0  0  0  2  0  0  2  0  3  1  1  0  0  0  0  0  0
   0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [43  6  0  6  0 39  9  0  8 18 24 10  1 16  0  0  0  0  0 30  4  0  0  1
  18  5  0  0  2  0  0  0  0 10  4  0  4  0  0  0  0  0  0  0  0  0  0  0
   0  1  2  0  3  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  7  3  2  0  4  0 11  0  0  5 10  0  4 12  3  8  2  8  0  0  0  8  0
   0  0  0  4  0  0  2  0  0  0  0  0 23  0  0  1  9  0  2  1  0 10  2  2
   0  0  0  0  1  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1
   0  0  0  0]
 [23  0  4  1 12  0  6 18 44  0 46  6  1  0  5 20  1  3  5  0  3 10  5  0
   0  0  0  0  1  0  0  0  8  0  0  6  0  2  0  0  0  2  0  1  1  0  0  0
   0  3  0  0  0  0  0  2  0  3  0  0  5  0  0  1  0  3  1  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0
   0  0  0  0]
 [ 0  0 22  3  1  0  6  0  0 14  0  0 10  0  0 11  0  3  1  6  1  0  8  1
   1  0  7  0  0  0  0  0  0  0  0  0  0  0  0  0  3  4  2  0  0  6  3  0
   0  1  0  7  1  0  1  2  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0  0
   0  3  0  0  0  0  0  0  0  4  0  0  1  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [24  0  3 29 30 16 23  0  4  0  0  1  1  0  1  8  0  0  3  4  7  3 23 14
   4  0  9  0  2 11  0  2  0  5  0  0  0  0  0  0  0  1  0  0  0  0  2  0
   2  0  0  0  0  0  0  2  1  0  0  0  5  2  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [26  0  0  0  3 35  6 21  6  4  1 12  2  8  2  0  6 13  0  0  0  3  0  0
   3  7  5  4  0  9  0  0  0  7  2  0  4  0  0  0  1  0  0  3  0  0  0  0
   1  0  3  0  2  0  0  0  0  7  0  0  0  0  3  0  0  0  0  0  0  0  0  0
   0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 3  5 26  0  0  6  8  3  0  0  0 11  8  1  0  0  4  5  0 13  6  0  0  0
   5  0  0  6  0  5  3  0  1  0  0  2  1  2  0  0  0  0  0  1  0  0  1  0
  11  3  3  3  0  1  0  2  1  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 3 41  4 26 14  0  0  1 15  9  6  7  2  0  9  0  0 12 19  0  0  0 13  9
   3  0  3  1  1  0  0  4  0  0  7  0  1  0  7  0  0  0  0  0  3  0  1  1
   0  0  1  3  0  1  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  1  0  0  1  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0
   0  0  0  0]
 [ 4  6 14 21 36  0 15  0  3  1  0 16  0 10  0 10  0 37  0  0  2  8 13  0
   0  5  0 14  0 10  1  5  0  4  0  0 12  0  0  0  0  0  0  0  0  0  0  0
   0  0  1  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  2  1  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 4 14  2  6  0  5  4  0  3  0  0  2  0 51  0  0  1 12  0  6  0  0  0  0
  13  0  2  0 15  0  3  5  3  3  6  1  1  1  9  0  0  0  0  0  1  0  0  0
   0  0  0  0  0  7  4  3  1  0  0  1  0  0  2  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  2  4 11 29  4  2  0 17  7  2 35 17  8  4  0  0 14 22 19 15  0  0  0
  11  2  0  1  0  4  0  0  0  8  0  0  0  0  0  3  4  2  2  0  0  0  0  0
   0  1  0  0  0  0  0  0  0  0  2  0  5  0  0  2  5  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]]/home/jianhui/anaconda3/envs/FedLLM/lib/python3.7/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/jianhui/anaconda3/envs/FedLLM/lib/python3.7/site-packages/torchvision/image.so: undefined symbol: _ZN2at4_ops19empty_memory_format4callEN3c108ArrayRefIlEENS2_8optionalINS2_10ScalarTypeEEENS5_INS2_6LayoutEEENS5_INS2_6DeviceEEENS5_IbEENS5_INS2_12MemoryFormatEEE
  warn(f"Failed to load image Python extension: {e}")
/data/jianhui/FedLoGe/util/etf_methods.py:134: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  sparse_etf = torch.tensor(sparse_etf, requires_grad=True)

Total size of testing set
8636
[444 422 399 379 364 345 327 315 295 284 274 258 244 237 221 210 204 184
 180 170 160 155 145 136 131 126 120 116 103  98  94  90  86  82  78  75
  68  64  62  55  54  54  46  42  43  44  36  40  32  33  26  26  23  26
  25  20  17  19  17  18  17  15  13  12  14   9  10  11   9   8   4   7
   6   6   4   6   1   4   4   4   1   4   2   2   3   2   2   4   1   1
   1   1   1   1   0   3   0   1   0   1]
40
Step 0, Loss 26.707042694091797
Step 100, Loss 16.122817993164062
Step 200, Loss 9.328774452209473
Step 300, Loss 5.0143256187438965
Step 400, Loss 2.319241523742676
Step 500, Loss 0.6721667051315308
Step 600, Loss -0.3084346055984497
Step 700, Loss -0.8770543336868286
Step 800, Loss -1.1979626417160034
Step 900, Loss -1.3741819858551025
Step 1000, Loss -1.468639612197876
Step 1100, Loss -1.5183303356170654
Step 1200, Loss -1.5444430112838745
Step 1300, Loss -1.5582386255264282
Step 1400, Loss -1.5658588409423828
Step 1500, Loss -1.5702534914016724
Step 1600, Loss -1.573004961013794
Step 1700, Loss -1.5746220350265503
Step 1800, Loss -1.5755937099456787
Step 1900, Loss -1.5763685703277588
Step 2000, Loss -1.5766655206680298
Step 2100, Loss -1.5769119262695312
Step 2200, Loss -1.5770058631896973
Step 2300, Loss -1.577066421508789
Step 2400, Loss -1.577109932899475
Step 2500, Loss -1.5771899223327637
Step 2600, Loss -1.5770494937896729
Step 2700, Loss -1.5769699811935425
Step 2800, Loss -1.5770304203033447
Step 2900, Loss -1.576891541481018
Step 3000, Loss -1.5768898725509644
Step 3100, Loss -1.5767631530761719
Step 3200, Loss -1.5768394470214844
Step 3300, Loss -1.576735019683838
Step 3400, Loss -1.5767710208892822
Step 3500, Loss -1.5766890048980713
Step 3600, Loss -1.5766385793685913
Step 3700, Loss -1.5765390396118164
Step 3800, Loss -1.5765506029129028
Step 3900, Loss -1.5765495300292969
Step 4000, Loss -1.5764702558517456
Step 4100, Loss -1.5763863325119019
Step 4200, Loss -1.5763828754425049
Step 4300, Loss -1.5763123035430908
Step 4400, Loss -1.5762789249420166
Step 4500, Loss -1.5762110948562622
Step 4600, Loss -1.5761919021606445
Step 4700, Loss -1.5762277841567993
Step 4800, Loss -1.5762481689453125
Step 4900, Loss -1.576088786125183
Step 5000, Loss -1.5761018991470337
Step 5100, Loss -1.5761808156967163
Step 5200, Loss -1.5761219263076782
Step 5300, Loss -1.5761094093322754
Step 5400, Loss -1.5760401487350464
Step 5500, Loss -1.5759962797164917
Step 5600, Loss -1.576080322265625
Step 5700, Loss -1.5761257410049438
Step 5800, Loss -1.576088309288025
Step 5900, Loss -1.5759828090667725
Step 6000, Loss -1.5760302543640137
Step 6100, Loss -1.576082468032837
Step 6200, Loss -1.5759607553482056
Step 6300, Loss -1.5759472846984863
Step 6400, Loss -1.575944423675537
Step 6500, Loss -1.575966715812683
Step 6600, Loss -1.5759642124176025
Step 6700, Loss -1.575973629951477
Step 6800, Loss -1.575981855392456
Step 6900, Loss -1.5759774446487427
Step 7000, Loss -1.575956106185913
Step 7100, Loss -1.5757426023483276
Step 7200, Loss -1.575937032699585
Step 7300, Loss -1.5759222507476807
Step 7400, Loss -1.5759332180023193
Step 7500, Loss -1.575863003730774
Step 7600, Loss -1.5758898258209229
Step 7700, Loss -1.575886607170105
Step 7800, Loss -1.5758919715881348
Step 7900, Loss -1.5759611129760742
Step 8000, Loss -1.5758798122406006
Step 8100, Loss -1.5759239196777344
Step 8200, Loss -1.5757964849472046
Step 8300, Loss -1.576015830039978
Step 8400, Loss -1.575979232788086
Step 8500, Loss -1.5759261846542358
Step 8600, Loss -1.575936198234558
Step 8700, Loss -1.5758062601089478
Step 8800, Loss -1.5758730173110962
Step 8900, Loss -1.5759665966033936
Step 9000, Loss -1.5758702754974365
Step 9100, Loss -1.5758799314498901
Step 9200, Loss -1.575838327407837
Step 9300, Loss -1.575832486152649
Step 9400, Loss -1.5758777856826782
Step 9500, Loss -1.575838327407837
Step 9600, Loss -1.5760245323181152
Step 9700, Loss -1.575888752937317
Step 9800, Loss -1.5758763551712036
Step 9900, Loss -1.575890064239502
Angle Mean: 90.57780456542969, Angle Variance: 0.042339928448200226
Norm Mean: 0.10025106370449066, Norm Variance: 2.5868063247003192e-09
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [02:30<20:50:16, 150.33s/it]The value of constant scaler:  tensor([1.8248], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.0736196319018405, middle:0.0, tail0.0
3shot of client 1:head:0.143646408839779, middle:0.0, tail0.0
3shot of client 2:head:0.0, middle:0.08571428571428572, tail0.0
3shot of client 3:head:0.0, middle:0.08064516129032258, tail0.0
3shot of client 4:head:0.0, middle:0.1951219512195122, tail0.0
3shot of client 5:head:0.0, middle:0.038461538461538464, tail0.0
3shot of client 6:head:0.03902439024390244, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.1111111111111111
3shot of client 8:head:0.0, middle:0.027777777777777776, tail0.0
3shot of client 9:head:0.01935483870967742, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.07692307692307693, tail0.0
3shot of client 11:head:0.04, middle:0.0, tail0.0
3shot of client 12:head:0.047872340425531915, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0625, tail0.0
3shot of client 14:head:0.233502538071066, middle:0.0, tail0.0
3shot of client 15:head:0.058823529411764705, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.34394904458598724, middle:0.0, tail0.0
3shot of client 18:head:0.2593984962406015, middle:0.0, tail0.0
3shot of client 19:head:0.14227642276422764, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.10638297872340426, tail0.0
3shot of client 21:head:0.04680851063829787, middle:0.0, tail0.0
3shot of client 22:head:0.08860759493670886, middle:0.0, tail0.0
3shot of client 23:head:0.05434782608695652, middle:0.0, tail0.0
3shot of client 24:head:0.26666666666666666, middle:0.0, tail0.0
3shot of client 25:head:0.03125, middle:0.0, tail0.0
3shot of client 26:head:0.1794871794871795, middle:0.0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.14285714285714285
3shot of client 28:head:0.05339805825242718, middle:0.0, tail0.0
3shot of client 29:head:0.07211538461538461, middle:0.02040816326530612, tail0.0
3shot of client 30:head:0.06306306306306306, middle:0.0, tail0.0
3shot of client 31:head:0.10362694300518134, middle:0.0, tail0.0
3shot of client 32:head:0.10476190476190476, middle:0.0, tail0.0
3shot of client 33:head:0.15508021390374332, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.08108108108108109, tail0.0
3shot of client 35:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 36:head:0.08045977011494253, middle:0.0, tail0.0
3shot of client 37:head:0.18181818181818182, middle:0.0, tail0.0
3shot of client 38:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 39:head:0.14646464646464646, middle:0.0, tail0.0
round 0, local average test acc  0.0641 

round 0, local macro average F1 score  0.0021 

round 0, local weighted average F1 score  0.0037 

round 0, global test acc  0.0100 

round 0, average 3shot acc: [head: 0.0779, middle: 0.0221, tail: 0.0063] 

round 0, global 3shot acc: [head: 0.0400, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.5876, 0.5769, 1.1510, 0.8579, 0.6485, 0.7241, 0.9049, 0.9081, 0.8174,
        0.5833, 0.7826, 0.5651, 0.5696, 0.6735, 0.7034, 0.8032, 0.7873, 0.5678,
        0.5811, 0.6482, 0.6934, 0.6510, 0.5785, 0.6199, 0.5809, 0.7467, 0.7098,
        0.8797, 0.6117, 0.5966, 0.6421, 0.6669, 0.7493, 0.8156, 0.5885, 0.5538,
        0.5939, 0.5842, 0.5788, 0.6459, 0.6269, 0.5797, 0.5840, 0.6274, 0.6861,
        0.5712, 0.5860, 0.5915, 0.5981, 0.6229, 0.5731, 0.6172, 0.5848, 0.6581,
        0.6354, 0.5719, 0.5768, 0.7089, 0.6092, 0.5644, 0.5771, 0.5930, 0.6343,
        0.5859, 0.5829, 0.5839, 0.5866, 0.6060, 0.5918, 0.6463, 0.5849, 0.5899,
        0.5646, 0.5671, 0.5808, 0.5860, 0.5946, 0.5908, 0.6332, 0.5743, 0.5780,
        0.5746, 0.5625, 0.5898, 0.5818, 0.5837, 0.5656, 0.5980, 0.5868, 0.5894,
        0.5832, 0.5846, 0.5881, 0.5677, 0.5843, 0.5835, 0.6077, 0.5770, 0.6074,
        0.6633], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.6384, 0.6139, 0.6511, 0.6057, 0.6023, 0.5892, 0.5974, 0.6031, 0.6179,
        0.5981, 0.6085, 0.6043, 0.5774, 0.5934, 0.5988, 0.6176, 0.6056, 0.5706,
        0.5930, 0.5867, 0.6047, 0.6025, 0.5959, 0.5863, 0.5734, 0.5838, 0.5802,
        0.5610, 0.5895, 0.5928, 0.5915, 0.5856, 0.5986, 0.5798, 0.5832, 0.5988,
        0.5887, 0.5887, 0.5786, 0.5887, 0.5752, 0.5715, 0.5788, 0.5819, 0.5770,
        0.5888, 0.5792, 0.5732, 0.5682, 0.5845, 0.5891, 0.5867, 0.5667, 0.5831,
        0.5792, 0.6064, 0.5714, 0.5666, 0.5781, 0.5998, 0.5652, 0.5782, 0.5866,
        0.5753, 0.5794, 0.5851, 0.5730, 0.5785, 0.5847, 0.5757, 0.5901, 0.5880,
        0.5645, 0.5803, 0.5766, 0.5877, 0.5899, 0.5763, 0.5659, 0.5905, 0.5763,
        0.5609, 0.5822, 0.5790, 0.5858, 0.5827, 0.5756, 0.5868, 0.5680, 0.5924,
        0.5740, 0.5604, 0.5610, 0.5805, 0.5799, 0.5821, 0.5736, 0.5685, 0.5850,
        0.5728], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([2.4927], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.0736196319018405, middle:0.0, tail0.0
3shot of client 1:head:0.143646408839779, middle:0.0, tail0.0
3shot of client 2:head:0.08955223880597014, middle:0.0, tail0.0
3shot of client 3:head:0.0, middle:0.016129032258064516, tail0.0
3shot of client 4:head:0.0, middle:0.1951219512195122, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.16666666666666666
3shot of client 6:head:0.07317073170731707, middle:0.0, tail0.0
3shot of client 7:head:0.15286624203821655, middle:0.0, tail0.0
3shot of client 8:head:0.28888888888888886, middle:0.0, tail0.0
3shot of client 9:head:0.04516129032258064, middle:0.0, tail0.0
3shot of client 10:head:0.11214953271028037, middle:0.0, tail0.0
3shot of client 11:head:0.04, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.08333333333333333
3shot of client 13:head:0.1452991452991453, middle:0.0, tail0.0
3shot of client 14:head:0.233502538071066, middle:0.0, tail0.0
3shot of client 15:head:0.058823529411764705, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.02702702702702703, tail0.0
3shot of client 17:head:0.18471337579617833, middle:0.0, tail0.0
3shot of client 18:head:0.14661654135338345, middle:0.0, tail0.0
3shot of client 19:head:0.14227642276422764, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0425531914893617, tail0.0
3shot of client 21:head:0.06808510638297872, middle:0.0, tail0.0
3shot of client 22:head:0.08860759493670886, middle:0.0, tail0.0
3shot of client 23:head:0.05434782608695652, middle:0.0, tail0.0
3shot of client 24:head:0.044444444444444446, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.06451612903225806, tail0.0
3shot of client 26:head:0.1794871794871795, middle:0.0, tail0.0
3shot of client 27:head:0.1259259259259259, middle:0.0, tail0.0
3shot of client 28:head:0.22330097087378642, middle:0.0, tail0.0
3shot of client 29:head:0.04807692307692308, middle:0.0, tail0.0
3shot of client 30:head:0.10810810810810811, middle:0.0, tail0.0
3shot of client 31:head:0.10362694300518134, middle:0.0, tail0.0
3shot of client 32:head:0.20952380952380953, middle:0.0, tail0.0
3shot of client 33:head:0.15508021390374332, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.2
3shot of client 35:head:0.22608695652173913, middle:0.0, tail0.0
3shot of client 36:head:0.05172413793103448, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.17777777777777778, tail0.0
3shot of client 38:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 39:head:0.14646464646464646, middle:0.0, tail0.0
round 1, local average test acc  0.0757 

round 1, local macro average F1 score  0.0041 

round 1, local weighted average F1 score  0.0117 

round 1, global test acc  0.0142 

round 1, average 3shot acc: [head: 0.0951, middle: 0.0131, tail: 0.0112] 

round 1, global 3shot acc: [head: 0.0568, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.5876, 0.5769, 1.1510, 0.8579, 0.6485, 0.7241, 0.9049, 0.9081, 0.8174,
        0.5833, 0.7826, 0.5651, 0.5696, 0.6735, 0.7034, 0.8032, 0.7873, 0.5678,
        0.5811, 0.6482, 0.6934, 0.6510, 0.5785, 0.6199, 0.5809, 0.7467, 0.7098,
        0.8797, 0.6117, 0.5966, 0.6421, 0.6669, 0.7493, 0.8156, 0.5885, 0.5538,
        0.5939, 0.5842, 0.5788, 0.6459, 0.6269, 0.5797, 0.5840, 0.6274, 0.6861,
        0.5712, 0.5860, 0.5915, 0.5981, 0.6229, 0.5731, 0.6172, 0.5848, 0.6581,
        0.6354, 0.5719, 0.5768, 0.7089, 0.6092, 0.5644, 0.5771, 0.5930, 0.6343,
        0.5859, 0.5829, 0.5839, 0.5866, 0.6060, 0.5918, 0.6463, 0.5849, 0.5899,
        0.5646, 0.5671, 0.5808, 0.5860, 0.5946, 0.5908, 0.6332, 0.5743, 0.5780,
        0.5746, 0.5625, 0.5898, 0.5818, 0.5837, 0.5656, 0.5980, 0.5868, 0.5894,
        0.5832, 0.5846, 0.5881, 0.5677, 0.5843, 0.5835, 0.6077, 0.5770, 0.6074,
        0.6633], device='cuda:4', grad_fn=<NormBackward1>)  0%|          | 2/500 [04:54<20:18:42, 146.83s/it]  1%|          | 3/500 [07:23<20:24:22, 147.81s/it]
g_aux tensor([0.7227, 0.6703, 0.7571, 0.6416, 0.6409, 0.6276, 0.6493, 0.6520, 0.6536,
        0.6281, 0.6708, 0.7245, 0.6110, 0.6587, 0.6838, 0.6460, 0.6106, 0.6035,
        0.6224, 0.6276, 0.6461, 0.6599, 0.6481, 0.6206, 0.6180, 0.6272, 0.5798,
        0.5722, 0.6053, 0.6136, 0.6263, 0.5912, 0.6530, 0.5894, 0.6024, 0.6003,
        0.5935, 0.6071, 0.5759, 0.5895, 0.5761, 0.5899, 0.5816, 0.5876, 0.5791,
        0.5959, 0.5810, 0.5762, 0.5730, 0.5933, 0.5988, 0.5880, 0.5777, 0.5839,
        0.5854, 0.6015, 0.5743, 0.5682, 0.5729, 0.5984, 0.5671, 0.5784, 0.5905,
        0.5696, 0.5762, 0.5846, 0.5766, 0.5800, 0.5847, 0.5763, 0.5920, 0.5866,
        0.5642, 0.5793, 0.5741, 0.5855, 0.5919, 0.5771, 0.5640, 0.5936, 0.5759,
        0.5607, 0.5826, 0.5808, 0.5824, 0.5854, 0.5756, 0.5896, 0.5706, 0.5926,
        0.5789, 0.5605, 0.5624, 0.5844, 0.5808, 0.5835, 0.5746, 0.5727, 0.5840,
        0.5749], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([3.1086], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.0736196319018405, middle:0.0, tail0.0
3shot of client 1:head:0.20994475138121546, middle:0.0, tail0.0
3shot of client 2:head:0.08955223880597014, middle:0.0, tail0.0
3shot of client 3:head:0.19831223628691982, middle:0.0, tail0.0
3shot of client 4:head:0.1452513966480447, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.16666666666666666
3shot of client 6:head:0.07317073170731707, middle:0.0, tail0.0
3shot of client 7:head:0.267515923566879, middle:0.025, tail0.0
3shot of client 8:head:0.07407407407407407, middle:0.0, tail0.0
3shot of client 9:head:0.0, middle:0.11428571428571428, tail0.0
3shot of client 10:head:0.11214953271028037, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.25
3shot of client 12:head:0.0, middle:0.08, tail0.0
3shot of client 13:head:0.017094017094017096, middle:0.0625, tail0.0
3shot of client 14:head:0.233502538071066, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.14285714285714285
3shot of client 16:head:0.006134969325153374, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.18471337579617833, middle:0.0, tail0.0
3shot of client 18:head:0.14661654135338345, middle:0.0, tail0.0
3shot of client 19:head:0.14227642276422764, middle:0.0, tail0.0
3shot of client 20:head:0.16939890710382513, middle:0.02127659574468085, tail0.0
3shot of client 21:head:0.04680851063829787, middle:0.0, tail0.0
3shot of client 22:head:0.006329113924050633, middle:0.08333333333333333, tail0.0
3shot of client 23:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 24:head:0.26666666666666666, middle:0.0, tail0.0
3shot of client 25:head:0.03125, middle:0.0, tail0.0
3shot of client 26:head:0.1794871794871795, middle:0.0, tail0.0
3shot of client 27:head:0.1111111111111111, middle:0.0, tail0.0
3shot of client 28:head:0.05825242718446602, middle:0.04, tail0.0
3shot of client 29:head:0.11057692307692307, middle:0.0, tail0.0
3shot of client 30:head:0.10810810810810811, middle:0.0, tail0.0
3shot of client 31:head:0.17616580310880828, middle:0.0, tail0.0
3shot of client 32:head:0.2, middle:0.0, tail0.0
3shot of client 33:head:0.016042780748663103, middle:0.06818181818181818, tail0.0
3shot of client 34:head:0.006134969325153374, middle:0.0, tail0.2
3shot of client 35:head:0.22608695652173913, middle:0.0, tail0.0
3shot of client 36:head:0.005747126436781609, middle:0.06521739130434782, tail0.0
3shot of client 37:head:0.0, middle:0.17777777777777778, tail0.0
3shot of client 38:head:0.0, middle:0.05263157894736842, tail0.0
3shot of client 39:head:0.005050505050505051, middle:0.05555555555555555, tail0.0
round 2, local average test acc  0.0770 

round 2, local macro average F1 score  0.0062 

round 2, local weighted average F1 score  0.0194 

round 2, global test acc  0.0119 

round 2, average 3shot acc: [head: 0.0935, middle: 0.0238, tail: 0.0190] 

round 2, global 3shot acc: [head: 0.0476, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.5876, 0.5769, 1.1510, 0.8579, 0.6485, 0.7241, 0.9049, 0.9081, 0.8174,
        0.5833, 0.7826, 0.5651, 0.5696, 0.6735, 0.7034, 0.8032, 0.7873, 0.5678,
        0.5811, 0.6482, 0.6934, 0.6510, 0.5785, 0.6199, 0.5809, 0.7467, 0.7098,
        0.8797, 0.6117, 0.5966, 0.6421, 0.6669, 0.7493, 0.8156, 0.5885, 0.5538,
        0.5939, 0.5842, 0.5788, 0.6459, 0.6269, 0.5797, 0.5840, 0.6274, 0.6861,
        0.5712, 0.5860, 0.5915, 0.5981, 0.6229, 0.5731, 0.6172, 0.5848, 0.6581,
        0.6354, 0.5719, 0.5768, 0.7089, 0.6092, 0.5644, 0.5771, 0.5930, 0.6343,
        0.5859, 0.5829, 0.5839, 0.5866, 0.6060, 0.5918, 0.6463, 0.5849, 0.5899,
        0.5646, 0.5671, 0.5808, 0.5860, 0.5946, 0.5908, 0.6332, 0.5743, 0.5780,
        0.5746, 0.5625, 0.5898, 0.5818, 0.5837, 0.5656, 0.5980, 0.5868, 0.5894,
        0.5832, 0.5846, 0.5881, 0.5677, 0.5843, 0.5835, 0.6077, 0.5770, 0.6074,
        0.6633], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.8009, 0.7160, 0.9485, 0.7101, 0.7641, 0.6877, 0.7684, 0.8064, 0.7401,
        0.7352, 0.7958, 0.8466, 0.7432, 0.7447, 0.7524, 0.7118, 0.6296, 0.7015,
        0.6455, 0.6583, 0.7305, 0.6750, 0.7082, 0.6912, 0.6729, 0.6493, 0.6031,
        0.5826, 0.6738, 0.6834, 0.6506, 0.6085, 0.6992, 0.6065, 0.6165, 0.6070,
        0.5972, 0.6443, 0.6028, 0.5997, 0.5853, 0.6037, 0.5974, 0.5929, 0.5826,
        0.6071, 0.5876, 0.5748, 0.5954, 0.6232, 0.6039, 0.5877, 0.5937, 0.6075,
        0.5876, 0.6124, 0.5808, 0.5637, 0.5745, 0.6041, 0.5688, 0.5819, 0.5917,
        0.5739, 0.5774, 0.5893, 0.5772, 0.5798, 0.5852, 0.5755, 0.5898, 0.5903,
        0.5654, 0.5841, 0.5734, 0.5863, 0.5921, 0.5766, 0.5690, 0.5944, 0.5776,
        0.5592, 0.5851, 0.5828, 0.5819, 0.5864, 0.5792, 0.5884, 0.5722, 0.5940,
        0.5800, 0.5616, 0.5625, 0.5835, 0.5816, 0.5851, 0.5753, 0.5742, 0.5841,
        0.5748], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([3.5134], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.0736196319018405, middle:0.0, tail0.0
3shot of client 1:head:0.24861878453038674, middle:0.0, tail0.0
3shot of client 2:head:0.08955223880597014, middle:0.0, tail0.0
3shot of client 3:head:0.12658227848101267, middle:0.03225806451612903, tail0.0
3shot of client 4:head:0.03910614525139665, middle:0.0, tail0.2
3shot of client 5:head:0.32075471698113206, middle:0.0, tail0.0
3shot of client 6:head:0.05853658536585366, middle:0.018518518518518517, tail0.0
3shot of client 7:head:0.267515923566879, middle:0.0, tail0.0
3shot of client 8:head:0.26666666666666666, middle:0.0, tail0.0
3shot of client 9:head:0.10967741935483871, middle:0.02857142857142857, tail0.0
3shot of client 10:head:0.11214953271028037, middle:0.0, tail0.0
3shot of client 11:head:0.072, middle:0.0, tail0.0
3shot of client 12:head:0.07446808510638298, middle:0.04, tail0.0
3shot of client 13:head:0.1794871794871795, middle:0.0, tail0.0
3shot of client 14:head:0.050761421319796954, middle:0.0, tail0.08333333333333333
3shot of client 15:head:0.08403361344537816, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.05405405405405406, tail0.0
3shot of client 17:head:0.05732484076433121, middle:0.0, tail0.0
3shot of client 18:head:0.13533834586466165, middle:0.0, tail0.0
3shot of client 19:head:0.14227642276422764, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0851063829787234, tail0.08333333333333333
3shot of client 21:head:0.05106382978723404, middle:0.01694915254237288, tail0.0
3shot of client 22:head:0.16455696202531644, middle:0.0, tail0.0
3shot of client 23:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 24:head:0.26666666666666666, middle:0.0, tail0.0
3shot of client 25:head:0.078125, middle:0.0967741935483871, tail0.0
3shot of client 26:head:0.1794871794871795, middle:0.0, tail0.0
3shot of client 27:head:0.14074074074074075, middle:0.125, tail0.0
3shot of client 28:head:0.09223300970873786, middle:0.0, tail0.0
3shot of client 29:head:0.057692307692307696, middle:0.04081632653061224, tail0.0
3shot of client 30:head:0.02702702702702703, middle:0.1, tail0.16666666666666666
3shot of client 31:head:0.12435233160621761, middle:0.0, tail0.09090909090909091
3shot of client 32:head:0.06666666666666667, middle:0.12, tail0.0  1%|          | 4/500 [09:49<20:14:25, 146.91s/it]  1%|          | 5/500 [12:16<20:12:07, 146.92s/it]
3shot of client 33:head:0.06951871657754011, middle:0.0, tail0.08333333333333333
3shot of client 34:head:0.03067484662576687, middle:0.08108108108108109, tail0.0
3shot of client 35:head:0.24347826086956523, middle:0.0, tail0.0
3shot of client 36:head:0.005747126436781609, middle:0.021739130434782608, tail0.0
3shot of client 37:head:0.0, middle:0.17777777777777778, tail0.0
3shot of client 38:head:0.3958333333333333, middle:0.05263157894736842, tail0.0
3shot of client 39:head:0.1717171717171717, middle:0.018518518518518517, tail0.0
round 3, local average test acc  0.0960 

round 3, local macro average F1 score  0.0142 

round 3, local weighted average F1 score  0.0485 

round 3, global test acc  0.0172 

round 3, average 3shot acc: [head: 0.1179, middle: 0.0277, tail: 0.0177] 

round 3, global 3shot acc: [head: 0.0688, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.5876, 0.5769, 1.1510, 0.8579, 0.6485, 0.7241, 0.9049, 0.9081, 0.8174,
        0.5833, 0.7826, 0.5651, 0.5696, 0.6735, 0.7034, 0.8032, 0.7873, 0.5678,
        0.5811, 0.6482, 0.6934, 0.6510, 0.5785, 0.6199, 0.5809, 0.7467, 0.7098,
        0.8797, 0.6117, 0.5966, 0.6421, 0.6669, 0.7493, 0.8156, 0.5885, 0.5538,
        0.5939, 0.5842, 0.5788, 0.6459, 0.6269, 0.5797, 0.5840, 0.6274, 0.6861,
        0.5712, 0.5860, 0.5915, 0.5981, 0.6229, 0.5731, 0.6172, 0.5848, 0.6581,
        0.6354, 0.5719, 0.5768, 0.7089, 0.6092, 0.5644, 0.5771, 0.5930, 0.6343,
        0.5859, 0.5829, 0.5839, 0.5866, 0.6060, 0.5918, 0.6463, 0.5849, 0.5899,
        0.5646, 0.5671, 0.5808, 0.5860, 0.5946, 0.5908, 0.6332, 0.5743, 0.5780,
        0.5746, 0.5625, 0.5898, 0.5818, 0.5837, 0.5656, 0.5980, 0.5868, 0.5894,
        0.5832, 0.5846, 0.5881, 0.5677, 0.5843, 0.5835, 0.6077, 0.5770, 0.6074,
        0.6633], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.8075, 0.8046, 1.0388, 0.7679, 0.8594, 0.7793, 0.9099, 0.9723, 0.8375,
        0.8294, 0.8858, 0.9414, 0.8140, 0.8147, 0.8630, 0.7879, 0.6653, 0.7295,
        0.7055, 0.6876, 0.8336, 0.7059, 0.7724, 0.7309, 0.7267, 0.6773, 0.6354,
        0.5986, 0.6944, 0.6838, 0.6862, 0.6542, 0.7287, 0.6307, 0.6259, 0.6360,
        0.6025, 0.6934, 0.6304, 0.6071, 0.5967, 0.6314, 0.6234, 0.6113, 0.5901,
        0.6273, 0.5895, 0.5824, 0.5966, 0.6644, 0.6194, 0.5907, 0.6051, 0.6196,
        0.5938, 0.6307, 0.5837, 0.5688, 0.5798, 0.6100, 0.5793, 0.5797, 0.5974,
        0.5740, 0.5770, 0.5897, 0.5924, 0.5867, 0.5886, 0.5748, 0.5931, 0.5958,
        0.5644, 0.5848, 0.5753, 0.5854, 0.5915, 0.5775, 0.5699, 0.5953, 0.5804,
        0.5607, 0.5870, 0.5824, 0.5891, 0.5862, 0.5810, 0.5874, 0.5683, 0.5921,
        0.5785, 0.5577, 0.5642, 0.5834, 0.5810, 0.5853, 0.5766, 0.5720, 0.5840,
        0.5757], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([3.8995], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.1411042944785276, middle:0.0, tail0.0
3shot of client 1:head:0.3812154696132597, middle:0.047619047619047616, tail0.0
3shot of client 2:head:0.08955223880597014, middle:0.0, tail0.0
3shot of client 3:head:0.14345991561181434, middle:0.016129032258064516, tail0.0
3shot of client 4:head:0.2011173184357542, middle:0.0, tail0.0
3shot of client 5:head:0.32075471698113206, middle:0.0, tail0.0
3shot of client 6:head:0.2097560975609756, middle:0.07407407407407407, tail0.0
3shot of client 7:head:0.19745222929936307, middle:0.0, tail0.1111111111111111
3shot of client 8:head:0.3037037037037037, middle:0.0, tail0.0
3shot of client 9:head:0.15483870967741936, middle:0.05714285714285714, tail0.0
3shot of client 10:head:0.19626168224299065, middle:0.0, tail0.0
3shot of client 11:head:0.176, middle:0.0, tail0.0
3shot of client 12:head:0.07446808510638298, middle:0.1, tail0.0
3shot of client 13:head:0.17094017094017094, middle:0.0, tail0.0
3shot of client 14:head:0.116751269035533, middle:0.0, tail0.08333333333333333
3shot of client 15:head:0.03361344537815126, middle:0.12903225806451613, tail0.0
3shot of client 16:head:0.20245398773006135, middle:0.02702702702702703, tail0.0
3shot of client 17:head:0.08917197452229299, middle:0.0, tail0.0
3shot of client 18:head:0.15037593984962405, middle:0.01694915254237288, tail0.058823529411764705
3shot of client 19:head:0.16666666666666666, middle:0.0, tail0.0
3shot of client 20:head:0.0273224043715847, middle:0.10638297872340426, tail0.08333333333333333
3shot of client 21:head:0.10212765957446808, middle:0.06779661016949153, tail0.07692307692307693
3shot of client 22:head:0.20253164556962025, middle:0.027777777777777776, tail0.0
3shot of client 23:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 24:head:0.05185185185185185, middle:0.0, tail0.0
3shot of client 25:head:0.109375, middle:0.0967741935483871, tail0.0
3shot of client 26:head:0.18803418803418803, middle:0.0, tail0.0
3shot of client 27:head:0.17037037037037037, middle:0.125, tail0.0
3shot of client 28:head:0.13106796116504854, middle:0.02, tail0.0
3shot of client 29:head:0.0673076923076923, middle:0.061224489795918366, tail0.0
3shot of client 30:head:0.08108108108108109, middle:0.1, tail0.0
3shot of client 31:head:0.13471502590673576, middle:0.0, tail0.0
3shot of client 32:head:0.14285714285714285, middle:0.12, tail0.0
3shot of client 33:head:0.08021390374331551, middle:0.11363636363636363, tail0.0
3shot of client 34:head:0.12883435582822086, middle:0.0, tail0.0
3shot of client 35:head:0.2, middle:0.0, tail0.0
3shot of client 36:head:0.25862068965517243, middle:0.0, tail0.0
3shot of client 37:head:0.06060606060606061, middle:0.0, tail0.0
3shot of client 38:head:0.3680555555555556, middle:0.0, tail0.0
3shot of client 39:head:0.1717171717171717, middle:0.0, tail0.0
round 4, local average test acc  0.1261 

round 4, local macro average F1 score  0.0339 

round 4, local weighted average F1 score  0.0934 

round 4, global test acc  0.0370 

round 4, average 3shot acc: [head: 0.1560, middle: 0.0327, tail: 0.0103] 

round 4, global 3shot acc: [head: 0.1440, middle: 0.0040, tail: 0.0000] 

l_head tensor([0.5876, 0.5769, 1.1510, 0.8579, 0.6485, 0.7241, 0.9049, 0.9081, 0.8174,
        0.5833, 0.7826, 0.5651, 0.5696, 0.6735, 0.7034, 0.8032, 0.7873, 0.5678,
        0.5811, 0.6482, 0.6934, 0.6510, 0.5785, 0.6199, 0.5809, 0.7467, 0.7098,
        0.8797, 0.6117, 0.5966, 0.6421, 0.6669, 0.7493, 0.8156, 0.5885, 0.5538,
        0.5939, 0.5842, 0.5788, 0.6459, 0.6269, 0.5797, 0.5840, 0.6274, 0.6861,
        0.5712, 0.5860, 0.5915, 0.5981, 0.6229, 0.5731, 0.6172, 0.5848, 0.6581,
        0.6354, 0.5719, 0.5768, 0.7089, 0.6092, 0.5644, 0.5771, 0.5930, 0.6343,
        0.5859, 0.5829, 0.5839, 0.5866, 0.6060, 0.5918, 0.6463, 0.5849, 0.5899,
        0.5646, 0.5671, 0.5808, 0.5860, 0.5946, 0.5908, 0.6332, 0.5743, 0.5780,
        0.5746, 0.5625, 0.5898, 0.5818, 0.5837, 0.5656, 0.5980, 0.5868, 0.5894,
        0.5832, 0.5846, 0.5881, 0.5677, 0.5843, 0.5835, 0.6077, 0.5770, 0.6074,
        0.6633], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.8929, 0.9463, 1.1855, 0.8477, 1.0377, 0.8403, 0.9771, 1.1361, 0.9564,
        0.9483, 1.0351, 1.1041, 0.9376, 0.9000, 0.9256, 0.8563, 0.7046, 0.8743,
        0.7894, 0.7504, 0.9126, 0.7514, 0.8377, 0.7988, 0.8083, 0.7231, 0.6576,
        0.6331, 0.7823, 0.7610, 0.7671, 0.7095, 0.7408, 0.6747, 0.6570, 0.6585,
        0.6416, 0.7234, 0.6374, 0.6321, 0.6073, 0.6449, 0.6418, 0.6345, 0.6103,
        0.6343, 0.5962, 0.6205, 0.6044, 0.6816, 0.6266, 0.5957, 0.6134, 0.6580,
        0.5950, 0.6303, 0.5894, 0.5740, 0.5877, 0.6238, 0.5919, 0.5911, 0.6045,
        0.5760, 0.5825, 0.5875, 0.5930, 0.5978, 0.5978, 0.5764, 0.5967, 0.5963,
        0.5679, 0.5915, 0.5762, 0.5842, 0.5942, 0.5785, 0.5757, 0.5936, 0.5803,
        0.5606, 0.5881, 0.5771, 0.5907, 0.5878, 0.5888, 0.5850, 0.5670, 0.5906,
        0.5791, 0.5575, 0.5642, 0.5836, 0.5804, 0.5853, 0.5774, 0.5722, 0.5847,
        0.5765], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([4.3161], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.1411042944785276, middle:0.05714285714285714, tail0.0
3shot of client 1:head:0.46408839779005523, middle:0.14285714285714285, tail0.0
3shot of client 2:head:0.08955223880597014, middle:0.0, tail0.0  1%|          | 6/500 [14:46<20:18:59, 148.06s/it]
3shot of client 3:head:0.11814345991561181, middle:0.03225806451612903, tail0.0
3shot of client 4:head:0.1564245810055866, middle:0.0, tail0.0
3shot of client 5:head:0.10377358490566038, middle:0.0, tail0.0
3shot of client 6:head:0.13658536585365855, middle:0.1111111111111111, tail0.0
3shot of client 7:head:0.22929936305732485, middle:0.0, tail0.0
3shot of client 8:head:0.3037037037037037, middle:0.0, tail0.0
3shot of client 9:head:0.01935483870967742, middle:0.11428571428571428, tail0.0
3shot of client 10:head:0.19626168224299065, middle:0.0, tail0.0
3shot of client 11:head:0.056, middle:0.0, tail0.0
3shot of client 12:head:0.1702127659574468, middle:0.0, tail0.0
3shot of client 13:head:0.19658119658119658, middle:0.03125, tail0.0
3shot of client 14:head:0.116751269035533, middle:0.0, tail0.08333333333333333
3shot of client 15:head:0.11764705882352941, middle:0.0, tail0.0
3shot of client 16:head:0.17177914110429449, middle:0.05405405405405406, tail0.0
3shot of client 17:head:0.2484076433121019, middle:0.0, tail0.0
3shot of client 18:head:0.11654135338345864, middle:0.03389830508474576, tail0.058823529411764705
3shot of client 19:head:0.1991869918699187, middle:0.0, tail0.0
3shot of client 20:head:0.11475409836065574, middle:0.0425531914893617, tail0.08333333333333333
3shot of client 21:head:0.0851063829787234, middle:0.13559322033898305, tail0.15384615384615385
3shot of client 22:head:0.22151898734177214, middle:0.027777777777777776, tail0.0
3shot of client 23:head:0.07608695652173914, middle:0.0, tail0.0
3shot of client 24:head:0.044444444444444446, middle:0.0, tail0.2857142857142857
3shot of client 25:head:0.2109375, middle:0.0, tail0.0
3shot of client 26:head:0.24786324786324787, middle:0.10714285714285714, tail0.0
3shot of client 27:head:0.17037037037037037, middle:0.09375, tail0.0
3shot of client 28:head:0.16019417475728157, middle:0.02, tail0.0
3shot of client 29:head:0.25, middle:0.04081632653061224, tail0.09090909090909091
3shot of client 30:head:0.06306306306306306, middle:0.16666666666666666, tail0.16666666666666666
3shot of client 31:head:0.15544041450777202, middle:0.0, tail0.09090909090909091
3shot of client 32:head:0.24761904761904763, middle:0.08, tail0.0
3shot of client 33:head:0.1711229946524064, middle:0.09090909090909091, tail0.0
3shot of client 34:head:0.018404907975460124, middle:0.0, tail0.1
3shot of client 35:head:0.12173913043478261, middle:0.03333333333333333, tail0.0
3shot of client 36:head:0.25862068965517243, middle:0.0, tail0.0
3shot of client 37:head:0.08080808080808081, middle:0.0, tail0.0
3shot of client 38:head:0.3194444444444444, middle:0.05263157894736842, tail0.0
3shot of client 39:head:0.17676767676767677, middle:0.018518518518518517, tail0.0
round 5, local average test acc  0.1334 

round 5, local macro average F1 score  0.0334 

round 5, local weighted average F1 score  0.0896 

round 5, global test acc  0.0429 

round 5, average 3shot acc: [head: 0.1636, middle: 0.0372, tail: 0.0278] 

round 5, global 3shot acc: [head: 0.1716, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.5876, 0.5769, 1.1510, 0.8579, 0.6485, 0.7241, 0.9049, 0.9081, 0.8174,
        0.5833, 0.7826, 0.5651, 0.5696, 0.6735, 0.7034, 0.8032, 0.7873, 0.5678,
        0.5811, 0.6482, 0.6934, 0.6510, 0.5785, 0.6199, 0.5809, 0.7467, 0.7098,
        0.8797, 0.6117, 0.5966, 0.6421, 0.6669, 0.7493, 0.8156, 0.5885, 0.5538,
        0.5939, 0.5842, 0.5788, 0.6459, 0.6269, 0.5797, 0.5840, 0.6274, 0.6861,
        0.5712, 0.5860, 0.5915, 0.5981, 0.6229, 0.5731, 0.6172, 0.5848, 0.6581,
        0.6354, 0.5719, 0.5768, 0.7089, 0.6092, 0.5644, 0.5771, 0.5930, 0.6343,
        0.5859, 0.5829, 0.5839, 0.5866, 0.6060, 0.5918, 0.6463, 0.5849, 0.5899,
        0.5646, 0.5671, 0.5808, 0.5860, 0.5946, 0.5908, 0.6332, 0.5743, 0.5780,
        0.5746, 0.5625, 0.5898, 0.5818, 0.5837, 0.5656, 0.5980, 0.5868, 0.5894,
        0.5832, 0.5846, 0.5881, 0.5677, 0.5843, 0.5835, 0.6077, 0.5770, 0.6074,
        0.6633], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.0036, 1.0001, 1.3568, 0.9027, 1.1816, 0.9555, 1.0749, 1.2583, 1.0892,
        1.1191, 1.1993, 1.2082, 1.0248, 0.9816, 0.9633, 0.9609, 0.7445, 0.9724,
        0.8345, 0.8272, 0.9869, 0.8116, 0.8992, 0.9199, 0.8789, 0.7689, 0.6779,
        0.6903, 0.8401, 0.8451, 0.8061, 0.7422, 0.7624, 0.7399, 0.6776, 0.6703,
        0.6585, 0.7275, 0.6526, 0.6459, 0.6182, 0.6465, 0.6475, 0.6479, 0.6192,
        0.6403, 0.5984, 0.6386, 0.6231, 0.7157, 0.6391, 0.6077, 0.6537, 0.6951,
        0.6004, 0.6391, 0.5926, 0.5896, 0.5919, 0.6436, 0.6235, 0.6095, 0.6170,
        0.5747, 0.5865, 0.5904, 0.5955, 0.6026, 0.5957, 0.5843, 0.6033, 0.6092,
        0.5686, 0.6045, 0.5772, 0.5844, 0.5964, 0.5766, 0.5776, 0.5929, 0.5825,
        0.5612, 0.5920, 0.5797, 0.5933, 0.5862, 0.5912, 0.5877, 0.5658, 0.5901,
        0.5740, 0.5568, 0.5633, 0.5814, 0.5809, 0.5888, 0.5781, 0.5738, 0.5833,
        0.5780], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([4.6470], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.2392638036809816, middle:0.11428571428571428, tail0.0
3shot of client 1:head:0.30386740331491713, middle:0.16666666666666666, tail0.0
3shot of client 2:head:0.08955223880597014, middle:0.02857142857142857, tail0.0
3shot of client 3:head:0.14345991561181434, middle:0.016129032258064516, tail0.0
3shot of client 4:head:0.1452513966480447, middle:0.0, tail0.0
3shot of client 5:head:0.10377358490566038, middle:0.038461538461538464, tail0.0
3shot of client 6:head:0.18536585365853658, middle:0.07407407407407407, tail0.09090909090909091
3shot of client 7:head:0.1337579617834395, middle:0.05, tail0.0
3shot of client 8:head:0.2740740740740741, middle:0.0, tail0.0
3shot of client 9:head:0.05161290322580645, middle:0.11428571428571428, tail0.1
3shot of client 10:head:0.1588785046728972, middle:0.038461538461538464, tail0.0
3shot of client 11:head:0.048, middle:0.09375, tail0.25
3shot of client 12:head:0.23404255319148937, middle:0.0, tail0.0
3shot of client 13:head:0.20512820512820512, middle:0.09375, tail0.0
3shot of client 14:head:0.29949238578680204, middle:0.023809523809523808, tail0.0
3shot of client 15:head:0.10084033613445378, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.15950920245398773, middle:0.08108108108108109, tail0.0
3shot of client 17:head:0.08917197452229299, middle:0.024390243902439025, tail0.0
3shot of client 18:head:0.17669172932330826, middle:0.05084745762711865, tail0.0
3shot of client 19:head:0.18699186991869918, middle:0.14035087719298245, tail0.0
3shot of client 20:head:0.0, middle:0.0425531914893617, tail0.16666666666666666
3shot of client 21:head:0.08936170212765958, middle:0.05084745762711865, tail0.0
3shot of client 22:head:0.2088607594936709, middle:0.027777777777777776, tail0.0
3shot of client 23:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 24:head:0.0, middle:0.08108108108108109, tail0.2857142857142857
3shot of client 25:head:0.3125, middle:0.0, tail0.125
3shot of client 26:head:0.24786324786324787, middle:0.07142857142857142, tail0.0
3shot of client 27:head:0.1037037037037037, middle:0.0625, tail0.0
3shot of client 28:head:0.12135922330097088, middle:0.0, tail0.0
3shot of client 29:head:0.20673076923076922, middle:0.061224489795918366, tail0.18181818181818182
3shot of client 30:head:0.11711711711711711, middle:0.2, tail0.3333333333333333
3shot of client 31:head:0.12435233160621761, middle:0.04081632653061224, tail0.09090909090909091
3shot of client 32:head:0.19047619047619047, middle:0.08, tail0.0
3shot of client 33:head:0.1711229946524064, middle:0.0, tail0.0
3shot of client 34:head:0.024539877300613498, middle:0.0, tail0.1
3shot of client 35:head:0.13043478260869565, middle:0.1, tail0.0
3shot of client 36:head:0.25862068965517243, middle:0.0, tail0.0
3shot of client 37:head:0.08080808080808081, middle:0.0, tail0.0
3shot of client 38:head:0.375, middle:0.0, tail0.0
3shot of client 39:head:0.10606060606060606, middle:0.018518518518518517, tail0.08333333333333333
round 6, local average test acc  0.1312 

round 6, local macro average F1 score  0.0391 

round 6, local weighted average F1 score  0.0856 

round 6, global test acc  0.0520 
  1%|▏         | 7/500 [17:16<20:22:37, 148.80s/it]  2%|▏         | 8/500 [19:43<20:15:29, 148.23s/it]
round 6, average 3shot acc: [head: 0.1560, middle: 0.0513, tail: 0.0452] 

round 6, global 3shot acc: [head: 0.1912, middle: 0.0168, tail: 0.0000] 

l_head tensor([0.5877, 0.5770, 1.5147, 0.9876, 0.6890, 0.8747, 1.3360, 1.3352, 1.2861,
        0.5834, 0.8188, 0.5653, 0.5698, 0.8700, 0.8517, 1.0873, 0.8556, 0.5679,
        0.5813, 0.6982, 0.8416, 0.7676, 0.5787, 0.8324, 0.5811, 0.9610, 0.8553,
        1.2667, 0.7004, 0.5967, 0.8485, 0.8694, 0.8258, 1.0347, 0.6081, 0.5540,
        0.5941, 0.5843, 0.5790, 0.6810, 0.6893, 0.5799, 0.5841, 0.7584, 0.7013,
        0.5713, 0.6199, 0.5917, 0.6785, 0.7231, 0.5732, 0.6454, 0.5850, 0.7201,
        0.6730, 0.5721, 0.6131, 0.7341, 0.6690, 0.5646, 0.5772, 0.5932, 0.7177,
        0.5861, 0.5831, 0.5841, 0.5868, 0.6943, 0.5919, 0.7046, 0.5851, 0.6288,
        0.5647, 0.5673, 0.5809, 0.5862, 0.5947, 0.5909, 0.6503, 0.5744, 0.5782,
        0.5748, 0.5627, 0.5899, 0.5819, 0.5838, 0.5657, 0.7259, 0.5869, 0.5895,
        0.5834, 0.5847, 0.5882, 0.5679, 0.5844, 0.5837, 0.6365, 0.5771, 0.6658,
        0.6908], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.0514, 1.1239, 1.4506, 1.0545, 1.2488, 1.0415, 1.1568, 1.3835, 1.1947,
        1.1856, 1.3024, 1.3313, 1.1100, 1.1003, 1.0860, 1.0652, 0.7987, 1.0304,
        0.9909, 0.8989, 1.0622, 0.8922, 0.9860, 1.0575, 0.9742, 0.7971, 0.7190,
        0.7166, 0.9082, 0.9343, 0.8994, 0.7792, 0.8179, 0.7941, 0.7228, 0.6933,
        0.6697, 0.7705, 0.6736, 0.6799, 0.6298, 0.6813, 0.6868, 0.6521, 0.6285,
        0.6566, 0.6113, 0.6539, 0.6164, 0.7435, 0.6475, 0.6180, 0.6688, 0.7267,
        0.6066, 0.6465, 0.5993, 0.6116, 0.5992, 0.6561, 0.6691, 0.6125, 0.6256,
        0.5763, 0.5889, 0.5889, 0.5995, 0.6081, 0.5999, 0.5879, 0.6251, 0.6175,
        0.5724, 0.6134, 0.5827, 0.5863, 0.6045, 0.5785, 0.5811, 0.5942, 0.5850,
        0.5621, 0.6009, 0.5866, 0.5925, 0.5877, 0.5933, 0.5884, 0.5640, 0.5934,
        0.5713, 0.5576, 0.5660, 0.5810, 0.5812, 0.5971, 0.5765, 0.5750, 0.5817,
        0.5800], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([4.9858], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.2085889570552147, middle:0.17142857142857143, tail0.0
3shot of client 1:head:0.27624309392265195, middle:0.23809523809523808, tail0.0
3shot of client 2:head:0.16417910447761194, middle:0.0, tail0.0
3shot of client 3:head:0.3333333333333333, middle:0.0, tail0.0
3shot of client 4:head:0.13966480446927373, middle:0.024390243902439025, tail0.0
3shot of client 5:head:0.11320754716981132, middle:0.0, tail0.0
3shot of client 6:head:0.25853658536585367, middle:0.07407407407407407, tail0.0
3shot of client 7:head:0.17834394904458598, middle:0.125, tail0.1111111111111111
3shot of client 8:head:0.2962962962962963, middle:0.0, tail0.0
3shot of client 9:head:0.0967741935483871, middle:0.05714285714285714, tail0.1
3shot of client 10:head:0.19626168224299065, middle:0.038461538461538464, tail0.0
3shot of client 11:head:0.216, middle:0.0, tail0.0
3shot of client 12:head:0.2074468085106383, middle:0.08, tail0.0
3shot of client 13:head:0.21367521367521367, middle:0.15625, tail0.0
3shot of client 14:head:0.20812182741116753, middle:0.09523809523809523, tail0.0
3shot of client 15:head:0.11764705882352941, middle:0.0, tail0.0
3shot of client 16:head:0.22699386503067484, middle:0.0, tail0.0
3shot of client 17:head:0.2484076433121019, middle:0.04878048780487805, tail0.0
3shot of client 18:head:0.18045112781954886, middle:0.1694915254237288, tail0.0
3shot of client 19:head:0.17479674796747968, middle:0.05263157894736842, tail0.07142857142857142
3shot of client 20:head:0.16939890710382513, middle:0.0425531914893617, tail0.08333333333333333
3shot of client 21:head:0.1574468085106383, middle:0.03389830508474576, tail0.0
3shot of client 22:head:0.2468354430379747, middle:0.027777777777777776, tail0.0
3shot of client 23:head:0.06521739130434782, middle:0.02127659574468085, tail0.08333333333333333
3shot of client 24:head:0.02962962962962963, middle:0.0, tail0.2857142857142857
3shot of client 25:head:0.34375, middle:0.0, tail0.0
3shot of client 26:head:0.23931623931623933, middle:0.03571428571428571, tail0.0
3shot of client 27:head:0.14074074074074075, middle:0.0625, tail0.14285714285714285
3shot of client 28:head:0.13592233009708737, middle:0.04, tail0.08333333333333333
3shot of client 29:head:0.2980769230769231, middle:0.02040816326530612, tail0.18181818181818182
3shot of client 30:head:0.10810810810810811, middle:0.23333333333333334, tail0.0
3shot of client 31:head:0.20207253886010362, middle:0.0, tail0.09090909090909091
3shot of client 32:head:0.19047619047619047, middle:0.08, tail0.0
3shot of client 33:head:0.17647058823529413, middle:0.022727272727272728, tail0.0
3shot of client 34:head:0.049079754601226995, middle:0.0, tail0.1
3shot of client 35:head:0.14782608695652175, middle:0.1, tail0.0
3shot of client 36:head:0.25862068965517243, middle:0.0, tail0.0
3shot of client 37:head:0.08080808080808081, middle:0.0, tail0.0
3shot of client 38:head:0.3055555555555556, middle:0.05263157894736842, tail0.0
3shot of client 39:head:0.1111111111111111, middle:0.1111111111111111, tail0.0
round 7, local average test acc  0.1555 

round 7, local macro average F1 score  0.0448 

round 7, local weighted average F1 score  0.1131 

round 7, global test acc  0.0474 

round 7, average 3shot acc: [head: 0.1878, middle: 0.0554, tail: 0.0333] 

round 7, global 3shot acc: [head: 0.1780, middle: 0.0116, tail: 0.0000] 

l_head tensor([0.5878, 0.5771, 1.7345, 1.1523, 0.7612, 1.0568, 1.6432, 1.7269, 1.6450,
        0.5836, 0.9337, 0.5654, 0.5699, 0.9302, 1.1304, 1.2825, 0.8910, 0.5680,
        0.5814, 0.6823, 0.9492, 0.9304, 0.5788, 0.9046, 0.5812, 1.2195, 0.8961,
        1.5257, 0.7008, 0.5968, 1.0272, 0.9861, 0.9100, 1.2189, 0.6884, 0.5541,
        0.5942, 0.5844, 0.5791, 0.8083, 0.8057, 0.5800, 0.5843, 0.7742, 0.7441,
        0.5714, 0.6835, 0.5918, 0.7704, 0.7426, 0.5733, 0.7049, 0.5851, 0.8752,
        0.6957, 0.5722, 0.6975, 0.7340, 0.7988, 0.5647, 0.5774, 0.5933, 0.7801,
        0.5862, 0.5832, 0.5842, 0.5869, 0.8036, 0.5920, 0.7629, 0.5852, 0.7314,
        0.5649, 0.5674, 0.5810, 0.5863, 0.5948, 0.5910, 0.6742, 0.5745, 0.5783,
        0.5750, 0.5628, 0.5900, 0.5820, 0.5839, 0.5658, 0.7737, 0.5870, 0.5896,
        0.5835, 0.5848, 0.5883, 0.5680, 0.5845, 0.5837, 0.6641, 0.5772, 0.7159,
        0.8073], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.1252, 1.2077, 1.5977, 1.2086, 1.3103, 1.1007, 1.2988, 1.4840, 1.3186,
        1.3142, 1.3370, 1.3981, 1.1966, 1.1482, 1.1394, 1.1731, 0.8374, 1.0683,
        1.0585, 0.9038, 1.1461, 0.9568, 1.0339, 1.1509, 1.0124, 0.8454, 0.7406,
        0.7739, 0.9281, 0.9549, 0.9653, 0.8198, 0.8719, 0.8362, 0.7411, 0.7038,
        0.6843, 0.8026, 0.7092, 0.7218, 0.6562, 0.7020, 0.7151, 0.6607, 0.6455,
        0.6757, 0.6311, 0.6773, 0.6290, 0.8354, 0.6568, 0.6379, 0.7086, 0.7362,
        0.6183, 0.6614, 0.6054, 0.6211, 0.6114, 0.6759, 0.7094, 0.6207, 0.6386,
        0.5787, 0.5890, 0.5962, 0.6004, 0.6064, 0.6065, 0.6012, 0.6214, 0.6366,
        0.5816, 0.6169, 0.5859, 0.5884, 0.6105, 0.5846, 0.5819, 0.5958, 0.5867,
        0.5612, 0.6002, 0.5881, 0.5932, 0.5881, 0.5954, 0.5882, 0.5641, 0.5935,
        0.5716, 0.5587, 0.5696, 0.5817, 0.5815, 0.6109, 0.5780, 0.5741, 0.5850,
        0.5841], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([5.3310], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.25153374233128833, middle:0.14285714285714285, tail0.0
3shot of client 1:head:0.20994475138121546, middle:0.19047619047619047, tail0.0
3shot of client 2:head:0.15671641791044777, middle:0.0, tail0.0
3shot of client 3:head:0.3037974683544304, middle:0.08064516129032258, tail0.0
3shot of client 4:head:0.1452513966480447, middle:0.04878048780487805, tail0.0
3shot of client 5:head:0.12264150943396226, middle:0.0, tail0.0
3shot of client 6:head:0.1951219512195122, middle:0.05555555555555555, tail0.0
3shot of client 7:head:0.2802547770700637, middle:0.1, tail0.0
3shot of client 8:head:0.28888888888888886, middle:0.027777777777777776, tail0.0
3shot of client 9:head:0.0967741935483871, middle:0.11428571428571428, tail0.0  2%|▏         | 9/500 [22:10<20:09:15, 147.77s/it]
3shot of client 10:head:0.14953271028037382, middle:0.038461538461538464, tail0.0
3shot of client 11:head:0.2, middle:0.0, tail0.0
3shot of client 12:head:0.22872340425531915, middle:0.02, tail0.0
3shot of client 13:head:0.2564102564102564, middle:0.125, tail0.0
3shot of client 14:head:0.23857868020304568, middle:0.07142857142857142, tail0.0
3shot of client 15:head:0.13445378151260504, middle:0.0, tail0.0
3shot of client 16:head:0.24539877300613497, middle:0.0, tail0.0
3shot of client 17:head:0.29936305732484075, middle:0.024390243902439025, tail0.0
3shot of client 18:head:0.24060150375939848, middle:0.06779661016949153, tail0.058823529411764705
3shot of client 19:head:0.2804878048780488, middle:0.03508771929824561, tail0.0
3shot of client 20:head:0.16393442622950818, middle:0.1276595744680851, tail0.08333333333333333
3shot of client 21:head:0.14893617021276595, middle:0.06779661016949153, tail0.0
3shot of client 22:head:0.2088607594936709, middle:0.027777777777777776, tail0.0
3shot of client 23:head:0.043478260869565216, middle:0.02127659574468085, tail0.08333333333333333
3shot of client 24:head:0.26666666666666666, middle:0.02702702702702703, tail0.0
3shot of client 25:head:0.2890625, middle:0.03225806451612903, tail0.0
3shot of client 26:head:0.24786324786324787, middle:0.03571428571428571, tail0.0
3shot of client 27:head:0.11851851851851852, middle:0.125, tail0.14285714285714285
3shot of client 28:head:0.1796116504854369, middle:0.0, tail0.08333333333333333
3shot of client 29:head:0.28365384615384615, middle:0.061224489795918366, tail0.09090909090909091
3shot of client 30:head:0.16216216216216217, middle:0.03333333333333333, tail0.0
3shot of client 31:head:0.19170984455958548, middle:0.0, tail0.09090909090909091
3shot of client 32:head:0.22857142857142856, middle:0.08, tail0.0
3shot of client 33:head:0.20855614973262032, middle:0.022727272727272728, tail0.0
3shot of client 34:head:0.05521472392638037, middle:0.0, tail0.0
3shot of client 35:head:0.1391304347826087, middle:0.06666666666666667, tail0.0
3shot of client 36:head:0.017241379310344827, middle:0.0, tail0.09090909090909091
3shot of client 37:head:0.020202020202020204, middle:0.0, tail0.18181818181818182
3shot of client 38:head:0.2777777777777778, middle:0.05263157894736842, tail0.0
3shot of client 39:head:0.10606060606060606, middle:0.09259259259259259, tail0.0
round 8, local average test acc  0.1574 

round 8, local macro average F1 score  0.0485 

round 8, local weighted average F1 score  0.1120 

round 8, global test acc  0.0574 

round 8, average 3shot acc: [head: 0.1920, middle: 0.0504, tail: 0.0227] 

round 8, global 3shot acc: [head: 0.1996, middle: 0.0300, tail: 0.0000] 

l_head tensor([0.5878, 0.5771, 1.7345, 1.1523, 0.7612, 1.0568, 1.6432, 1.7269, 1.6450,
        0.5836, 0.9337, 0.5654, 0.5699, 0.9302, 1.1304, 1.2825, 0.8910, 0.5680,
        0.5814, 0.6823, 0.9492, 0.9304, 0.5788, 0.9046, 0.5812, 1.2195, 0.8961,
        1.5257, 0.7008, 0.5968, 1.0272, 0.9861, 0.9100, 1.2189, 0.6884, 0.5541,
        0.5942, 0.5844, 0.5791, 0.8083, 0.8057, 0.5800, 0.5843, 0.7742, 0.7441,
        0.5714, 0.6835, 0.5918, 0.7704, 0.7426, 0.5733, 0.7049, 0.5851, 0.8752,
        0.6957, 0.5722, 0.6975, 0.7340, 0.7988, 0.5647, 0.5774, 0.5933, 0.7801,
        0.5862, 0.5832, 0.5842, 0.5869, 0.8036, 0.5920, 0.7629, 0.5852, 0.7314,
        0.5649, 0.5674, 0.5810, 0.5863, 0.5948, 0.5910, 0.6742, 0.5745, 0.5783,
        0.5750, 0.5628, 0.5900, 0.5820, 0.5839, 0.5658, 0.7737, 0.5870, 0.5896,
        0.5835, 0.5848, 0.5883, 0.5680, 0.5845, 0.5837, 0.6641, 0.5772, 0.7159,
        0.8073], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.2350, 1.3657, 1.7148, 1.3116, 1.4143, 1.1570, 1.3307, 1.5711, 1.3756,
        1.3368, 1.4260, 1.5142, 1.2572, 1.2520, 1.2688, 1.2341, 0.8937, 1.1832,
        1.1509, 0.9128, 1.2127, 1.0497, 1.1030, 1.2015, 1.1137, 0.8715, 0.7534,
        0.8109, 0.9664, 1.0039, 1.0754, 0.8817, 0.9148, 0.8557, 0.7964, 0.7199,
        0.7239, 0.8578, 0.7321, 0.7333, 0.6632, 0.7189, 0.7464, 0.6609, 0.6604,
        0.6902, 0.6300, 0.7010, 0.6288, 0.8628, 0.6681, 0.6465, 0.7494, 0.7655,
        0.6265, 0.6746, 0.6159, 0.6279, 0.6113, 0.6835, 0.7288, 0.6381, 0.6613,
        0.5783, 0.5905, 0.6003, 0.6015, 0.6181, 0.6096, 0.6107, 0.6284, 0.6467,
        0.5811, 0.6210, 0.5906, 0.5878, 0.6161, 0.5867, 0.5825, 0.5970, 0.5904,
        0.5604, 0.6050, 0.5927, 0.5942, 0.5898, 0.6014, 0.5887, 0.5636, 0.5952,
        0.5752, 0.5581, 0.5696, 0.5823, 0.5861, 0.6367, 0.5792, 0.5746, 0.5849,
        0.5921], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([5.6586], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.25153374233128833, middle:0.22857142857142856, tail0.0
3shot of client 1:head:0.32044198895027626, middle:0.23809523809523808, tail0.0
3shot of client 2:head:0.14925373134328357, middle:0.0, tail0.0
3shot of client 3:head:0.37130801687763715, middle:0.0, tail0.0
3shot of client 4:head:0.2905027932960894, middle:0.07317073170731707, tail0.0
3shot of client 5:head:0.11320754716981132, middle:0.0, tail0.0
3shot of client 6:head:0.2146341463414634, middle:0.037037037037037035, tail0.0
3shot of client 7:head:0.29936305732484075, middle:0.0, tail0.1111111111111111
3shot of client 8:head:0.28888888888888886, middle:0.027777777777777776, tail0.0
3shot of client 9:head:0.08387096774193549, middle:0.11428571428571428, tail0.1
3shot of client 10:head:0.18691588785046728, middle:0.038461538461538464, tail0.0
3shot of client 11:head:0.232, middle:0.0, tail0.0
3shot of client 12:head:0.2712765957446808, middle:0.1, tail0.0
3shot of client 13:head:0.2564102564102564, middle:0.15625, tail0.0
3shot of client 14:head:0.3197969543147208, middle:0.023809523809523808, tail0.0
3shot of client 15:head:0.15126050420168066, middle:0.03225806451612903, tail0.0
3shot of client 16:head:0.26380368098159507, middle:0.0, tail0.0
3shot of client 17:head:0.21019108280254778, middle:0.04878048780487805, tail0.0
3shot of client 18:head:0.22932330827067668, middle:0.03389830508474576, tail0.0
3shot of client 19:head:0.27235772357723576, middle:0.03508771929824561, tail0.07142857142857142
3shot of client 20:head:0.11475409836065574, middle:0.0, tail0.0
3shot of client 21:head:0.19574468085106383, middle:0.06779661016949153, tail0.0
3shot of client 22:head:0.23417721518987342, middle:0.05555555555555555, tail0.0
3shot of client 23:head:0.19021739130434784, middle:0.0, tail0.0
3shot of client 24:head:0.3111111111111111, middle:0.0, tail0.0
3shot of client 25:head:0.3671875, middle:0.03225806451612903, tail0.0
3shot of client 26:head:0.24786324786324787, middle:0.14285714285714285, tail0.0
3shot of client 27:head:0.14074074074074075, middle:0.125, tail0.14285714285714285
3shot of client 28:head:0.1650485436893204, middle:0.02, tail0.08333333333333333
3shot of client 29:head:0.32211538461538464, middle:0.10204081632653061, tail0.09090909090909091
3shot of client 30:head:0.12612612612612611, middle:0.06666666666666667, tail0.0
3shot of client 31:head:0.19170984455958548, middle:0.0, tail0.09090909090909091
3shot of client 32:head:0.06666666666666667, middle:0.0, tail0.0
3shot of client 33:head:0.1925133689839572, middle:0.0, tail0.0
3shot of client 34:head:0.10429447852760736, middle:0.0, tail0.0
3shot of client 35:head:0.1826086956521739, middle:0.0, tail0.0
3shot of client 36:head:0.21264367816091953, middle:0.043478260869565216, tail0.0
3shot of client 37:head:0.020202020202020204, middle:0.0, tail0.18181818181818182
3shot of client 38:head:0.3819444444444444, middle:0.13157894736842105, tail0.0
3shot of client 39:head:0.11616161616161616, middle:0.05555555555555555, tail0.0
round 9, local average test acc  0.1761 

round 9, local macro average F1 score  0.0554 

round 9, local weighted average F1 score  0.1292 

round 9, global test acc  0.0607 

round 9, average 3shot acc: [head: 0.2165, middle: 0.0508, tail: 0.0218] 

round 9, global 3shot acc: [head: 0.2228, middle: 0.0200, tail: 0.0000] 

l_head tensor([0.5878, 0.5771, 1.7345, 1.1523, 0.7612, 1.0568, 1.6432, 1.7269, 1.6450,
        0.5836, 0.9337, 0.5654, 0.5699, 0.9302, 1.1304, 1.2825, 0.8910, 0.5680,
        0.5814, 0.6823, 0.9492, 0.9304, 0.5788, 0.9046, 0.5812, 1.2195, 0.8961,
        1.5257, 0.7008, 0.5968, 1.0272, 0.9861, 0.9100, 1.2189, 0.6884, 0.5541,
        0.5942, 0.5844, 0.5791, 0.8083, 0.8057, 0.5800, 0.5843, 0.7742, 0.7441,
        0.5714, 0.6835, 0.5918, 0.7704, 0.7426, 0.5733, 0.7049, 0.5851, 0.8752,
        0.6957, 0.5722, 0.6975, 0.7340, 0.7988, 0.5647, 0.5774, 0.5933, 0.7801,
        0.5862, 0.5832, 0.5842, 0.5869, 0.8036, 0.5920, 0.7629, 0.5852, 0.7314,
        0.5649, 0.5674, 0.5810, 0.5863, 0.5948, 0.5910, 0.6742, 0.5745, 0.5783,
        0.5750, 0.5628, 0.5900, 0.5820, 0.5839, 0.5658, 0.7737, 0.5870, 0.5896,
        0.5835, 0.5848, 0.5883, 0.5680, 0.5845, 0.5837, 0.6641, 0.5772, 0.7159,
        0.8073], device='cuda:4', grad_fn=<NormBackward1>)  2%|▏         | 10/500 [24:37<20:04:17, 147.46s/it]  2%|▏         | 11/500 [26:49<19:24:02, 142.83s/it]
g_aux tensor([1.3055, 1.4896, 1.8218, 1.4018, 1.5152, 1.1650, 1.3949, 1.6612, 1.4337,
        1.4341, 1.5293, 1.5529, 1.3356, 1.3183, 1.3833, 1.2961, 0.9287, 1.2242,
        1.1899, 0.9347, 1.2769, 1.0942, 1.1266, 1.2732, 1.1637, 0.9050, 0.7884,
        0.8066, 1.0167, 1.0588, 1.1430, 0.9136, 0.9453, 0.8830, 0.8320, 0.7267,
        0.7420, 0.9040, 0.7776, 0.7460, 0.6776, 0.7346, 0.7741, 0.6775, 0.6695,
        0.7256, 0.6472, 0.7567, 0.6334, 0.9018, 0.6929, 0.6494, 0.8022, 0.8147,
        0.6368, 0.6850, 0.6214, 0.6293, 0.6169, 0.7146, 0.7586, 0.6374, 0.6717,
        0.5842, 0.5960, 0.6026, 0.6053, 0.6317, 0.6249, 0.6161, 0.6347, 0.6718,
        0.5813, 0.6341, 0.5885, 0.5881, 0.6181, 0.5902, 0.5889, 0.6026, 0.5940,
        0.5614, 0.6143, 0.6079, 0.6028, 0.5900, 0.6123, 0.5897, 0.5630, 0.5957,
        0.5730, 0.5585, 0.5785, 0.5828, 0.5901, 0.6369, 0.5801, 0.5752, 0.5851,
        0.5920], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([5.9135], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.26993865030674846, middle:0.2, tail0.0
3shot of client 1:head:0.44751381215469616, middle:0.19047619047619047, tail0.0
3shot of client 2:head:0.14925373134328357, middle:0.0, tail0.0
3shot of client 3:head:0.35864978902953587, middle:0.0, tail0.0
3shot of client 4:head:0.30726256983240224, middle:0.07317073170731707, tail0.0
3shot of client 5:head:0.04716981132075472, middle:0.0, tail0.16666666666666666
3shot of client 6:head:0.21951219512195122, middle:0.1111111111111111, tail0.09090909090909091
3shot of client 7:head:0.21656050955414013, middle:0.05, tail0.2222222222222222
3shot of client 8:head:0.3037037037037037, middle:0.027777777777777776, tail0.0
3shot of client 9:head:0.2645161290322581, middle:0.02857142857142857, tail0.0
3shot of client 10:head:0.16822429906542055, middle:0.07692307692307693, tail0.0
3shot of client 11:head:0.216, middle:0.0, tail0.0
3shot of client 12:head:0.2712765957446808, middle:0.08, tail0.0
3shot of client 13:head:0.26495726495726496, middle:0.125, tail0.0
3shot of client 14:head:0.2182741116751269, middle:0.047619047619047616, tail0.0
3shot of client 15:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 16:head:0.2883435582822086, middle:0.0, tail0.0
3shot of client 17:head:0.18471337579617833, middle:0.04878048780487805, tail0.2
3shot of client 18:head:0.2518796992481203, middle:0.03389830508474576, tail0.0
3shot of client 19:head:0.3048780487804878, middle:0.017543859649122806, tail0.07142857142857142
3shot of client 20:head:0.15846994535519127, middle:0.0, tail0.0
3shot of client 21:head:0.2170212765957447, middle:0.15254237288135594, tail0.0
3shot of client 22:head:0.1962025316455696, middle:0.027777777777777776, tail0.0
3shot of client 23:head:0.2391304347826087, middle:0.02127659574468085, tail0.0
3shot of client 24:head:0.11851851851851852, middle:0.08108108108108109, tail0.0
3shot of client 25:head:0.3046875, middle:0.0, tail0.0
3shot of client 26:head:0.1452991452991453, middle:0.03571428571428571, tail0.0
3shot of client 27:head:0.16296296296296298, middle:0.15625, tail0.14285714285714285
3shot of client 28:head:0.32038834951456313, middle:0.1, tail0.0
3shot of client 29:head:0.32211538461538464, middle:0.08163265306122448, tail0.18181818181818182
3shot of client 30:head:0.14414414414414414, middle:0.03333333333333333, tail0.0
3shot of client 31:head:0.20207253886010362, middle:0.10204081632653061, tail0.0
3shot of client 32:head:0.21904761904761905, middle:0.0, tail0.5
3shot of client 33:head:0.18181818181818182, middle:0.045454545454545456, tail0.0
3shot of client 34:head:0.06134969325153374, middle:0.0, tail0.0
3shot of client 35:head:0.19130434782608696, middle:0.13333333333333333, tail0.0
3shot of client 36:head:0.20689655172413793, middle:0.0, tail0.0
3shot of client 37:head:0.025252525252525252, middle:0.0, tail0.18181818181818182
3shot of client 38:head:0.3819444444444444, middle:0.10526315789473684, tail0.0
3shot of client 39:head:0.10606060606060606, middle:0.05555555555555555, tail0.0
round 10, local average test acc  0.1809 

round 10, local macro average F1 score  0.0606 

round 10, local weighted average F1 score  0.1446 

round 10, global test acc  0.0642 

round 10, average 3shot acc: [head: 0.2200, middle: 0.0561, tail: 0.0439] 

round 10, global 3shot acc: [head: 0.2476, middle: 0.0092, tail: 0.0000] 

l_head tensor([0.5878, 0.5771, 1.7345, 1.1523, 0.7612, 1.0568, 1.6432, 1.7269, 1.6450,
        0.5836, 0.9337, 0.5654, 0.5699, 0.9302, 1.1304, 1.2825, 0.8910, 0.5680,
        0.5814, 0.6823, 0.9492, 0.9304, 0.5788, 0.9046, 0.5812, 1.2195, 0.8961,
        1.5257, 0.7008, 0.5968, 1.0272, 0.9861, 0.9100, 1.2189, 0.6884, 0.5541,
        0.5942, 0.5844, 0.5791, 0.8083, 0.8057, 0.5800, 0.5843, 0.7742, 0.7441,
        0.5714, 0.6835, 0.5918, 0.7704, 0.7426, 0.5733, 0.7049, 0.5851, 0.8752,
        0.6957, 0.5722, 0.6975, 0.7340, 0.7988, 0.5647, 0.5774, 0.5933, 0.7801,
        0.5862, 0.5832, 0.5842, 0.5869, 0.8036, 0.5920, 0.7629, 0.5852, 0.7314,
        0.5649, 0.5674, 0.5810, 0.5863, 0.5948, 0.5910, 0.6742, 0.5745, 0.5783,
        0.5750, 0.5628, 0.5900, 0.5820, 0.5839, 0.5658, 0.7737, 0.5870, 0.5896,
        0.5835, 0.5848, 0.5883, 0.5680, 0.5845, 0.5837, 0.6641, 0.5772, 0.7159,
        0.8073], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.3746, 1.5017, 1.8860, 1.4333, 1.5756, 1.1727, 1.4520, 1.7690, 1.4797,
        1.5027, 1.6749, 1.5707, 1.4311, 1.3366, 1.4571, 1.3597, 0.9997, 1.2718,
        1.2296, 0.9364, 1.3143, 1.1364, 1.1056, 1.3706, 1.2045, 0.9245, 0.8052,
        0.8175, 1.0900, 1.0866, 1.1592, 0.9307, 0.9905, 0.9147, 0.8545, 0.7607,
        0.7634, 0.9149, 0.7885, 0.7902, 0.7046, 0.7388, 0.7770, 0.6989, 0.6944,
        0.7519, 0.6721, 0.7845, 0.6413, 0.9604, 0.7039, 0.6742, 0.8180, 0.8663,
        0.6529, 0.6997, 0.6319, 0.6454, 0.6260, 0.7399, 0.7756, 0.6497, 0.6858,
        0.6013, 0.6054, 0.6080, 0.6046, 0.6318, 0.6312, 0.6260, 0.6480, 0.6719,
        0.5811, 0.6549, 0.5903, 0.5875, 0.6258, 0.5909, 0.5929, 0.6098, 0.5972,
        0.5614, 0.6123, 0.6234, 0.6130, 0.5960, 0.6155, 0.5898, 0.5624, 0.5961,
        0.5717, 0.5558, 0.5916, 0.5793, 0.5901, 0.6371, 0.5805, 0.5756, 0.5870,
        0.5921], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([6.1688], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.24539877300613497, middle:0.2, tail0.0
3shot of client 1:head:0.5193370165745856, middle:0.19047619047619047, tail0.0
3shot of client 2:head:0.19402985074626866, middle:0.0, tail0.0
3shot of client 3:head:0.37130801687763715, middle:0.0, tail0.0
3shot of client 4:head:0.3128491620111732, middle:0.0975609756097561, tail0.1
3shot of client 5:head:0.018867924528301886, middle:0.0, tail0.16666666666666666
3shot of client 6:head:0.28292682926829266, middle:0.07407407407407407, tail0.0
3shot of client 7:head:0.24203821656050956, middle:0.025, tail0.2222222222222222
3shot of client 8:head:0.3111111111111111, middle:0.05555555555555555, tail0.0
3shot of client 9:head:0.2709677419354839, middle:0.08571428571428572, tail0.1
3shot of client 10:head:0.21495327102803738, middle:0.07692307692307693, tail0.0
3shot of client 11:head:0.344, middle:0.0, tail0.0
3shot of client 12:head:0.26595744680851063, middle:0.08, tail0.0
3shot of client 13:head:0.24786324786324787, middle:0.125, tail0.0
3shot of client 14:head:0.3299492385786802, middle:0.09523809523809523, tail0.0
3shot of client 15:head:0.17647058823529413, middle:0.03225806451612903, tail0.0
3shot of client 16:head:0.3558282208588957, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.3503184713375796, middle:0.024390243902439025, tail0.0
3shot of client 18:head:0.2706766917293233, middle:0.01694915254237288, tail0.0
3shot of client 19:head:0.35365853658536583, middle:0.017543859649122806, tail0.07142857142857142
3shot of client 20:head:0.21311475409836064, middle:0.0, tail0.0
3shot of client 21:head:0.2723404255319149, middle:0.15254237288135594, tail0.0
3shot of client 22:head:0.3037974683544304, middle:0.027777777777777776, tail0.0
3shot of client 23:head:0.09782608695652174, middle:0.1276595744680851, tail0.0
3shot of client 24:head:0.15555555555555556, middle:0.05405405405405406, tail0.0  2%|▏         | 12/500 [29:19<19:39:38, 145.04s/it]
3shot of client 25:head:0.4140625, middle:0.0967741935483871, tail0.0
3shot of client 26:head:0.20512820512820512, middle:0.07142857142857142, tail0.0
3shot of client 27:head:0.14814814814814814, middle:0.125, tail0.14285714285714285
3shot of client 28:head:0.18932038834951456, middle:0.22, tail0.0
3shot of client 29:head:0.42788461538461536, middle:0.0, tail0.09090909090909091
3shot of client 30:head:0.15315315315315314, middle:0.03333333333333333, tail0.16666666666666666
3shot of client 31:head:0.36787564766839376, middle:0.02040816326530612, tail0.0
3shot of client 32:head:0.11428571428571428, middle:0.0, tail0.3333333333333333
3shot of client 33:head:0.1711229946524064, middle:0.0, tail0.0
3shot of client 34:head:0.09202453987730061, middle:0.0, tail0.0
3shot of client 35:head:0.22608695652173913, middle:0.03333333333333333, tail0.0
3shot of client 36:head:0.39080459770114945, middle:0.021739130434782608, tail0.09090909090909091
3shot of client 37:head:0.025252525252525252, middle:0.0, tail0.18181818181818182
3shot of client 38:head:0.4305555555555556, middle:0.05263157894736842, tail0.0
3shot of client 39:head:0.2222222222222222, middle:0.037037037037037035, tail0.0
round 11, local average test acc  0.2100 

round 11, local macro average F1 score  0.0706 

round 11, local weighted average F1 score  0.1735 

round 11, global test acc  0.0706 

round 11, average 3shot acc: [head: 0.2575, middle: 0.0595, tail: 0.0417] 

round 11, global 3shot acc: [head: 0.2780, middle: 0.0044, tail: 0.0000] 

l_head tensor([0.5878, 0.5771, 1.7345, 1.1523, 0.7612, 1.0568, 1.6432, 1.7269, 1.6450,
        0.5836, 0.9337, 0.5654, 0.5699, 0.9302, 1.1304, 1.2825, 0.8910, 0.5680,
        0.5814, 0.6823, 0.9492, 0.9304, 0.5788, 0.9046, 0.5812, 1.2195, 0.8961,
        1.5257, 0.7008, 0.5968, 1.0272, 0.9861, 0.9100, 1.2189, 0.6884, 0.5541,
        0.5942, 0.5844, 0.5791, 0.8083, 0.8057, 0.5800, 0.5843, 0.7742, 0.7441,
        0.5714, 0.6835, 0.5918, 0.7704, 0.7426, 0.5733, 0.7049, 0.5851, 0.8752,
        0.6957, 0.5722, 0.6975, 0.7340, 0.7988, 0.5647, 0.5774, 0.5933, 0.7801,
        0.5862, 0.5832, 0.5842, 0.5869, 0.8036, 0.5920, 0.7629, 0.5852, 0.7314,
        0.5649, 0.5674, 0.5810, 0.5863, 0.5948, 0.5910, 0.6742, 0.5745, 0.5783,
        0.5750, 0.5628, 0.5900, 0.5820, 0.5839, 0.5658, 0.7737, 0.5870, 0.5896,
        0.5835, 0.5848, 0.5883, 0.5680, 0.5845, 0.5837, 0.6641, 0.5772, 0.7159,
        0.8073], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.4860, 1.5453, 1.9110, 1.4404, 1.6773, 1.2130, 1.4564, 1.8154, 1.5149,
        1.6351, 1.7497, 1.6337, 1.5241, 1.4126, 1.4802, 1.3988, 1.0352, 1.3797,
        1.3043, 0.9866, 1.3747, 1.1685, 1.1382, 1.4753, 1.2537, 0.9553, 0.8255,
        0.8311, 1.1315, 1.1336, 1.1686, 0.9490, 1.0051, 0.9633, 0.8678, 0.7904,
        0.7785, 0.9521, 0.8218, 0.8316, 0.7110, 0.7488, 0.7914, 0.7244, 0.6981,
        0.7720, 0.7003, 0.8087, 0.6529, 0.9680, 0.7203, 0.6873, 0.8467, 0.9139,
        0.6684, 0.7136, 0.6392, 0.6581, 0.6492, 0.7572, 0.7984, 0.6656, 0.6961,
        0.6115, 0.6218, 0.6174, 0.6103, 0.6374, 0.6365, 0.6369, 0.6953, 0.7146,
        0.5853, 0.6773, 0.5993, 0.5891, 0.6316, 0.5984, 0.6022, 0.6174, 0.6019,
        0.5643, 0.6157, 0.6349, 0.6271, 0.5968, 0.6217, 0.5895, 0.5619, 0.5957,
        0.5734, 0.5555, 0.5933, 0.5800, 0.5915, 0.6372, 0.5817, 0.5719, 0.5865,
        0.5924], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([6.4016], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.25766871165644173, middle:0.2571428571428571, tail0.1
3shot of client 1:head:0.5359116022099447, middle:0.19047619047619047, tail0.0
3shot of client 2:head:0.05223880597014925, middle:0.05714285714285714, tail0.0
3shot of client 3:head:0.37130801687763715, middle:0.0, tail0.0
3shot of client 4:head:0.25139664804469275, middle:0.0975609756097561, tail0.1
3shot of client 5:head:0.05660377358490566, middle:0.0, tail0.16666666666666666
3shot of client 6:head:0.3073170731707317, middle:0.07407407407407407, tail0.0
3shot of client 7:head:0.2356687898089172, middle:0.05, tail0.1111111111111111
3shot of client 8:head:0.21481481481481482, middle:0.027777777777777776, tail0.125
3shot of client 9:head:0.3225806451612903, middle:0.05714285714285714, tail0.0
3shot of client 10:head:0.18691588785046728, middle:0.07692307692307693, tail0.16666666666666666
3shot of client 11:head:0.28, middle:0.0, tail0.0
3shot of client 12:head:0.3723404255319149, middle:0.02, tail0.08333333333333333
3shot of client 13:head:0.2905982905982906, middle:0.15625, tail0.0
3shot of client 14:head:0.19289340101522842, middle:0.07142857142857142, tail0.08333333333333333
3shot of client 15:head:0.17647058823529413, middle:0.03225806451612903, tail0.0
3shot of client 16:head:0.3374233128834356, middle:0.16216216216216217, tail0.0
3shot of client 17:head:0.3184713375796178, middle:0.07317073170731707, tail0.1
3shot of client 18:head:0.2631578947368421, middle:0.01694915254237288, tail0.0
3shot of client 19:head:0.35365853658536583, middle:0.017543859649122806, tail0.07142857142857142
3shot of client 20:head:0.2185792349726776, middle:0.0, tail0.0
3shot of client 21:head:0.25957446808510637, middle:0.1016949152542373, tail0.0
3shot of client 22:head:0.3291139240506329, middle:0.1111111111111111, tail0.1
3shot of client 23:head:0.02717391304347826, middle:0.02127659574468085, tail0.0
3shot of client 24:head:0.14074074074074075, middle:0.05405405405405406, tail0.14285714285714285
3shot of client 25:head:0.4140625, middle:0.06451612903225806, tail0.0
3shot of client 26:head:0.1794871794871795, middle:0.10714285714285714, tail0.0
3shot of client 27:head:0.17777777777777778, middle:0.125, tail0.2857142857142857
3shot of client 28:head:0.3300970873786408, middle:0.1, tail0.0
3shot of client 29:head:0.40865384615384615, middle:0.0, tail0.09090909090909091
3shot of client 30:head:0.16216216216216217, middle:0.03333333333333333, tail0.0
3shot of client 31:head:0.37305699481865284, middle:0.02040816326530612, tail0.0
3shot of client 32:head:0.1523809523809524, middle:0.0, tail0.3333333333333333
3shot of client 33:head:0.20320855614973263, middle:0.045454545454545456, tail0.0
3shot of client 34:head:0.08588957055214724, middle:0.0, tail0.0
3shot of client 35:head:0.23478260869565218, middle:0.03333333333333333, tail0.0
3shot of client 36:head:0.27586206896551724, middle:0.0, tail0.0
3shot of client 37:head:0.18686868686868688, middle:0.022222222222222223, tail0.09090909090909091
3shot of client 38:head:0.3819444444444444, middle:0.05263157894736842, tail0.0
3shot of client 39:head:0.1414141414141414, middle:0.05555555555555555, tail0.0
round 12, local average test acc  0.2060 

round 12, local macro average F1 score  0.0729 

round 12, local weighted average F1 score  0.1713 

round 12, global test acc  0.0781 

round 12, average 3shot acc: [head: 0.2515, middle: 0.0596, tail: 0.0538] 

round 12, global 3shot acc: [head: 0.2944, middle: 0.0180, tail: 0.0000] 

l_head tensor([0.5878, 0.5771, 1.7345, 1.1523, 0.7612, 1.0568, 1.6432, 1.7269, 1.6450,
        0.5836, 0.9337, 0.5654, 0.5699, 0.9302, 1.1304, 1.2825, 0.8910, 0.5680,
        0.5814, 0.6823, 0.9492, 0.9304, 0.5788, 0.9046, 0.5812, 1.2195, 0.8961,
        1.5257, 0.7008, 0.5968, 1.0272, 0.9861, 0.9100, 1.2189, 0.6884, 0.5541,
        0.5942, 0.5844, 0.5791, 0.8083, 0.8057, 0.5800, 0.5843, 0.7742, 0.7441,
        0.5714, 0.6835, 0.5918, 0.7704, 0.7426, 0.5733, 0.7049, 0.5851, 0.8752,
        0.6957, 0.5722, 0.6975, 0.7340, 0.7988, 0.5647, 0.5774, 0.5933, 0.7801,
        0.5862, 0.5832, 0.5842, 0.5869, 0.8036, 0.5920, 0.7629, 0.5852, 0.7314,
        0.5649, 0.5674, 0.5810, 0.5863, 0.5948, 0.5910, 0.6742, 0.5745, 0.5783,
        0.5750, 0.5628, 0.5900, 0.5820, 0.5839, 0.5658, 0.7737, 0.5870, 0.5896,
        0.5835, 0.5848, 0.5883, 0.5680, 0.5845, 0.5837, 0.6641, 0.5772, 0.7159,
        0.8073], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.5386, 1.5803, 1.9802, 1.5135, 1.7654, 1.3121, 1.4896, 1.8262, 1.5373,
        1.6511, 1.7503, 1.6748, 1.5680, 1.4550, 1.5466, 1.4259, 1.1031, 1.4798,
        1.3717, 1.0040, 1.4637, 1.2010, 1.1899, 1.5507, 1.2736, 0.9694, 0.8612,
        0.8682, 1.1259, 1.1697, 1.1948, 0.9929, 1.0418, 0.9821, 0.8840, 0.8538,
        0.8100, 0.9805, 0.8448, 0.8529, 0.7124, 0.7769, 0.8109, 0.7228, 0.7238,
        0.7871, 0.7172, 0.8521, 0.6777, 1.0031, 0.7329, 0.6898, 0.8617, 0.9286,
        0.6783, 0.7179, 0.6539, 0.6724, 0.6912, 0.7612, 0.8244, 0.6770, 0.7043,
        0.6148, 0.6355, 0.6139, 0.6159, 0.6476, 0.6557, 0.6504, 0.6769, 0.7403,
        0.5918, 0.6848, 0.6034, 0.5970, 0.6447, 0.6009, 0.6068, 0.6201, 0.6032,
        0.5661, 0.6247, 0.6356, 0.6275, 0.5979, 0.6249, 0.5941, 0.5617, 0.6002,
        0.5824, 0.5568, 0.5894, 0.5825, 0.5919, 0.6495, 0.5875, 0.5723, 0.5915,
        0.5968], device='cuda:4', grad_fn=<NormBackward1>)  3%|▎         | 13/500 [31:52<19:56:29, 147.41s/it]  3%|▎         | 14/500 [34:18<19:49:41, 146.88s/it]
The value of constant scaler:  tensor([6.6630], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.3067484662576687, middle:0.2, tail0.0
3shot of client 1:head:0.5524861878453039, middle:0.11904761904761904, tail0.0
3shot of client 2:head:0.06716417910447761, middle:0.05714285714285714, tail0.0
3shot of client 3:head:0.3881856540084388, middle:0.03225806451612903, tail0.0
3shot of client 4:head:0.329608938547486, middle:0.0975609756097561, tail0.0
3shot of client 5:head:0.05660377358490566, middle:0.038461538461538464, tail0.16666666666666666
3shot of client 6:head:0.3170731707317073, middle:0.07407407407407407, tail0.0
3shot of client 7:head:0.18471337579617833, middle:0.1, tail0.2222222222222222
3shot of client 8:head:0.17037037037037037, middle:0.027777777777777776, tail0.125
3shot of client 9:head:0.2903225806451613, middle:0.02857142857142857, tail0.0
3shot of client 10:head:0.27102803738317754, middle:0.038461538461538464, tail0.0
3shot of client 11:head:0.064, middle:0.03125, tail0.125
3shot of client 12:head:0.3404255319148936, middle:0.16, tail0.0
3shot of client 13:head:0.3076923076923077, middle:0.15625, tail0.0
3shot of client 14:head:0.2233502538071066, middle:0.09523809523809523, tail0.08333333333333333
3shot of client 15:head:0.29411764705882354, middle:0.12903225806451613, tail0.0
3shot of client 16:head:0.3558282208588957, middle:0.05405405405405406, tail0.0
3shot of client 17:head:0.2356687898089172, middle:0.0975609756097561, tail0.1
3shot of client 18:head:0.3233082706766917, middle:0.1694915254237288, tail0.058823529411764705
3shot of client 19:head:0.3130081300813008, middle:0.08771929824561403, tail0.07142857142857142
3shot of client 20:head:0.18032786885245902, middle:0.0, tail0.0
3shot of client 21:head:0.2680851063829787, middle:0.1016949152542373, tail0.0
3shot of client 22:head:0.33544303797468356, middle:0.1111111111111111, tail0.0
3shot of client 23:head:0.06521739130434782, middle:0.02127659574468085, tail0.0
3shot of client 24:head:0.16296296296296298, middle:0.05405405405405406, tail0.14285714285714285
3shot of client 25:head:0.4296875, middle:0.0967741935483871, tail0.0
3shot of client 26:head:0.2564102564102564, middle:0.17857142857142858, tail0.0
3shot of client 27:head:0.17777777777777778, middle:0.125, tail0.14285714285714285
3shot of client 28:head:0.33495145631067963, middle:0.1, tail0.0
3shot of client 29:head:0.3942307692307692, middle:0.0, tail0.09090909090909091
3shot of client 30:head:0.16216216216216217, middle:0.06666666666666667, tail0.0
3shot of client 31:head:0.37305699481865284, middle:0.02040816326530612, tail0.0
3shot of client 32:head:0.13333333333333333, middle:0.0, tail0.3333333333333333
3shot of client 33:head:0.1711229946524064, middle:0.045454545454545456, tail0.0
3shot of client 34:head:0.10429447852760736, middle:0.0, tail0.0
3shot of client 35:head:0.28695652173913044, middle:0.0, tail0.0
3shot of client 36:head:0.3793103448275862, middle:0.0, tail0.0
3shot of client 37:head:0.23232323232323232, middle:0.0, tail0.09090909090909091
3shot of client 38:head:0.4722222222222222, middle:0.10526315789473684, tail0.0
3shot of client 39:head:0.23737373737373738, middle:0.07407407407407407, tail0.08333333333333333
round 13, local average test acc  0.2176 

round 13, local macro average F1 score  0.0763 

round 13, local weighted average F1 score  0.1670 

round 13, global test acc  0.0870 

round 13, average 3shot acc: [head: 0.2637, middle: 0.0724, tail: 0.0459] 

round 13, global 3shot acc: [head: 0.3248, middle: 0.0232, tail: 0.0000] 

l_head tensor([0.5878, 0.5771, 1.7345, 1.1523, 0.7612, 1.0568, 1.6432, 1.7269, 1.6450,
        0.5836, 0.9337, 0.5654, 0.5699, 0.9302, 1.1304, 1.2825, 0.8910, 0.5680,
        0.5814, 0.6823, 0.9492, 0.9304, 0.5788, 0.9046, 0.5812, 1.2195, 0.8961,
        1.5257, 0.7008, 0.5968, 1.0272, 0.9861, 0.9100, 1.2189, 0.6884, 0.5541,
        0.5942, 0.5844, 0.5791, 0.8083, 0.8057, 0.5800, 0.5843, 0.7742, 0.7441,
        0.5714, 0.6835, 0.5918, 0.7704, 0.7426, 0.5733, 0.7049, 0.5851, 0.8752,
        0.6957, 0.5722, 0.6975, 0.7340, 0.7988, 0.5647, 0.5774, 0.5933, 0.7801,
        0.5862, 0.5832, 0.5842, 0.5869, 0.8036, 0.5920, 0.7629, 0.5852, 0.7314,
        0.5649, 0.5674, 0.5810, 0.5863, 0.5948, 0.5910, 0.6742, 0.5745, 0.5783,
        0.5750, 0.5628, 0.5900, 0.5820, 0.5839, 0.5658, 0.7737, 0.5870, 0.5896,
        0.5835, 0.5848, 0.5883, 0.5680, 0.5845, 0.5837, 0.6641, 0.5772, 0.7159,
        0.8073], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.6199, 1.6571, 2.0383, 1.5767, 1.8295, 1.3668, 1.5316, 1.8520, 1.5802,
        1.7621, 1.7325, 1.7161, 1.6148, 1.5458, 1.6292, 1.4479, 1.1606, 1.5084,
        1.4142, 1.0430, 1.5093, 1.2998, 1.2173, 1.5775, 1.3461, 1.0093, 0.8760,
        0.9102, 1.1225, 1.1929, 1.2588, 1.0040, 1.0565, 0.9941, 0.9286, 0.8456,
        0.8199, 1.0258, 0.8706, 0.8465, 0.7177, 0.8325, 0.8293, 0.7294, 0.7576,
        0.7876, 0.7152, 0.8930, 0.6886, 1.0217, 0.7322, 0.7136, 0.8761, 0.9561,
        0.7143, 0.7263, 0.6690, 0.6746, 0.7075, 0.7864, 0.8934, 0.6847, 0.7255,
        0.6191, 0.6428, 0.6208, 0.6240, 0.6623, 0.6563, 0.6634, 0.6987, 0.7669,
        0.5940, 0.6873, 0.6148, 0.5948, 0.6710, 0.6031, 0.6112, 0.6249, 0.6077,
        0.5683, 0.6306, 0.6389, 0.6294, 0.6015, 0.6245, 0.5947, 0.5620, 0.6074,
        0.5980, 0.5567, 0.5896, 0.5863, 0.5943, 0.6634, 0.5925, 0.5689, 0.5954,
        0.6034], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([6.9072], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.26380368098159507, middle:0.2571428571428571, tail0.0
3shot of client 1:head:0.5193370165745856, middle:0.19047619047619047, tail0.0
3shot of client 2:head:0.08208955223880597, middle:0.02857142857142857, tail0.0
3shot of client 3:head:0.35443037974683544, middle:0.016129032258064516, tail0.0
3shot of client 4:head:0.4692737430167598, middle:0.024390243902439025, tail0.0
3shot of client 5:head:0.02830188679245283, middle:0.038461538461538464, tail0.16666666666666666
3shot of client 6:head:0.2146341463414634, middle:0.16666666666666666, tail0.0
3shot of client 7:head:0.27388535031847133, middle:0.075, tail0.1111111111111111
3shot of client 8:head:0.4148148148148148, middle:0.05555555555555555, tail0.0
3shot of client 9:head:0.27741935483870966, middle:0.11428571428571428, tail0.1
3shot of client 10:head:0.205607476635514, middle:0.07692307692307693, tail0.0
3shot of client 11:head:0.064, middle:0.03125, tail0.0
3shot of client 12:head:0.2765957446808511, middle:0.18, tail0.0
3shot of client 13:head:0.2905982905982906, middle:0.28125, tail0.0
3shot of client 14:head:0.23857868020304568, middle:0.11904761904761904, tail0.08333333333333333
3shot of client 15:head:0.24369747899159663, middle:0.12903225806451613, tail0.0
3shot of client 16:head:0.4233128834355828, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.21019108280254778, middle:0.0975609756097561, tail0.0
3shot of client 18:head:0.30451127819548873, middle:0.1864406779661017, tail0.0
3shot of client 19:head:0.3699186991869919, middle:0.03508771929824561, tail0.14285714285714285
3shot of client 20:head:0.28415300546448086, middle:0.0425531914893617, tail0.16666666666666666
3shot of client 21:head:0.2765957446808511, middle:0.13559322033898305, tail0.0
3shot of client 22:head:0.3227848101265823, middle:0.1388888888888889, tail0.0
3shot of client 23:head:0.08695652173913043, middle:0.02127659574468085, tail0.0
3shot of client 24:head:0.2, middle:0.05405405405405406, tail0.14285714285714285
3shot of client 25:head:0.5546875, middle:0.06451612903225806, tail0.0
3shot of client 26:head:0.24786324786324787, middle:0.14285714285714285, tail0.0
3shot of client 27:head:0.13333333333333333, middle:0.15625, tail0.2857142857142857
3shot of client 28:head:0.21359223300970873, middle:0.04, tail0.0
3shot of client 29:head:0.4519230769230769, middle:0.0, tail0.09090909090909091
3shot of client 30:head:0.15315315315315314, middle:0.16666666666666666, tail0.0
3shot of client 31:head:0.35751295336787564, middle:0.02040816326530612, tail0.0
3shot of client 32:head:0.1523809523809524, middle:0.0, tail0.3333333333333333
3shot of client 33:head:0.3582887700534759, middle:0.11363636363636363, tail0.0  3%|▎         | 15/500 [36:49<19:58:27, 148.26s/it]
3shot of client 34:head:0.1165644171779141, middle:0.0, tail0.0
3shot of client 35:head:0.19130434782608696, middle:0.16666666666666666, tail0.0
3shot of client 36:head:0.3793103448275862, middle:0.021739130434782608, tail0.0
3shot of client 37:head:0.18181818181818182, middle:0.08888888888888889, tail0.09090909090909091
3shot of client 38:head:0.4791666666666667, middle:0.10526315789473684, tail0.0
3shot of client 39:head:0.22727272727272727, middle:0.18518518518518517, tail0.08333333333333333
round 14, local average test acc  0.2289 

round 14, local macro average F1 score  0.0784 

round 14, local weighted average F1 score  0.1853 

round 14, global test acc  0.0836 

round 14, average 3shot acc: [head: 0.2723, middle: 0.0969, tail: 0.0449] 

round 14, global 3shot acc: [head: 0.3096, middle: 0.0244, tail: 0.0002] 

l_head tensor([0.5878, 0.5771, 1.7345, 1.1523, 0.7612, 1.0568, 1.6432, 1.7269, 1.6450,
        0.5836, 0.9337, 0.5654, 0.5699, 0.9302, 1.1304, 1.2825, 0.8910, 0.5680,
        0.5814, 0.6823, 0.9492, 0.9304, 0.5788, 0.9046, 0.5812, 1.2195, 0.8961,
        1.5257, 0.7008, 0.5968, 1.0272, 0.9861, 0.9100, 1.2189, 0.6884, 0.5541,
        0.5942, 0.5844, 0.5791, 0.8083, 0.8057, 0.5800, 0.5843, 0.7742, 0.7441,
        0.5714, 0.6835, 0.5918, 0.7704, 0.7426, 0.5733, 0.7049, 0.5851, 0.8752,
        0.6957, 0.5722, 0.6975, 0.7340, 0.7988, 0.5647, 0.5774, 0.5933, 0.7801,
        0.5862, 0.5832, 0.5842, 0.5869, 0.8036, 0.5920, 0.7629, 0.5852, 0.7314,
        0.5649, 0.5674, 0.5810, 0.5863, 0.5948, 0.5910, 0.6742, 0.5745, 0.5783,
        0.5750, 0.5628, 0.5900, 0.5820, 0.5839, 0.5658, 0.7737, 0.5870, 0.5896,
        0.5835, 0.5848, 0.5883, 0.5680, 0.5845, 0.5837, 0.6641, 0.5772, 0.7159,
        0.8073], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.7287, 1.7290, 2.0823, 1.6093, 1.8987, 1.4262, 1.5502, 1.9168, 1.5988,
        1.7661, 1.7507, 1.7345, 1.6946, 1.6289, 1.7024, 1.4342, 1.2031, 1.4842,
        1.4313, 1.0828, 1.5820, 1.3438, 1.2406, 1.6204, 1.3626, 1.0223, 0.8939,
        0.9121, 1.1260, 1.2408, 1.3153, 1.0277, 1.0664, 1.0059, 0.9454, 0.8819,
        0.8546, 1.0799, 0.8701, 0.8953, 0.7281, 0.9012, 0.8527, 0.7429, 0.7630,
        0.7943, 0.7406, 0.9111, 0.7157, 1.1025, 0.7412, 0.7108, 0.8984, 0.9547,
        0.7223, 0.7322, 0.6768, 0.6827, 0.7153, 0.8037, 0.9560, 0.7047, 0.7175,
        0.6357, 0.6595, 0.6258, 0.6246, 0.6809, 0.6706, 0.6731, 0.7152, 0.7809,
        0.5976, 0.6897, 0.6162, 0.6055, 0.6697, 0.6037, 0.6155, 0.6279, 0.6102,
        0.5711, 0.6362, 0.6562, 0.6302, 0.6036, 0.6295, 0.5978, 0.5623, 0.6079,
        0.5975, 0.5605, 0.5910, 0.5936, 0.6045, 0.6634, 0.5931, 0.5703, 0.5953,
        0.5996], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([7.1091], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.2822085889570552, middle:0.2571428571428571, tail0.0
3shot of client 1:head:0.5414364640883977, middle:0.19047619047619047, tail0.09090909090909091
3shot of client 2:head:0.20149253731343283, middle:0.05714285714285714, tail0.0
3shot of client 3:head:0.39662447257383965, middle:0.016129032258064516, tail0.0
3shot of client 4:head:0.3575418994413408, middle:0.14634146341463414, tail0.1
3shot of client 5:head:0.0660377358490566, middle:0.07692307692307693, tail0.16666666666666666
3shot of client 6:head:0.24878048780487805, middle:0.18518518518518517, tail0.0
3shot of client 7:head:0.2802547770700637, middle:0.1, tail0.2222222222222222
3shot of client 8:head:0.4148148148148148, middle:0.1111111111111111, tail0.0
3shot of client 9:head:0.3032258064516129, middle:0.05714285714285714, tail0.1
3shot of client 10:head:0.411214953271028, middle:0.15384615384615385, tail0.0
3shot of client 11:head:0.072, middle:0.03125, tail0.125
3shot of client 12:head:0.3723404255319149, middle:0.04, tail0.08333333333333333
3shot of client 13:head:0.4700854700854701, middle:0.15625, tail0.0
3shot of client 14:head:0.233502538071066, middle:0.07142857142857142, tail0.08333333333333333
3shot of client 15:head:0.3025210084033613, middle:0.12903225806451613, tail0.0
3shot of client 16:head:0.44171779141104295, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.27388535031847133, middle:0.07317073170731707, tail0.1
3shot of client 18:head:0.3308270676691729, middle:0.1864406779661017, tail0.0
3shot of client 19:head:0.3943089430894309, middle:0.05263157894736842, tail0.14285714285714285
3shot of client 20:head:0.2677595628415301, middle:0.14893617021276595, tail0.0
3shot of client 21:head:0.2978723404255319, middle:0.15254237288135594, tail0.0
3shot of client 22:head:0.33544303797468356, middle:0.16666666666666666, tail0.0
3shot of client 23:head:0.07065217391304347, middle:0.02127659574468085, tail0.0
3shot of client 24:head:0.17037037037037037, middle:0.08108108108108109, tail0.0
3shot of client 25:head:0.453125, middle:0.0967741935483871, tail0.0
3shot of client 26:head:0.23076923076923078, middle:0.14285714285714285, tail0.0
3shot of client 27:head:0.14814814814814814, middle:0.125, tail0.14285714285714285
3shot of client 28:head:0.1941747572815534, middle:0.04, tail0.0
3shot of client 29:head:0.4807692307692308, middle:0.02040816326530612, tail0.09090909090909091
3shot of client 30:head:0.15315315315315314, middle:0.1, tail0.0
3shot of client 31:head:0.38341968911917096, middle:0.0, tail0.0
3shot of client 32:head:0.21904761904761905, middle:0.0, tail0.3333333333333333
3shot of client 33:head:0.3850267379679144, middle:0.06818181818181818, tail0.0
3shot of client 34:head:0.10429447852760736, middle:0.0, tail0.0
3shot of client 35:head:0.3739130434782609, middle:0.23333333333333334, tail0.0
3shot of client 36:head:0.04597701149425287, middle:0.17391304347826086, tail0.0
3shot of client 37:head:0.21212121212121213, middle:0.022222222222222223, tail0.09090909090909091
3shot of client 38:head:0.5138888888888888, middle:0.07894736842105263, tail0.0
3shot of client 39:head:0.25757575757575757, middle:0.05555555555555555, tail0.0
round 15, local average test acc  0.2444 

round 15, local macro average F1 score  0.0990 

round 15, local weighted average F1 score  0.2087 

round 15, global test acc  0.0929 

round 15, average 3shot acc: [head: 0.2923, middle: 0.0982, tail: 0.0468] 

round 15, global 3shot acc: [head: 0.3376, middle: 0.0268, tail: 0.0036] 

l_head tensor([0.5878, 0.5771, 1.7345, 1.1523, 0.7612, 1.0568, 1.6432, 1.7269, 1.6450,
        0.5836, 0.9337, 0.5654, 0.5699, 0.9302, 1.1304, 1.2825, 0.8910, 0.5680,
        0.5814, 0.6823, 0.9492, 0.9304, 0.5788, 0.9046, 0.5812, 1.2195, 0.8961,
        1.5257, 0.7008, 0.5968, 1.0272, 0.9861, 0.9100, 1.2189, 0.6884, 0.5541,
        0.5942, 0.5844, 0.5791, 0.8083, 0.8057, 0.5800, 0.5843, 0.7742, 0.7441,
        0.5714, 0.6835, 0.5918, 0.7704, 0.7426, 0.5733, 0.7049, 0.5851, 0.8752,
        0.6957, 0.5722, 0.6975, 0.7340, 0.7988, 0.5647, 0.5774, 0.5933, 0.7801,
        0.5862, 0.5832, 0.5842, 0.5869, 0.8036, 0.5920, 0.7629, 0.5852, 0.7314,
        0.5649, 0.5674, 0.5810, 0.5863, 0.5948, 0.5910, 0.6742, 0.5745, 0.5783,
        0.5750, 0.5628, 0.5900, 0.5820, 0.5839, 0.5658, 0.7737, 0.5870, 0.5896,
        0.5835, 0.5848, 0.5883, 0.5680, 0.5845, 0.5837, 0.6641, 0.5772, 0.7159,
        0.8073], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.8554, 1.8142, 2.1329, 1.6864, 1.9235, 1.4702, 1.5654, 1.9325, 1.6098,
        1.7897, 1.7342, 1.7803, 1.6986, 1.6524, 1.6970, 1.4852, 1.2726, 1.4984,
        1.4934, 1.0972, 1.6250, 1.3747, 1.2702, 1.6683, 1.4627, 1.0528, 0.9036,
        0.9481, 1.1320, 1.2499, 1.3629, 1.0536, 1.0746, 1.0095, 0.9620, 0.8845,
        0.8922, 1.0919, 0.8791, 0.9081, 0.7482, 0.9514, 0.8733, 0.7447, 0.7935,
        0.8108, 0.7718, 0.9174, 0.7338, 1.1469, 0.7477, 0.7254, 0.9140, 0.9637,
        0.7372, 0.7498, 0.6908, 0.6913, 0.7535, 0.8163, 0.9674, 0.7124, 0.7341,
        0.6442, 0.6739, 0.6297, 0.6300, 0.7545, 0.6931, 0.6724, 0.7048, 0.7915,
        0.5997, 0.7068, 0.6395, 0.6094, 0.6877, 0.6101, 0.6260, 0.6388, 0.6115,
        0.5747, 0.6373, 0.6563, 0.6323, 0.6036, 0.6391, 0.6033, 0.5679, 0.6169,
        0.6093, 0.5640, 0.5888, 0.6008, 0.6070, 0.6751, 0.6018, 0.5710, 0.5983,
        0.6096], device='cuda:4', grad_fn=<NormBackward1>)  3%|▎         | 16/500 [39:16<19:51:29, 147.71s/it]  3%|▎         | 17/500 [41:39<19:39:37, 146.54s/it]
The value of constant scaler:  tensor([7.2957], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.26993865030674846, middle:0.2571428571428571, tail0.0
3shot of client 1:head:0.5524861878453039, middle:0.19047619047619047, tail0.09090909090909091
3shot of client 2:head:0.15671641791044777, middle:0.05714285714285714, tail0.0
3shot of client 3:head:0.4050632911392405, middle:0.04838709677419355, tail0.0
3shot of client 4:head:0.3128491620111732, middle:0.21951219512195122, tail0.2
3shot of client 5:head:0.16981132075471697, middle:0.11538461538461539, tail0.0
3shot of client 6:head:0.28780487804878047, middle:0.14814814814814814, tail0.0
3shot of client 7:head:0.2229299363057325, middle:0.05, tail0.2222222222222222
3shot of client 8:head:0.4074074074074074, middle:0.1111111111111111, tail0.0
3shot of client 9:head:0.25161290322580643, middle:0.05714285714285714, tail0.1
3shot of client 10:head:0.4672897196261682, middle:0.15384615384615385, tail0.0
3shot of client 11:head:0.088, middle:0.03125, tail0.125
3shot of client 12:head:0.4095744680851064, middle:0.06, tail0.08333333333333333
3shot of client 13:head:0.4358974358974359, middle:0.15625, tail0.0
3shot of client 14:head:0.20304568527918782, middle:0.09523809523809523, tail0.0
3shot of client 15:head:0.20168067226890757, middle:0.06451612903225806, tail0.14285714285714285
3shot of client 16:head:0.4233128834355828, middle:0.1891891891891892, tail0.0
3shot of client 17:head:0.4140127388535032, middle:0.04878048780487805, tail0.1
3shot of client 18:head:0.2894736842105263, middle:0.1864406779661017, tail0.0
3shot of client 19:head:0.34552845528455284, middle:0.05263157894736842, tail0.14285714285714285
3shot of client 20:head:0.16939890710382513, middle:0.1276595744680851, tail0.0
3shot of client 21:head:0.2680851063829787, middle:0.22033898305084745, tail0.0
3shot of client 22:head:0.310126582278481, middle:0.1388888888888889, tail0.0
3shot of client 23:head:0.05434782608695652, middle:0.02127659574468085, tail0.0
3shot of client 24:head:0.2, middle:0.05405405405405406, tail0.14285714285714285
3shot of client 25:head:0.5, middle:0.1935483870967742, tail0.0
3shot of client 26:head:0.2564102564102564, middle:0.17857142857142858, tail0.0
3shot of client 27:head:0.22962962962962963, middle:0.4375, tail0.0
3shot of client 28:head:0.1796116504854369, middle:0.06, tail0.0
3shot of client 29:head:0.4855769230769231, middle:0.0, tail0.09090909090909091
3shot of client 30:head:0.3153153153153153, middle:0.13333333333333333, tail0.0
3shot of client 31:head:0.37823834196891193, middle:0.02040816326530612, tail0.0
3shot of client 32:head:0.1523809523809524, middle:0.04, tail0.3333333333333333
3shot of client 33:head:0.39572192513368987, middle:0.11363636363636363, tail0.0
3shot of client 34:head:0.1165644171779141, middle:0.0, tail0.0
3shot of client 35:head:0.3391304347826087, middle:0.26666666666666666, tail0.0
3shot of client 36:head:0.1781609195402299, middle:0.043478260869565216, tail0.0
3shot of client 37:head:0.19696969696969696, middle:0.06666666666666667, tail0.0
3shot of client 38:head:0.4930555555555556, middle:0.10526315789473684, tail0.0
3shot of client 39:head:0.26262626262626265, middle:0.07407407407407407, tail0.0
round 16, local average test acc  0.2491 

round 16, local macro average F1 score  0.1004 

round 16, local weighted average F1 score  0.2122 

round 16, global test acc  0.0923 

round 16, average 3shot acc: [head: 0.2949, middle: 0.1147, tail: 0.0444] 

round 16, global 3shot acc: [head: 0.3368, middle: 0.0296, tail: 0.0014] 

l_head tensor([0.5878, 0.5771, 1.7345, 1.1523, 0.7612, 1.0568, 1.6432, 1.7269, 1.6450,
        0.5836, 0.9337, 0.5654, 0.5699, 0.9302, 1.1304, 1.2825, 0.8910, 0.5680,
        0.5814, 0.6823, 0.9492, 0.9304, 0.5788, 0.9046, 0.5812, 1.2195, 0.8961,
        1.5257, 0.7008, 0.5968, 1.0272, 0.9861, 0.9100, 1.2189, 0.6884, 0.5541,
        0.5942, 0.5844, 0.5791, 0.8083, 0.8057, 0.5800, 0.5843, 0.7742, 0.7441,
        0.5714, 0.6835, 0.5918, 0.7704, 0.7426, 0.5733, 0.7049, 0.5851, 0.8752,
        0.6957, 0.5722, 0.6975, 0.7340, 0.7988, 0.5647, 0.5774, 0.5933, 0.7801,
        0.5862, 0.5832, 0.5842, 0.5869, 0.8036, 0.5920, 0.7629, 0.5852, 0.7314,
        0.5649, 0.5674, 0.5810, 0.5863, 0.5948, 0.5910, 0.6742, 0.5745, 0.5783,
        0.5750, 0.5628, 0.5900, 0.5820, 0.5839, 0.5658, 0.7737, 0.5870, 0.5896,
        0.5835, 0.5848, 0.5883, 0.5680, 0.5845, 0.5837, 0.6641, 0.5772, 0.7159,
        0.8073], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.9314, 1.8498, 2.1119, 1.7732, 1.9731, 1.4967, 1.6423, 1.9583, 1.6424,
        1.8383, 1.7783, 1.7944, 1.7012, 1.6620, 1.7139, 1.5166, 1.3331, 1.5657,
        1.5111, 1.1027, 1.6242, 1.4010, 1.2842, 1.7356, 1.4851, 1.1160, 0.8925,
        0.9644, 1.1327, 1.2605, 1.4056, 1.0636, 1.0781, 1.0171, 0.9707, 0.9049,
        0.9854, 1.0900, 0.8958, 0.9134, 0.7856, 0.9612, 0.8806, 0.7590, 0.8029,
        0.8217, 0.8056, 0.9358, 0.7431, 1.1631, 0.7626, 0.7477, 0.9333, 1.0026,
        0.7614, 0.7601, 0.7172, 0.7010, 0.7473, 0.8344, 0.9998, 0.7459, 0.7636,
        0.6574, 0.6768, 0.6391, 0.6335, 0.7678, 0.7076, 0.6786, 0.7286, 0.8080,
        0.6189, 0.7141, 0.6485, 0.6070, 0.6941, 0.6245, 0.6282, 0.6580, 0.6156,
        0.5744, 0.6507, 0.6645, 0.6312, 0.6075, 0.6518, 0.6035, 0.5710, 0.6240,
        0.6112, 0.5660, 0.5962, 0.6005, 0.6068, 0.6851, 0.6030, 0.5757, 0.6025,
        0.6098], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([7.4848], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.2883435582822086, middle:0.22857142857142856, tail0.0
3shot of client 1:head:0.5469613259668509, middle:0.19047619047619047, tail0.09090909090909091
3shot of client 2:head:0.208955223880597, middle:0.05714285714285714, tail0.0
3shot of client 3:head:0.3881856540084388, middle:0.03225806451612903, tail0.0
3shot of client 4:head:0.24581005586592178, middle:0.24390243902439024, tail0.0
3shot of client 5:head:0.29245283018867924, middle:0.15384615384615385, tail0.0
3shot of client 6:head:0.2634146341463415, middle:0.14814814814814814, tail0.09090909090909091
3shot of client 7:head:0.3885350318471338, middle:0.025, tail0.2222222222222222
3shot of client 8:head:0.43703703703703706, middle:0.1111111111111111, tail0.0
3shot of client 9:head:0.27741935483870966, middle:0.08571428571428572, tail0.1
3shot of client 10:head:0.42990654205607476, middle:0.15384615384615385, tail0.0
3shot of client 11:head:0.104, middle:0.03125, tail0.25
3shot of client 12:head:0.40425531914893614, middle:0.02, tail0.0
3shot of client 13:head:0.4188034188034188, middle:0.28125, tail0.14285714285714285
3shot of client 14:head:0.233502538071066, middle:0.09523809523809523, tail0.0
3shot of client 15:head:0.25210084033613445, middle:0.0967741935483871, tail0.14285714285714285
3shot of client 16:head:0.4233128834355828, middle:0.1891891891891892, tail0.0
3shot of client 17:head:0.3885350318471338, middle:0.04878048780487805, tail0.1
3shot of client 18:head:0.29699248120300753, middle:0.1694915254237288, tail0.0
3shot of client 19:head:0.3902439024390244, middle:0.07017543859649122, tail0.07142857142857142
3shot of client 20:head:0.14754098360655737, middle:0.1276595744680851, tail0.08333333333333333
3shot of client 21:head:0.3148936170212766, middle:0.05084745762711865, tail0.0
3shot of client 22:head:0.3227848101265823, middle:0.1388888888888889, tail0.0
3shot of client 23:head:0.07065217391304347, middle:0.02127659574468085, tail0.0
3shot of client 24:head:0.21481481481481482, middle:0.08108108108108109, tail0.14285714285714285
3shot of client 25:head:0.4453125, middle:0.22580645161290322, tail0.0
3shot of client 26:head:0.29914529914529914, middle:0.32142857142857145, tail0.14285714285714285
3shot of client 27:head:0.2814814814814815, middle:0.4375, tail0.0
3shot of client 28:head:0.20388349514563106, middle:0.06, tail0.0
3shot of client 29:head:0.46634615384615385, middle:0.0, tail0.09090909090909091
3shot of client 30:head:0.3153153153153153, middle:0.2, tail0.0
3shot of client 31:head:0.32124352331606215, middle:0.08163265306122448, tail0.0
3shot of client 32:head:0.18095238095238095, middle:0.04, tail0.3333333333333333  4%|▎         | 18/500 [44:03<19:29:54, 145.63s/it]
3shot of client 33:head:0.37433155080213903, middle:0.11363636363636363, tail0.0
3shot of client 34:head:0.4662576687116564, middle:0.0, tail0.0
3shot of client 35:head:0.3652173913043478, middle:0.23333333333333334, tail0.14285714285714285
3shot of client 36:head:0.15517241379310345, middle:0.021739130434782608, tail0.0
3shot of client 37:head:0.36363636363636365, middle:0.08888888888888889, tail0.0
3shot of client 38:head:0.5138888888888888, middle:0.02631578947368421, tail0.0
3shot of client 39:head:0.29292929292929293, middle:0.07407407407407407, tail0.0
round 17, local average test acc  0.2697 

round 17, local macro average F1 score  0.1071 

round 17, local weighted average F1 score  0.2318 

round 17, global test acc  0.0962 

round 17, average 3shot acc: [head: 0.3199, middle: 0.1194, tail: 0.0537] 

round 17, global 3shot acc: [head: 0.3428, middle: 0.0352, tail: 0.0034] 

l_head tensor([0.5878, 0.5771, 1.7345, 1.1523, 0.7612, 1.0568, 1.6432, 1.7269, 1.6450,
        0.5836, 0.9337, 0.5654, 0.5699, 0.9302, 1.1304, 1.2825, 0.8910, 0.5680,
        0.5814, 0.6823, 0.9492, 0.9304, 0.5788, 0.9046, 0.5812, 1.2195, 0.8961,
        1.5257, 0.7008, 0.5968, 1.0272, 0.9861, 0.9100, 1.2189, 0.6884, 0.5541,
        0.5942, 0.5844, 0.5791, 0.8083, 0.8057, 0.5800, 0.5843, 0.7742, 0.7441,
        0.5714, 0.6835, 0.5918, 0.7704, 0.7426, 0.5733, 0.7049, 0.5851, 0.8752,
        0.6957, 0.5722, 0.6975, 0.7340, 0.7988, 0.5647, 0.5774, 0.5933, 0.7801,
        0.5862, 0.5832, 0.5842, 0.5869, 0.8036, 0.5920, 0.7629, 0.5852, 0.7314,
        0.5649, 0.5674, 0.5810, 0.5863, 0.5948, 0.5910, 0.6742, 0.5745, 0.5783,
        0.5750, 0.5628, 0.5900, 0.5820, 0.5839, 0.5658, 0.7737, 0.5870, 0.5896,
        0.5835, 0.5848, 0.5883, 0.5680, 0.5845, 0.5837, 0.6641, 0.5772, 0.7159,
        0.8073], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.9222, 1.9026, 2.1209, 1.8064, 2.0144, 1.5208, 1.6764, 1.9716, 1.6536,
        1.8145, 1.7808, 1.8629, 1.7321, 1.7304, 1.7173, 1.5457, 1.3320, 1.6159,
        1.5022, 1.1345, 1.6600, 1.4323, 1.3002, 1.7687, 1.5268, 1.1376, 0.9104,
        1.0024, 1.1627, 1.2662, 1.4206, 1.0986, 1.0828, 1.0364, 0.9745, 0.9287,
        0.9749, 1.0908, 0.9163, 0.9403, 0.8336, 0.9746, 0.8951, 0.7870, 0.8613,
        0.8450, 0.7928, 0.9590, 0.7599, 1.1690, 0.7689, 0.7578, 0.9579, 1.0097,
        0.7900, 0.7666, 0.7294, 0.7096, 0.7811, 0.8371, 1.0685, 0.7755, 0.7971,
        0.6812, 0.6852, 0.6565, 0.6377, 0.7825, 0.7161, 0.6949, 0.7551, 0.8065,
        0.6197, 0.7210, 0.6578, 0.6064, 0.7101, 0.6278, 0.6305, 0.6706, 0.6208,
        0.5791, 0.6620, 0.6711, 0.6366, 0.6199, 0.6541, 0.6036, 0.5787, 0.6219,
        0.6215, 0.5663, 0.6143, 0.6004, 0.6139, 0.6918, 0.6031, 0.5748, 0.6113,
        0.6088], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([7.6644], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.3619631901840491, middle:0.17142857142857143, tail0.0
3shot of client 1:head:0.5303867403314917, middle:0.19047619047619047, tail0.09090909090909091
3shot of client 2:head:0.21641791044776118, middle:0.08571428571428572, tail0.0
3shot of client 3:head:0.3080168776371308, middle:0.03225806451612903, tail0.0
3shot of client 4:head:0.2346368715083799, middle:0.2682926829268293, tail0.0
3shot of client 5:head:0.330188679245283, middle:0.07692307692307693, tail0.0
3shot of client 6:head:0.28292682926829266, middle:0.14814814814814814, tail0.09090909090909091
3shot of client 7:head:0.3885350318471338, middle:0.025, tail0.1111111111111111
3shot of client 8:head:0.4148148148148148, middle:0.05555555555555555, tail0.0
3shot of client 9:head:0.2645161290322581, middle:0.08571428571428572, tail0.2
3shot of client 10:head:0.4485981308411215, middle:0.11538461538461539, tail0.0
3shot of client 11:head:0.536, middle:0.125, tail0.25
3shot of client 12:head:0.43617021276595747, middle:0.08, tail0.0
3shot of client 13:head:0.41025641025641024, middle:0.1875, tail0.14285714285714285
3shot of client 14:head:0.4263959390862944, middle:0.047619047619047616, tail0.0
3shot of client 15:head:0.23529411764705882, middle:0.0967741935483871, tail0.14285714285714285
3shot of client 16:head:0.4539877300613497, middle:0.16216216216216217, tail0.0
3shot of client 17:head:0.40764331210191085, middle:0.04878048780487805, tail0.1
3shot of client 18:head:0.31954887218045114, middle:0.1864406779661017, tail0.0
3shot of client 19:head:0.37398373983739835, middle:0.07017543859649122, tail0.07142857142857142
3shot of client 20:head:0.15846994535519127, middle:0.1702127659574468, tail0.16666666666666666
3shot of client 21:head:0.33191489361702126, middle:0.13559322033898305, tail0.0
3shot of client 22:head:0.34177215189873417, middle:0.16666666666666666, tail0.0
3shot of client 23:head:0.20108695652173914, middle:0.1276595744680851, tail0.08333333333333333
3shot of client 24:head:0.17777777777777778, middle:0.02702702702702703, tail0.14285714285714285
3shot of client 25:head:0.46875, middle:0.0967741935483871, tail0.0
3shot of client 26:head:0.2905982905982906, middle:0.25, tail0.0
3shot of client 27:head:0.2740740740740741, middle:0.375, tail0.0
3shot of client 28:head:0.1941747572815534, middle:0.06, tail0.0
3shot of client 29:head:0.44711538461538464, middle:0.04081632653061224, tail0.09090909090909091
3shot of client 30:head:0.25225225225225223, middle:0.3333333333333333, tail0.0
3shot of client 31:head:0.36787564766839376, middle:0.08163265306122448, tail0.0
3shot of client 32:head:0.18095238095238095, middle:0.04, tail0.5
3shot of client 33:head:0.42780748663101603, middle:0.11363636363636363, tail0.0
3shot of client 34:head:0.3006134969325153, middle:0.05405405405405406, tail0.2
3shot of client 35:head:0.3565217391304348, middle:0.26666666666666666, tail0.0
3shot of client 36:head:0.15517241379310345, middle:0.043478260869565216, tail0.0
3shot of client 37:head:0.37373737373737376, middle:0.1111111111111111, tail0.0
3shot of client 38:head:0.4583333333333333, middle:0.15789473684210525, tail0.1111111111111111
3shot of client 39:head:0.2828282828282828, middle:0.16666666666666666, tail0.08333333333333333
round 18, local average test acc  0.2839 

round 18, local macro average F1 score  0.1199 

round 18, local weighted average F1 score  0.2642 

round 18, global test acc  0.1044 

round 18, average 3shot acc: [head: 0.3356, middle: 0.1269, tail: 0.0645] 

round 18, global 3shot acc: [head: 0.3456, middle: 0.0564, tail: 0.0078] 

l_head tensor([0.5878, 0.5772, 2.0252, 1.3328, 0.8009, 1.4840, 1.7111, 2.0266, 1.7085,
        0.5836, 1.1447, 0.5655, 0.5700, 1.1710, 1.2748, 1.5337, 1.1463, 0.5680,
        0.5814, 0.7272, 1.1947, 1.0879, 0.5788, 1.2034, 0.5813, 1.6395, 1.0587,
        1.8584, 0.8089, 0.5969, 1.1735, 1.2738, 1.0119, 1.4189, 0.7084, 0.5542,
        0.5943, 0.5845, 0.5792, 0.9459, 0.8812, 0.5801, 0.5843, 0.8685, 0.8716,
        0.5715, 0.7754, 0.5919, 0.9638, 0.9062, 0.5734, 0.8025, 0.5851, 1.0275,
        0.7461, 0.5723, 0.7208, 0.8119, 0.8632, 0.5648, 0.5774, 0.5933, 0.9189,
        0.5862, 0.5832, 0.5842, 0.5869, 1.0337, 0.5921, 0.9039, 0.5853, 0.8624,
        0.5649, 0.5675, 0.5811, 0.5864, 0.5949, 0.5911, 0.8132, 0.5746, 0.5784,
        0.5750, 0.5628, 0.5901, 0.5821, 0.5840, 0.5659, 0.9459, 0.5871, 0.5897,
        0.5836, 0.5849, 0.5883, 0.5681, 0.5846, 0.5838, 0.7638, 0.5773, 0.7767,
        0.9700], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.9534, 1.9103, 2.1100, 1.8535, 1.9667, 1.5698, 1.7380, 2.0758, 1.6673,
        1.8502, 1.7897, 1.8595, 1.7727, 1.7656, 1.7181, 1.5585, 1.3523, 1.6327,
        1.5339, 1.1063, 1.6570, 1.4645, 1.2812, 1.8101, 1.5555, 1.1339, 0.9166,
        1.0214, 1.2049, 1.3079, 1.4283, 1.1255, 1.0665, 1.0854, 0.9999, 0.9474,
        0.9917, 1.1025, 0.9266, 0.9390, 0.8590, 1.0046, 0.9076, 0.8145, 0.8750,
        0.8667, 0.8033, 1.0017, 0.7691, 1.2065, 0.7942, 0.7603, 1.0279, 1.0382,
        0.8068, 0.7729, 0.7359, 0.7462, 0.7803, 0.8738, 1.0887, 0.7888, 0.8235,
        0.6884, 0.6848, 0.6677, 0.6405, 0.7899, 0.7353, 0.7075, 0.7676, 0.8033,
        0.6289, 0.7467, 0.6560, 0.6103, 0.7280, 0.6365, 0.6417, 0.6670, 0.6249,
        0.5906, 0.6784, 0.6826, 0.6443, 0.6222, 0.6528, 0.6038, 0.5834, 0.6227,
        0.6209, 0.5715, 0.6235, 0.6004, 0.6137, 0.7112, 0.6046, 0.5759, 0.6152,
        0.6143], device='cuda:4', grad_fn=<NormBackward1>)  4%|▍         | 19/500 [46:29<19:27:23, 145.62s/it]  4%|▍         | 20/500 [49:00<19:38:15, 147.28s/it]
The value of constant scaler:  tensor([7.8781], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.32515337423312884, middle:0.14285714285714285, tail0.0
3shot of client 1:head:0.5580110497237569, middle:0.21428571428571427, tail0.09090909090909091
3shot of client 2:head:0.208955223880597, middle:0.11428571428571428, tail0.0
3shot of client 3:head:0.3291139240506329, middle:0.04838709677419355, tail0.0
3shot of client 4:head:0.2346368715083799, middle:0.2682926829268293, tail0.0
3shot of client 5:head:0.39622641509433965, middle:0.11538461538461539, tail0.0
3shot of client 6:head:0.2926829268292683, middle:0.2037037037037037, tail0.09090909090909091
3shot of client 7:head:0.37579617834394907, middle:0.075, tail0.1111111111111111
3shot of client 8:head:0.4222222222222222, middle:0.08333333333333333, tail0.125
3shot of client 9:head:0.25806451612903225, middle:0.14285714285714285, tail0.1
3shot of client 10:head:0.45794392523364486, middle:0.23076923076923078, tail0.0
3shot of client 11:head:0.56, middle:0.0625, tail0.25
3shot of client 12:head:0.44148936170212766, middle:0.06, tail0.08333333333333333
3shot of client 13:head:0.452991452991453, middle:0.21875, tail0.14285714285714285
3shot of client 14:head:0.4010152284263959, middle:0.047619047619047616, tail0.0
3shot of client 15:head:0.2605042016806723, middle:0.06451612903225806, tail0.14285714285714285
3shot of client 16:head:0.5950920245398773, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.445859872611465, middle:0.04878048780487805, tail0.1
3shot of client 18:head:0.424812030075188, middle:0.1016949152542373, tail0.11764705882352941
3shot of client 19:head:0.3252032520325203, middle:0.10526315789473684, tail0.07142857142857142
3shot of client 20:head:0.16393442622950818, middle:0.1276595744680851, tail0.08333333333333333
3shot of client 21:head:0.33191489361702126, middle:0.1016949152542373, tail0.0
3shot of client 22:head:0.3924050632911392, middle:0.1111111111111111, tail0.1
3shot of client 23:head:0.21195652173913043, middle:0.19148936170212766, tail0.08333333333333333
3shot of client 24:head:0.2, middle:0.02702702702702703, tail0.14285714285714285
3shot of client 25:head:0.4609375, middle:0.16129032258064516, tail0.0
3shot of client 26:head:0.42735042735042733, middle:0.21428571428571427, tail0.0
3shot of client 27:head:0.28888888888888886, middle:0.4375, tail0.0
3shot of client 28:head:0.4320388349514563, middle:0.1, tail0.0
3shot of client 29:head:0.4807692307692308, middle:0.04081632653061224, tail0.09090909090909091
3shot of client 30:head:0.26126126126126126, middle:0.3333333333333333, tail0.0
3shot of client 31:head:0.26424870466321243, middle:0.24489795918367346, tail0.0
3shot of client 32:head:0.19047619047619047, middle:0.04, tail0.3333333333333333
3shot of client 33:head:0.41711229946524064, middle:0.11363636363636363, tail0.0
3shot of client 34:head:0.36809815950920244, middle:0.16216216216216217, tail0.2
3shot of client 35:head:0.3739130434782609, middle:0.23333333333333334, tail0.0
3shot of client 36:head:0.15517241379310345, middle:0.021739130434782608, tail0.0
3shot of client 37:head:0.3787878787878788, middle:0.15555555555555556, tail0.0
3shot of client 38:head:0.4722222222222222, middle:0.15789473684210525, tail0.1111111111111111
3shot of client 39:head:0.23232323232323232, middle:0.16666666666666666, tail0.08333333333333333
round 19, local average test acc  0.3028 

round 19, local macro average F1 score  0.1238 

round 19, local weighted average F1 score  0.2618 

round 19, global test acc  0.1120 

round 19, average 3shot acc: [head: 0.3567, middle: 0.1400, tail: 0.0664] 

round 19, global 3shot acc: [head: 0.3820, middle: 0.0476, tail: 0.0092] 

l_head tensor([0.5878, 0.5772, 2.0252, 1.3328, 0.8009, 1.4840, 1.7111, 2.0266, 1.7085,
        0.5836, 1.1447, 0.5655, 0.5700, 1.1710, 1.2748, 1.5337, 1.1463, 0.5680,
        0.5814, 0.7272, 1.1947, 1.0879, 0.5788, 1.2034, 0.5813, 1.6395, 1.0587,
        1.8584, 0.8089, 0.5969, 1.1735, 1.2738, 1.0119, 1.4189, 0.7084, 0.5542,
        0.5943, 0.5845, 0.5792, 0.9459, 0.8812, 0.5801, 0.5843, 0.8685, 0.8716,
        0.5715, 0.7754, 0.5919, 0.9638, 0.9062, 0.5734, 0.8025, 0.5851, 1.0275,
        0.7461, 0.5723, 0.7208, 0.8119, 0.8632, 0.5648, 0.5774, 0.5933, 0.9189,
        0.5862, 0.5832, 0.5842, 0.5869, 1.0337, 0.5921, 0.9039, 0.5853, 0.8624,
        0.5649, 0.5675, 0.5811, 0.5864, 0.5949, 0.5911, 0.8132, 0.5746, 0.5784,
        0.5750, 0.5628, 0.5901, 0.5821, 0.5840, 0.5659, 0.9459, 0.5871, 0.5897,
        0.5836, 0.5849, 0.5883, 0.5681, 0.5846, 0.5838, 0.7638, 0.5773, 0.7767,
        0.9700], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.0609, 1.9861, 2.1666, 1.8379, 1.9983, 1.6376, 1.7431, 2.1009, 1.6980,
        1.8293, 1.7825, 1.8517, 1.8046, 1.8388, 1.7707, 1.5919, 1.4188, 1.6598,
        1.5453, 1.1499, 1.7138, 1.5313, 1.2925, 1.8309, 1.5854, 1.1533, 0.9397,
        1.0324, 1.2090, 1.3506, 1.4855, 1.1372, 1.1150, 1.1097, 1.0022, 1.0262,
        0.9887, 1.1375, 0.9356, 0.9642, 0.9076, 1.0599, 0.9065, 0.8495, 0.8869,
        0.8760, 0.8194, 1.0340, 0.8299, 1.2501, 0.8082, 0.7569, 1.0451, 1.0438,
        0.8323, 0.7745, 0.7526, 0.7536, 0.8411, 0.8733, 1.1258, 0.8193, 0.8167,
        0.7286, 0.6973, 0.6792, 0.6530, 0.8047, 0.7381, 0.7151, 0.7725, 0.8052,
        0.6351, 0.7553, 0.6623, 0.6134, 0.7490, 0.6393, 0.6450, 0.6721, 0.6280,
        0.5921, 0.7001, 0.6944, 0.6453, 0.6268, 0.6521, 0.6038, 0.5866, 0.6279,
        0.6445, 0.5726, 0.6225, 0.6079, 0.6185, 0.7347, 0.6144, 0.5754, 0.6178,
        0.6200], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([8.0366], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.3803680981595092, middle:0.08571428571428572, tail0.0
3shot of client 1:head:0.56353591160221, middle:0.19047619047619047, tail0.09090909090909091
3shot of client 2:head:0.208955223880597, middle:0.08571428571428572, tail0.0
3shot of client 3:head:0.3333333333333333, middle:0.03225806451612903, tail0.0
3shot of client 4:head:0.4134078212290503, middle:0.3902439024390244, tail0.1
3shot of client 5:head:0.3867924528301887, middle:0.11538461538461539, tail0.0
3shot of client 6:head:0.2926829268292683, middle:0.16666666666666666, tail0.0
3shot of client 7:head:0.2611464968152866, middle:0.15, tail0.1111111111111111
3shot of client 8:head:0.2962962962962963, middle:0.2777777777777778, tail0.25
3shot of client 9:head:0.25161290322580643, middle:0.08571428571428572, tail0.1
3shot of client 10:head:0.42990654205607476, middle:0.15384615384615385, tail0.0
3shot of client 11:head:0.56, middle:0.125, tail0.25
3shot of client 12:head:0.4521276595744681, middle:0.08, tail0.08333333333333333
3shot of client 13:head:0.4358974358974359, middle:0.1875, tail0.2857142857142857
3shot of client 14:head:0.3553299492385787, middle:0.19047619047619047, tail0.25
3shot of client 15:head:0.25210084033613445, middle:0.16129032258064516, tail0.14285714285714285
3shot of client 16:head:0.588957055214724, middle:0.13513513513513514, tail0.0
3shot of client 17:head:0.4585987261146497, middle:0.0975609756097561, tail0.2
3shot of client 18:head:0.4323308270676692, middle:0.11864406779661017, tail0.11764705882352941
3shot of client 19:head:0.35772357723577236, middle:0.10526315789473684, tail0.14285714285714285
3shot of client 20:head:0.20765027322404372, middle:0.14893617021276595, tail0.16666666666666666
3shot of client 21:head:0.32340425531914896, middle:0.1694915254237288, tail0.0
3shot of client 22:head:0.3670886075949367, middle:0.1388888888888889, tail0.1
3shot of client 23:head:0.22282608695652173, middle:0.19148936170212766, tail0.08333333333333333
3shot of client 24:head:0.21481481481481482, middle:0.08108108108108109, tail0.14285714285714285
3shot of client 25:head:0.4453125, middle:0.1935483870967742, tail0.0
3shot of client 26:head:0.39316239316239315, middle:0.32142857142857145, tail0.2857142857142857
3shot of client 27:head:0.3333333333333333, middle:0.375, tail0.0
3shot of client 28:head:0.44660194174757284, middle:0.1, tail0.0
3shot of client 29:head:0.4807692307692308, middle:0.0, tail0.09090909090909091
3shot of client 30:head:0.25225225225225223, middle:0.3333333333333333, tail0.16666666666666666  4%|▍         | 21/500 [51:26<19:33:03, 146.94s/it]
3shot of client 31:head:0.3005181347150259, middle:0.30612244897959184, tail0.0
3shot of client 32:head:0.23809523809523808, middle:0.08, tail0.3333333333333333
3shot of client 33:head:0.42245989304812837, middle:0.11363636363636363, tail0.0
3shot of client 34:head:0.4110429447852761, middle:0.1891891891891892, tail0.3
3shot of client 35:head:0.3130434782608696, middle:0.3, tail0.0
3shot of client 36:head:0.23563218390804597, middle:0.08695652173913043, tail0.0
3shot of client 37:head:0.3787878787878788, middle:0.1111111111111111, tail0.0
3shot of client 38:head:0.4930555555555556, middle:0.07894736842105263, tail0.1111111111111111
3shot of client 39:head:0.2777777777777778, middle:0.2222222222222222, tail0.08333333333333333
round 20, local average test acc  0.3124 

round 20, local macro average F1 score  0.1335 

round 20, local weighted average F1 score  0.2658 

round 20, global test acc  0.1172 

round 20, average 3shot acc: [head: 0.3617, middle: 0.1619, tail: 0.0997] 

round 20, global 3shot acc: [head: 0.3844, middle: 0.0696, tail: 0.0074] 

l_head tensor([0.5878, 0.5772, 2.0252, 1.3328, 0.8009, 1.4840, 1.7111, 2.0266, 1.7085,
        0.5836, 1.1447, 0.5655, 0.5700, 1.1710, 1.2748, 1.5337, 1.1463, 0.5680,
        0.5814, 0.7272, 1.1947, 1.0879, 0.5788, 1.2034, 0.5813, 1.6395, 1.0587,
        1.8584, 0.8089, 0.5969, 1.1735, 1.2738, 1.0119, 1.4189, 0.7084, 0.5542,
        0.5943, 0.5845, 0.5792, 0.9459, 0.8812, 0.5801, 0.5843, 0.8685, 0.8716,
        0.5715, 0.7754, 0.5919, 0.9638, 0.9062, 0.5734, 0.8025, 0.5851, 1.0275,
        0.7461, 0.5723, 0.7208, 0.8119, 0.8632, 0.5648, 0.5774, 0.5933, 0.9189,
        0.5862, 0.5832, 0.5842, 0.5869, 1.0337, 0.5921, 0.9039, 0.5853, 0.8624,
        0.5649, 0.5675, 0.5811, 0.5864, 0.5949, 0.5911, 0.8132, 0.5746, 0.5784,
        0.5750, 0.5628, 0.5901, 0.5821, 0.5840, 0.5659, 0.9459, 0.5871, 0.5897,
        0.5836, 0.5849, 0.5883, 0.5681, 0.5846, 0.5838, 0.7638, 0.5773, 0.7767,
        0.9700], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.0856, 2.0020, 2.1967, 1.8471, 2.0194, 1.6662, 1.7656, 2.0928, 1.7185,
        1.8857, 1.8077, 1.8337, 1.8051, 1.8641, 1.8030, 1.6173, 1.4037, 1.6950,
        1.6073, 1.1533, 1.7098, 1.5187, 1.3083, 1.8787, 1.6244, 1.2042, 0.9773,
        1.0504, 1.2651, 1.3581, 1.5339, 1.1718, 1.1121, 1.1207, 1.0305, 1.0933,
        1.0109, 1.1732, 0.9490, 0.9785, 0.9108, 1.0843, 0.9087, 0.8644, 0.9124,
        0.8976, 0.8413, 1.0645, 0.8295, 1.2613, 0.8148, 0.7670, 1.0620, 1.1410,
        0.8510, 0.7828, 0.7846, 0.7560, 0.8715, 0.8875, 1.1300, 0.8190, 0.8373,
        0.7233, 0.6906, 0.6988, 0.6768, 0.8243, 0.7570, 0.7103, 0.7840, 0.8245,
        0.6430, 0.7659, 0.6698, 0.6226, 0.7673, 0.6519, 0.6583, 0.6759, 0.6325,
        0.6082, 0.7116, 0.7174, 0.6637, 0.6398, 0.6677, 0.6044, 0.5885, 0.6322,
        0.6419, 0.5741, 0.6387, 0.6117, 0.6236, 0.7476, 0.6143, 0.5810, 0.6216,
        0.6234], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([8.2635], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.3619631901840491, middle:0.22857142857142856, tail0.0
3shot of client 1:head:0.5303867403314917, middle:0.19047619047619047, tail0.09090909090909091
3shot of client 2:head:0.19402985074626866, middle:0.08571428571428572, tail0.0
3shot of client 3:head:0.2869198312236287, middle:0.0967741935483871, tail0.0
3shot of client 4:head:0.4245810055865922, middle:0.36585365853658536, tail0.1
3shot of client 5:head:0.22641509433962265, middle:0.07692307692307693, tail0.0
3shot of client 6:head:0.43902439024390244, middle:0.09259259259259259, tail0.18181818181818182
3shot of client 7:head:0.40764331210191085, middle:0.15, tail0.0
3shot of client 8:head:0.362962962962963, middle:0.2222222222222222, tail0.25
3shot of client 9:head:0.2967741935483871, middle:0.05714285714285714, tail0.2
3shot of client 10:head:0.514018691588785, middle:0.15384615384615385, tail0.0
3shot of client 11:head:0.552, middle:0.15625, tail0.375
3shot of client 12:head:0.43617021276595747, middle:0.02, tail0.08333333333333333
3shot of client 13:head:0.41025641025641024, middle:0.21875, tail0.2857142857142857
3shot of client 14:head:0.40609137055837563, middle:0.09523809523809523, tail0.0
3shot of client 15:head:0.2857142857142857, middle:0.0967741935483871, tail0.14285714285714285
3shot of client 16:head:0.6012269938650306, middle:0.13513513513513514, tail0.0
3shot of client 17:head:0.45222929936305734, middle:0.14634146341463414, tail0.0
3shot of client 18:head:0.4323308270676692, middle:0.1864406779661017, tail0.058823529411764705
3shot of client 19:head:0.4349593495934959, middle:0.10526315789473684, tail0.0
3shot of client 20:head:0.18579234972677597, middle:0.14893617021276595, tail0.08333333333333333
3shot of client 21:head:0.3191489361702128, middle:0.2033898305084746, tail0.0
3shot of client 22:head:0.3924050632911392, middle:0.1111111111111111, tail0.0
3shot of client 23:head:0.1793478260869565, middle:0.23404255319148937, tail0.08333333333333333
3shot of client 24:head:0.23703703703703705, middle:0.05405405405405406, tail0.14285714285714285
3shot of client 25:head:0.4765625, middle:0.12903225806451613, tail0.0
3shot of client 26:head:0.2564102564102564, middle:0.32142857142857145, tail0.14285714285714285
3shot of client 27:head:0.2814814814814815, middle:0.34375, tail0.14285714285714285
3shot of client 28:head:0.46601941747572817, middle:0.12, tail0.0
3shot of client 29:head:0.47596153846153844, middle:0.04081632653061224, tail0.09090909090909091
3shot of client 30:head:0.25225225225225223, middle:0.4666666666666667, tail0.16666666666666666
3shot of client 31:head:0.2849740932642487, middle:0.24489795918367346, tail0.0
3shot of client 32:head:0.24761904761904763, middle:0.12, tail0.3333333333333333
3shot of client 33:head:0.43315508021390375, middle:0.11363636363636363, tail0.0
3shot of client 34:head:0.4294478527607362, middle:0.1891891891891892, tail0.3
3shot of client 35:head:0.3217391304347826, middle:0.26666666666666666, tail0.0
3shot of client 36:head:0.25862068965517243, middle:0.043478260869565216, tail0.0
3shot of client 37:head:0.3787878787878788, middle:0.17777777777777778, tail0.0
3shot of client 38:head:0.4791666666666667, middle:0.05263157894736842, tail0.2222222222222222
3shot of client 39:head:0.26262626262626265, middle:0.2037037037037037, tail0.08333333333333333
round 21, local average test acc  0.3157 

round 21, local macro average F1 score  0.1524 

round 21, local weighted average F1 score  0.2903 

round 21, global test acc  0.1230 

round 21, average 3shot acc: [head: 0.3669, middle: 0.1616, tail: 0.0890] 

round 21, global 3shot acc: [head: 0.3892, middle: 0.0672, tail: 0.0178] 

l_head tensor([0.5878, 0.5772, 2.0252, 1.3328, 0.8009, 1.4840, 1.7111, 2.0266, 1.7085,
        0.5836, 1.1447, 0.5655, 0.5700, 1.1710, 1.2748, 1.5337, 1.1463, 0.5680,
        0.5814, 0.7272, 1.1947, 1.0879, 0.5788, 1.2034, 0.5813, 1.6395, 1.0587,
        1.8584, 0.8089, 0.5969, 1.1735, 1.2738, 1.0119, 1.4189, 0.7084, 0.5542,
        0.5943, 0.5845, 0.5792, 0.9459, 0.8812, 0.5801, 0.5843, 0.8685, 0.8716,
        0.5715, 0.7754, 0.5919, 0.9638, 0.9062, 0.5734, 0.8025, 0.5851, 1.0275,
        0.7461, 0.5723, 0.7208, 0.8119, 0.8632, 0.5648, 0.5774, 0.5933, 0.9189,
        0.5862, 0.5832, 0.5842, 0.5869, 1.0337, 0.5921, 0.9039, 0.5853, 0.8624,
        0.5649, 0.5675, 0.5811, 0.5864, 0.5949, 0.5911, 0.8132, 0.5746, 0.5784,
        0.5750, 0.5628, 0.5901, 0.5821, 0.5840, 0.5659, 0.9459, 0.5871, 0.5897,
        0.5836, 0.5849, 0.5883, 0.5681, 0.5846, 0.5838, 0.7638, 0.5773, 0.7767,
        0.9700], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.1812, 2.0708, 2.2185, 1.9708, 2.0032, 1.7137, 1.8310, 2.1318, 1.7693,
        1.8633, 1.8575, 1.8505, 1.8598, 1.9237, 1.8415, 1.6848, 1.4123, 1.7142,
        1.6276, 1.1533, 1.7480, 1.5991, 1.3261, 1.8889, 1.6863, 1.2372, 1.0167,
        1.0428, 1.2724, 1.3671, 1.5922, 1.1745, 1.1513, 1.1547, 1.0778, 1.1454,
        1.0074, 1.2055, 0.9737, 1.0083, 0.9106, 1.1586, 0.9265, 0.8614, 0.9375,
        0.9270, 0.8344, 1.0911, 0.8424, 1.3035, 0.8270, 0.7772, 1.1312, 1.1222,
        0.8805, 0.7994, 0.7777, 0.7589, 0.8932, 0.9047, 1.1749, 0.8352, 0.8575,
        0.7406, 0.7005, 0.6997, 0.6823, 0.8286, 0.7756, 0.7213, 0.7766, 0.8467,
        0.6505, 0.7613, 0.6805, 0.6379, 0.7853, 0.6621, 0.6635, 0.6789, 0.6365,
        0.6172, 0.7440, 0.7270, 0.6706, 0.6438, 0.6706, 0.6044, 0.5963, 0.6380,
        0.6557, 0.5788, 0.6466, 0.6117, 0.6270, 0.7697, 0.6208, 0.5806, 0.6377,
        0.6333], device='cuda:4', grad_fn=<NormBackward1>)  4%|▍         | 22/500 [53:57<19:40:45, 148.21s/it]  5%|▍         | 23/500 [56:25<19:37:30, 148.11s/it]
The value of constant scaler:  tensor([8.4214], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.4049079754601227, middle:0.17142857142857143, tail0.0
3shot of client 1:head:0.574585635359116, middle:0.19047619047619047, tail0.09090909090909091
3shot of client 2:head:0.1791044776119403, middle:0.05714285714285714, tail0.0
3shot of client 3:head:0.28270042194092826, middle:0.11290322580645161, tail0.06666666666666667
3shot of client 4:head:0.3743016759776536, middle:0.3170731707317073, tail0.1
3shot of client 5:head:0.11320754716981132, middle:0.038461538461538464, tail0.0
3shot of client 6:head:0.35609756097560974, middle:0.2222222222222222, tail0.09090909090909091
3shot of client 7:head:0.3503184713375796, middle:0.15, tail0.1111111111111111
3shot of client 8:head:0.3925925925925926, middle:0.25, tail0.375
3shot of client 9:head:0.2967741935483871, middle:0.05714285714285714, tail0.2
3shot of client 10:head:0.5420560747663551, middle:0.23076923076923078, tail0.0
3shot of client 11:head:0.52, middle:0.15625, tail0.375
3shot of client 12:head:0.4574468085106383, middle:0.04, tail0.08333333333333333
3shot of client 13:head:0.36752136752136755, middle:0.21875, tail0.2857142857142857
3shot of client 14:head:0.38578680203045684, middle:0.07142857142857142, tail0.0
3shot of client 15:head:0.3697478991596639, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.5214723926380368, middle:0.16216216216216217, tail0.0
3shot of client 17:head:0.42038216560509556, middle:0.07317073170731707, tail0.1
3shot of client 18:head:0.41353383458646614, middle:0.15254237288135594, tail0.11764705882352941
3shot of client 19:head:0.3943089430894309, middle:0.08771929824561403, tail0.07142857142857142
3shot of client 20:head:0.20218579234972678, middle:0.1702127659574468, tail0.16666666666666666
3shot of client 21:head:0.2851063829787234, middle:0.2033898305084746, tail0.0
3shot of client 22:head:0.4050632911392405, middle:0.25, tail0.3
3shot of client 23:head:0.18478260869565216, middle:0.0851063829787234, tail0.0
3shot of client 24:head:0.26666666666666666, middle:0.10810810810810811, tail0.14285714285714285
3shot of client 25:head:0.453125, middle:0.22580645161290322, tail0.0
3shot of client 26:head:0.2905982905982906, middle:0.35714285714285715, tail0.0
3shot of client 27:head:0.3037037037037037, middle:0.46875, tail0.14285714285714285
3shot of client 28:head:0.4854368932038835, middle:0.12, tail0.0
3shot of client 29:head:0.4951923076923077, middle:0.10204081632653061, tail0.09090909090909091
3shot of client 30:head:0.25225225225225223, middle:0.36666666666666664, tail0.16666666666666666
3shot of client 31:head:0.29533678756476683, middle:0.20408163265306123, tail0.0
3shot of client 32:head:0.1619047619047619, middle:0.08, tail0.3333333333333333
3shot of client 33:head:0.2994652406417112, middle:0.29545454545454547, tail0.08333333333333333
3shot of client 34:head:0.4110429447852761, middle:0.21621621621621623, tail0.3
3shot of client 35:head:0.34782608695652173, middle:0.2, tail0.14285714285714285
3shot of client 36:head:0.25287356321839083, middle:0.043478260869565216, tail0.09090909090909091
3shot of client 37:head:0.3838383838383838, middle:0.13333333333333333, tail0.0
3shot of client 38:head:0.4444444444444444, middle:0.02631578947368421, tail0.2222222222222222
3shot of client 39:head:0.23232323232323232, middle:0.2037037037037037, tail0.0
round 22, local average test acc  0.3078 

round 22, local macro average F1 score  0.1562 

round 22, local weighted average F1 score  0.2756 

round 22, global test acc  0.1236 

round 22, average 3shot acc: [head: 0.3543, middle: 0.1671, tail: 0.1063] 

round 22, global 3shot acc: [head: 0.3812, middle: 0.0840, tail: 0.0146] 

l_head tensor([0.5878, 0.5772, 2.4028, 1.5433, 0.8982, 1.5345, 1.9650, 2.2813, 2.0595,
        0.5836, 1.3962, 0.5655, 0.5700, 1.4975, 1.4591, 1.7445, 1.2920, 0.5680,
        0.5815, 0.8146, 1.2257, 1.2918, 0.5789, 1.3557, 0.5813, 1.8838, 1.1963,
        2.2398, 0.8817, 0.5969, 1.4648, 1.5924, 1.1286, 1.7309, 0.8281, 0.5542,
        0.5943, 0.5845, 0.5792, 1.0828, 1.1022, 0.5801, 0.5843, 0.9833, 1.0568,
        0.5715, 0.9666, 0.5919, 1.0578, 0.9966, 0.5734, 0.9351, 0.5851, 1.1547,
        0.8492, 0.5723, 0.9152, 0.9420, 0.9400, 0.5648, 0.5774, 0.5934, 1.1106,
        0.5862, 0.5833, 0.5843, 0.5870, 1.1401, 0.5921, 0.9936, 0.5853, 1.0312,
        0.5649, 0.5675, 0.5811, 0.5864, 0.5949, 0.5911, 0.9470, 0.5746, 0.5784,
        0.5751, 0.5628, 0.5901, 0.5821, 0.5840, 0.5659, 1.0999, 0.5871, 0.5897,
        0.5836, 0.5849, 0.5883, 0.5681, 0.5846, 0.5838, 0.8201, 0.5773, 0.8563,
        1.1237], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.1971, 2.0843, 2.2572, 1.9813, 2.0095, 1.7663, 1.8831, 2.1505, 1.8121,
        1.9230, 1.8805, 1.8364, 1.9404, 1.9627, 1.8259, 1.6993, 1.4185, 1.7399,
        1.6235, 1.1740, 1.7719, 1.6127, 1.3528, 1.9698, 1.6950, 1.2569, 1.0455,
        1.0800, 1.2807, 1.4382, 1.6334, 1.1832, 1.1454, 1.2153, 1.0907, 1.1583,
        1.0383, 1.1815, 0.9918, 1.0538, 0.9444, 1.1670, 0.9317, 0.9153, 0.9484,
        0.9444, 0.8486, 1.1692, 0.8797, 1.3101, 0.8458, 0.7947, 1.1388, 1.1729,
        0.8709, 0.7990, 0.8201, 0.7762, 0.9223, 0.9261, 1.2357, 0.8666, 0.8750,
        0.7423, 0.6953, 0.7048, 0.6939, 0.8229, 0.7890, 0.7299, 0.8226, 0.8569,
        0.6584, 0.7717, 0.6913, 0.6420, 0.7738, 0.6779, 0.6952, 0.6884, 0.6396,
        0.6168, 0.7460, 0.7613, 0.7002, 0.6648, 0.6720, 0.6035, 0.5938, 0.6397,
        0.6618, 0.5825, 0.6649, 0.6132, 0.6266, 0.7693, 0.6240, 0.5858, 0.6427,
        0.6350], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([8.5957], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.3312883435582822, middle:0.4, tail0.0
3shot of client 1:head:0.6077348066298343, middle:0.19047619047619047, tail0.0
3shot of client 2:head:0.23134328358208955, middle:0.05714285714285714, tail0.0
3shot of client 3:head:0.3333333333333333, middle:0.25806451612903225, tail0.0
3shot of client 4:head:0.25139664804469275, middle:0.34146341463414637, tail0.1
3shot of client 5:head:0.14150943396226415, middle:0.11538461538461539, tail0.0
3shot of client 6:head:0.35609756097560974, middle:0.12962962962962962, tail0.09090909090909091
3shot of client 7:head:0.3821656050955414, middle:0.1, tail0.2222222222222222
3shot of client 8:head:0.31851851851851853, middle:0.2222222222222222, tail0.375
3shot of client 9:head:0.36129032258064514, middle:0.05714285714285714, tail0.0
3shot of client 10:head:0.5046728971962616, middle:0.19230769230769232, tail0.0
3shot of client 11:head:0.376, middle:0.28125, tail0.125
3shot of client 12:head:0.5159574468085106, middle:0.04, tail0.08333333333333333
3shot of client 13:head:0.41025641025641024, middle:0.21875, tail0.14285714285714285
3shot of client 14:head:0.3401015228426396, middle:0.16666666666666666, tail0.08333333333333333
3shot of client 15:head:0.3277310924369748, middle:0.0967741935483871, tail0.0
3shot of client 16:head:0.5030674846625767, middle:0.13513513513513514, tail0.0
3shot of client 17:head:0.4267515923566879, middle:0.21951219512195122, tail0.1
3shot of client 18:head:0.39849624060150374, middle:0.2033898305084746, tail0.11764705882352941
3shot of client 19:head:0.45934959349593496, middle:0.10526315789473684, tail0.07142857142857142
3shot of client 20:head:0.3825136612021858, middle:0.1276595744680851, tail0.08333333333333333
3shot of client 21:head:0.3659574468085106, middle:0.2542372881355932, tail0.07692307692307693
3shot of client 22:head:0.3987341772151899, middle:0.25, tail0.3
3shot of client 23:head:0.2391304347826087, middle:0.0851063829787234, tail0.0
3shot of client 24:head:0.24444444444444444, middle:0.08108108108108109, tail0.14285714285714285
3shot of client 25:head:0.5, middle:0.22580645161290322, tail0.0
3shot of client 26:head:0.3333333333333333, middle:0.42857142857142855, tail0.14285714285714285
3shot of client 27:head:0.3111111111111111, middle:0.40625, tail0.14285714285714285
3shot of client 28:head:0.4563106796116505, middle:0.1, tail0.0
3shot of client 29:head:0.5144230769230769, middle:0.10204081632653061, tail0.09090909090909091
3shot of client 30:head:0.2702702702702703, middle:0.36666666666666664, tail0.16666666666666666  5%|▍         | 24/500 [58:56<19:41:33, 148.94s/it]
3shot of client 31:head:0.3160621761658031, middle:0.1836734693877551, tail0.0
3shot of client 32:head:0.34285714285714286, middle:0.08, tail0.5
3shot of client 33:head:0.3155080213903743, middle:0.29545454545454547, tail0.08333333333333333
3shot of client 34:head:0.44785276073619634, middle:0.1891891891891892, tail0.3
3shot of client 35:head:0.391304347826087, middle:0.16666666666666666, tail0.0
3shot of client 36:head:0.23563218390804597, middle:0.043478260869565216, tail0.09090909090909091
3shot of client 37:head:0.35353535353535354, middle:0.15555555555555556, tail0.0
3shot of client 38:head:0.4930555555555556, middle:0.05263157894736842, tail0.2222222222222222
3shot of client 39:head:0.24242424242424243, middle:0.18518518518518517, tail0.08333333333333333
round 23, local average test acc  0.3208 

round 23, local macro average F1 score  0.1493 

round 23, local weighted average F1 score  0.2773 

round 23, global test acc  0.1272 

round 23, average 3shot acc: [head: 0.3683, middle: 0.1827, tail: 0.0984] 

round 23, global 3shot acc: [head: 0.3896, middle: 0.0716, tail: 0.0238] 

l_head tensor([0.5878, 0.5772, 2.6636, 1.7804, 0.9816, 1.7057, 2.3249, 2.6035, 2.3980,
        0.5836, 1.5728, 0.5655, 0.5700, 1.6915, 1.5773, 1.9800, 1.5964, 0.5680,
        0.5815, 0.9169, 1.4767, 1.4411, 0.5789, 1.5125, 0.5813, 2.0125, 1.3755,
        2.5532, 1.1033, 0.5969, 1.5975, 1.6807, 1.2333, 2.0009, 0.9941, 0.5542,
        0.5943, 0.5845, 0.5792, 1.2362, 1.2350, 0.5801, 0.5843, 1.1372, 1.2487,
        0.5715, 1.0430, 0.5919, 1.2703, 1.1922, 0.5734, 1.1095, 0.5851, 1.2084,
        0.9905, 0.5723, 1.0457, 1.0863, 1.1433, 0.5648, 0.5774, 0.5934, 1.3117,
        0.5862, 0.5833, 0.5843, 0.5870, 1.3563, 0.5921, 1.1541, 0.5853, 1.1573,
        0.5649, 0.5675, 0.5811, 0.5864, 0.5949, 0.5911, 1.0379, 0.5746, 0.5784,
        0.5751, 0.5629, 0.5901, 0.5821, 0.5840, 0.5659, 1.2562, 0.5871, 0.5897,
        0.5836, 0.5849, 0.5883, 0.5681, 0.5846, 0.5838, 0.8627, 0.5773, 0.8822,
        1.2355], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.2487, 2.1222, 2.3006, 2.0303, 2.0206, 1.7669, 1.9557, 2.2156, 1.9134,
        2.0081, 1.8927, 1.8282, 1.9386, 1.9648, 1.8092, 1.6831, 1.5138, 1.7700,
        1.6689, 1.1420, 1.8025, 1.6219, 1.3811, 1.9578, 1.7324, 1.3475, 1.0464,
        1.1258, 1.3194, 1.4507, 1.6450, 1.2303, 1.1430, 1.2249, 1.1272, 1.1582,
        1.0892, 1.1909, 0.9892, 1.0483, 0.9705, 1.1858, 0.9503, 0.9028, 0.9979,
        0.9594, 0.8763, 1.1836, 0.8955, 1.3868, 0.8606, 0.7869, 1.2071, 1.2017,
        0.9093, 0.8111, 0.8491, 0.7871, 0.9203, 0.9633, 1.2544, 0.8692, 0.9031,
        0.7359, 0.7022, 0.7143, 0.7013, 0.8646, 0.8064, 0.7505, 0.8337, 0.8742,
        0.6689, 0.7891, 0.6944, 0.6424, 0.8035, 0.6982, 0.7133, 0.6966, 0.6464,
        0.6253, 0.7649, 0.7799, 0.7109, 0.6629, 0.6937, 0.6137, 0.5948, 0.6522,
        0.6628, 0.5852, 0.6628, 0.6143, 0.6333, 0.7692, 0.6226, 0.5929, 0.6400,
        0.6398], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([8.7906], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.38650306748466257, middle:0.4, tail0.0
3shot of client 1:head:0.6574585635359116, middle:0.23809523809523808, tail0.0
3shot of client 2:head:0.23880597014925373, middle:0.05714285714285714, tail0.0
3shot of client 3:head:0.4472573839662447, middle:0.12903225806451613, tail0.06666666666666667
3shot of client 4:head:0.37988826815642457, middle:0.2682926829268293, tail0.1
3shot of client 5:head:0.1320754716981132, middle:0.07692307692307693, tail0.0
3shot of client 6:head:0.4146341463414634, middle:0.2222222222222222, tail0.18181818181818182
3shot of client 7:head:0.4140127388535032, middle:0.175, tail0.4444444444444444
3shot of client 8:head:0.37037037037037035, middle:0.2777777777777778, tail0.375
3shot of client 9:head:0.3741935483870968, middle:0.08571428571428572, tail0.0
3shot of client 10:head:0.48598130841121495, middle:0.2692307692307692, tail0.16666666666666666
3shot of client 11:head:0.464, middle:0.3125, tail0.125
3shot of client 12:head:0.43617021276595747, middle:0.1, tail0.16666666666666666
3shot of client 13:head:0.452991452991453, middle:0.28125, tail0.14285714285714285
3shot of client 14:head:0.3604060913705584, middle:0.09523809523809523, tail0.16666666666666666
3shot of client 15:head:0.3865546218487395, middle:0.16129032258064516, tail0.0
3shot of client 16:head:0.588957055214724, middle:0.13513513513513514, tail0.0
3shot of client 17:head:0.45222929936305734, middle:0.1951219512195122, tail0.2
3shot of client 18:head:0.45864661654135336, middle:0.15254237288135594, tail0.0
3shot of client 19:head:0.45528455284552843, middle:0.17543859649122806, tail0.14285714285714285
3shot of client 20:head:0.2786885245901639, middle:0.14893617021276595, tail0.08333333333333333
3shot of client 21:head:0.4, middle:0.23728813559322035, tail0.0
3shot of client 22:head:0.41139240506329117, middle:0.25, tail0.2
3shot of client 23:head:0.22282608695652173, middle:0.10638297872340426, tail0.0
3shot of client 24:head:0.24444444444444444, middle:0.08108108108108109, tail0.14285714285714285
3shot of client 25:head:0.5703125, middle:0.1935483870967742, tail0.0
3shot of client 26:head:0.3504273504273504, middle:0.39285714285714285, tail0.14285714285714285
3shot of client 27:head:0.3333333333333333, middle:0.3125, tail0.14285714285714285
3shot of client 28:head:0.4077669902912621, middle:0.2, tail0.0
3shot of client 29:head:0.4230769230769231, middle:0.1836734693877551, tail0.18181818181818182
3shot of client 30:head:0.26126126126126126, middle:0.3, tail0.16666666666666666
3shot of client 31:head:0.34196891191709844, middle:0.1836734693877551, tail0.0
3shot of client 32:head:0.3619047619047619, middle:0.16, tail0.3333333333333333
3shot of client 33:head:0.29411764705882354, middle:0.3181818181818182, tail0.08333333333333333
3shot of client 34:head:0.49079754601226994, middle:0.16216216216216217, tail0.3
3shot of client 35:head:0.34782608695652173, middle:0.2, tail0.0
3shot of client 36:head:0.25862068965517243, middle:0.06521739130434782, tail0.09090909090909091
3shot of client 37:head:0.3888888888888889, middle:0.17777777777777778, tail0.0
3shot of client 38:head:0.5208333333333334, middle:0.07894736842105263, tail0.2222222222222222
3shot of client 39:head:0.29292929292929293, middle:0.16666666666666666, tail0.08333333333333333
round 24, local average test acc  0.3393 

round 24, local macro average F1 score  0.1800 

round 24, local weighted average F1 score  0.3178 

round 24, global test acc  0.1293 

round 24, average 3shot acc: [head: 0.3889, middle: 0.1932, tail: 0.1113] 

round 24, global 3shot acc: [head: 0.4056, middle: 0.0720, tail: 0.0198] 

l_head tensor([0.5878, 0.5772, 2.6636, 1.7804, 0.9816, 1.7057, 2.3249, 2.6035, 2.3980,
        0.5836, 1.5728, 0.5655, 0.5700, 1.6915, 1.5773, 1.9800, 1.5964, 0.5680,
        0.5815, 0.9169, 1.4767, 1.4411, 0.5789, 1.5125, 0.5813, 2.0125, 1.3755,
        2.5532, 1.1033, 0.5969, 1.5975, 1.6807, 1.2333, 2.0009, 0.9941, 0.5542,
        0.5943, 0.5845, 0.5792, 1.2362, 1.2350, 0.5801, 0.5843, 1.1372, 1.2487,
        0.5715, 1.0430, 0.5919, 1.2703, 1.1922, 0.5734, 1.1095, 0.5851, 1.2084,
        0.9905, 0.5723, 1.0457, 1.0863, 1.1433, 0.5648, 0.5774, 0.5934, 1.3117,
        0.5862, 0.5833, 0.5843, 0.5870, 1.3563, 0.5921, 1.1541, 0.5853, 1.1573,
        0.5649, 0.5675, 0.5811, 0.5864, 0.5949, 0.5911, 1.0379, 0.5746, 0.5784,
        0.5751, 0.5629, 0.5901, 0.5821, 0.5840, 0.5659, 1.2562, 0.5871, 0.5897,
        0.5836, 0.5849, 0.5883, 0.5681, 0.5846, 0.5838, 0.8627, 0.5773, 0.8822,
        1.2355], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.3619, 2.2195, 2.3071, 2.1082, 2.0074, 1.8338, 1.9520, 2.3051, 1.9533,
        2.0358, 1.9230, 1.8620, 1.9707, 2.0078, 1.8442, 1.7129, 1.5438, 1.8065,
        1.6854, 1.1660, 1.9001, 1.6760, 1.3891, 2.0035, 1.7534, 1.3720, 1.0472,
        1.1121, 1.3676, 1.4753, 1.6741, 1.2512, 1.1890, 1.2594, 1.1423, 1.1884,
        1.1073, 1.2320, 0.9960, 1.0954, 0.9821, 1.2167, 0.9786, 0.9293, 0.9953,
        0.9733, 0.9036, 1.2079, 0.9266, 1.4322, 0.8827, 0.7883, 1.2566, 1.1879,
        0.9188, 0.8177, 0.8652, 0.8081, 0.9342, 0.9871, 1.2544, 0.8714, 0.8865,
        0.7435, 0.7084, 0.7193, 0.7044, 0.9302, 0.8394, 0.7582, 0.8245, 0.8690,
        0.6790, 0.7991, 0.7028, 0.6559, 0.8149, 0.7094, 0.7322, 0.7043, 0.6465,
        0.6351, 0.7829, 0.7987, 0.7199, 0.6647, 0.6983, 0.6179, 0.6022, 0.6565,
        0.6765, 0.5866, 0.6608, 0.6185, 0.6409, 0.7863, 0.6298, 0.5986, 0.6387,
        0.6488], device='cuda:4', grad_fn=<NormBackward1>)  5%|▌         | 25/500 [1:01:27<19:44:04, 149.57s/it]  5%|▌         | 26/500 [1:03:50<19:27:20, 147.76s/it]
The value of constant scaler:  tensor([8.9429], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.3803680981595092, middle:0.37142857142857144, tail0.0
3shot of client 1:head:0.6298342541436464, middle:0.16666666666666666, tail0.0
3shot of client 2:head:0.31343283582089554, middle:0.14285714285714285, tail0.0
3shot of client 3:head:0.4345991561181435, middle:0.11290322580645161, tail0.0
3shot of client 4:head:0.41899441340782123, middle:0.2682926829268293, tail0.1
3shot of client 5:head:0.11320754716981132, middle:0.23076923076923078, tail0.0
3shot of client 6:head:0.4, middle:0.18518518518518517, tail0.18181818181818182
3shot of client 7:head:0.36942675159235666, middle:0.125, tail0.3333333333333333
3shot of client 8:head:0.45925925925925926, middle:0.1388888888888889, tail0.25
3shot of client 9:head:0.3419354838709677, middle:0.05714285714285714, tail0.2
3shot of client 10:head:0.48598130841121495, middle:0.23076923076923078, tail0.0
3shot of client 11:head:0.488, middle:0.3125, tail0.25
3shot of client 12:head:0.46808510638297873, middle:0.12, tail0.08333333333333333
3shot of client 13:head:0.46153846153846156, middle:0.25, tail0.2857142857142857
3shot of client 14:head:0.39086294416243655, middle:0.09523809523809523, tail0.25
3shot of client 15:head:0.46218487394957986, middle:0.12903225806451613, tail0.0
3shot of client 16:head:0.558282208588957, middle:0.16216216216216217, tail0.0
3shot of client 17:head:0.5095541401273885, middle:0.14634146341463414, tail0.2
3shot of client 18:head:0.4699248120300752, middle:0.22033898305084745, tail0.17647058823529413
3shot of client 19:head:0.4634146341463415, middle:0.22807017543859648, tail0.14285714285714285
3shot of client 20:head:0.28415300546448086, middle:0.14893617021276595, tail0.08333333333333333
3shot of client 21:head:0.37446808510638296, middle:0.288135593220339, tail0.0
3shot of client 22:head:0.4620253164556962, middle:0.2777777777777778, tail0.3
3shot of client 23:head:0.29347826086956524, middle:0.1276595744680851, tail0.08333333333333333
3shot of client 24:head:0.23703703703703705, middle:0.13513513513513514, tail0.14285714285714285
3shot of client 25:head:0.578125, middle:0.22580645161290322, tail0.125
3shot of client 26:head:0.38461538461538464, middle:0.42857142857142855, tail0.14285714285714285
3shot of client 27:head:0.26666666666666666, middle:0.4375, tail0.14285714285714285
3shot of client 28:head:0.49029126213592233, middle:0.22, tail0.0
3shot of client 29:head:0.4375, middle:0.24489795918367346, tail0.09090909090909091
3shot of client 30:head:0.3063063063063063, middle:0.43333333333333335, tail0.16666666666666666
3shot of client 31:head:0.3316062176165803, middle:0.22448979591836735, tail0.0
3shot of client 32:head:0.3238095238095238, middle:0.16, tail0.6666666666666666
3shot of client 33:head:0.3422459893048128, middle:0.36363636363636365, tail0.0
3shot of client 34:head:0.34355828220858897, middle:0.13513513513513514, tail0.2
3shot of client 35:head:0.3391304347826087, middle:0.23333333333333334, tail0.0
3shot of client 36:head:0.3620689655172414, middle:0.06521739130434782, tail0.18181818181818182
3shot of client 37:head:0.3787878787878788, middle:0.2, tail0.09090909090909091
3shot of client 38:head:0.5347222222222222, middle:0.13157894736842105, tail0.0
3shot of client 39:head:0.2828282828282828, middle:0.14814814814814814, tail0.0
round 25, local average test acc  0.3504 

round 25, local macro average F1 score  0.1839 

round 25, local weighted average F1 score  0.3345 

round 25, global test acc  0.1322 

round 25, average 3shot acc: [head: 0.3993, middle: 0.2081, tail: 0.1218] 

round 25, global 3shot acc: [head: 0.4144, middle: 0.0768, tail: 0.0188] 

l_head tensor([0.5878, 0.5772, 2.6636, 1.7804, 0.9816, 1.7057, 2.3249, 2.6035, 2.3980,
        0.5836, 1.5728, 0.5655, 0.5700, 1.6915, 1.5773, 1.9800, 1.5964, 0.5680,
        0.5815, 0.9169, 1.4767, 1.4411, 0.5789, 1.5125, 0.5813, 2.0125, 1.3755,
        2.5532, 1.1033, 0.5969, 1.5975, 1.6807, 1.2333, 2.0009, 0.9941, 0.5542,
        0.5943, 0.5845, 0.5792, 1.2362, 1.2350, 0.5801, 0.5843, 1.1372, 1.2487,
        0.5715, 1.0430, 0.5919, 1.2703, 1.1922, 0.5734, 1.1095, 0.5851, 1.2084,
        0.9905, 0.5723, 1.0457, 1.0863, 1.1433, 0.5648, 0.5774, 0.5934, 1.3117,
        0.5862, 0.5833, 0.5843, 0.5870, 1.3563, 0.5921, 1.1541, 0.5853, 1.1573,
        0.5649, 0.5675, 0.5811, 0.5864, 0.5949, 0.5911, 1.0379, 0.5746, 0.5784,
        0.5751, 0.5629, 0.5901, 0.5821, 0.5840, 0.5659, 1.2562, 0.5871, 0.5897,
        0.5836, 0.5849, 0.5883, 0.5681, 0.5846, 0.5838, 0.8627, 0.5773, 0.8822,
        1.2355], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.3675, 2.2605, 2.2934, 2.1202, 2.0266, 1.8588, 1.9676, 2.2618, 2.0502,
        2.0493, 1.9238, 1.8471, 1.9461, 2.0211, 1.8422, 1.6977, 1.5759, 1.9612,
        1.7363, 1.2355, 1.8714, 1.7311, 1.4136, 2.0469, 1.7873, 1.4218, 1.0944,
        1.1272, 1.3871, 1.5077, 1.6858, 1.2553, 1.1879, 1.2783, 1.1604, 1.2245,
        1.1480, 1.2255, 1.0358, 1.1213, 1.0346, 1.2718, 0.9727, 0.9547, 1.0331,
        0.9907, 0.9319, 1.2428, 0.9787, 1.4280, 0.9169, 0.7871, 1.2507, 1.2485,
        0.9553, 0.8251, 0.8876, 0.8243, 0.9510, 1.0072, 1.2701, 0.8878, 0.9487,
        0.7456, 0.7131, 0.7321, 0.7211, 0.9295, 0.8623, 0.7679, 0.8287, 0.9387,
        0.6801, 0.8100, 0.7097, 0.6771, 0.8475, 0.7136, 0.7371, 0.7176, 0.6650,
        0.6461, 0.8101, 0.8100, 0.7214, 0.6715, 0.7020, 0.6187, 0.6003, 0.6640,
        0.6783, 0.5907, 0.6551, 0.6188, 0.6384, 0.7971, 0.6362, 0.6108, 0.6484,
        0.6485], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([9.1165], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.4171779141104294, middle:0.37142857142857144, tail0.0
3shot of client 1:head:0.6685082872928176, middle:0.14285714285714285, tail0.0
3shot of client 2:head:0.27611940298507465, middle:0.08571428571428572, tail0.0
3shot of client 3:head:0.4345991561181435, middle:0.04838709677419355, tail0.0
3shot of client 4:head:0.4134078212290503, middle:0.24390243902439024, tail0.1
3shot of client 5:head:0.14150943396226415, middle:0.19230769230769232, tail0.0
3shot of client 6:head:0.40487804878048783, middle:0.2037037037037037, tail0.09090909090909091
3shot of client 7:head:0.4012738853503185, middle:0.125, tail0.2222222222222222
3shot of client 8:head:0.4666666666666667, middle:0.1388888888888889, tail0.25
3shot of client 9:head:0.2903225806451613, middle:0.22857142857142856, tail0.1
3shot of client 10:head:0.514018691588785, middle:0.19230769230769232, tail0.16666666666666666
3shot of client 11:head:0.464, middle:0.3125, tail0.375
3shot of client 12:head:0.5, middle:0.12, tail0.08333333333333333
3shot of client 13:head:0.4444444444444444, middle:0.3125, tail0.2857142857142857
3shot of client 14:head:0.41116751269035534, middle:0.09523809523809523, tail0.3333333333333333
3shot of client 15:head:0.4789915966386555, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.5276073619631901, middle:0.16216216216216217, tail0.0
3shot of client 17:head:0.40764331210191085, middle:0.3170731707317073, tail0.2
3shot of client 18:head:0.32706766917293234, middle:0.13559322033898305, tail0.058823529411764705
3shot of client 19:head:0.46747967479674796, middle:0.19298245614035087, tail0.07142857142857142
3shot of client 20:head:0.2677595628415301, middle:0.1702127659574468, tail0.08333333333333333
3shot of client 21:head:0.39574468085106385, middle:0.2033898305084746, tail0.0
3shot of client 22:head:0.4430379746835443, middle:0.2222222222222222, tail0.2
3shot of client 23:head:0.358695652173913, middle:0.1276595744680851, tail0.08333333333333333
3shot of client 24:head:0.5185185185185185, middle:0.05405405405405406, tail0.0
3shot of client 25:head:0.5546875, middle:0.16129032258064516, tail0.125
3shot of client 26:head:0.41025641025641024, middle:0.4642857142857143, tail0.2857142857142857
3shot of client 27:head:0.26666666666666666, middle:0.46875, tail0.14285714285714285
3shot of client 28:head:0.46601941747572817, middle:0.22, tail0.0
3shot of client 29:head:0.5625, middle:0.1836734693877551, tail0.36363636363636365
3shot of client 30:head:0.2972972972972973, middle:0.4, tail0.16666666666666666  5%|▌         | 27/500 [1:07:49<22:59:31, 174.99s/it]
3shot of client 31:head:0.33678756476683935, middle:0.20408163265306123, tail0.0
3shot of client 32:head:0.19047619047619047, middle:0.16, tail0.3333333333333333
3shot of client 33:head:0.3155080213903743, middle:0.29545454545454547, tail0.08333333333333333
3shot of client 34:head:0.32515337423312884, middle:0.10810810810810811, tail0.1
3shot of client 35:head:0.33043478260869563, middle:0.23333333333333334, tail0.0
3shot of client 36:head:0.47701149425287354, middle:0.10869565217391304, tail0.09090909090909091
3shot of client 37:head:0.3434343434343434, middle:0.2, tail0.09090909090909091
3shot of client 38:head:0.5694444444444444, middle:0.18421052631578946, tail0.0
3shot of client 39:head:0.3181818181818182, middle:0.18518518518518517, tail0.0
round 26, local average test acc  0.3530 

round 26, local macro average F1 score  0.1775 

round 26, local weighted average F1 score  0.3329 

round 26, global test acc  0.1383 

round 26, average 3shot acc: [head: 0.4051, middle: 0.2010, tail: 0.1122] 

round 26, global 3shot acc: [head: 0.4216, middle: 0.0748, tail: 0.0284] 

l_head tensor([0.5878, 0.5772, 2.6636, 1.7804, 0.9816, 1.7057, 2.3249, 2.6035, 2.3980,
        0.5836, 1.5728, 0.5655, 0.5700, 1.6915, 1.5773, 1.9800, 1.5964, 0.5680,
        0.5815, 0.9169, 1.4767, 1.4411, 0.5789, 1.5125, 0.5813, 2.0125, 1.3755,
        2.5532, 1.1033, 0.5969, 1.5975, 1.6807, 1.2333, 2.0009, 0.9941, 0.5542,
        0.5943, 0.5845, 0.5792, 1.2362, 1.2350, 0.5801, 0.5843, 1.1372, 1.2487,
        0.5715, 1.0430, 0.5919, 1.2703, 1.1922, 0.5734, 1.1095, 0.5851, 1.2084,
        0.9905, 0.5723, 1.0457, 1.0863, 1.1433, 0.5648, 0.5774, 0.5934, 1.3117,
        0.5862, 0.5833, 0.5843, 0.5870, 1.3563, 0.5921, 1.1541, 0.5853, 1.1573,
        0.5649, 0.5675, 0.5811, 0.5864, 0.5949, 0.5911, 1.0379, 0.5746, 0.5784,
        0.5751, 0.5629, 0.5901, 0.5821, 0.5840, 0.5659, 1.2562, 0.5871, 0.5897,
        0.5836, 0.5849, 0.5883, 0.5681, 0.5846, 0.5838, 0.8627, 0.5773, 0.8822,
        1.2355], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.4689, 2.2995, 2.3126, 2.1536, 2.0625, 1.9412, 1.9652, 2.2700, 2.1450,
        2.0883, 1.9915, 1.8760, 1.9503, 2.0528, 1.9070, 1.6863, 1.6273, 1.9124,
        1.7988, 1.3050, 1.9035, 1.8021, 1.4584, 2.0937, 1.8918, 1.4348, 1.1339,
        1.1454, 1.4109, 1.5400, 1.7274, 1.2725, 1.2092, 1.2938, 1.2099, 1.2495,
        1.1802, 1.2712, 1.0340, 1.1341, 1.0440, 1.3469, 0.9820, 0.9733, 1.0444,
        1.0221, 0.9721, 1.2695, 1.0313, 1.4470, 0.9185, 0.8067, 1.2675, 1.2337,
        1.0220, 0.8325, 0.9197, 0.8213, 0.9781, 1.0238, 1.3106, 0.8988, 0.9753,
        0.7485, 0.7142, 0.7302, 0.7362, 0.9458, 0.8805, 0.7734, 0.8554, 1.0095,
        0.6787, 0.8180, 0.7229, 0.6956, 0.8674, 0.7176, 0.7437, 0.7346, 0.6650,
        0.6595, 0.8338, 0.8138, 0.7146, 0.6779, 0.7148, 0.6264, 0.6074, 0.6688,
        0.6793, 0.5923, 0.6530, 0.6235, 0.6424, 0.7966, 0.6358, 0.6163, 0.6508,
        0.6455], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([9.2868], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.4110429447852761, middle:0.34285714285714286, tail0.0
3shot of client 1:head:0.6574585635359116, middle:0.16666666666666666, tail0.0
3shot of client 2:head:0.3358208955223881, middle:0.14285714285714285, tail0.0
3shot of client 3:head:0.46835443037974683, middle:0.11290322580645161, tail0.0
3shot of client 4:head:0.4581005586592179, middle:0.2926829268292683, tail0.1
3shot of client 5:head:0.1320754716981132, middle:0.2692307692307692, tail0.0
3shot of client 6:head:0.40487804878048783, middle:0.18518518518518517, tail0.18181818181818182
3shot of client 7:head:0.39490445859872614, middle:0.15, tail0.3333333333333333
3shot of client 8:head:0.4666666666666667, middle:0.1388888888888889, tail0.25
3shot of client 9:head:0.4, middle:0.14285714285714285, tail0.1
3shot of client 10:head:0.4953271028037383, middle:0.3076923076923077, tail0.16666666666666666
3shot of client 11:head:0.544, middle:0.34375, tail0.25
3shot of client 12:head:0.5478723404255319, middle:0.18, tail0.25
3shot of client 13:head:0.3162393162393162, middle:0.25, tail0.14285714285714285
3shot of client 14:head:0.4416243654822335, middle:0.09523809523809523, tail0.16666666666666666
3shot of client 15:head:0.4789915966386555, middle:0.12903225806451613, tail0.0
3shot of client 16:head:0.5705521472392638, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.5286624203821656, middle:0.1951219512195122, tail0.2
3shot of client 18:head:0.34210526315789475, middle:0.13559322033898305, tail0.058823529411764705
3shot of client 19:head:0.43902439024390244, middle:0.24561403508771928, tail0.07142857142857142
3shot of client 20:head:0.2459016393442623, middle:0.14893617021276595, tail0.08333333333333333
3shot of client 21:head:0.4085106382978723, middle:0.2542372881355932, tail0.0
3shot of client 22:head:0.43037974683544306, middle:0.19444444444444445, tail0.3
3shot of client 23:head:0.33695652173913043, middle:0.19148936170212766, tail0.08333333333333333
3shot of client 24:head:0.4962962962962963, middle:0.05405405405405406, tail0.0
3shot of client 25:head:0.53125, middle:0.1935483870967742, tail0.0
3shot of client 26:head:0.3162393162393162, middle:0.35714285714285715, tail0.14285714285714285
3shot of client 27:head:0.28888888888888886, middle:0.4375, tail0.0
3shot of client 28:head:0.49514563106796117, middle:0.06, tail0.0
3shot of client 29:head:0.5961538461538461, middle:0.2653061224489796, tail0.36363636363636365
3shot of client 30:head:0.2702702702702703, middle:0.43333333333333335, tail0.16666666666666666
3shot of client 31:head:0.38341968911917096, middle:0.16326530612244897, tail0.0
3shot of client 32:head:0.2, middle:0.2, tail0.3333333333333333
3shot of client 33:head:0.44385026737967914, middle:0.22727272727272727, tail0.0
3shot of client 34:head:0.4662576687116564, middle:0.02702702702702703, tail0.0
3shot of client 35:head:0.34782608695652173, middle:0.26666666666666666, tail0.2857142857142857
3shot of client 36:head:0.4482758620689655, middle:0.10869565217391304, tail0.0
3shot of client 37:head:0.3333333333333333, middle:0.2, tail0.09090909090909091
3shot of client 38:head:0.5486111111111112, middle:0.15789473684210525, tail0.0
3shot of client 39:head:0.30303030303030304, middle:0.16666666666666666, tail0.0
round 27, local average test acc  0.3627 

round 27, local macro average F1 score  0.1866 

round 27, local weighted average F1 score  0.3364 

round 27, global test acc  0.1396 

round 27, average 3shot acc: [head: 0.4181, middle: 0.2010, tail: 0.1030] 

round 27, global 3shot acc: [head: 0.4160, middle: 0.0788, tail: 0.0318] 

l_head tensor([0.5878, 0.5772, 2.6636, 1.7804, 0.9816, 1.7057, 2.3249, 2.6035, 2.3980,
        0.5836, 1.5728, 0.5655, 0.5700, 1.6915, 1.5773, 1.9800, 1.5964, 0.5680,
        0.5815, 0.9169, 1.4767, 1.4411, 0.5789, 1.5125, 0.5813, 2.0125, 1.3755,
        2.5532, 1.1033, 0.5969, 1.5975, 1.6807, 1.2333, 2.0009, 0.9941, 0.5542,
        0.5943, 0.5845, 0.5792, 1.2362, 1.2350, 0.5801, 0.5843, 1.1372, 1.2487,
        0.5715, 1.0430, 0.5919, 1.2703, 1.1922, 0.5734, 1.1095, 0.5851, 1.2084,
        0.9905, 0.5723, 1.0457, 1.0863, 1.1433, 0.5648, 0.5774, 0.5934, 1.3117,
        0.5862, 0.5833, 0.5843, 0.5870, 1.3563, 0.5921, 1.1541, 0.5853, 1.1573,
        0.5649, 0.5675, 0.5811, 0.5864, 0.5949, 0.5911, 1.0379, 0.5746, 0.5784,
        0.5751, 0.5629, 0.5901, 0.5821, 0.5840, 0.5659, 1.2562, 0.5871, 0.5897,
        0.5836, 0.5849, 0.5883, 0.5681, 0.5846, 0.5838, 0.8627, 0.5773, 0.8822,
        1.2355], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.5534, 2.3809, 2.3622, 2.1481, 2.0791, 2.0438, 1.9782, 2.3077, 2.1704,
        2.1221, 1.9831, 1.8952, 1.9693, 2.0829, 1.8995, 1.7194, 1.7719, 1.9240,
        1.8201, 1.2827, 1.9354, 1.8162, 1.5226, 2.1574, 1.8953, 1.4986, 1.1801,
        1.1818, 1.4306, 1.5574, 1.7391, 1.3030, 1.2596, 1.3283, 1.2390, 1.2772,
        1.1797, 1.2759, 1.0548, 1.1282, 1.0397, 1.3780, 1.0081, 1.0039, 1.0603,
        1.0373, 1.0221, 1.3053, 1.1189, 1.4516, 0.9424, 0.8281, 1.3148, 1.2764,
        1.0505, 0.8438, 0.9325, 0.8473, 1.0229, 1.0297, 1.3472, 0.9286, 0.9724,
        0.7798, 0.7185, 0.7281, 0.7477, 0.9688, 0.9299, 0.7863, 0.8604, 1.0445,
        0.6848, 0.8411, 0.7364, 0.7122, 0.8951, 0.7234, 0.7435, 0.7570, 0.6720,
        0.6610, 0.8414, 0.8104, 0.7147, 0.6833, 0.7236, 0.6336, 0.6180, 0.6815,
        0.7009, 0.5996, 0.6642, 0.6379, 0.6416, 0.8296, 0.6486, 0.6219, 0.6535,
        0.6542], device='cuda:4', grad_fn=<NormBackward1>)  6%|▌         | 28/500 [1:22:16<50:11:13, 382.78s/it]  6%|▌         | 29/500 [1:36:57<69:37:26, 532.16s/it]
The value of constant scaler:  tensor([9.4673], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.39263803680981596, middle:0.34285714285714286, tail0.0
3shot of client 1:head:0.6685082872928176, middle:0.23809523809523808, tail0.0
3shot of client 2:head:0.2835820895522388, middle:0.22857142857142856, tail0.0
3shot of client 3:head:0.4641350210970464, middle:0.11290322580645161, tail0.0
3shot of client 4:head:0.4301675977653631, middle:0.21951219512195122, tail0.1
3shot of client 5:head:0.12264150943396226, middle:0.23076923076923078, tail0.0
3shot of client 6:head:0.40487804878048783, middle:0.18518518518518517, tail0.18181818181818182
3shot of client 7:head:0.37579617834394907, middle:0.15, tail0.1111111111111111
3shot of client 8:head:0.5111111111111111, middle:0.1111111111111111, tail0.25
3shot of client 9:head:0.432258064516129, middle:0.14285714285714285, tail0.1
3shot of client 10:head:0.5700934579439252, middle:0.19230769230769232, tail0.16666666666666666
3shot of client 11:head:0.504, middle:0.3125, tail0.125
3shot of client 12:head:0.5957446808510638, middle:0.22, tail0.25
3shot of client 13:head:0.3076923076923077, middle:0.3125, tail0.14285714285714285
3shot of client 14:head:0.48223350253807107, middle:0.16666666666666666, tail0.16666666666666666
3shot of client 15:head:0.4789915966386555, middle:0.12903225806451613, tail0.0
3shot of client 16:head:0.5276073619631901, middle:0.10810810810810811, tail0.1
3shot of client 17:head:0.4968152866242038, middle:0.14634146341463414, tail0.2
3shot of client 18:head:0.44360902255639095, middle:0.3559322033898305, tail0.058823529411764705
3shot of client 19:head:0.5121951219512195, middle:0.21052631578947367, tail0.07142857142857142
3shot of client 20:head:0.4808743169398907, middle:0.0851063829787234, tail0.08333333333333333
3shot of client 21:head:0.42127659574468085, middle:0.23728813559322035, tail0.0
3shot of client 22:head:0.45569620253164556, middle:0.3055555555555556, tail0.3
3shot of client 23:head:0.33152173913043476, middle:0.1702127659574468, tail0.08333333333333333
3shot of client 24:head:0.32592592592592595, middle:0.16216216216216217, tail0.0
3shot of client 25:head:0.5625, middle:0.25806451612903225, tail0.0
3shot of client 26:head:0.29914529914529914, middle:0.35714285714285715, tail0.0
3shot of client 27:head:0.3111111111111111, middle:0.5625, tail0.14285714285714285
3shot of client 28:head:0.5485436893203883, middle:0.12, tail0.0
3shot of client 29:head:0.5913461538461539, middle:0.24489795918367346, tail0.18181818181818182
3shot of client 30:head:0.27927927927927926, middle:0.43333333333333335, tail0.3333333333333333
3shot of client 31:head:0.36787564766839376, middle:0.22448979591836735, tail0.09090909090909091
3shot of client 32:head:0.2, middle:0.24, tail0.16666666666666666
3shot of client 33:head:0.43315508021390375, middle:0.3181818181818182, tail0.0
3shot of client 34:head:0.4723926380368098, middle:0.05405405405405406, tail0.0
3shot of client 35:head:0.48695652173913045, middle:0.3, tail0.2857142857142857
3shot of client 36:head:0.46551724137931033, middle:0.15217391304347827, tail0.0
3shot of client 37:head:0.37373737373737376, middle:0.28888888888888886, tail0.18181818181818182
3shot of client 38:head:0.5763888888888888, middle:0.13157894736842105, tail0.0
3shot of client 39:head:0.3383838383838384, middle:0.2037037037037037, tail0.08333333333333333
round 28, local average test acc  0.3783 

round 28, local macro average F1 score  0.1981 

round 28, local weighted average F1 score  0.3627 

round 28, global test acc  0.1507 

round 28, average 3shot acc: [head: 0.4332, middle: 0.2241, tail: 0.0989] 

round 28, global 3shot acc: [head: 0.4444, middle: 0.1044, tail: 0.0270] 

l_head tensor([0.5878, 0.5772, 2.6636, 1.7804, 0.9816, 1.7057, 2.3249, 2.6035, 2.3980,
        0.5836, 1.5728, 0.5655, 0.5700, 1.6915, 1.5773, 1.9800, 1.5964, 0.5680,
        0.5815, 0.9169, 1.4767, 1.4411, 0.5789, 1.5125, 0.5813, 2.0125, 1.3755,
        2.5532, 1.1033, 0.5969, 1.5975, 1.6807, 1.2333, 2.0009, 0.9941, 0.5542,
        0.5943, 0.5845, 0.5792, 1.2362, 1.2350, 0.5801, 0.5843, 1.1372, 1.2487,
        0.5715, 1.0430, 0.5919, 1.2703, 1.1922, 0.5734, 1.1095, 0.5851, 1.2084,
        0.9905, 0.5723, 1.0457, 1.0863, 1.1433, 0.5648, 0.5774, 0.5934, 1.3117,
        0.5862, 0.5833, 0.5843, 0.5870, 1.3563, 0.5921, 1.1541, 0.5853, 1.1573,
        0.5649, 0.5675, 0.5811, 0.5864, 0.5949, 0.5911, 1.0379, 0.5746, 0.5784,
        0.5751, 0.5629, 0.5901, 0.5821, 0.5840, 0.5659, 1.2562, 0.5871, 0.5897,
        0.5836, 0.5849, 0.5883, 0.5681, 0.5846, 0.5838, 0.8627, 0.5773, 0.8822,
        1.2355], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.6397, 2.4242, 2.3900, 2.1918, 2.0887, 2.1027, 1.9946, 2.3784, 2.2054,
        2.1309, 2.0386, 1.9254, 2.0269, 2.1601, 1.9272, 1.7390, 1.8241, 1.9264,
        1.8395, 1.3803, 2.0374, 1.8358, 1.5109, 2.1454, 1.9532, 1.5253, 1.2090,
        1.2081, 1.4649, 1.5966, 1.8092, 1.3563, 1.2751, 1.3548, 1.2766, 1.3317,
        1.2097, 1.3205, 1.0542, 1.1872, 1.0901, 1.4662, 1.0202, 1.0033, 1.0677,
        1.0952, 1.0227, 1.3367, 1.1881, 1.4779, 0.9501, 0.8477, 1.3150, 1.2834,
        1.0705, 0.8505, 0.9699, 0.8650, 1.0566, 1.0458, 1.3878, 0.9425, 1.0150,
        0.7965, 0.7330, 0.7363, 0.7594, 0.9886, 0.9375, 0.7941, 0.8882, 1.0795,
        0.6854, 0.8503, 0.7492, 0.7289, 0.9126, 0.7294, 0.7563, 0.7668, 0.6791,
        0.6765, 0.8664, 0.8147, 0.7138, 0.6985, 0.7405, 0.6328, 0.6297, 0.6885,
        0.7285, 0.6092, 0.6608, 0.6443, 0.6593, 0.8573, 0.6536, 0.6333, 0.6576,
        0.6640], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([9.6215], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.38650306748466257, middle:0.37142857142857144, tail0.0
3shot of client 1:head:0.6519337016574586, middle:0.23809523809523808, tail0.0
3shot of client 2:head:0.29850746268656714, middle:0.2571428571428571, tail0.0
3shot of client 3:head:0.48523206751054854, middle:0.12903225806451613, tail0.0
3shot of client 4:head:0.4301675977653631, middle:0.2682926829268293, tail0.1
3shot of client 5:head:0.18867924528301888, middle:0.19230769230769232, tail0.0
3shot of client 6:head:0.4292682926829268, middle:0.24074074074074073, tail0.18181818181818182
3shot of client 7:head:0.4267515923566879, middle:0.125, tail0.3333333333333333
3shot of client 8:head:0.4888888888888889, middle:0.16666666666666666, tail0.25
3shot of client 9:head:0.4258064516129032, middle:0.2, tail0.1
3shot of client 10:head:0.5607476635514018, middle:0.23076923076923078, tail0.0
3shot of client 11:head:0.52, middle:0.28125, tail0.25
3shot of client 12:head:0.526595744680851, middle:0.22, tail0.08333333333333333
3shot of client 13:head:0.2905982905982906, middle:0.28125, tail0.14285714285714285
3shot of client 14:head:0.47715736040609136, middle:0.19047619047619047, tail0.25
3shot of client 15:head:0.3697478991596639, middle:0.2903225806451613, tail0.0
3shot of client 16:head:0.5276073619631901, middle:0.13513513513513514, tail0.1
3shot of client 17:head:0.5286624203821656, middle:0.0975609756097561, tail0.2
3shot of client 18:head:0.45864661654135336, middle:0.3389830508474576, tail0.058823529411764705
3shot of client 19:head:0.42276422764227645, middle:0.2631578947368421, tail0.14285714285714285
3shot of client 20:head:0.48633879781420764, middle:0.06382978723404255, tail0.08333333333333333
3shot of client 21:head:0.4085106382978723, middle:0.3050847457627119, tail0.0
3shot of client 22:head:0.5443037974683544, middle:0.19444444444444445, tail0.1
3shot of client 23:head:0.3423913043478261, middle:0.1702127659574468, tail0.08333333333333333
3shot of client 24:head:0.37777777777777777, middle:0.16216216216216217, tail0.0
3shot of client 25:head:0.5546875, middle:0.2903225806451613, tail0.125
3shot of client 26:head:0.47863247863247865, middle:0.5357142857142857, tail0.0
3shot of client 27:head:0.31851851851851853, middle:0.5, tail0.0
3shot of client 28:head:0.529126213592233, middle:0.06, tail0.0
3shot of client 29:head:0.5528846153846154, middle:0.24489795918367346, tail0.2727272727272727
3shot of client 30:head:0.27927927927927926, middle:0.4666666666666667, tail0.16666666666666666  6%|▌         | 30/500 [1:51:23<82:32:33, 632.24s/it]
3shot of client 31:head:0.36787564766839376, middle:0.24489795918367346, tail0.0
3shot of client 32:head:0.2, middle:0.28, tail0.5
3shot of client 33:head:0.40641711229946526, middle:0.2727272727272727, tail0.0
3shot of client 34:head:0.4539877300613497, middle:0.02702702702702703, tail0.0
3shot of client 35:head:0.4956521739130435, middle:0.3, tail0.14285714285714285
3shot of client 36:head:0.5057471264367817, middle:0.13043478260869565, tail0.0
3shot of client 37:head:0.3434343434343434, middle:0.2222222222222222, tail0.09090909090909091
3shot of client 38:head:0.625, middle:0.18421052631578946, tail0.0
3shot of client 39:head:0.3838383838383838, middle:0.16666666666666666, tail0.0
round 29, local average test acc  0.3841 

round 29, local macro average F1 score  0.2030 

round 29, local weighted average F1 score  0.3710 

round 29, global test acc  0.1594 

round 29, average 3shot acc: [head: 0.4387, middle: 0.2335, tail: 0.0939] 

round 29, global 3shot acc: [head: 0.4560, middle: 0.1120, tail: 0.0348] 

l_head tensor([0.5878, 0.5772, 2.6636, 1.7804, 0.9816, 1.7057, 2.3249, 2.6035, 2.3980,
        0.5836, 1.5728, 0.5655, 0.5700, 1.6915, 1.5773, 1.9800, 1.5964, 0.5680,
        0.5815, 0.9169, 1.4767, 1.4411, 0.5789, 1.5125, 0.5813, 2.0125, 1.3755,
        2.5532, 1.1033, 0.5969, 1.5975, 1.6807, 1.2333, 2.0009, 0.9941, 0.5542,
        0.5943, 0.5845, 0.5792, 1.2362, 1.2350, 0.5801, 0.5843, 1.1372, 1.2487,
        0.5715, 1.0430, 0.5919, 1.2703, 1.1922, 0.5734, 1.1095, 0.5851, 1.2084,
        0.9905, 0.5723, 1.0457, 1.0863, 1.1433, 0.5648, 0.5774, 0.5934, 1.3117,
        0.5862, 0.5833, 0.5843, 0.5870, 1.3563, 0.5921, 1.1541, 0.5853, 1.1573,
        0.5649, 0.5675, 0.5811, 0.5864, 0.5949, 0.5911, 1.0379, 0.5746, 0.5784,
        0.5751, 0.5629, 0.5901, 0.5821, 0.5840, 0.5659, 1.2562, 0.5871, 0.5897,
        0.5836, 0.5849, 0.5883, 0.5681, 0.5846, 0.5838, 0.8627, 0.5773, 0.8822,
        1.2355], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.6552, 2.4644, 2.3616, 2.2396, 2.1709, 2.1126, 2.0661, 2.3523, 2.2136,
        2.1786, 2.0337, 1.9380, 2.0549, 2.1579, 1.9216, 1.7998, 1.7964, 1.9866,
        1.8654, 1.4268, 2.1165, 1.8512, 1.5714, 2.2202, 2.0043, 1.5117, 1.2523,
        1.2247, 1.5072, 1.6172, 1.8128, 1.3713, 1.3563, 1.3838, 1.2767, 1.3955,
        1.2260, 1.3112, 1.0871, 1.2556, 1.1459, 1.5087, 1.0535, 1.0456, 1.0964,
        1.0971, 1.0246, 1.3741, 1.2393, 1.4794, 0.9342, 0.8838, 1.3317, 1.2953,
        1.0721, 0.8566, 0.9903, 0.9084, 1.1221, 1.0540, 1.4552, 0.9640, 1.0101,
        0.8383, 0.7529, 0.7468, 0.7830, 0.9940, 0.9569, 0.8206, 0.9057, 1.0771,
        0.6850, 0.8564, 0.7657, 0.7385, 0.9182, 0.7414, 0.7729, 0.7926, 0.6841,
        0.6755, 0.8806, 0.8243, 0.7217, 0.6967, 0.7396, 0.6441, 0.6330, 0.7118,
        0.7496, 0.6186, 0.6621, 0.6613, 0.6686, 0.8918, 0.6736, 0.6390, 0.6673,
        0.6832], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([9.7745], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.4601226993865031, middle:0.4, tail0.1
3shot of client 1:head:0.6740331491712708, middle:0.2619047619047619, tail0.0
3shot of client 2:head:0.3208955223880597, middle:0.2, tail0.0
3shot of client 3:head:0.48945147679324896, middle:0.1935483870967742, tail0.0
3shot of client 4:head:0.5027932960893855, middle:0.2926829268292683, tail0.1
3shot of client 5:head:0.3490566037735849, middle:0.19230769230769232, tail0.0
3shot of client 6:head:0.4097560975609756, middle:0.2037037037037037, tail0.18181818181818182
3shot of client 7:head:0.39490445859872614, middle:0.175, tail0.2222222222222222
3shot of client 8:head:0.4666666666666667, middle:0.16666666666666666, tail0.25
3shot of client 9:head:0.4129032258064516, middle:0.08571428571428572, tail0.1
3shot of client 10:head:0.6074766355140186, middle:0.23076923076923078, tail0.0
3shot of client 11:head:0.6, middle:0.15625, tail0.625
3shot of client 12:head:0.574468085106383, middle:0.3, tail0.08333333333333333
3shot of client 13:head:0.36752136752136755, middle:0.3125, tail0.0
3shot of client 14:head:0.48223350253807107, middle:0.21428571428571427, tail0.25
3shot of client 15:head:0.3949579831932773, middle:0.2903225806451613, tail0.0
3shot of client 16:head:0.48466257668711654, middle:0.16216216216216217, tail0.1
3shot of client 17:head:0.5414012738853503, middle:0.14634146341463414, tail0.1
3shot of client 18:head:0.44360902255639095, middle:0.3728813559322034, tail0.058823529411764705
3shot of client 19:head:0.42276422764227645, middle:0.3333333333333333, tail0.14285714285714285
3shot of client 20:head:0.33879781420765026, middle:0.1702127659574468, tail0.16666666666666666
3shot of client 21:head:0.41702127659574467, middle:0.288135593220339, tail0.0
3shot of client 22:head:0.5189873417721519, middle:0.25, tail0.1
3shot of client 23:head:0.3641304347826087, middle:0.23404255319148937, tail0.08333333333333333
3shot of client 24:head:0.362962962962963, middle:0.02702702702702703, tail0.0
3shot of client 25:head:0.5078125, middle:0.2903225806451613, tail0.125
3shot of client 26:head:0.4358974358974359, middle:0.5, tail0.14285714285714285
3shot of client 27:head:0.34814814814814815, middle:0.34375, tail0.14285714285714285
3shot of client 28:head:0.470873786407767, middle:0.16, tail0.0
3shot of client 29:head:0.5625, middle:0.30612244897959184, tail0.36363636363636365
3shot of client 30:head:0.3063063063063063, middle:0.6333333333333333, tail0.0
3shot of client 31:head:0.46113989637305697, middle:0.2857142857142857, tail0.0
3shot of client 32:head:0.18095238095238095, middle:0.28, tail0.16666666666666666
3shot of client 33:head:0.3850267379679144, middle:0.29545454545454547, tail0.08333333333333333
3shot of client 34:head:0.43558282208588955, middle:0.13513513513513514, tail0.2
3shot of client 35:head:0.5043478260869565, middle:0.3333333333333333, tail0.14285714285714285
3shot of client 36:head:0.5172413793103449, middle:0.15217391304347827, tail0.0
3shot of client 37:head:0.30303030303030304, middle:0.2222222222222222, tail0.09090909090909091
3shot of client 38:head:0.6041666666666666, middle:0.2631578947368421, tail0.0
3shot of client 39:head:0.4444444444444444, middle:0.16666666666666666, tail0.0
round 30, local average test acc  0.3939 

round 30, local macro average F1 score  0.2133 

round 30, local weighted average F1 score  0.3754 

round 30, global test acc  0.1572 

round 30, average 3shot acc: [head: 0.4467, middle: 0.2507, tail: 0.1031] 

round 30, global 3shot acc: [head: 0.4456, middle: 0.1140, tail: 0.0346] 

l_head tensor([0.5878, 0.5772, 2.6636, 1.7804, 0.9816, 1.7057, 2.3249, 2.6035, 2.3980,
        0.5836, 1.5728, 0.5655, 0.5700, 1.6915, 1.5773, 1.9800, 1.5964, 0.5680,
        0.5815, 0.9169, 1.4767, 1.4411, 0.5789, 1.5125, 0.5813, 2.0125, 1.3755,
        2.5532, 1.1033, 0.5969, 1.5975, 1.6807, 1.2333, 2.0009, 0.9941, 0.5542,
        0.5943, 0.5845, 0.5792, 1.2362, 1.2350, 0.5801, 0.5843, 1.1372, 1.2487,
        0.5715, 1.0430, 0.5919, 1.2703, 1.1922, 0.5734, 1.1095, 0.5851, 1.2084,
        0.9905, 0.5723, 1.0457, 1.0863, 1.1433, 0.5648, 0.5774, 0.5934, 1.3117,
        0.5862, 0.5833, 0.5843, 0.5870, 1.3563, 0.5921, 1.1541, 0.5853, 1.1573,
        0.5649, 0.5675, 0.5811, 0.5864, 0.5949, 0.5911, 1.0379, 0.5746, 0.5784,
        0.5751, 0.5629, 0.5901, 0.5821, 0.5840, 0.5659, 1.2562, 0.5871, 0.5897,
        0.5836, 0.5849, 0.5883, 0.5681, 0.5846, 0.5838, 0.8627, 0.5773, 0.8822,
        1.2355], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.6647, 2.5036, 2.3482, 2.2677, 2.2122, 2.1497, 2.1747, 2.4422, 2.2896,
        2.2141, 2.0426, 1.9920, 2.1167, 2.1700, 1.9296, 1.8249, 1.8511, 2.0691,
        1.9006, 1.4586, 2.1618, 1.9176, 1.5783, 2.2165, 2.0003, 1.5303, 1.2376,
        1.2328, 1.5379, 1.6141, 1.8327, 1.4477, 1.3833, 1.4160, 1.3020, 1.4245,
        1.2903, 1.3504, 1.1161, 1.2912, 1.2253, 1.5106, 1.0905, 1.0866, 1.1064,
        1.1451, 1.1054, 1.3604, 1.2818, 1.5453, 0.9438, 0.8852, 1.4147, 1.2832,
        1.0690, 0.8716, 1.0367, 0.9660, 1.1354, 1.0615, 1.4749, 1.0044, 1.0524,
        0.8663, 0.7929, 0.7747, 0.7836, 1.0325, 0.9763, 0.8799, 0.9145, 1.0790,
        0.7091, 0.8613, 0.7614, 0.7443, 0.9374, 0.7590, 0.7703, 0.8050, 0.6851,
        0.6733, 0.9162, 0.8247, 0.7290, 0.6999, 0.7613, 0.6437, 0.6483, 0.7035,
        0.7469, 0.6245, 0.6651, 0.6663, 0.6757, 0.9179, 0.6742, 0.6435, 0.6701,
        0.6818], device='cuda:4', grad_fn=<NormBackward1>)  6%|▌         | 31/500 [2:05:57<91:49:46, 704.88s/it]
nohup: ignoring input
./temp/fl_acc_cifar100_resnet34_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N20_100_seed3407_p1_dirichlet1.0_IF0.02_LossCE.txt
Files already downloaded and verified
[500, 480, 462, 444, 426, 410, 394, 379, 364, 350, 336, 323, 311, 299, 287, 276, 265, 255, 245, 235, 226, 218, 209, 201, 193, 186, 178, 172, 165, 158, 152, 146, 141, 135, 130, 125, 120, 115, 111, 107, 102, 98, 95, 91, 87, 84, 81, 78, 75, 72, 69, 66, 64, 61, 59, 56, 54, 52, 50, 48, 46, 44, 43, 41, 39, 38, 36, 35, 34, 32, 31, 30, 29, 27, 26, 25, 24, 23, 22, 22, 21, 20, 19, 18, 18, 17, 16, 16, 15, 14, 14, 13, 13, 12, 12, 11, 11, 10, 10, 10]
12608
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[570, 712, 662, 720, 618, 725, 737, 505, 658, 678, 817, 646, 671, 616, 477, 642, 488, 544, 629, 493]
training set distribution:
[[17 45  5 34 11 10  4 31  2 14  0 17 14 26  7  9 19 20 19 10  4  0 18  3
  12  4  4 23 24  1  0  0 14  1 13  8  4  5  2  1  4  8  9 11  0  4  0  9
   2  1  1  1  2  4  3 10  0  2  5  2  6  0  1  3  2  3  2  0  0  0  1  1
   0  0  0  0  0  0  0  4  0  1  0  0  0  3  2  2  0  0  0  0  0  0  2  0
   2  0  2  0]
 [37 35 37 79  7 58  5 14 23  9  6 25 24  3 10 15 21  7 18 20  2  2  7 19
   6 20 15  2 14  2 24  0  8  2 15  4 20  7  0  0  0  3  1  5  2  1  3  0
   1  3  6  4  2  4  2  1  1  1  1  0  0  2  1  0  0  0  4  0  4  2  6  0
   4  2  4  0  2  0  0  1  0  0  1  0  3  1  0  0  0  0  0  0  0  3  0  3
   6  0  0  0]
 [72 23 27  5  4  5 79  4 10  6 65 13 13  2 43 10  0  8 18 14  6  0 16  2
   0  3 24  2  0  0  1  3 15 18 11  3  2  2  6  4  3  8  2  2  1  0 11  0
   2  1  0  5  0  0  2  7  0  1  1  5  6  9  2  0  3  6  0  2  4  1  2  1
   2  0  3  7  2  1  1  0  0  0  2  2  2  1  0  3  2  1  1  1  1  2  1  0
   0  1  0  0]
 [59 40  8  2  0 13  2 18 30  1  0  1 21  2 62  5 36 36 13 75  1 27  1 33
   8 17  3 11  2  2  2 15  6 19  4  5  7  1  3  0  4  5  0  5  2  0  0  3
   5 21  0  1  2  1  5  7  2  0  1  2  0  7  1  1  1  6  0  0  1  2  1  0
   0  2  4  2  2  0  1  3  2  4  2  0  0  1  2  1  0  2  5  1  2  0  1  2
   1  2  1  0]
 [21 21 45 49 16  0  3 42 58  4  1  2 10  7  4  6 24  4 10 11 33 10 16  2
   1 19  6  6  0  5  3  4  0  0  4 14  1  0  1  0  6  1  4 16  7  3  9 16
   2  0  4  2  0  5  1  3 15  2  2  9  7  2  0  5  3  2  0  0  0  1  1  2
   0  0  0  5  5  1  1  2  0  5  0  1  0  0  0  0  0  1  0  0  0  0  0  2
   0  1  0  1]
 [ 9  1 26  7 48 50 14  0  2  4 14 46 37 57 12 20  4  7  4  5 24 60  9  7
   1 10  9 23  7  7  5  5 12 14  5  4  2  1 17 15  4 15  6  2  1  6  0  1
   1  6 12  6  5  0  0  1  3  0  0  2  1  1  0  1  1  3  3  8  1  2  4  2
   0  0  0  4  0  1  0  4  0  1  0  0  2  1  1  0  1  0  0  2  0  0  0  0
   0  0  0  6]
 [25 32 22 89 14  0 12 45  7 17 42 25  1  2 16 31  5 23  3  5 21 17 13 27
  35 11  4  6  9  2  1  9  3  8  3  5  8  2 13  1  3  0  8 14  5  0  2  3
   3  3  3  0  9 12  2  1 11  2  6  1  4  0  1  1  3  1  3  0  0  1  0  1
   1  0  1  1  0  1  1  0  3  1  1  1  1  2  1  3  0  0  0  1  0  0  0  0
   0  0  0  1]
 [10 22  5 20 11 10  6  8 35 26 32 27  5 11  2  5 12 11 12  0  6  1  0 10
   4  1  0  4 13 11  2  7  9  0  3  8 19  8  9  1  1  0  7  1  7 32  1  1
   0 11  2  4  4  1  3  2  0  0  2  0  0  1  0  0  1  3  5  0  0  1  0  1
   1  0  0  0  0  2  7  0  1  2  1  1  3  0  4  1  0  0  2  1  0  1  0  0
   0  0  0  1]
 [24  6 36 10 28  2 48 32 34 26 19 32 26  4  3  7  1  3 25  5 31  4 16  5
   0  1  3 12 13  4  4  6  1  1  2 12  0 12  2 36 12  9  4  2  5 11  7 11
   3  0  1  6  2  0  2  5  0  2  0  5  1  1  8  0  0  3  0  3  0  0  4  4
   0  0  0  0  0  0  1  1  0  0  3  0  2  0  0  0  0  0  1  0  0  2  1  0
   0  0  0  0]
 [62 20 59 36  7  4  3 34  9 14 32  1  9  0 24  4 45  4 18  9  2 20 11 56
   2 16  1  1  2  4  6  0  0 10 13  3  5 10  7  2  2  0  1  1  9  2 12  8
  11  0  0 12  2  1  3  6  5  3  6  4  0  1  0  0  1  1  1  1  1  0  0  0
   2  2  2  2  0  0  1  0  0  1  1  1  0  0  2  0  0  1  2  0  0  0  0  0
   1  1  0  0]
 [23 56 65 22  6 40 20 35 12 38  6 16  5 60 23 12 31  7 14  3 13 19  3  1
   6 17  8  2 17 18  4 17  8  1  3  3  2 17  7  7 21 11  5  0  3  1  5  3
   7  5 10  1  2  7  9  6  3  2  7  0  0  0  3  2  2  1  1  0 10  2  0  2
   1  0  2  0  0  1  2  0  0  0  1  0  0  0  2  0  0  0  2  0  1  0  3  1
   0  1  1  1]
 [ 9 64  2 14 27 66  5 25 27 33 27  9  6 35 20 11  2 21 12  1  2  6 10  5
   7  3  9  5  3 14 16 15  1  7  1 12  6  0  8  4  1  0 13  5 12  0  5  4
   0  0  0  0  1  5  5  1  0  0  0  6  2  2  4  0  2  0  0  1  1  2  2  0
   0  3  0  0  0  3  2  0  2  1  3  1  1  0  0  0  1  1  0  0  2  1  0  0
   0  1  0  0]
 [10 15 10 29  2 52 53 13 13  5 36  5 30  8  7  6 13  0 23 16 13  7 14  1
  26 15  8  0 14 40  1 25  6  1 15  3 19  0  0  4  7 10  0  1  6  4  1  2
   3  0  1  0  1  3  3  0  1  5  7  3  9  1  2  2  1  0  2  7  1  0  1  1
   0  3  1  1  1  4  0  1  3  1  1  1  0  1  0  3  0  0  0  0  0  1  1  1
   0  1  3  0]
 [18 24  5  4 23  0 68 22 13 46 10 12  1 25  0 11 29  2  9  4 10  3 22  2
  35 10  5  1  5  5  3  2 16 19 13  4  0  1  0  2 10  5  9  1 11  2  0  3
   1  5  3  6  2  2  2  2  2  5  1  3  1  4  4  2  0  0  1  1  6  0  1  1
   3  9  4  0  3  0  1  0  2  1  0  1  2  2  0  0  1  0  0  3  2  1  0  0
   0  0  1  0]
 [ 1  6 14 24 45  1 39  1  1 18  1  3 16 11  6 38  3 22  3 10 10  4  2 14
   1  6  4  9  1  3  6  0 13  3  4  2  4  1  4  0  1 17  0  2  2  1  7  3
   5  1  6  1  9  0  5  2  1  5  4  1  0  0  2  4  0  0  8  6  1  3  3  4
   3  1  0  0  0  1  0  0  0  1  1  1  0  0  1  1  3  5  0  0  0  0  0  0
   0  1  0  0]
 [26  8 52  0 14 31  1 12  5 34 23  8  3 14  2 24  1 32 17  3 19  0 12  1
  21  2 10 21 15 13  3  7  6 15  1 13 17 15  4  3  1  4 10  0  2  3  4  0
   0  7  4 10  5  0  5  1  0  8  4  0  2  2  1  9  0  0  0  1  2  9  0  2
   6  3  0  2  2  4  0  1  5  0  0  5  1  4  0  0  0  0  0  1  0  0  1  1
   0  0  2  0]
 [57 21 15  5  7  3  8  5  0  0  0 21  6 17  0 14  5  9  4  5  1 16 15  6
   5  3 53  2  2 10 44  4  0  1  1  5  0 19  1  0  1  0  5  0  3  5  2  2
   4  4  2  0  6  3  0  0  0  3  0  5  2  7  5  2  0  4  0  3  2  1  2  4
   0  0  0  0  0  0  0  4  2  1  0  2  0  1  0  2  0  1  1  3  0  1  2  0
   0  1  0  0]
 [ 9 15 14 10 19 18 15  5 30 37  0 15 59  2 22 20  9 14 12 24 14  1  1  1
   2  7  9  0  2  0  9  1  5  8  6  4  2 10  6  7  2  1  1  1  0  2 11  6
   2  0 11  1  7  0  2  1  2  1  0  0  3  1  1  2 18  0  4  1  0  2  2  1
   0  0  1  0  0  2  2  0  0  0  0  1  0  0  1  0  2  1  0  0  3  0  0  0
   1  0  0  0]
 [ 5 17  0  1 80 21  7 13 10 15 22 39 24 11 17 13  0  4  6  5 10 21 12  1
   8 14  2 37 13  8  1 18  6  1  5  7  0  2 14 13 14  0  3 22  1  6  0  2
  20  4  2  1  1  6  4  0  5  3  0  0  0  2  7  4  0  1  1  1  0  0  0  1
   1  2  0  0  2  2  2  0  0  0  0  0  0  0  0  0  4  0  0  0  2  0  0  0
   0  0  0  0]
 [ 6  9 15  4 57 26  2 20 43  3  0  6  1  2  7 15  5 21  5 10  4  0 11  5
  13  7  1  5  9  9 17  8 12  6  8  6  2  2  7  7  5  1  7  0  8  1  1  1
   3  0  1  5  2  7  1  0  3  7  3  0  2  1  0  3  1  4  1  0  0  3  1  2
   5  0  4  1  5  0  0  1  1  0  2  0  1  0  0  0  1  1  0  0  0  0  0  1
   0  0  0  0]]
Total size of training set
12608
local test distribution:
[[13 35  3 26  8  7  3 24  1 11  0 13 11 20  5  7 15 15 15  7  3  0 14  2
   9  3  3 18 19  0  0  0 11  0 10  6  3  3  1  0  3  6  7  8  0  3  0  7
   1  0  0  0  1  3  2  7  0  1  3  1  4  0  0  2  1  2  1  0  0  0  0  0
   0  0  0  0  0  0  0  3  0  0  0  0  0  2  1  1  0  0  0  0  0  0  1  0
   1  0  1  0]
 [29 27 29 62  5 46  3 11 18  7  4 19 19  2  7 11 16  5 14 15  1  1  5 15
   4 15 11  1 11  1 19  0  6  1 11  3 15  5  0  0  0  2  0  3  1  0  2  0
   0  2  4  3  1  3  1  0  0  0  0  0  0  1  0  0  0  0  3  0  3  1  4  0
   3  1  3  0  1  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  2  0  2
   4  0  0  0]
 [57 18 21  3  3  3 62  3  7  4 51 10 10  1 34  7  0  6 14 11  4  0 12  1
   0  2 19  1  0  0  0  2 11 14  8  2  1  1  4  3  2  6  1  1  0  0  8  0
   1  0  0  3  0  0  1  5  0  0  0  3  4  7  1  0  2  4  0  1  3  0  1  0
   1  0  2  5  1  0  0  0  0  0  1  1  1  0  0  2  1  0  0  0  0  1  0  0
   0  0  0  0]
 [46 31  6  1  0 10  1 14 23  0  0  0 16  1 49  3 28 28 10 59  0 21  0 26
   6 13  2  8  1  1  1 11  4 15  3  3  5  0  2  0  3  3  0  3  1  0  0  2
   3 16  0  0  1  0  3  5  1  0  0  1  0  5  0  0  0  4  0  0  0  1  0  0
   0  1  3  1  1  0  0  2  1  3  1  0  0  0  1  0  0  1  3  0  1  0  0  1
   0  1  0  0]
 [16 16 35 38 12  0  2 33 46  3  0  1  7  5  3  4 19  3  7  8 26  7 12  1
   0 15  4  4  0  3  2  3  0  0  3 11  0  0  0  0  4  0  3 12  5  2  7 12
   1  0  3  1  0  3  0  2 11  1  1  7  5  1  0  3  2  1  0  0  0  0  0  1
   0  0  0  3  3  0  0  1  0  3  0  0  0  0  0  0  0  0  0  0  0  0  0  1
   0  0  0  0]
 [ 7  0 20  5 38 39 11  0  1  3 11 36 29 45  9 15  3  5  3  3 19 47  7  5
   0  7  7 18  5  5  3  3  9 11  3  3  1  0 13 11  3 11  4  1  0  4  0  0
   0  4  9  4  3  0  0  0  2  0  0  1  0  0  0  0  0  2  2  6  0  1  3  1
   0  0  0  3  0  0  0  3  0  0  0  0  1  0  0  0  0  0  0  1  0  0  0  0
   0  0  0  4]
 [19 25 17 70 11  0  9 35  5 13 33 19  0  1 12 24  3 18  2  3 16 13 10 21
  27  8  3  4  7  1  0  7  2  6  2  3  6  1 10  0  2  0  6 11  3  0  1  2
   2  2  2  0  7  9  1  0  8  1  4  0  3  0  0  0  2  0  2  0  0  0  0  0
   0  0  0  0  0  0  0  0  2  0  0  0  0  1  0  2  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 7 17  3 15  8  7  4  6 27 20 25 21  3  8  1  3  9  8  9  0  4  0  0  7
   3  0  0  3 10  8  1  5  7  0  2  6 15  6  7  0  0  0  5  0  5 25  0  0
   0  8  1  3  3  0  2  1  0  0  1  0  0  0  0  0  0  2  3  0  0  0  0  0
   0  0  0  0  0  1  5  0  0  1  0  0  2  0  3  0  0  0  1  0  0  0  0  0
   0  0  0  0]
 [19  4 28  7 22  1 38 25 26 20 15 25 20  3  2  5  0  2 19  3 24  3 12  3
   0  0  2  9 10  3  3  4  0  0  1  9  0  9  1 28  9  7  3  1  3  8  5  8
   2  0  0  4  1  0  1  3  0  1  0  3  0  0  6  0  0  2  0  2  0  0  3  3
   0  0  0  0  0  0  0  0  0  0  2  0  1  0  0  0  0  0  0  0  0  1  0  0
   0  0  0  0]
 [49 15 46 28  5  3  2 26  7 11 25  0  7  0 19  3 35  3 14  7  1 15  8 44
   1 12  0  0  1  3  4  0  0  7 10  2  3  7  5  1  1  0  0  0  7  1  9  6
   8  0  0  9  1  0  2  4  3  2  4  3  0  0  0  0  0  0  0  0  0  0  0  0
   1  1  1  1  0  0  0  0  0  0  0  0  0  0  1  0  0  0  1  0  0  0  0  0
   0  0  0  0]
 [18 44 51 17  4 31 15 27  9 30  4 12  3 47 18  9 24  5 11  2 10 15  2  0
   4 13  6  1 13 14  3 13  6  0  2  2  1 13  5  5 16  8  3  0  2  0  3  2
   5  3  7  0  1  5  7  4  2  1  5  0  0  0  2  1  1  0  0  0  7  1  0  1
   0  0  1  0  0  0  1  0  0  0  0  0  0  0  1  0  0  0  1  0  0  0  2  0
   0  0  0  0]
 [ 7 50  1 11 21 52  3 19 21 26 21  7  4 27 15  8  1 16  9  0  1  4  7  3
   5  2  7  3  2 11 12 11  0  5  0  9  4  0  6  3  0  0 10  3  9  0  3  3
   0  0  0  0  0  3  3  0  0  0  0  4  1  1  3  0  1  0  0  0  0  1  1  0
   0  2  0  0  0  2  1  0  1  0  2  0  0  0  0  0  0  0  0  0  1  0  0  0
   0  0  0  0]
 [ 7 11  7 23  1 41 42 10 10  3 28  3 23  6  5  4 10  0 18 12 10  5 11  0
  20 11  6  0 11 31  0 19  4  0 11  2 15  0  0  3  5  7  0  0  4  3  0  1
   2  0  0  0  0  2  2  0  0  3  5  2  7  0  1  1  0  0  1  5  0  0  0  0
   0  2  0  0  0  3  0  0  2  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0
   0  0  2  0]
 [14 19  3  3 18  0 53 17 10 36  7  9  0 19  0  8 23  1  7  3  7  2 17  1
  27  7  3  0  3  3  2  1 12 15 10  3  0  0  0  1  7  3  7  0  8  1  0  2
   0  3  2  4  1  1  1  1  1  3  0  2  0  3  3  1  0  0  0  0  4  0  0  0
   2  7  3  0  2  0  0  0  1  0  0  0  1  1  0  0  0  0  0  2  1  0  0  0
   0  0  0  0]
 [ 0  4 11 19 35  0 30  0  0 14  0  2 12  8  4 30  2 17  2  7  7  3  1 11
   0  4  3  7  0  2  4  0 10  2  3  1  3  0  3  0  0 13  0  1  1  0  5  2
   3  0  4  0  7  0  3  1  0  3  3  0  0  0  1  3  0  0  6  4  0  2  2  3
   2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  3  0  0  0  0  0  0
   0  0  0  0]
 [20  6 41  0 11 24  0  9  3 26 18  6  2 11  1 19  0 25 13  2 15  0  9  0
  16  1  7 16 11 10  2  5  4 11  0 10 13 11  3  2  0  3  7  0  1  2  3  0
   0  5  3  7  3  0  3  0  0  6  3  0  1  1  0  7  0  0  0  0  1  7  0  1
   4  2  0  1  1  3  0  0  3  0  0  3  0  3  0  0  0  0  0  0  0  0  0  0
   0  0  1  0]
 [45 16 11  3  5  2  6  3  0  0  0 16  4 13  0 11  3  7  3  3  0 12 11  4
   3  2 42  1  1  7 34  3  0  0  0  3  0 15  0  0  0  0  3  0  2  3  1  1
   3  3  1  0  4  2  0  0  0  2  0  3  1  5  3  1  0  3  0  2  1  0  1  3
   0  0  0  0  0  0  0  3  1  0  0  1  0  0  0  1  0  0  0  2  0  0  1  0
   0  0  0  0]
 [ 7 11 11  7 15 14 11  3 23 29  0 11 46  1 17 15  7 11  9 19 11  0  0  0
   1  5  7  0  1  0  7  0  3  6  4  3  1  7  4  5  1  0  0  0  0  1  8  4
   1  0  8  0  5  0  1  0  1  0  0  0  2  0  0  1 14  0  3  0  0  1  1  0
   0  0  0  0  0  1  1  0  0  0  0  0  0  0  0  0  1  0  0  0  2  0  0  0
   0  0  0  0]
 [ 3 13  0  0 63 16  5 10  7 11 17 30 19  8 13 10  0  3  4  3  7 16  9  0
   6 11  1 29 10  6  0 14  4  0  3  5  0  1 11 10 11  0  2 17  0  4  0  1
  15  3  1  0  0  4  3  0  3  2  0  0  0  1  5  3  0  0  0  0  0  0  0  0
   0  1  0  0  1  1  1  0  0  0  0  0  0  0  0  0  3  0  0  0  1  0  0  0
   0  0  0  0]
 [ 4  7 11  3 45 20  1 15 34  2  0  4  0  1  5 11  3 16  3  7  3  0  8  3
  10  5  0  3  7  7 13  6  9  4  6  4  1  1  5  5  3  0  5  0  6  0  0  0
   2  0  0  3  1  5  0  0  2  5  2  0  1  0  0  2  0  3  0  0  0  2  0  1
   3  0  3  0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]]
Total size of testing set
9142
[387 369 355 341 330 316 301 290 278 269 259 244 235 227 219 207 201 194
 186 174 169 164 155 147 142 136 133 126 123 116 110 107 102  97  92  90
  87  80  80  77  70  69  66  61  58  57  55  53  49  49  45  41  40  40
  36  33  34  31  31  30  29  25  25  25  23  23  21  20  19  17  16  14
  16  17  16  14  13  11   9  12  11   7   7   5   8   7   7   8   7   4
   6   5   6   4   4   4   5   1   4   4]
20
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [04:19<35:57:38, 259.44s/it]  0%|          | 2/500 [08:29<35:07:16, 253.89s/it]3shot of client 0:head:0.0, middle:0.012195121951219513, tail0.0
3shot of client 1:head:0.012437810945273632, middle:0.0, tail0.0
3shot of client 2:head:0.008333333333333333, middle:0.0, tail0.0
3shot of client 3:head:0.0025252525252525255, middle:0.0, tail0.0
3shot of client 4:head:0.002976190476190476, middle:0.0, tail0.0
3shot of client 5:head:0.007481296758104738, middle:0.0, tail0.0
3shot of client 6:head:0.009685230024213076, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.0027247956403269754, middle:0.0, tail0.0
3shot of client 9:head:0.005333333333333333, middle:0.0, tail0.0
3shot of client 10:head:0.00663716814159292, middle:0.016666666666666666, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.008174386920980926, middle:0.010526315789473684, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.011857707509881422, middle:0.0, tail0.0
3shot of client 15:head:0.0084985835694051, middle:0.0, tail0.0
3shot of client 16:head:0.0038461538461538464, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.002890173410404624, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 0, local average test acc  0.0040 

round 0, local macro average F1 score  0.0038 

round 0, local weighted average F1 score  0.0057 

round 0, global test acc  0.3196 

round 0, average 3shot acc: [head: 0.0047, middle: 0.0025, tail: 0.0000] 

round 0, global 3shot acc: [head: 0.7242, middle: 0.3133, tail: 0.0028] 

l_head tensor([1.2969, 2.0941, 2.2073, 2.7269, 2.0424, 2.6902, 1.3663, 2.9066, 1.3917,
        1.9338, 0.5677, 2.5176, 2.4804, 2.4419, 1.7948, 1.5596, 2.4034, 2.2724,
        2.2233, 1.9073, 1.3847, 0.5850, 2.1933, 1.5282, 1.9564, 1.6568, 1.9638,
        2.2838, 2.5522, 1.1300, 0.5776, 0.5801, 2.3346, 1.2021, 2.3814, 2.3673,
        1.9607, 1.8307, 1.8479, 1.1996, 1.7334, 1.6220, 2.3211, 2.3922, 0.5853,
        1.8134, 0.5836, 2.5038, 1.3940, 1.2854, 1.1465, 0.9027, 1.3605, 1.5460,
        1.3044, 2.3415, 0.5709, 1.3220, 1.9868, 1.5707, 1.6834, 0.5795, 1.1184,
        1.7663, 1.3395, 1.5140, 1.4269, 0.5789, 0.5794, 0.5748, 0.9610, 1.0904,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 2.1826, 0.5775,
        1.0796, 0.5815, 0.5747, 0.5807, 1.7440, 1.3263, 1.3759, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 1.3678, 0.5781, 1.1214, 0.5664, 1.4776,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.2572, 1.6225, 1.8280, 1.5562, 1.5973, 1.4761, 1.4269, 1.6250, 1.5449,
        1.4076, 1.2750, 1.6740, 1.4312, 1.4058, 1.3015, 1.4309, 1.3898, 1.4643,
        1.5800, 1.4220, 1.2822, 1.2421, 1.5775, 1.2424, 1.2601, 1.4319, 1.2909,
        1.3837, 1.3704, 1.2343, 1.2461, 1.2699, 1.3192, 1.1622, 1.3793, 1.4316,
        1.1464, 1.2539, 1.2470, 0.9598, 1.2941, 1.0233, 1.1815, 1.1233, 1.0926,
        1.0260, 0.9076, 1.1758, 1.0901, 0.9562, 0.8436, 0.8843, 1.0790, 1.0284,
        1.1337, 0.8347, 0.9324, 0.9887, 0.9408, 0.8235, 0.8313, 0.8515, 0.8397,
        0.7786, 0.6632, 0.6892, 0.7409, 0.7392, 0.7431, 0.8388, 0.7404, 0.7814,
        0.6314, 0.7020, 0.6616, 0.7236, 0.7338, 0.6383, 0.6639, 0.6922, 0.6244,
        0.6936, 0.6556, 0.6182, 0.6341, 0.6277, 0.6321, 0.6457, 0.6089, 0.5899,
        0.6140, 0.6179, 0.5907, 0.5776, 0.6173, 0.6175, 0.5770, 0.5768, 0.5940,
        0.5923], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.006329113924050633, middle:0.012195121951219513, tail0.0
3shot of client 1:head:0.0024875621890547263, middle:0.0, tail0.0
3shot of client 2:head:0.005555555555555556, middle:0.0, tail0.0
3shot of client 3:head:0.007575757575757576, middle:0.01, tail0.04
3shot of client 4:head:0.0, middle:0.01098901098901099, tail0.0
3shot of client 5:head:0.007481296758104738, middle:0.0, tail0.0
3shot of client 6:head:0.007263922518159807, middle:0.0, tail0.0
3shot of client 7:head:0.0037313432835820895, middle:0.0, tail0.0
3shot of client 8:head:0.005449591280653951, middle:0.0, tail0.0
3shot of client 9:head:0.005333333333333333, middle:0.0, tail0.0
3shot of client 10:head:0.0022123893805309734, middle:0.0, tail0.0
3shot of client 11:head:0.00558659217877095, middle:0.0, tail0.0
3shot of client 12:head:0.005449591280653951, middle:0.010526315789473684, tail0.0
3shot of client 13:head:0.002976190476190476, middle:0.0, tail0.0
3shot of client 14:head:0.003952569169960474, middle:0.0, tail0.0
3shot of client 15:head:0.0028328611898017, middle:0.010752688172043012, tail0.0
3shot of client 16:head:0.007692307692307693, middle:0.0, tail0.0
3shot of client 17:head:0.006734006734006734, middle:0.0, tail0.0
3shot of client 18:head:0.008670520231213872, middle:0.0, tail0.0
3shot of client 19:head:0.0038022813688212928, middle:0.0, tail0.0
round 1, local average test acc  0.0045 

round 1, local macro average F1 score  0.0045 

round 1, local weighted average F1 score  0.0066 

round 1, global test acc  0.3349 

round 1, average 3shot acc: [head: 0.0051, middle: 0.0027, tail: 0.0020] 

round 1, global 3shot acc: [head: 0.7281, middle: 0.3597, tail: 0.0033] 

l_head tensor([1.6900, 2.9310, 2.7397, 3.4905, 3.1833, 3.1069, 1.7478, 3.1964, 1.5231,
        2.3116, 0.5677, 3.2574, 2.3910, 3.0452, 2.3916, 1.8077, 3.0011, 2.7251,
        2.5729, 2.3664, 1.6457, 0.5850, 2.7170, 1.6874, 2.2389, 2.1933, 2.3269,
        3.0958, 3.0296, 1.5890, 0.5776, 0.5801, 2.6035, 1.3866, 2.7303, 3.0668,
        2.1427, 2.5016, 2.0284, 1.4451, 2.2811, 2.0943, 3.3228, 2.8966, 0.5853,
        2.2369, 0.5836, 2.8510, 1.8454, 1.5890, 1.4800, 1.2790, 1.6749, 1.9851,
        1.6484, 3.4151, 0.5709, 1.5034, 2.4059, 2.1621, 2.3263, 0.5795, 1.2962,
        2.2566, 1.8308, 1.9195, 2.0773, 0.5789, 0.5794, 0.5748, 1.4224, 1.6412,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 2.8062, 0.5775,
        1.2981, 0.5815, 0.5747, 0.5807, 2.1692, 1.8070, 1.8433, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 1.7351, 0.5781, 1.5131, 0.5664, 1.8717,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.4463, 1.8659, 2.1002, 1.8431, 1.9084, 1.7343, 1.6510, 1.7956, 1.7124,
        1.6768, 1.5602, 2.0011, 1.6740, 1.6833, 1.5639, 1.6347, 1.6478, 1.7113,
        1.7229, 1.6686, 1.4643, 1.4533, 1.8907, 1.5050, 1.4867, 1.6352, 1.5189,
        1.6162, 1.5587, 1.4859, 1.3598, 1.4921, 1.5615, 1.3679, 1.6264, 1.7904,
        1.4516, 1.5658, 1.5370, 1.1773, 1.5111, 1.1670, 1.4732, 1.4607, 1.3680,
        1.2714, 1.2454, 1.4847, 1.3369, 1.2827, 1.0800, 1.1536, 1.3997, 1.2333,
        1.3960, 1.0798, 1.1940, 1.1978, 1.2514, 1.1260, 1.0879, 1.1640, 1.1198,
        1.0133, 0.7553, 0.8270, 0.9709, 0.9447, 0.9709, 1.0914, 0.9405, 1.0275,
        0.7152, 0.8453, 0.7883, 0.8820, 0.9386, 0.7738, 0.7558, 0.7967, 0.6973,
        0.8430, 0.7733, 0.7135, 0.7694, 0.7146, 0.7251, 0.7466, 0.6717, 0.6528,
        0.6975, 0.6651, 0.6476, 0.6282, 0.6973, 0.6796, 0.6273, 0.6226, 0.6287,
        0.6250], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.006329113924050633, middle:0.0, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.038461538461538464
3shot of client 2:head:0.008333333333333333, middle:0.0, tail0.0
3shot of client 3:head:0.0025252525252525255, middle:0.0, tail0.0
3shot of client 4:head:0.002976190476190476, middle:0.02197802197802198, tail0.0
3shot of client 5:head:0.004987531172069825, middle:0.0, tail0.0
3shot of client 6:head:0.007263922518159807, middle:0.009900990099009901, tail0.0
3shot of client 7:head:0.0037313432835820895, middle:0.0, tail0.0
3shot of client 8:head:0.0027247956403269754, middle:0.0, tail0.0
3shot of client 9:head:0.013333333333333334, middle:0.0, tail0.0
3shot of client 10:head:0.00663716814159292, middle:0.008333333333333333, tail0.0
3shot of client 11:head:0.00558659217877095, middle:0.0, tail0.0
3shot of client 12:head:0.008174386920980926, middle:0.010526315789473684, tail0.0
3shot of client 13:head:0.002976190476190476, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
  1%|          | 3/500 [12:28<34:07:43, 247.21s/it]  1%|          | 4/500 [16:16<32:59:36, 239.47s/it]3shot of client 15:head:0.0056657223796034, middle:0.0, tail0.0
3shot of client 16:head:0.0038461538461538464, middle:0.014492753623188406, tail0.0
3shot of client 17:head:0.003367003367003367, middle:0.0, tail0.0
3shot of client 18:head:0.002890173410404624, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 2, local average test acc  0.0043 

round 2, local macro average F1 score  0.0047 

round 2, local weighted average F1 score  0.0060 

round 2, global test acc  0.3419 

round 2, average 3shot acc: [head: 0.0046, middle: 0.0038, tail: 0.0019] 

round 2, global 3shot acc: [head: 0.7258, middle: 0.3840, tail: 0.0044] 

l_head tensor([1.9326, 3.0542, 3.0118, 3.8272, 3.4560, 3.2108, 2.1892, 3.2634, 2.2901,
        2.8195, 0.5677, 3.5370, 2.9408, 3.2531, 2.3063, 1.9975, 3.1564, 2.8637,
        2.6648, 2.5967, 1.9089, 0.5850, 2.9554, 1.8800, 2.8438, 2.3745, 2.5533,
        3.3694, 3.5380, 1.7567, 0.5776, 0.5801, 2.6855, 1.4035, 3.1760, 3.3855,
        2.4535, 2.6892, 2.1420, 1.4451, 2.6399, 2.2538, 3.4745, 3.2209, 0.5853,
        2.5275, 0.5836, 3.1156, 2.1066, 1.6324, 1.7163, 1.5632, 2.0503, 1.9369,
        1.6990, 3.6144, 0.5709, 1.6902, 2.5428, 2.3249, 2.4360, 0.5795, 1.6051,
        2.4226, 1.9531, 2.3099, 2.1716, 0.5789, 0.5794, 0.5748, 1.7987, 1.8604,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 2.9064, 0.5775,
        1.5288, 0.5815, 0.5747, 0.5807, 2.7105, 2.1947, 2.4266, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 2.0655, 0.5781, 1.9063, 0.5664, 2.2800,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.5779, 1.9764, 2.2674, 2.0135, 2.0542, 1.9044, 1.8112, 1.9241, 1.8401,
        1.8042, 1.7252, 2.2270, 1.8664, 1.7992, 1.7080, 1.7777, 1.7548, 1.8088,
        1.7773, 1.7390, 1.6505, 1.5943, 2.0223, 1.6671, 1.6073, 1.6982, 1.6664,
        1.7368, 1.7184, 1.6050, 1.4818, 1.6634, 1.6895, 1.4640, 1.8092, 1.9096,
        1.5780, 1.7100, 1.7160, 1.2856, 1.6219, 1.2751, 1.6416, 1.6495, 1.4570,
        1.4625, 1.4570, 1.6527, 1.4715, 1.4357, 1.2305, 1.3372, 1.5779, 1.4169,
        1.5773, 1.1844, 1.3694, 1.3146, 1.3622, 1.2795, 1.1645, 1.3077, 1.2619,
        1.1654, 0.8774, 0.9305, 1.1178, 1.1059, 1.1221, 1.1979, 1.0033, 1.1735,
        0.7983, 0.9450, 0.8954, 1.0837, 1.0961, 0.8891, 0.9072, 0.8621, 0.7767,
        0.9879, 0.9082, 0.7972, 0.8392, 0.8161, 0.8269, 0.8480, 0.7434, 0.7183,
        0.7657, 0.7319, 0.6933, 0.6969, 0.7869, 0.7503, 0.6679, 0.6627, 0.6680,
        0.6699], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.006329113924050633, middle:0.012195121951219513, tail0.0
3shot of client 1:head:0.0024875621890547263, middle:0.01020408163265306, tail0.0
3shot of client 2:head:0.005555555555555556, middle:0.010309278350515464, tail0.0
3shot of client 3:head:0.010101010101010102, middle:0.0, tail0.0
3shot of client 4:head:0.008928571428571428, middle:0.0, tail0.0
3shot of client 5:head:0.0024937655860349127, middle:0.0, tail0.0
3shot of client 6:head:0.009685230024213076, middle:0.0, tail0.0
3shot of client 7:head:0.0037313432835820895, middle:0.0, tail0.0
3shot of client 8:head:0.0027247956403269754, middle:0.0, tail0.0
3shot of client 9:head:0.005333333333333333, middle:0.0, tail0.0
3shot of client 10:head:0.00663716814159292, middle:0.0, tail0.0
3shot of client 11:head:0.008379888268156424, middle:0.0, tail0.0
3shot of client 12:head:0.0027247956403269754, middle:0.021052631578947368, tail0.0
3shot of client 13:head:0.008928571428571428, middle:0.0, tail0.0
3shot of client 14:head:0.007905138339920948, middle:0.0, tail0.0
3shot of client 15:head:0.0056657223796034, middle:0.010752688172043012, tail0.0
3shot of client 16:head:0.0038461538461538464, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.002890173410404624, middle:0.0, tail0.0
3shot of client 19:head:0.011406844106463879, middle:0.0, tail0.0
round 3, local average test acc  0.0050 

round 3, local macro average F1 score  0.0041 

round 3, local weighted average F1 score  0.0072 

round 3, global test acc  0.3478 

round 3, average 3shot acc: [head: 0.0058, middle: 0.0032, tail: 0.0000] 

round 3, global 3shot acc: [head: 0.7216, middle: 0.4040, tail: 0.0074] 

l_head tensor([2.0590, 3.1984, 3.1686, 3.8878, 4.0247, 3.4877, 2.2327, 3.6608, 2.3903,
        2.8661, 0.5677, 3.7945, 3.0663, 3.3449, 2.8130, 2.2196, 3.3063, 3.2060,
        3.0088, 2.7716, 2.1593, 0.5850, 3.3423, 1.8917, 2.9933, 2.3670, 2.8083,
        3.7796, 3.7451, 1.8338, 0.5776, 0.5801, 2.9918, 1.6385, 3.6684, 3.6352,
        2.7376, 3.0862, 2.4121, 1.4457, 3.0390, 2.4424, 3.6707, 4.1583, 0.5853,
        2.7546, 0.5836, 3.4381, 2.2355, 1.7563, 1.9125, 1.6626, 2.1219, 2.2068,
        1.6702, 3.9650, 0.5709, 2.0154, 2.7359, 2.5328, 2.6857, 0.5795, 1.9240,
        2.6047, 2.2122, 2.5958, 2.5324, 0.5789, 0.5794, 0.5748, 1.6794, 2.0251,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 3.2552, 0.5775,
        1.8232, 0.5815, 0.5747, 0.5807, 3.0637, 2.3384, 2.6014, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 2.4515, 0.5781, 2.0335, 0.5664, 2.7004,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.6432, 2.1109, 2.4131, 2.1829, 2.1202, 1.9347, 1.9206, 1.9880, 1.9163,
        1.8362, 1.8168, 2.2986, 1.9120, 1.8705, 1.7618, 1.8347, 1.8724, 1.8943,
        1.8306, 1.7952, 1.7043, 1.6663, 2.1598, 1.7338, 1.6895, 1.7708, 1.7584,
        1.8335, 1.7585, 1.6629, 1.5769, 1.6599, 1.8073, 1.5683, 1.9588, 2.0332,
        1.6763, 1.8654, 1.8106, 1.3731, 1.7256, 1.3905, 1.7950, 1.7797, 1.5742,
        1.5741, 1.5796, 1.7826, 1.5327, 1.5384, 1.2800, 1.4297, 1.7342, 1.5084,
        1.6885, 1.3235, 1.4189, 1.4726, 1.4732, 1.4010, 1.3242, 1.4244, 1.3975,
        1.2927, 0.9437, 1.0708, 1.2149, 1.2794, 1.2623, 1.2901, 1.1354, 1.2233,
        0.8757, 1.0397, 0.9986, 1.1780, 1.2076, 0.9796, 1.0002, 0.9511, 0.8433,
        1.0935, 1.0000, 0.8718, 0.9259, 0.8939, 0.8796, 0.9502, 0.7898, 0.7868,
        0.8480, 0.7931, 0.7543, 0.7681, 0.8664, 0.8106, 0.7205, 0.7051, 0.7214,
        0.7113], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0031645569620253164, middle:0.0, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.0
3shot of client 2:head:0.008333333333333333, middle:0.0, tail0.0
3shot of client 3:head:0.005050505050505051, middle:0.0, tail0.04
3shot of client 4:head:0.005952380952380952, middle:0.0, tail0.0
3shot of client 5:head:0.007481296758104738, middle:0.0, tail0.0
3shot of client 6:head:0.004842615012106538, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.008174386920980926, middle:0.02127659574468085, tail0.0
3shot of client 9:head:0.008, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.002793296089385475, middle:0.0, tail0.0
3shot of client 12:head:0.0027247956403269754, middle:0.010526315789473684, tail0.0
3shot of client 13:head:0.002976190476190476, middle:0.011764705882352941, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0028328611898017, middle:0.0, tail0.0
3shot of client 16:head:0.0038461538461538464, middle:0.0, tail0.0
3shot of client 17:head:0.006734006734006734, middle:0.0136986301369863, tail0.0
3shot of client 18:head:0.002890173410404624, middle:0.0, tail0.0
3shot of client 19:head:0.0038022813688212928, middle:0.0, tail0.0
round 4, local average test acc  0.0037 

round 4, local macro average F1 score  0.0037 

round 4, local weighted average F1 score  0.0049 

round 4, global test acc  0.3523 

round 4, average 3shot acc: [head: 0.0040, middle: 0.0029, tail: 0.0020] 

round 4, global 3shot acc: [head: 0.7187, middle: 0.4177, tail: 0.0108] 

l_head   1%|          | 5/500 [19:51<31:43:20, 230.71s/it]  1%|          | 6/500 [23:29<31:03:37, 226.35s/it]tensor([2.5124, 3.2631, 3.1768, 3.9901, 4.1703, 3.3880, 2.4565, 3.9115, 2.4787,
        3.0701, 0.5677, 4.0235, 3.3975, 3.5686, 2.9975, 2.1589, 3.3843, 3.4190,
        3.1019, 3.0000, 2.2373, 0.5850, 3.5485, 2.0426, 3.1790, 2.5477, 2.8937,
        3.9151, 3.7899, 1.8671, 0.5776, 0.5801, 3.2207, 1.7718, 4.0202, 3.8286,
        3.1823, 3.1535, 2.6353, 1.6047, 3.1889, 2.5575, 3.9818, 4.3425, 0.5853,
        2.9550, 0.5836, 3.7943, 2.2267, 1.8802, 2.1780, 1.8630, 2.5767, 2.5470,
        2.0719, 4.2195, 0.5709, 2.2266, 2.9517, 3.0117, 2.6969, 0.5795, 2.1114,
        3.0249, 2.3843, 2.8059, 2.6997, 0.5789, 0.5794, 0.5748, 1.8257, 2.0760,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 3.3797, 0.5775,
        2.0585, 0.5815, 0.5747, 0.5807, 3.2788, 2.7803, 2.6224, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 2.8913, 0.5781, 2.3117, 0.5664, 3.0709,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.7082, 2.1754, 2.5409, 2.2918, 2.2512, 1.9749, 1.9804, 2.0233, 2.0203,
        1.9340, 1.8627, 2.3998, 2.0169, 1.9735, 1.8247, 1.8733, 1.9044, 1.9183,
        1.8559, 1.8650, 1.7447, 1.6970, 2.2288, 1.8461, 1.7461, 1.8176, 1.8170,
        1.8385, 1.8198, 1.7133, 1.6493, 1.7896, 1.8637, 1.6265, 2.0745, 2.1440,
        1.7578, 1.9036, 1.9304, 1.4074, 1.7957, 1.4405, 1.8971, 1.8891, 1.7096,
        1.6511, 1.7289, 1.8705, 1.5949, 1.6333, 1.3859, 1.5172, 1.8714, 1.5968,
        1.7712, 1.3797, 1.4866, 1.5532, 1.5946, 1.5173, 1.3595, 1.5291, 1.4824,
        1.3965, 1.0259, 1.1423, 1.3045, 1.3895, 1.3473, 1.3447, 1.1616, 1.3242,
        0.9197, 1.0816, 1.0770, 1.3071, 1.2925, 1.0716, 1.0472, 1.0332, 0.9078,
        1.2076, 1.0864, 0.9641, 1.0079, 0.9690, 0.9468, 1.0516, 0.8405, 0.8477,
        0.8884, 0.8600, 0.8050, 0.8170, 0.9293, 0.8441, 0.7608, 0.7388, 0.7658,
        0.7653], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.006329113924050633, middle:0.012195121951219513, tail0.0
3shot of client 1:head:0.0024875621890547263, middle:0.0, tail0.0
3shot of client 2:head:0.005555555555555556, middle:0.010309278350515464, tail0.0
3shot of client 3:head:0.0025252525252525255, middle:0.01, tail0.0
3shot of client 4:head:0.002976190476190476, middle:0.0, tail0.0
3shot of client 5:head:0.007481296758104738, middle:0.0, tail0.0
3shot of client 6:head:0.002421307506053269, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0625
3shot of client 8:head:0.005449591280653951, middle:0.02127659574468085, tail0.0
3shot of client 9:head:0.005333333333333333, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.008333333333333333, tail0.0
3shot of client 11:head:0.008379888268156424, middle:0.011111111111111112, tail0.0
3shot of client 12:head:0.0, middle:0.010526315789473684, tail0.0
3shot of client 13:head:0.002976190476190476, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0084985835694051, middle:0.0, tail0.0
3shot of client 16:head:0.0038461538461538464, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 5, local average test acc  0.0034 

round 5, local macro average F1 score  0.0038 

round 5, local weighted average F1 score  0.0042 

round 5, global test acc  0.3565 

round 5, average 3shot acc: [head: 0.0032, middle: 0.0042, tail: 0.0031] 

round 5, global 3shot acc: [head: 0.7145, middle: 0.4290, tail: 0.0162] 

l_head tensor([2.4878, 3.3506, 3.3006, 4.1260, 4.1727, 3.5421, 2.5938, 3.8488, 2.5829,
        3.1145, 0.5677, 4.2765, 3.3134, 3.5137, 3.1027, 2.3525, 3.6434, 3.7309,
        2.9766, 3.0895, 2.2785, 0.5850, 3.7654, 2.0944, 3.0594, 2.5713, 3.0165,
        4.2909, 3.9512, 2.0939, 0.5776, 0.5801, 3.2243, 1.8498, 4.1078, 3.9880,
        3.0855, 3.2845, 2.6578, 1.6045, 3.2948, 2.5985, 3.9327, 4.4745, 0.5853,
        3.0272, 0.5836, 3.8891, 2.2263, 1.9979, 2.3025, 1.9782, 2.6447, 2.6528,
        1.9740, 4.5210, 0.5709, 2.2283, 3.1897, 2.9042, 2.7046, 0.5795, 2.1868,
        3.1769, 2.6711, 3.0987, 2.8999, 0.5789, 0.5794, 0.5748, 1.9911, 2.2039,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 3.6762, 0.5775,
        2.1764, 0.5815, 0.5747, 0.5807, 3.4233, 2.9297, 2.8705, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 2.9919, 0.5781, 2.4518, 0.5664, 3.1095,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.7211, 2.2398, 2.5973, 2.3590, 2.2614, 2.0207, 2.0491, 2.1014, 1.9967,
        1.9629, 1.8750, 2.4219, 2.0065, 2.0296, 1.8583, 1.9225, 1.9014, 1.9917,
        1.9135, 1.9056, 1.7601, 1.7496, 2.2169, 1.9115, 1.7718, 1.8819, 1.8756,
        1.9453, 1.8392, 1.7374, 1.6746, 1.8422, 1.8721, 1.6904, 2.1429, 2.2679,
        1.8068, 1.9530, 2.0222, 1.4159, 1.8416, 1.4816, 1.9856, 1.9525, 1.7776,
        1.7021, 1.8095, 1.9464, 1.6741, 1.6753, 1.4729, 1.6307, 1.9710, 1.6697,
        1.8537, 1.4335, 1.5236, 1.6369, 1.6593, 1.6306, 1.4587, 1.6506, 1.5327,
        1.4862, 1.0942, 1.1660, 1.4107, 1.4742, 1.4248, 1.4375, 1.2071, 1.3632,
        0.9821, 1.1710, 1.1139, 1.3742, 1.3888, 1.1174, 1.0988, 1.0804, 0.9672,
        1.2603, 1.1705, 1.0081, 1.0396, 1.0307, 1.0075, 1.1317, 0.9207, 0.8856,
        0.9426, 0.9006, 0.8676, 0.8415, 0.9913, 0.9001, 0.8077, 0.7984, 0.7983,
        0.7997], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.006329113924050633, middle:0.0, tail0.0
3shot of client 1:head:0.0024875621890547263, middle:0.02040816326530612, tail0.0
3shot of client 2:head:0.005555555555555556, middle:0.0, tail0.0
3shot of client 3:head:0.0025252525252525255, middle:0.01, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.007481296758104738, middle:0.0, tail0.0
3shot of client 6:head:0.002421307506053269, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.010899182561307902, middle:0.0, tail0.0
3shot of client 9:head:0.005333333333333333, middle:0.0, tail0.0
3shot of client 10:head:0.0022123893805309734, middle:0.0, tail0.0
3shot of client 11:head:0.002793296089385475, middle:0.0, tail0.0
3shot of client 12:head:0.0027247956403269754, middle:0.010526315789473684, tail0.0
3shot of client 13:head:0.002976190476190476, middle:0.0, tail0.047619047619047616
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0056657223796034, middle:0.0, tail0.0
3shot of client 16:head:0.007692307692307693, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.021739130434782608, tail0.043478260869565216
3shot of client 19:head:0.0038022813688212928, middle:0.0, tail0.0
round 6, local average test acc  0.0035 

round 6, local macro average F1 score  0.0052 

round 6, local weighted average F1 score  0.0045 

round 6, global test acc  0.3588 

round 6, average 3shot acc: [head: 0.0035, middle: 0.0031, tail: 0.0046] 

round 6, global 3shot acc: [head: 0.7129, middle: 0.4353, tail: 0.0185] 

l_head tensor([2.4820, 3.5528, 3.5776, 4.3414, 4.3128, 3.4770, 2.6001, 3.8061, 2.5634,
        3.1626, 0.5677, 4.4128, 3.4706, 3.6689, 3.2336, 2.5041, 3.6948, 3.7565,
        3.3462, 3.0976, 2.4226, 0.5850, 3.7209, 2.2044, 3.2364, 2.5883, 3.1633,
        4.3015, 4.1274, 2.2659, 0.5776, 0.5801, 3.2221, 1.9106, 4.1354, 4.0069,
        3.1444, 3.3389, 2.8604, 1.6037, 3.3613, 2.6752, 4.0308, 4.5352, 0.5853,
        3.1526, 0.5836, 3.8682, 2.2430, 2.0815, 2.5065, 2.0752, 2.7778, 2.7064,
        2.0009, 4.6074, 0.5709, 2.3305, 3.4366, 2.8136, 2.8580, 0.5795, 2.1787,
        3.2664, 2.7864, 3.2750, 3.0025, 0.5789, 0.5794, 0.5748, 2.0863, 2.3637,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 3.9783, 0.5775,
        2.2626, 0.5815, 0.5747, 0.5807, 3.8923, 3.0493, 2.9608, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 3.1194, 0.5781, 2.6960, 0.5664, 3.2614,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux   1%|▏         | 7/500 [26:58<30:14:29, 220.83s/it]  2%|▏         | 8/500 [30:32<29:51:27, 218.47s/it]  2%|▏         | 9/500 [34:11<29:50:19, 218.78s/it]tensor([1.7952, 2.2841, 2.6613, 2.4142, 2.3252, 2.0607, 2.0981, 2.1306, 2.0426,
        1.9864, 1.9373, 2.4734, 2.0469, 2.1035, 1.8870, 1.9382, 1.9645, 2.0493,
        1.9311, 1.9163, 1.7798, 1.7351, 2.2869, 1.9945, 1.8289, 1.8962, 1.9190,
        1.9739, 1.9137, 1.8102, 1.7392, 1.8835, 1.9203, 1.7063, 2.1632, 2.3347,
        1.8385, 2.0005, 2.0177, 1.4608, 1.9058, 1.4737, 2.0621, 2.0123, 1.8129,
        1.7754, 1.9137, 2.0021, 1.6856, 1.7439, 1.5104, 1.6652, 2.0649, 1.7686,
        1.9413, 1.5120, 1.5819, 1.6853, 1.7553, 1.7139, 1.4980, 1.7243, 1.5895,
        1.5593, 1.1534, 1.2129, 1.4635, 1.5583, 1.4799, 1.5076, 1.2461, 1.4156,
        1.0301, 1.2243, 1.1731, 1.4433, 1.4356, 1.1667, 1.1593, 1.1298, 1.0099,
        1.2967, 1.2223, 1.0363, 1.0716, 1.1078, 1.0769, 1.1782, 0.9613, 0.9240,
        1.0162, 0.9466, 0.9202, 0.8755, 1.0419, 0.9518, 0.8590, 0.8418, 0.8515,
        0.8361], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0031645569620253164, middle:0.012195121951219513, tail0.0
3shot of client 1:head:0.0, middle:0.01020408163265306, tail0.0
3shot of client 2:head:0.005555555555555556, middle:0.0, tail0.043478260869565216
3shot of client 3:head:0.005050505050505051, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.00997506234413965, middle:0.009433962264150943, tail0.0
3shot of client 6:head:0.009685230024213076, middle:0.009900990099009901, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.005449591280653951, middle:0.0, tail0.0
3shot of client 9:head:0.008, middle:0.0, tail0.0
3shot of client 10:head:0.0022123893805309734, middle:0.008333333333333333, tail0.0
3shot of client 11:head:0.008379888268156424, middle:0.0, tail0.0
3shot of client 12:head:0.005449591280653951, middle:0.010526315789473684, tail0.0
3shot of client 13:head:0.002976190476190476, middle:0.0, tail0.047619047619047616
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0028328611898017, middle:0.0, tail0.0
3shot of client 16:head:0.015384615384615385, middle:0.0, tail0.0
3shot of client 17:head:0.013468013468013467, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.0038022813688212928, middle:0.0, tail0.0
round 7, local average test acc  0.0048 

round 7, local macro average F1 score  0.0052 

round 7, local weighted average F1 score  0.0064 

round 7, global test acc  0.3622 

round 7, average 3shot acc: [head: 0.0051, middle: 0.0036, tail: 0.0046] 

round 7, global 3shot acc: [head: 0.7116, middle: 0.4423, tail: 0.0228] 

l_head tensor([2.6001, 3.6003, 3.5330, 4.3369, 4.4243, 3.4984, 2.5596, 3.9820, 2.6040,
        3.4454, 0.5677, 4.4511, 3.4187, 3.6054, 3.2715, 2.5002, 3.7619, 3.7449,
        3.5043, 3.2847, 2.4337, 0.5850, 3.8058, 2.3263, 3.4418, 2.6618, 3.2355,
        4.3468, 4.1425, 2.3340, 0.5776, 0.5801, 3.2231, 2.0154, 4.1265, 4.0481,
        3.2278, 3.4274, 2.8698, 1.7329, 3.4182, 3.0241, 4.2550, 4.4704, 0.5853,
        3.2449, 0.5836, 4.0331, 2.3713, 2.0857, 2.6094, 2.0541, 2.9316, 2.7402,
        2.1681, 4.6127, 0.5709, 2.4170, 3.5784, 3.0422, 2.9274, 0.5795, 2.3537,
        3.4639, 2.9454, 3.4398, 3.0671, 0.5789, 0.5794, 0.5748, 2.1712, 2.3440,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 4.2100, 0.5775,
        2.3411, 0.5815, 0.5747, 0.5807, 3.9125, 3.0967, 3.0970, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 3.2755, 0.5781, 2.8088, 0.5664, 3.4603,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8108, 2.3258, 2.6901, 2.4411, 2.4081, 2.1179, 2.1266, 2.1519, 2.0804,
        2.0615, 1.9841, 2.5198, 2.0839, 2.1145, 1.9345, 1.9582, 1.9839, 2.1144,
        1.9344, 1.9726, 1.8150, 1.7949, 2.2956, 2.0307, 1.8800, 1.9054, 1.9271,
        2.0112, 1.9644, 1.8486, 1.7829, 1.9252, 1.9318, 1.7328, 2.1956, 2.3774,
        1.8714, 1.9936, 2.1322, 1.4870, 1.9610, 1.5212, 2.0804, 2.0536, 1.8420,
        1.8384, 2.0204, 2.0584, 1.6983, 1.7845, 1.5468, 1.7234, 2.0887, 1.8038,
        1.9747, 1.5688, 1.6498, 1.7413, 1.8200, 1.7983, 1.5552, 1.8109, 1.6475,
        1.6010, 1.2030, 1.2473, 1.5010, 1.6109, 1.5400, 1.5320, 1.2843, 1.4588,
        1.0504, 1.2714, 1.2471, 1.5014, 1.4927, 1.2087, 1.2029, 1.1711, 1.0426,
        1.3839, 1.2859, 1.0838, 1.1123, 1.1520, 1.0938, 1.2070, 0.9870, 0.9725,
        1.0670, 0.9652, 0.9554, 0.9173, 1.1052, 0.9614, 0.8922, 0.8648, 0.8980,
        0.8855], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.0024875621890547263, middle:0.0, tail0.0
3shot of client 2:head:0.005555555555555556, middle:0.0, tail0.0
3shot of client 3:head:0.005050505050505051, middle:0.0, tail0.0
3shot of client 4:head:0.002976190476190476, middle:0.0, tail0.0
3shot of client 5:head:0.004987531172069825, middle:0.0, tail0.0
3shot of client 6:head:0.007263922518159807, middle:0.009900990099009901, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.008174386920980926, middle:0.0, tail0.0
3shot of client 9:head:0.005333333333333333, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.008333333333333333, tail0.0
3shot of client 11:head:0.0, middle:0.011111111111111112, tail0.0
3shot of client 12:head:0.005449591280653951, middle:0.010526315789473684, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.003952569169960474, middle:0.0, tail0.0
3shot of client 15:head:0.0056657223796034, middle:0.0, tail0.0
3shot of client 16:head:0.007692307692307693, middle:0.0, tail0.0
3shot of client 17:head:0.003367003367003367, middle:0.0136986301369863, tail0.0
3shot of client 18:head:0.002890173410404624, middle:0.0, tail0.0
3shot of client 19:head:0.0076045627376425855, middle:0.0, tail0.0
round 8, local average test acc  0.0035 

round 8, local macro average F1 score  0.0030 

round 8, local weighted average F1 score  0.0041 

round 8, global test acc  0.3640 

round 8, average 3shot acc: [head: 0.0039, middle: 0.0027, tail: 0.0000] 

round 8, global 3shot acc: [head: 0.7084, middle: 0.4490, tail: 0.0249] 

l_head tensor([2.5174, 3.6455, 3.6099, 4.5309, 4.5934, 3.4976, 2.7667, 4.1123, 2.6558,
        3.3709, 0.5677, 4.5430, 3.5687, 3.7031, 3.2877, 2.5102, 3.9297, 3.9349,
        3.3893, 3.2602, 2.4717, 0.5850, 3.8509, 2.3059, 3.2130, 2.8259, 3.2372,
        4.6859, 4.1115, 2.3112, 0.5776, 0.5801, 3.2713, 2.0628, 4.3407, 4.2289,
        3.2232, 3.5023, 2.8976, 1.7322, 3.4466, 3.0232, 4.2635, 4.5970, 0.5853,
        3.5428, 0.5836, 4.1223, 2.5130, 2.0878, 2.6205, 2.0542, 2.9569, 2.7453,
        2.3217, 4.6909, 0.5709, 2.4294, 3.8436, 3.2132, 2.9960, 0.5795, 2.4877,
        3.4364, 3.1764, 3.5444, 3.1422, 0.5789, 0.5794, 0.5748, 2.2248, 2.3888,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 4.2495, 0.5775,
        2.4967, 0.5815, 0.5747, 0.5807, 4.0054, 3.1224, 3.1746, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 3.3579, 0.5781, 2.8654, 0.5664, 3.6412,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8528, 2.3324, 2.7327, 2.4619, 2.4003, 2.1513, 2.1748, 2.1702, 2.1262,
        2.1028, 2.0341, 2.5623, 2.1283, 2.1774, 1.9621, 2.0172, 2.0503, 2.1365,
        1.9596, 1.9719, 1.8214, 1.8744, 2.3304, 2.1038, 1.9259, 1.9593, 1.9520,
        2.0090, 2.0050, 1.8991, 1.8219, 1.9786, 1.9738, 1.7783, 2.2389, 2.4723,
        1.9111, 2.0200, 2.1484, 1.5263, 1.9836, 1.5401, 2.0878, 2.0924, 1.9020,
        1.8812, 2.0616, 2.0806, 1.7254, 1.8275, 1.5912, 1.7450, 2.1180, 1.8758,
        2.0200, 1.5976, 1.6830, 1.7985, 1.8787, 1.8086, 1.5878, 1.8234, 1.7253,
        1.6642, 1.2403, 1.2901, 1.5399, 1.6426, 1.5768, 1.5695, 1.3069, 1.5090,
        1.0980, 1.2976, 1.2867, 1.5687, 1.5153, 1.2660, 1.2294, 1.2044, 1.1018,
        1.4349, 1.3485, 1.1399, 1.1559, 1.2231, 1.1656, 1.2436, 1.0293, 0.9917,
        1.1103, 0.9944, 1.0000, 0.9537, 1.1317, 0.9921, 0.9377, 0.8904, 0.9293,
        0.9291], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0031645569620253164, middle:0.0, tail0.0
  2%|▏         | 10/500 [37:57<30:03:18, 220.81s/it]  2%|▏         | 11/500 [41:54<30:40:01, 225.77s/it]3shot of client 1:head:0.004975124378109453, middle:0.0, tail0.0
3shot of client 2:head:0.008333333333333333, middle:0.010309278350515464, tail0.0
3shot of client 3:head:0.010101010101010102, middle:0.0, tail0.0
3shot of client 4:head:0.005952380952380952, middle:0.0, tail0.0
3shot of client 5:head:0.0024937655860349127, middle:0.0, tail0.0
3shot of client 6:head:0.007263922518159807, middle:0.009900990099009901, tail0.0
3shot of client 7:head:0.0037313432835820895, middle:0.0, tail0.0
3shot of client 8:head:0.0027247956403269754, middle:0.0, tail0.0
3shot of client 9:head:0.010666666666666666, middle:0.0, tail0.0
3shot of client 10:head:0.004424778761061947, middle:0.008333333333333333, tail0.0
3shot of client 11:head:0.002793296089385475, middle:0.011111111111111112, tail0.0
3shot of client 12:head:0.0, middle:0.010526315789473684, tail0.0
3shot of client 13:head:0.005952380952380952, middle:0.011764705882352941, tail0.0
3shot of client 14:head:0.003952569169960474, middle:0.0, tail0.0
3shot of client 15:head:0.0056657223796034, middle:0.0, tail0.0
3shot of client 16:head:0.011538461538461539, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.0076045627376425855, middle:0.0, tail0.0
round 9, local average test acc  0.0044 

round 9, local macro average F1 score  0.0038 

round 9, local weighted average F1 score  0.0063 

round 9, global test acc  0.3662 

round 9, average 3shot acc: [head: 0.0051, middle: 0.0031, tail: 0.0000] 

round 9, global 3shot acc: [head: 0.7100, middle: 0.4510, tail: 0.0277] 

l_head tensor([2.5579, 3.9217, 3.6359, 4.6727, 4.5324, 3.5671, 2.9801, 4.3460, 2.7469,
        3.3968, 0.5677, 4.5458, 3.4668, 3.7159, 3.4236, 2.5138, 4.0100, 3.9014,
        3.4731, 3.2342, 2.5202, 0.5850, 3.9889, 2.3692, 3.4235, 2.9182, 3.4132,
        4.6335, 4.2805, 2.4985, 0.5776, 0.5801, 3.6307, 2.0276, 4.3826, 4.4295,
        3.2633, 3.6406, 2.9921, 1.7274, 3.5272, 3.0487, 4.5273, 4.5867, 0.5853,
        3.5876, 0.5836, 4.3313, 2.4566, 2.1492, 2.6768, 2.1925, 2.9916, 2.7578,
        2.3194, 4.8696, 0.5709, 2.4986, 4.0368, 3.3547, 3.0964, 0.5795, 2.4682,
        3.4822, 3.4255, 3.6022, 3.3340, 0.5789, 0.5794, 0.5748, 2.2401, 2.4507,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 4.4881, 0.5775,
        2.6002, 0.5815, 0.5747, 0.5807, 4.1006, 3.1599, 3.2192, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 3.4387, 0.5781, 2.9902, 0.5664, 3.6895,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8914, 2.3878, 2.7406, 2.4948, 2.4282, 2.1902, 2.2197, 2.2073, 2.1636,
        2.1127, 2.0513, 2.5747, 2.1590, 2.2221, 1.9816, 2.0741, 2.0694, 2.1450,
        1.9907, 1.9921, 1.8843, 1.8591, 2.3570, 2.1200, 1.9496, 1.9908, 2.0130,
        2.0281, 2.0632, 1.9356, 1.8611, 1.9838, 1.9886, 1.8133, 2.3277, 2.5485,
        1.9232, 2.0348, 2.1487, 1.5456, 2.0066, 1.5957, 2.1810, 2.1337, 1.9088,
        1.9447, 2.1223, 2.1445, 1.7417, 1.8251, 1.6195, 1.7610, 2.1930, 1.9172,
        2.0818, 1.6267, 1.7088, 1.8669, 1.9305, 1.8532, 1.6307, 1.8466, 1.7618,
        1.7028, 1.2677, 1.3380, 1.5975, 1.6900, 1.6332, 1.6264, 1.3691, 1.5702,
        1.1298, 1.3476, 1.3165, 1.6124, 1.5720, 1.3199, 1.3020, 1.2326, 1.1123,
        1.4834, 1.4116, 1.1847, 1.1916, 1.2479, 1.2469, 1.2796, 1.0568, 1.0144,
        1.1622, 1.0329, 1.0343, 0.9799, 1.2002, 1.0386, 0.9742, 0.9128, 0.9702,
        0.9622], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0031645569620253164, middle:0.0, tail0.0
3shot of client 1:head:0.0, middle:0.01020408163265306, tail0.0
3shot of client 2:head:0.008333333333333333, middle:0.0, tail0.0
3shot of client 3:head:0.005050505050505051, middle:0.0, tail0.0
3shot of client 4:head:0.002976190476190476, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.007263922518159807, middle:0.019801980198019802, tail0.0
3shot of client 7:head:0.0037313432835820895, middle:0.0136986301369863, tail0.0
3shot of client 8:head:0.008174386920980926, middle:0.0, tail0.0
3shot of client 9:head:0.005333333333333333, middle:0.0, tail0.0
3shot of client 10:head:0.0022123893805309734, middle:0.008333333333333333, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.005449591280653951, middle:0.010526315789473684, tail0.0
3shot of client 13:head:0.005952380952380952, middle:0.0, tail0.0
3shot of client 14:head:0.003952569169960474, middle:0.0, tail0.0
3shot of client 15:head:0.0056657223796034, middle:0.0, tail0.0
3shot of client 16:head:0.007692307692307693, middle:0.0, tail0.0
3shot of client 17:head:0.003367003367003367, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.010869565217391304, tail0.043478260869565216
3shot of client 19:head:0.0, middle:0.0, tail0.0
round 10, local average test acc  0.0038 

round 10, local macro average F1 score  0.0043 

round 10, local weighted average F1 score  0.0047 

round 10, global test acc  0.3665 

round 10, average 3shot acc: [head: 0.0039, middle: 0.0037, tail: 0.0022] 

round 10, global 3shot acc: [head: 0.7068, middle: 0.4517, tail: 0.0305] 

l_head tensor([2.7036, 4.0094, 3.7850, 4.6347, 4.6640, 3.5652, 2.9977, 4.3593, 2.7018,
        3.4606, 0.5677, 4.5313, 3.5579, 3.8884, 3.5184, 2.5927, 3.9909, 3.9098,
        3.3988, 3.3849, 2.6259, 0.5850, 3.9985, 2.3665, 3.4480, 2.9059, 3.4464,
        4.6527, 4.4990, 2.5776, 0.5776, 0.5801, 3.6988, 2.0585, 4.4936, 4.5210,
        3.3384, 3.5777, 3.0227, 1.7325, 3.5715, 3.2098, 4.4999, 4.6789, 0.5853,
        3.6372, 0.5836, 4.3075, 2.4549, 2.1357, 2.8938, 2.2205, 3.2274, 2.8426,
        2.2359, 5.0151, 0.5709, 2.6049, 3.8575, 3.4135, 3.1218, 0.5795, 2.5608,
        3.5182, 3.4381, 3.6223, 3.3816, 0.5789, 0.5794, 0.5748, 2.3359, 2.5477,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 4.7124, 0.5775,
        2.8084, 0.5815, 0.5747, 0.5807, 4.1757, 3.2963, 3.3613, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 3.4670, 0.5781, 2.9427, 0.5664, 3.6779,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.9316, 2.4012, 2.7683, 2.5639, 2.4545, 2.2379, 2.2771, 2.1976, 2.1487,
        2.1393, 2.0544, 2.6398, 2.1814, 2.2409, 1.9968, 2.0828, 2.0955, 2.1902,
        2.0042, 2.0443, 1.9134, 1.8788, 2.3847, 2.1659, 1.9635, 1.9988, 2.0737,
        2.0673, 2.0726, 1.9462, 1.9060, 1.9977, 2.0230, 1.8379, 2.3339, 2.5868,
        1.9945, 2.0786, 2.1666, 1.6012, 2.0451, 1.6176, 2.1831, 2.1693, 1.9438,
        1.9444, 2.1706, 2.1852, 1.8146, 1.8710, 1.6768, 1.7622, 2.2346, 1.9579,
        2.1262, 1.6968, 1.7134, 1.8864, 1.9878, 1.9268, 1.6517, 1.9004, 1.8037,
        1.7481, 1.2695, 1.3610, 1.6359, 1.7273, 1.6625, 1.6561, 1.3795, 1.6006,
        1.1373, 1.3785, 1.3586, 1.6576, 1.6078, 1.3570, 1.3377, 1.2730, 1.1568,
        1.5329, 1.4573, 1.2343, 1.2076, 1.2978, 1.2810, 1.3363, 1.0926, 1.0540,
        1.1796, 1.0749, 1.0720, 0.9994, 1.2474, 1.0781, 0.9822, 0.9419, 0.9958,
        0.9927], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.0024875621890547263, middle:0.0, tail0.0
3shot of client 2:head:0.008333333333333333, middle:0.0, tail0.0
3shot of client 3:head:0.007575757575757576, middle:0.0, tail0.0
3shot of client 4:head:0.011904761904761904, middle:0.0, tail0.0
3shot of client 5:head:0.004987531172069825, middle:0.0, tail0.0
3shot of client 6:head:0.009685230024213076, middle:0.009900990099009901, tail0.0
3shot of client 7:head:0.007462686567164179, middle:0.0, tail0.0
3shot of client 8:head:0.008174386920980926, middle:0.010638297872340425, tail0.0
3shot of client 9:head:0.010666666666666666, middle:0.0, tail0.0
3shot of client 10:head:0.0022123893805309734, middle:0.008333333333333333, tail0.0
3shot of client 11:head:0.00558659217877095, middle:0.0, tail0.0
3shot of client 12:head:0.0027247956403269754, middle:0.010526315789473684, tail0.0
3shot of client 13:head:0.0, middle:0.011764705882352941, tail0.0
3shot of client 14:head:0.011857707509881422, middle:0.0, tail0.0
  2%|▏         | 12/500 [46:10<31:52:06, 235.10s/it]  3%|▎         | 13/500 [50:30<32:50:14, 242.74s/it]3shot of client 15:head:0.0056657223796034, middle:0.0, tail0.0
3shot of client 16:head:0.007692307692307693, middle:0.0, tail0.0
3shot of client 17:head:0.003367003367003367, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.043478260869565216
3shot of client 19:head:0.0038022813688212928, middle:0.0, tail0.0
round 11, local average test acc  0.0049 

round 11, local macro average F1 score  0.0048 

round 11, local weighted average F1 score  0.0065 

round 11, global test acc  0.3688 

round 11, average 3shot acc: [head: 0.0057, middle: 0.0026, tail: 0.0022] 

round 11, global 3shot acc: [head: 0.7048, middle: 0.4570, tail: 0.0338] 

l_head tensor([2.6767, 3.8666, 3.6961, 4.6719, 4.6279, 3.6097, 3.0605, 4.3907, 2.7759,
        3.4598, 0.5677, 4.6225, 3.6205, 4.0027, 3.4983, 2.5952, 4.0065, 4.0155,
        3.4943, 3.4554, 2.6747, 0.5850, 3.9362, 2.3251, 3.6186, 2.9300, 3.5349,
        4.6784, 4.4634, 2.5024, 0.5776, 0.5801, 3.6945, 2.0683, 4.5716, 4.5380,
        3.3116, 3.6041, 3.0656, 1.8112, 3.7165, 3.2427, 4.4933, 4.6108, 0.5853,
        3.7484, 0.5836, 4.3748, 2.4900, 2.2898, 2.9352, 2.2158, 3.1992, 2.8449,
        2.3832, 5.1283, 0.5709, 2.6891, 3.8859, 3.4023, 3.1506, 0.5795, 2.6279,
        3.6933, 3.5711, 3.7764, 3.3744, 0.5789, 0.5794, 0.5748, 2.3356, 2.5506,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 4.8319, 0.5775,
        2.8674, 0.5815, 0.5747, 0.5807, 4.2400, 3.4183, 3.3963, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 3.5716, 0.5781, 3.0242, 0.5664, 3.7999,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.9620, 2.3881, 2.7936, 2.5809, 2.4648, 2.2535, 2.2884, 2.2300, 2.1728,
        2.1533, 2.0768, 2.6451, 2.2149, 2.2560, 2.0061, 2.0710, 2.0892, 2.2084,
        2.0689, 2.0537, 1.9232, 1.8875, 2.3977, 2.1817, 1.9942, 2.0143, 2.0596,
        2.0778, 2.0716, 1.9484, 1.9193, 2.0265, 2.0607, 1.8403, 2.3354, 2.5872,
        2.0048, 2.1035, 2.1924, 1.6179, 2.0838, 1.6541, 2.2037, 2.1745, 1.9835,
        1.9690, 2.2130, 2.2166, 1.7957, 1.9219, 1.7187, 1.7984, 2.2522, 1.9937,
        2.1973, 1.7382, 1.7361, 1.9346, 2.0011, 1.9480, 1.7133, 1.9392, 1.8418,
        1.8076, 1.3142, 1.3958, 1.6459, 1.7619, 1.6701, 1.6898, 1.4329, 1.6204,
        1.2024, 1.4236, 1.3975, 1.7049, 1.6546, 1.4041, 1.3601, 1.2795, 1.1865,
        1.5633, 1.4786, 1.2641, 1.2618, 1.3505, 1.2945, 1.3626, 1.1073, 1.0672,
        1.2323, 1.1036, 1.0894, 1.0280, 1.2888, 1.0888, 1.0350, 0.9596, 1.0309,
        1.0181], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.006329113924050633, middle:0.0, tail0.0
3shot of client 1:head:0.009950248756218905, middle:0.0, tail0.0
3shot of client 2:head:0.008333333333333333, middle:0.0, tail0.0
3shot of client 3:head:0.007575757575757576, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.01098901098901099, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.007263922518159807, middle:0.0, tail0.0
3shot of client 7:head:0.0037313432835820895, middle:0.0136986301369863, tail0.0
3shot of client 8:head:0.008174386920980926, middle:0.0, tail0.0
3shot of client 9:head:0.010666666666666666, middle:0.0, tail0.0
3shot of client 10:head:0.0022123893805309734, middle:0.0, tail0.0
3shot of client 11:head:0.008379888268156424, middle:0.022222222222222223, tail0.0
3shot of client 12:head:0.005449591280653951, middle:0.010526315789473684, tail0.0
3shot of client 13:head:0.0, middle:0.011764705882352941, tail0.0
3shot of client 14:head:0.007905138339920948, middle:0.0, tail0.0
3shot of client 15:head:0.0028328611898017, middle:0.0, tail0.0
3shot of client 16:head:0.007692307692307693, middle:0.0, tail0.0
3shot of client 17:head:0.003367003367003367, middle:0.0, tail0.0
3shot of client 18:head:0.002890173410404624, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.011406844106463879, middle:0.0, tail0.0
round 12, local average test acc  0.0051 

round 12, local macro average F1 score  0.0051 

round 12, local weighted average F1 score  0.0069 

round 12, global test acc  0.3715 

round 12, average 3shot acc: [head: 0.0057, middle: 0.0040, tail: 0.0000] 

round 12, global 3shot acc: [head: 0.7048, middle: 0.4617, tail: 0.0372] 

l_head tensor([2.7382, 3.9830, 3.7795, 4.6413, 4.6333, 3.6037, 3.2024, 4.4029, 2.7744,
        3.4508, 0.5677, 4.5841, 3.6821, 4.0455, 3.3931, 2.5941, 4.0604, 4.0621,
        3.4968, 3.4686, 2.5809, 0.5850, 3.9943, 2.3917, 3.6801, 2.9849, 3.5666,
        4.8050, 4.5467, 2.6206, 0.5776, 0.5801, 3.9495, 2.1675, 4.6262, 4.5463,
        3.4250, 3.6525, 3.1390, 1.7964, 3.6535, 3.2687, 4.5501, 4.4499, 0.5853,
        3.7072, 0.5836, 4.5265, 2.4900, 2.2320, 2.9650, 2.2143, 3.3059, 2.9555,
        2.3552, 5.0863, 0.5709, 2.6731, 3.9457, 3.4450, 3.1069, 0.5795, 2.5892,
        3.7787, 3.6009, 3.9017, 3.4401, 0.5789, 0.5794, 0.5748, 2.4730, 2.6727,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 4.9083, 0.5775,
        2.9448, 0.5815, 0.5747, 0.5807, 4.2956, 3.5478, 3.4648, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 3.7320, 0.5781, 3.0154, 0.5664, 3.9663,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.9673, 2.4002, 2.8128, 2.6015, 2.4851, 2.2768, 2.3207, 2.2366, 2.1819,
        2.1731, 2.1211, 2.6341, 2.2231, 2.3202, 2.0236, 2.0987, 2.1228, 2.2192,
        2.0969, 2.0760, 1.9474, 1.8902, 2.4260, 2.2231, 2.0205, 2.0490, 2.0733,
        2.0896, 2.0905, 1.9654, 1.9193, 2.0124, 2.0984, 1.8208, 2.3617, 2.6617,
        2.0056, 2.1226, 2.2101, 1.6343, 2.1270, 1.6727, 2.2226, 2.2032, 1.9855,
        1.9997, 2.2467, 2.2418, 1.8419, 1.9192, 1.7465, 1.8347, 2.3040, 2.0720,
        2.2265, 1.7610, 1.7744, 1.9803, 2.0244, 1.9639, 1.7075, 1.9686, 1.8730,
        1.8419, 1.3566, 1.4163, 1.6711, 1.8093, 1.7318, 1.7158, 1.4482, 1.6870,
        1.2392, 1.4385, 1.4090, 1.7357, 1.6913, 1.4392, 1.3975, 1.3290, 1.2193,
        1.5925, 1.5193, 1.3146, 1.2824, 1.3718, 1.3196, 1.4039, 1.1506, 1.1066,
        1.2559, 1.1394, 1.1163, 1.0387, 1.2994, 1.1251, 1.0424, 0.9738, 1.0753,
        1.0470], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.012195121951219513, tail0.0
3shot of client 1:head:0.0, middle:0.01020408163265306, tail0.0
3shot of client 2:head:0.008333333333333333, middle:0.0, tail0.0
3shot of client 3:head:0.007575757575757576, middle:0.0, tail0.0
3shot of client 4:head:0.002976190476190476, middle:0.0, tail0.0
3shot of client 5:head:0.0024937655860349127, middle:0.0, tail0.0
3shot of client 6:head:0.009685230024213076, middle:0.009900990099009901, tail0.0
3shot of client 7:head:0.0, middle:0.0136986301369863, tail0.0
3shot of client 8:head:0.008174386920980926, middle:0.0, tail0.0
3shot of client 9:head:0.008, middle:0.0, tail0.0
3shot of client 10:head:0.008849557522123894, middle:0.0, tail0.0
3shot of client 11:head:0.002793296089385475, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.010526315789473684, tail0.0
3shot of client 13:head:0.0, middle:0.011764705882352941, tail0.0
3shot of client 14:head:0.003952569169960474, middle:0.0, tail0.0
3shot of client 15:head:0.0028328611898017, middle:0.0, tail0.0
3shot of client 16:head:0.007692307692307693, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.002890173410404624, middle:0.021739130434782608, tail0.0
3shot of client 19:head:0.0076045627376425855, middle:0.0, tail0.0
round 13, local average test acc  0.0041 

round 13, local macro average F1 score  0.0042 

round 13, local weighted average F1 score  0.0049 

round 13, global test acc  0.3702 

round 13, average 3shot acc: [head: 0.0042, middle: 0.0045, tail: 0.0000] 

round 13, global 3shot acc: [head: 0.7019, middle: 0.4587, tail: 0.0385] 

l_head   3%|▎         | 14/500 [54:41<33:04:46, 245.03s/it]  3%|▎         | 15/500 [58:36<32:37:14, 242.13s/it]tensor([2.7776, 4.0195, 3.7864, 4.7096, 4.6720, 3.6403, 3.2191, 4.6013, 2.7566,
        3.5550, 0.5677, 4.6970, 3.6687, 4.1045, 3.3956, 2.7147, 4.0839, 4.0819,
        3.5183, 3.4809, 2.5834, 0.5850, 4.0475, 2.3931, 3.7250, 3.0996, 3.6424,
        4.7532, 4.6343, 2.6611, 0.5776, 0.5801, 3.8718, 2.1673, 4.6821, 4.6701,
        3.3986, 3.7116, 3.1048, 1.7945, 3.6634, 3.3505, 4.6189, 4.4820, 0.5853,
        3.7242, 0.5836, 4.6335, 2.5956, 2.2513, 3.0686, 2.2214, 3.3825, 2.9932,
        2.3947, 5.1193, 0.5709, 2.7819, 3.9449, 3.4549, 3.2930, 0.5795, 2.6501,
        3.7905, 3.7227, 3.8827, 3.5067, 0.5789, 0.5794, 0.5748, 2.4547, 2.6682,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 4.9850, 0.5775,
        3.0149, 0.5815, 0.5747, 0.5807, 4.4347, 3.5475, 3.5909, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 3.8271, 0.5781, 3.1394, 0.5664, 3.9937,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.9809, 2.4631, 2.8449, 2.7079, 2.5060, 2.3090, 2.3392, 2.2687, 2.1645,
        2.1823, 2.1443, 2.6785, 2.2552, 2.3585, 2.0463, 2.1176, 2.1417, 2.2495,
        2.1171, 2.1057, 1.9566, 1.9312, 2.4528, 2.2392, 2.0666, 2.0680, 2.1062,
        2.1095, 2.1007, 1.9803, 1.9558, 2.0452, 2.0829, 1.8360, 2.3604, 2.7003,
        2.0185, 2.1398, 2.2032, 1.6505, 2.1442, 1.6964, 2.2467, 2.2313, 2.0043,
        2.0245, 2.2999, 2.2754, 1.8648, 1.9414, 1.7374, 1.8480, 2.3314, 2.0912,
        2.2428, 1.7998, 1.7914, 2.0116, 2.0396, 2.0102, 1.7537, 2.0165, 1.8947,
        1.8696, 1.4074, 1.4420, 1.7027, 1.8468, 1.7349, 1.7476, 1.4826, 1.7095,
        1.2542, 1.4729, 1.4359, 1.7618, 1.7141, 1.4811, 1.4302, 1.3635, 1.2372,
        1.6686, 1.5667, 1.3701, 1.3047, 1.4014, 1.3588, 1.4614, 1.1662, 1.1302,
        1.2771, 1.1538, 1.1446, 1.0583, 1.3349, 1.1442, 1.0685, 1.0018, 1.0965,
        1.0766], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.004975124378109453, middle:0.0, tail0.0
3shot of client 2:head:0.008333333333333333, middle:0.0, tail0.0
3shot of client 3:head:0.005050505050505051, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.014527845036319613, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.008174386920980926, middle:0.0, tail0.0
3shot of client 9:head:0.008, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.011111111111111112, tail0.0
3shot of client 12:head:0.0027247956403269754, middle:0.010526315789473684, tail0.0
3shot of client 13:head:0.005952380952380952, middle:0.0, tail0.0
3shot of client 14:head:0.007905138339920948, middle:0.0, tail0.0
3shot of client 15:head:0.0028328611898017, middle:0.0, tail0.0
3shot of client 16:head:0.007692307692307693, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.0038022813688212928, middle:0.0, tail0.0
round 14, local average test acc  0.0034 

round 14, local macro average F1 score  0.0026 

round 14, local weighted average F1 score  0.0040 

round 14, global test acc  0.3730 

round 14, average 3shot acc: [head: 0.0040, middle: 0.0016, tail: 0.0000] 

round 14, global 3shot acc: [head: 0.7048, middle: 0.4643, tail: 0.0390] 

l_head tensor([2.7649, 4.0031, 3.8247, 4.7476, 4.7065, 3.5846, 3.2784, 4.6567, 2.7650,
        3.5954, 0.5677, 4.6457, 3.7002, 4.1626, 3.4333, 2.5845, 4.1608, 4.0570,
        3.5361, 3.5489, 2.6347, 0.5850, 3.9873, 2.4878, 3.6941, 3.0799, 3.7526,
        4.7356, 4.5449, 2.7865, 0.5776, 0.5801, 3.8604, 2.3092, 4.5988, 4.6161,
        3.3559, 3.7654, 3.1893, 1.7930, 3.7626, 3.4069, 4.6520, 4.5615, 0.5853,
        3.9881, 0.5836, 4.7589, 2.5543, 2.2513, 3.1218, 2.2574, 3.4237, 2.9679,
        2.5930, 5.2027, 0.5709, 2.8473, 3.9945, 3.5963, 3.3198, 0.5795, 2.7483,
        3.9440, 3.8127, 4.0338, 3.4629, 0.5789, 0.5794, 0.5748, 2.5437, 2.7125,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 4.9714, 0.5775,
        3.0822, 0.5815, 0.5747, 0.5807, 4.5054, 3.5705, 3.6199, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 3.9044, 0.5781, 3.1265, 0.5664, 4.1064,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.9560, 2.4707, 2.8882, 2.7034, 2.5067, 2.3430, 2.3652, 2.2727, 2.1720,
        2.2102, 2.1394, 2.6800, 2.2643, 2.3503, 2.0596, 2.1224, 2.1390, 2.2451,
        2.1069, 2.1268, 1.9682, 1.9557, 2.4511, 2.2669, 2.0836, 2.0958, 2.1433,
        2.1320, 2.1346, 1.9965, 1.9960, 2.0641, 2.1216, 1.8623, 2.3704, 2.7403,
        2.0508, 2.1663, 2.2264, 1.6971, 2.1760, 1.7223, 2.3091, 2.2403, 2.0420,
        2.0522, 2.3480, 2.3111, 1.8848, 1.9495, 1.7462, 1.8805, 2.3683, 2.1228,
        2.2896, 1.8265, 1.7984, 2.0433, 2.0429, 2.0214, 1.7535, 2.0700, 1.9371,
        1.9256, 1.4265, 1.4676, 1.7137, 1.8677, 1.7779, 1.7787, 1.5173, 1.7137,
        1.2804, 1.4914, 1.4585, 1.8002, 1.7519, 1.5217, 1.4500, 1.3950, 1.2695,
        1.6816, 1.6002, 1.3817, 1.3364, 1.4427, 1.3804, 1.5067, 1.1842, 1.1619,
        1.3019, 1.1803, 1.1618, 1.0840, 1.3653, 1.1628, 1.0865, 1.0328, 1.1204,
        1.1158], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.012195121951219513, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.0
3shot of client 2:head:0.005555555555555556, middle:0.0, tail0.0
3shot of client 3:head:0.007575757575757576, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0024937655860349127, middle:0.0, tail0.0
3shot of client 6:head:0.007263922518159807, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.005449591280653951, middle:0.0, tail0.0
3shot of client 9:head:0.005333333333333333, middle:0.0, tail0.0
3shot of client 10:head:0.0022123893805309734, middle:0.025, tail0.0
3shot of client 11:head:0.00558659217877095, middle:0.011111111111111112, tail0.0
3shot of client 12:head:0.0027247956403269754, middle:0.021052631578947368, tail0.0
3shot of client 13:head:0.002976190476190476, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0028328611898017, middle:0.0, tail0.0
3shot of client 16:head:0.007692307692307693, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.005780346820809248, middle:0.0, tail0.0
3shot of client 19:head:0.0076045627376425855, middle:0.015151515151515152, tail0.0
round 15, local average test acc  0.0035 

round 15, local macro average F1 score  0.0031 

round 15, local weighted average F1 score  0.0043 

round 15, global test acc  0.3730 

round 15, average 3shot acc: [head: 0.0036, middle: 0.0042, tail: 0.0000] 

round 15, global 3shot acc: [head: 0.7000, middle: 0.4663, tail: 0.0413] 

l_head tensor([2.7974, 4.0255, 3.7882, 4.7918, 4.7314, 3.6390, 3.2456, 4.7768, 2.7785,
        3.5313, 0.5677, 4.6343, 3.8107, 4.1246, 3.4940, 2.6906, 4.2363, 4.1082,
        3.5079, 3.6141, 2.6488, 0.5850, 4.2561, 2.5705, 3.8766, 3.1197, 3.8436,
        4.8782, 4.6856, 2.8011, 0.5776, 0.5801, 3.8278, 2.2877, 4.8568, 4.6880,
        3.4574, 3.7609, 3.2059, 1.8577, 3.8242, 3.4307, 4.6795, 4.5815, 0.5853,
        4.0664, 0.5836, 4.8646, 2.5579, 2.2513, 3.1289, 2.2627, 3.4062, 2.9634,
        2.5871, 5.3087, 0.5709, 2.8015, 4.0195, 3.6459, 3.4022, 0.5795, 2.7967,
        4.0120, 3.8727, 4.0437, 3.5603, 0.5789, 0.5794, 0.5748, 2.4531, 2.7562,
        0.5625, 0.5779, 0.5769, 0.5899, 0.5849, 0.5723, 0.5617, 4.9829, 0.5775,
        3.2039, 0.5815, 0.5747, 0.5807, 4.6252, 3.6163, 3.6970, 0.5671, 0.5903,
        0.5720, 0.5576, 0.5576, 0.5833, 3.9267, 0.5781, 3.2327, 0.5664, 4.1005,
        0.5693], device='cuda:7', grad_fn=<LinalgVectorNormBackward0>)
g_aux   3%|▎         | 16/500 [1:02:17<31:41:04, 235.67s/it]  3%|▎         | 17/500 [1:06:09<31:28:10, 234.56s/it]
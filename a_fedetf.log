nohup: ignoring input
./temp/fl_acc_cifar10_resnet18_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N40_10_seed3407_p1_dirichlet0.5_IF0.02_LossCE.txt
Files already downloaded and verified
[5000, 3237, 2096, 1357, 878, 568, 368, 238, 154, 100]
13996
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[226, 200, 143, 400, 329, 90, 221, 637, 842, 250, 726, 518, 793, 161, 235, 161, 218, 559, 487, 418, 221, 234, 176, 162, 239, 66, 600, 183, 189, 512, 995, 619, 558, 431, 282, 158, 224, 122, 172, 239]
training set distribution:
[[ 72  90   1   0  13   0  23   0  27   0]
 [118   3  12   6  42  10   0   4   0   5]
 [ 32   5   6  43  12   2  22  18   0   3]
 [ 91  37  46  66 110  40   4   2   0   4]
 [ 73 133  59  30   0   0  20   6   0   8]
 [ 10  21  30   1   3  12   0   9   4   0]
 [  0  27  38   0 116  20  15   1   3   1]
 [105 516   3   4   2   0   2   2   0   3]
 [570   1  46  93  87  15   6  19   0   5]
 [  0 120   4  12  59  50   5   0   0   0]
 [397 149 122  11  31   0   0  11   3   2]
 [262 165   1   7   1  51  17   7   6   1]
 [581  93  72   5  21   4   0  10   7   0]
 [ 30   1 104   0   8  10   4   4   0   0]
 [ 15 159  13  19   3  14   5   1   0   6]
 [ 57   0  33  22  17   9   2  15   2   4]
 [  2  59  71  15  42   0  27   0   0   2]
 [323  58  84  37   3   0  26  11   4  13]
 [  2 267 143  18  19  11   0   6  17   4]
 [113  23 172  56   0   3  14  37   0   0]
 [ 93   5  93  13   4   9   1   1   1   1]
 [  0  70  53  43  44   6   7   0  11   0]
 [  0  30  32  90   0   9  11   2   2   0]
 [ 99   8   0   1   2  40   4   1   6   1]
 [126  58  35   0  14   3   2   0   1   0]
 [  3   1  30   4   3  11   5   4   0   5]
 [423 146  13   0   0   1   7   5   3   2]
 [  6   1  70  25  46  34   0   1   0   0]
 [  0 124   8  31   7   0  10   0   5   4]
 [428   0  52   3  17   0   3   6   1   2]
 [190 570   0 173  48   0   4   0   0  10]
 [332 118   6  84   1   6  44   3  21   4]
 [152  29 355   0   6   3  11   0   2   0]
 [  2  11  67 304  13  14   4   1  12   3]
 [ 62  91  85  21  14   4   2   1   1   1]
 [  1   1  35  48  34   0  38   1   0   0]
 [125  12  43   3   2   0  10  16  13   0]
 [ 20  15   0  40   8  29   3   1   1   5]
 [ 48  19  36   0   0  40   7  22   0   0]
 [ 37   1  23  29  26 108   3  10   1   1]]
Total size of training set
13996
local test distribution:
[[ 51  64   0   0   9   0  16   0  19   0]
 [ 84   2   8   4  30   7   0   2   0   3]
 [ 22   3   4  30   8   1  15  12   0   2]
 [ 65  26  32  47  78  28   2   1   0   2]
 [ 52  95  42  21   0   0  14   4   0   5]
 [  7  15  21   0   2   8   0   6   2   0]
 [  0  19  27   0  82  14  10   0   2   0]
 [ 75 368   2   2   1   0   1   1   0   2]
 [407   0  32  66  62  10   4  13   0   3]
 [  0  85   2   8  42  35   3   0   0   0]
 [283 106  87   7  22   0   0   7   2   1]
 [187 117   0   5   0  36  12   5   4   0]
 [415  66  51   3  15   2   0   7   5   0]
 [ 21   0  74   0   5   7   2   2   0   0]
 [ 10 113   9  13   2  10   3   0   0   4]
 [ 40   0  23  15  12   6   1  10   1   2]
 [  1  42  50  10  30   0  19   0   0   1]
 [230  41  60  26   2   0  18   7   2   9]
 [  1 190 102  12  13   7   0   4  12   2]
 [ 80  16 122  40   0   2  10  26   0   0]
 [ 66   3  66   9   2   6   0   0   0   0]
 [  0  50  37  30  31   4   5   0   7   0]
 [  0  21  22  64   0   6   7   1   1   0]
 [ 70   5   0   0   1  28   2   0   4   0]
 [ 90  41  25   0  10   2   1   0   0   0]
 [  2   0  21   2   2   7   3   2   0   3]
 [302 104   9   0   0   0   5   3   2   1]
 [  4   0  50  17  32  24   0   0   0   0]
 [  0  88   5  22   5   0   7   0   3   2]
 [305   0  37   2  12   0   2   4   0   1]
 [135 407   0 123  34   0   2   0   0   7]
 [237  84   4  60   0   4  31   2  15   2]
 [108  20 253   0   4   2   7   0   1   0]
 [  1   7  47 217   9  10   2   0   8   2]
 [ 44  65  60  15  10   2   1   0   0   0]
 [  0   0  25  34  24   0  27   0   0   0]
 [ 89   8  30   2   1   0   7  11   9   0]
 [ 14  10   0  28   5  20   2   0   0   3]
 [ 34  13  25   0   0  28   5  15   0   0]
 [ 26   0  16  20  18  77   2   7   0   0]]
Total size of testing set
9850
[3558 2294 1480  954  615  393  248  152   99   57]
40
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [02:20<19:30:14, 140.71s/it]  0%|          | 2/500 [04:33<18:50:44, 136.23s/it]3shot of client 0:head:0.014925373134328358, middle:0.0, tail0
3shot of client 1:head:0.06140350877192982, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.06666666666666667, tail0.0
3shot of client 3:head:0.009009009009009009, middle:0.018518518518518517, tail0.0
3shot of client 4:head:0.005291005291005291, middle:0.0, tail0.0
3shot of client 5:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 6:head:0.1484375, middle:0.0, tail0.0
3shot of client 7:head:0.010869565217391304, middle:0.0, tail0.0
3shot of client 8:head:0.11627906976744186, middle:0.018691588785046728, tail0.058823529411764705
3shot of client 9:head:0.47530864197530864, middle:0.0, tail0.0
3shot of client 10:head:0.056555269922879174, middle:0.05504587155963303, tail0.0
3shot of client 11:head:0.01644736842105263, middle:0.0, tail0.0
3shot of client 12:head:0.10187110187110188, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.022222222222222223, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.03323262839879154, middle:0.03773584905660377, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.012396694214876033, middle:0.023809523809523808, tail0.0
3shot of client 20:head:0.007575757575757576, middle:0.0, tail0.2
3shot of client 21:head:0.3108108108108108, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.07142857142857142, middle:0.0, tail0.0
3shot of client 24:head:0.007633587786259542, middle:0.02857142857142857, tail0.3333333333333333
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.05665024630541872, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.6909090909090909, middle:0.0, tail0.0
3shot of client 29:head:0.19344262295081968, middle:0.0, tail0.0
3shot of client 30:head:0.007380073800738007, middle:0.0, tail0.0
3shot of client 31:head:0.03412073490813648, middle:0.0, tail0.0
3shot of client 32:head:0.002770083102493075, middle:0.0, tail0.0
3shot of client 33:head:0.007575757575757576, middle:0.037037037037037035, tail0.0
3shot of client 34:head:0.005917159763313609, middle:0.0, tail0.0
3shot of client 35:head:0.09302325581395349, middle:0.0, tail0
3shot of client 36:head:0.06722689075630252, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.00980392156862745, middle:0.0, tail0.0
3shot of client 39:head:0.0070921985815602835, middle:0.0, tail0.0
round 0, local average test acc  0.0627 

round 0, local macro average F1 score  0.0249 

round 0, local weighted average F1 score  0.0710 

round 0, global test acc  0.6083 

round 0, average 3shot acc: [head: 0.0715, middle: 0.0073, tail: 0.0156] 

round 0, global 3shot acc: [head: 0.8600, middle: 0.6443, tail: 0.2367] 

l_head tensor([1.7159, 1.3608, 0.8673, 0.6701, 1.1499, 0.5809, 1.2057, 0.6040, 0.9843,
        0.5777], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.0461, 1.0203, 0.9730, 0.8679, 0.8524, 0.7189, 0.7660, 0.7209, 0.6663,
        0.7044], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.022388059701492536, middle:0.0, tail0
3shot of client 1:head:0.08771929824561403, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.09259259259259259, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.1484375, middle:0.0, tail0.0
3shot of client 7:head:0.005434782608695652, middle:0.0, tail0.0
3shot of client 8:head:0.12050739957716702, middle:0.009345794392523364, tail0.0
3shot of client 9:head:0.49382716049382713, middle:0.0, tail0.0
3shot of client 10:head:0.043701799485861184, middle:0.0, tail0.0
3shot of client 11:head:0.023026315789473683, middle:0.0, tail0.07142857142857142
3shot of client 12:head:0.12266112266112267, middle:0.015151515151515152, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.007936507936507936, middle:0.0, tail0.0
3shot of client 15:head:0.022222222222222223, middle:0.0, tail0.0
3shot of client 16:head:0.00819672131147541, middle:0.0, tail0.0
3shot of client 17:head:0.045317220543806644, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.01652892561983471, middle:0.0, tail0.0
3shot of client 20:head:0.015151515151515152, middle:0.0, tail0.0
3shot of client 21:head:0.3108108108108108, middle:0.0, tail0.0
3shot of client 22:head:0.17757009345794392, middle:0.07692307692307693, tail0.0
3shot of client 23:head:0.09183673469387756, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.0665024630541872, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.7090909090909091, middle:0.0, tail0.0
3shot of client 29:head:0.2098360655737705, middle:0.0, tail0.0
3shot of client 30:head:0.005535055350553505, middle:0.0, tail0.0
3shot of client 31:head:0.03412073490813648, middle:0.021739130434782608, tail0.0
3shot of client 32:head:0.002770083102493075, middle:0.0, tail0.0
3shot of client 33:head:0.003787878787878788, middle:0.0, tail0.0
3shot of client 34:head:0.005917159763313609, middle:0.0, tail0.0
3shot of client 35:head:0.06976744186046512, middle:0.0, tail0
3shot of client 36:head:0.06722689075630252, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 1, local average test acc  0.0655 

round 1, local macro average F1 score  0.0240 

round 1, local weighted average F1 score  0.0829 

round 1, global test acc  0.6517 

round 1, average 3shot acc: [head: 0.0754, middle: 0.0055, tail: 0.0019] 

round 1, global 3shot acc: [head: 0.8517, middle: 0.6897, tail: 0.3470] 

l_head tensor([1.7169, 1.2816, 0.9528, 0.6704, 1.1073, 0.5819, 1.1239, 0.6049, 1.2360,
        0.5786], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.1812, 1.1038, 1.0982, 0.9620, 0.9566, 0.7940, 0.8597, 0.8005, 0.7614,
        0.8303], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.022388059701492536, middle:0.0, tail0
3shot of client 1:head:0.07017543859649122, middle:0.05263157894736842, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.018518518518518517, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.002717391304347826, middle:0.0, tail0.0
3shot of client 8:head:0.1331923890063425, middle:0.0, tail0.0
3shot of client 9:head:0.49382716049382713, middle:0.0, tail0.0
3shot of client 10:head:0.04627249357326478, middle:0.0, tail0.058823529411764705
3shot of client 11:head:0.02631578947368421, middle:0.0, tail0.0
3shot of client 12:head:0.13097713097713098, middle:0.0, tail0.0
3shot of client 13:head:0.021052631578947368, middle:0.0, tail0.0
3shot of client 14:head:0.007936507936507936, middle:0.0, tail0.0
3shot of client 15:head:0.022222222222222223, middle:0.0, tail0.25
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.054380664652567974, middle:0.0, tail0.09090909090909091
3shot of client 18:head:0.003424657534246575, middle:0.0, tail0.0
3shot of client 19:head:0.008264462809917356, middle:0.047619047619047616, tail0.0
3shot of client 20:head:0.015151515151515152, middle:0.0, tail0.0
3shot of client 21:head:0.31756756756756754, middle:0.0, tail0.0
3shot of client 22:head:0.17757009345794392, middle:0.0, tail0.0
3shot of client 23:head:0.09183673469387756, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
  1%|          | 3/500 [06:43<18:23:20, 133.20s/it]  1%|          | 4/500 [08:56<18:21:48, 133.28s/it]  1%|          | 5/500 [11:09<18:18:58, 133.21s/it]3shot of client 26:head:0.07635467980295567, middle:0, tail0.1
3shot of client 27:head:0.009433962264150943, middle:0.0, tail0.0
3shot of client 28:head:0.7272727272727273, middle:0.0, tail0.0
3shot of client 29:head:0.22295081967213115, middle:0.0, tail0.0
3shot of client 30:head:0.005535055350553505, middle:0.0, tail0.0
3shot of client 31:head:0.047244094488188976, middle:0.0, tail0.0
3shot of client 32:head:0.00554016620498615, middle:0.05, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.06976744186046512, middle:0.0, tail0
3shot of client 36:head:0.10084033613445378, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.043478260869565216, tail0.0
round 2, local average test acc  0.0679 

round 2, local macro average F1 score  0.0260 

round 2, local weighted average F1 score  0.0566 

round 2, global test acc  0.6666 

round 2, average 3shot acc: [head: 0.0780, middle: 0.0054, tail: 0.0132] 

round 2, global 3shot acc: [head: 0.8602, middle: 0.6893, tail: 0.3857] 

l_head tensor([1.8714, 1.3814, 0.9785, 0.6709, 1.1528, 0.5833, 1.1866, 0.6060, 1.1859,
        0.5800], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.3033, 1.1613, 1.1814, 1.0577, 0.9964, 0.8634, 0.8935, 0.8596, 0.8150,
        0.8931], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.022388059701492536, middle:0.04, tail0
3shot of client 1:head:0.07017543859649122, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.0, tail0.0
3shot of client 4:head:0.015873015873015872, middle:0.0, tail0.0
3shot of client 5:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.002717391304347826, middle:0.0, tail0.0
3shot of client 8:head:0.1416490486257928, middle:0.0, tail0.0
3shot of client 9:head:0.4876543209876543, middle:0.0, tail0.0
3shot of client 10:head:0.043701799485861184, middle:0.009174311926605505, tail0.0
3shot of client 11:head:0.03618421052631579, middle:0.0, tail0.0
3shot of client 12:head:0.12474012474012475, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.007936507936507936, middle:0.0, tail0.0
3shot of client 15:head:0.022222222222222223, middle:0.0, tail0.25
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.04833836858006042, middle:0.018867924528301886, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.008264462809917356, middle:0.0, tail0.0
3shot of client 20:head:0.015151515151515152, middle:0.0, tail0.0
3shot of client 21:head:0.31756756756756754, middle:0.0, tail0.0
3shot of client 22:head:0.17757009345794392, middle:0.0, tail0.0
3shot of client 23:head:0.09183673469387756, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.07142857142857142, middle:0, tail0.05
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.7181818181818181, middle:0.0, tail0.0
3shot of client 29:head:0.22295081967213115, middle:0.0, tail0.0
3shot of client 30:head:0.005535055350553505, middle:0.006369426751592357, tail0.0
3shot of client 31:head:0.05249343832020997, middle:0.0, tail0.08333333333333333
3shot of client 32:head:0.00554016620498615, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.05813953488372093, middle:0.0, tail0
3shot of client 36:head:0.08403361344537816, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.00980392156862745, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 3, local average test acc  0.0664 

round 3, local macro average F1 score  0.0235 

round 3, local weighted average F1 score  0.0833 

round 3, global test acc  0.6751 

round 3, average 3shot acc: [head: 0.0768, middle: 0.0019, tail: 0.0101] 

round 3, global 3shot acc: [head: 0.8570, middle: 0.6937, tail: 0.4140] 

l_head tensor([1.8987, 1.4366, 1.0031, 0.6714, 1.2431, 0.5850, 1.2645, 0.6075, 1.2900,
        0.5816], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.3981, 1.2069, 1.2533, 1.1226, 1.0724, 0.8873, 0.9330, 0.8985, 0.8485,
        0.9447], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.014925373134328358, middle:0.0, tail0
3shot of client 1:head:0.07017543859649122, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.013513513513513514, middle:0.037037037037037035, tail0.0
3shot of client 4:head:0.005291005291005291, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.1484375, middle:0.041666666666666664, tail0.0
3shot of client 7:head:0.005434782608695652, middle:0.0, tail0.0
3shot of client 8:head:0.13742071881606766, middle:0.009345794392523364, tail0.0
3shot of client 9:head:0.47530864197530864, middle:0.0, tail0.0
3shot of client 10:head:0.038560411311053984, middle:0.01834862385321101, tail0.058823529411764705
3shot of client 11:head:0.023026315789473683, middle:0.0, tail0.0
3shot of client 12:head:0.1288981288981289, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.022222222222222223, middle:0.0625, tail0.0
3shot of client 16:head:0.0, middle:0.034482758620689655, tail0.0
3shot of client 17:head:0.04833836858006042, middle:0.0, tail0.0
3shot of client 18:head:0.003424657534246575, middle:0.02702702702702703, tail0.0
3shot of client 19:head:0.012396694214876033, middle:0.0, tail0.0
3shot of client 20:head:0.015151515151515152, middle:0.0, tail0.0
3shot of client 21:head:0.31756756756756754, middle:0.0, tail0.0
3shot of client 22:head:0.17757009345794392, middle:0.0, tail0.0
3shot of client 23:head:0.09183673469387756, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.02857142857142857, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.07142857142857142, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.7, middle:0.0, tail0.0
3shot of client 29:head:0.2098360655737705, middle:0.0, tail0.0
3shot of client 30:head:0.0018450184501845018, middle:0.0, tail0.0
3shot of client 31:head:0.04199475065616798, middle:0.0, tail0.0
3shot of client 32:head:0.00554016620498615, middle:0.0, tail0.0
3shot of client 33:head:0.003787878787878788, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.06976744186046512, middle:0.0, tail0
3shot of client 36:head:0.06722689075630252, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.00980392156862745, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.043478260869565216, tail0.0
round 4, local average test acc  0.0650 

round 4, local macro average F1 score  0.0230 

round 4, local weighted average F1 score  0.0706 

round 4, global test acc  0.6728 

round 4, average 3shot acc: [head: 0.0743, middle: 0.0078, tail: 0.0015] 

round 4, global 3shot acc: [head: 0.8570, middle: 0.6930, tail: 0.4070] 

l_head tensor([1.9228, 1.5055, 1.0094, 0.6723, 1.2558, 0.5878, 1.2926, 0.6101, 1.3043,
        0.5844], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.4948, 1.2485, 1.3277, 1.1784, 1.1045, 0.9080, 0.9558, 0.9199, 0.8844,
        0.9744], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.014925373134328358, middle:0.0, tail0
3shot of client 1:head:0.07894736842105263, middle:0.05263157894736842, tail0.0
3shot of client 2:head:0.02531645569620253, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
  1%|          | 6/500 [13:23<18:17:04, 133.25s/it]  1%|▏         | 7/500 [15:34<18:09:36, 132.61s/it]3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.1484375, middle:0.0, tail0.0
3shot of client 7:head:0.008152173913043478, middle:0.0, tail0.0
3shot of client 8:head:0.13530655391120508, middle:0.0, tail0.0
3shot of client 9:head:0.4876543209876543, middle:0.0, tail0.0
3shot of client 10:head:0.04627249357326478, middle:0.009174311926605505, tail0.0
3shot of client 11:head:0.03289473684210526, middle:0.0, tail0.0
3shot of client 12:head:0.14137214137214138, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.007936507936507936, middle:0.0, tail0.0
3shot of client 15:head:0.022222222222222223, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.054380664652567974, middle:0.018867924528301886, tail0.0
3shot of client 18:head:0.003424657534246575, middle:0.0, tail0.0
3shot of client 19:head:0.012396694214876033, middle:0.0, tail0.0
3shot of client 20:head:0.015151515151515152, middle:0.0, tail0.0
3shot of client 21:head:0.31756756756756754, middle:0.0, tail0.0
3shot of client 22:head:0.17757009345794392, middle:0.0, tail0.0
3shot of client 23:head:0.09183673469387756, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.07881773399014778, middle:0, tail0.0
3shot of client 27:head:0.018867924528301886, middle:0.0, tail0.0
3shot of client 28:head:0.7, middle:0.0, tail0.0
3shot of client 29:head:0.23934426229508196, middle:0.0, tail0.0
3shot of client 30:head:0.005535055350553505, middle:0.01910828025477707, tail0.0
3shot of client 31:head:0.049868766404199474, middle:0.021739130434782608, tail0.0
3shot of client 32:head:0.002770083102493075, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.046511627906976744, middle:0.0, tail0
3shot of client 36:head:0.09243697478991597, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.029411764705882353, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 5, local average test acc  0.0675 

round 5, local macro average F1 score  0.0245 

round 5, local weighted average F1 score  0.0863 

round 5, global test acc  0.6948 

round 5, average 3shot acc: [head: 0.0783, middle: 0.0031, tail: 0.0000] 

round 5, global 3shot acc: [head: 0.8557, middle: 0.6960, tail: 0.4790] 

l_head tensor([1.8975, 1.4334, 1.0546, 0.6742, 1.2806, 0.5920, 1.4405, 0.6140, 1.4408,
        0.5887], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.5509, 1.2682, 1.3759, 1.2375, 1.1451, 0.9392, 0.9792, 0.9417, 0.9146,
        1.0205], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.007462686567164179, middle:0.0, tail0
3shot of client 1:head:0.07894736842105263, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.018518518518518517, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 6:head:0.1484375, middle:0.041666666666666664, tail0.0
3shot of client 7:head:0.002717391304347826, middle:0.0, tail0.0
3shot of client 8:head:0.1416490486257928, middle:0.0, tail0.0
3shot of client 9:head:0.47530864197530864, middle:0.0, tail0.0
3shot of client 10:head:0.05141388174807198, middle:0.01834862385321101, tail0.0
3shot of client 11:head:0.029605263157894735, middle:0.0, tail0.0
3shot of client 12:head:0.13721413721413722, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.022222222222222223, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.0634441087613293, middle:0.018867924528301886, tail0.0
3shot of client 18:head:0.003424657534246575, middle:0.0, tail0.0
3shot of client 19:head:0.008264462809917356, middle:0.0, tail0.0
3shot of client 20:head:0.015151515151515152, middle:0.0, tail0.0
3shot of client 21:head:0.3108108108108108, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.09183673469387756, middle:0.0, tail0.0
3shot of client 24:head:0.03816793893129771, middle:0.02857142857142857, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.09113300492610837, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.6909090909090909, middle:0.0, tail0.0
3shot of client 29:head:0.24262295081967214, middle:0.0, tail0.0
3shot of client 30:head:0.0036900369003690036, middle:0.0, tail0.1111111111111111
3shot of client 31:head:0.04461942257217848, middle:0.0, tail0.0
3shot of client 32:head:0.00554016620498615, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.011834319526627219, middle:0.0, tail0.0
3shot of client 35:head:0.05813953488372093, middle:0.0, tail0
3shot of client 36:head:0.10084033613445378, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.0392156862745098, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 6, local average test acc  0.0674 

round 6, local macro average F1 score  0.0209 

round 6, local weighted average F1 score  0.0658 

round 6, global test acc  0.6912 

round 6, average 3shot acc: [head: 0.0780, middle: 0.0032, tail: 0.0029] 

round 6, global 3shot acc: [head: 0.8612, middle: 0.6957, tail: 0.4600] 

l_head tensor([2.0415, 1.5582, 1.0627, 0.6760, 1.2718, 0.5954, 1.4267, 0.6173, 1.5034,
        0.5923], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.6576, 1.3018, 1.4442, 1.2941, 1.1684, 0.9791, 1.0093, 0.9628, 0.9353,
        1.0615], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.014925373134328358, middle:0.04, tail0
3shot of client 1:head:0.07894736842105263, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.1484375, middle:0.0, tail0.0
3shot of client 7:head:0.002717391304347826, middle:0.0, tail0.0
3shot of client 8:head:0.13953488372093023, middle:0.0, tail0.0
3shot of client 9:head:0.47530864197530864, middle:0.0, tail0.0
3shot of client 10:head:0.05141388174807198, middle:0.03669724770642202, tail0.0
3shot of client 11:head:0.03289473684210526, middle:0.0, tail0.0
3shot of client 12:head:0.13305613305613306, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.022222222222222223, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.06948640483383686, middle:0.0, tail0.09090909090909091
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.01652892561983471, middle:0.0, tail0.0
3shot of client 20:head:0.015151515151515152, middle:0.0, tail0.0
3shot of client 21:head:0.3108108108108108, middle:0.0, tail0.0
3shot of client 22:head:0.17757009345794392, middle:0.07692307692307693, tail0.0
3shot of client 23:head:0.11224489795918367, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.08620689655172414, middle:0, tail0.0
3shot of client 27:head:0.009433962264150943, middle:0.0, tail0.0
3shot of client 28:head:0.7, middle:0.0, tail0.0
3shot of client 29:head:0.23934426229508196, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.006369426751592357, tail0.0
3shot of client 31:head:0.04199475065616798, middle:0.0, tail0.0
3shot of client 32:head:0.002770083102493075, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
  2%|▏         | 8/500 [17:46<18:06:05, 132.45s/it]  2%|▏         | 9/500 [20:02<18:12:34, 133.51s/it]  2%|▏         | 10/500 [22:17<18:14:14, 133.99s/it]3shot of client 34:head:0.011834319526627219, middle:0.0, tail0.0
3shot of client 35:head:0.05813953488372093, middle:0.0, tail0
3shot of client 36:head:0.09243697478991597, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.5
round 7, local average test acc  0.0677 

round 7, local macro average F1 score  0.0300 

round 7, local weighted average F1 score  0.0882 

round 7, global test acc  0.7004 

round 7, average 3shot acc: [head: 0.0780, middle: 0.0041, tail: 0.0156] 

round 7, global 3shot acc: [head: 0.8485, middle: 0.7140, tail: 0.4893] 

l_head tensor([2.0544, 1.5605, 1.0653, 0.6774, 1.2924, 0.5979, 1.4565, 0.6197, 1.6289,
        0.5948], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.7206, 1.3211, 1.4845, 1.3323, 1.2006, 1.0009, 1.0172, 0.9868, 0.9713,
        1.0815], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0
3shot of client 1:head:0.08771929824561403, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.009009009009009009, middle:0.018518518518518517, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.13953488372093023, middle:0.0, tail0.0
3shot of client 9:head:0.46296296296296297, middle:0.0, tail0.0
3shot of client 10:head:0.04113110539845758, middle:0.01834862385321101, tail0.0
3shot of client 11:head:0.013157894736842105, middle:0.0, tail0.0
3shot of client 12:head:0.1392931392931393, middle:0.0, tail0.058823529411764705
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.011111111111111112, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.06042296072507553, middle:0.018867924528301886, tail0.09090909090909091
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.01652892561983471, middle:0.023809523809523808, tail0.0
3shot of client 20:head:0.015151515151515152, middle:0.0, tail0.0
3shot of client 21:head:0.3108108108108108, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.09183673469387756, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.07389162561576355, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.6727272727272727, middle:0.0, tail0.0
3shot of client 29:head:0.23934426229508196, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.012738853503184714, tail0.1111111111111111
3shot of client 31:head:0.03412073490813648, middle:0.0, tail0.0
3shot of client 32:head:0.002770083102493075, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.04, tail0.0
3shot of client 35:head:0.05813953488372093, middle:0.0, tail0
3shot of client 36:head:0.10084033613445378, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.5
round 8, local average test acc  0.0640 

round 8, local macro average F1 score  0.0179 

round 8, local weighted average F1 score  0.0501 

round 8, global test acc  0.7041 

round 8, average 3shot acc: [head: 0.0738, middle: 0.0034, tail: 0.0200] 

round 8, global 3shot acc: [head: 0.8452, middle: 0.7257, tail: 0.4943] 

l_head tensor([2.1146, 1.5986, 1.0918, 0.6789, 1.2937, 0.6005, 1.5078, 0.6223, 1.6685,
        0.5974], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8069, 1.3383, 1.5424, 1.3662, 1.2350, 1.0154, 1.0434, 1.0093, 0.9905,
        1.0956], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.007462686567164179, middle:0.0, tail0
3shot of client 1:head:0.07894736842105263, middle:0.0, tail0.0
3shot of client 2:head:0.0, middle:0.0, tail0.0
3shot of client 3:head:0.009009009009009009, middle:0.037037037037037035, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.002717391304347826, middle:0.0, tail0.0
3shot of client 8:head:0.15644820295983086, middle:0.0, tail0.0
3shot of client 9:head:0.4691358024691358, middle:0.0, tail0.0
3shot of client 10:head:0.05141388174807198, middle:0.027522935779816515, tail0.0
3shot of client 11:head:0.023026315789473683, middle:0.0, tail0.0
3shot of client 12:head:0.14553014553014554, middle:0.0, tail0.058823529411764705
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.011111111111111112, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.08157099697885196, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.01652892561983471, middle:0.0, tail0.0
3shot of client 20:head:0.015151515151515152, middle:0.0, tail0.0
3shot of client 21:head:0.32432432432432434, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.10204081632653061, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.08866995073891626, middle:0, tail0.0
3shot of client 27:head:0.009433962264150943, middle:0.0, tail0.0
3shot of client 28:head:0.6818181818181818, middle:0.0, tail0.0
3shot of client 29:head:0.2754098360655738, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.012738853503184714, tail0.0
3shot of client 31:head:0.049868766404199474, middle:0.0, tail0.0
3shot of client 32:head:0.00554016620498615, middle:0.0, tail0.07142857142857142
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.011834319526627219, middle:0.0, tail0.0
3shot of client 35:head:0.046511627906976744, middle:0.0, tail0
3shot of client 36:head:0.11764705882352941, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.0196078431372549, middle:0.07692307692307693, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 9, local average test acc  0.0683 

round 9, local macro average F1 score  0.0233 

round 9, local weighted average F1 score  0.0732 

round 9, global test acc  0.6911 

round 9, average 3shot acc: [head: 0.0790, middle: 0.0040, tail: 0.0034] 

round 9, global 3shot acc: [head: 0.8517, middle: 0.7110, tail: 0.4570] 

l_head tensor([2.1268, 1.6762, 1.1239, 0.6802, 1.3470, 0.6026, 1.5584, 0.6245, 1.8572,
        0.5996], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8675, 1.3738, 1.6072, 1.4037, 1.2639, 1.0321, 1.0636, 1.0197, 1.0096,
        1.1152], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.014925373134328358, middle:0.0, tail0
3shot of client 1:head:0.07017543859649122, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.018518518518518517, tail0.0
3shot of client 4:head:0.005291005291005291, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.1522198731501057, middle:0.009345794392523364, tail0.058823529411764705
3shot of client 9:head:0.4691358024691358, middle:0.0, tail0.0
3shot of client 10:head:0.04884318766066838, middle:0.01834862385321101, tail0.0
3shot of client 11:head:0.023026315789473683, middle:0.0, tail0.0
3shot of client 12:head:0.15176715176715178, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
  2%|▏         | 11/500 [24:25<17:58:05, 132.28s/it]  2%|▏         | 12/500 [26:38<17:55:27, 132.23s/it]3shot of client 14:head:0.007936507936507936, middle:0.0, tail0.0
3shot of client 15:head:0.022222222222222223, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.0755287009063444, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.008264462809917356, middle:0.023809523809523808, tail0.0
3shot of client 20:head:0.015151515151515152, middle:0.0, tail0.0
3shot of client 21:head:0.3108108108108108, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.10204081632653061, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.08620689655172414, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.6636363636363637, middle:0.0, tail0.0
3shot of client 29:head:0.25245901639344265, middle:0.0, tail0.0
3shot of client 30:head:0.0018450184501845018, middle:0.012738853503184714, tail0.0
3shot of client 31:head:0.047244094488188976, middle:0.0, tail0.0
3shot of client 32:head:0.002770083102493075, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.04, tail0.0
3shot of client 35:head:0.046511627906976744, middle:0.0, tail0
3shot of client 36:head:0.11764705882352941, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.0196078431372549, middle:0.07692307692307693, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.5
round 10, local average test acc  0.0669 

round 10, local macro average F1 score  0.0208 

round 10, local weighted average F1 score  0.0600 

round 10, global test acc  0.7034 

round 10, average 3shot acc: [head: 0.0771, middle: 0.0051, tail: 0.0147] 

round 10, global 3shot acc: [head: 0.8490, middle: 0.7187, tail: 0.4940] 

l_head tensor([2.2369, 1.7149, 1.1414, 0.6815, 1.4118, 0.6043, 1.6234, 0.6262, 1.8792,
        0.6014], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.9500, 1.3895, 1.6586, 1.4343, 1.3045, 1.0433, 1.0805, 1.0441, 1.0333,
        1.1337], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.007462686567164179, middle:0.0, tail0
3shot of client 1:head:0.07017543859649122, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.037037037037037035, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.16279069767441862, middle:0.0, tail0.0
3shot of client 9:head:0.4567901234567901, middle:0.0, tail0.0
3shot of client 10:head:0.04884318766066838, middle:0.01834862385321101, tail0.0
3shot of client 11:head:0.03289473684210526, middle:0.0, tail0.0
3shot of client 12:head:0.14760914760914762, middle:0.015151515151515152, tail0.0
3shot of client 13:head:0.021052631578947368, middle:0.08333333333333333, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.044444444444444446, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.08157099697885196, middle:0.018867924528301886, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.008264462809917356, middle:0.023809523809523808, tail0.0
3shot of client 20:head:0.015151515151515152, middle:0.0, tail0.0
3shot of client 21:head:0.31756756756756754, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.10204081632653061, middle:0.0, tail0.0
3shot of client 24:head:0.03816793893129771, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.09359605911330049, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.6454545454545455, middle:0.0, tail0.0
3shot of client 29:head:0.2754098360655738, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.006369426751592357, tail0.0
3shot of client 31:head:0.049868766404199474, middle:0.0, tail0.0
3shot of client 32:head:0.00554016620498615, middle:0.0, tail0.0
3shot of client 33:head:0.003787878787878788, middle:0.0, tail0.0
3shot of client 34:head:0.023668639053254437, middle:0.0, tail0.0
3shot of client 35:head:0.046511627906976744, middle:0.0, tail0
3shot of client 36:head:0.1092436974789916, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.029411764705882353, middle:0.07692307692307693, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.5
round 11, local average test acc  0.0688 

round 11, local macro average F1 score  0.0253 

round 11, local weighted average F1 score  0.0691 

round 11, global test acc  0.7022 

round 11, average 3shot acc: [head: 0.0791, middle: 0.0072, tail: 0.0132] 

round 11, global 3shot acc: [head: 0.8512, middle: 0.7187, tail: 0.4870] 

l_head tensor([2.2653, 1.7155, 1.1229, 0.6833, 1.4146, 0.6066, 1.6899, 0.6286, 1.9340,
        0.6038], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.0162, 1.4146, 1.7182, 1.4625, 1.3103, 1.0750, 1.1057, 1.0511, 1.0338,
        1.1392], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.007462686567164179, middle:0.0, tail0
3shot of client 1:head:0.07017543859649122, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.018518518518518517, tail0.0
3shot of client 4:head:0.005291005291005291, middle:0.0, tail0.0
3shot of client 5:head:0.0392156862745098, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.15856236786469344, middle:0.0, tail0.0
3shot of client 9:head:0.46296296296296297, middle:0.0, tail0.0
3shot of client 10:head:0.05141388174807198, middle:0.0, tail0.0
3shot of client 11:head:0.019736842105263157, middle:0.0, tail0.0
3shot of client 12:head:0.14760914760914762, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.05555555555555555, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.034482758620689655, tail0.0
3shot of client 17:head:0.0755287009063444, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.012396694214876033, middle:0.07142857142857142, tail0.0
3shot of client 20:head:0.022727272727272728, middle:0.0, tail0.0
3shot of client 21:head:0.3108108108108108, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.11224489795918367, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.02857142857142857, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.09113300492610837, middle:0, tail0.0
3shot of client 27:head:0.009433962264150943, middle:0.0, tail0.0
3shot of client 28:head:0.6454545454545455, middle:0.0, tail0.0
3shot of client 29:head:0.26885245901639343, middle:0.0, tail0.0
3shot of client 30:head:0.0018450184501845018, middle:0.01910828025477707, tail0.0
3shot of client 31:head:0.05249343832020997, middle:0.0, tail0.0
3shot of client 32:head:0.008310249307479225, middle:0.0, tail0.0
3shot of client 33:head:0.007575757575757576, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.03488372093023256, middle:0.0, tail0
3shot of client 36:head:0.1092436974789916, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.0196078431372549, middle:0.07692307692307693, tail0.0
3shot of client 39:head:0.0070921985815602835, middle:0.0, tail0.5
round 12, local average test acc  0.0691 

round 12, local macro average F1 score  0.0223 

round 12, local weighted average F1 score  0.0687 

  3%|▎         | 13/500 [28:51<17:55:05, 132.45s/it]  3%|▎         | 14/500 [31:02<17:51:01, 132.22s/it]  3%|▎         | 15/500 [33:17<17:54:13, 132.89s/it]round 12, global test acc  0.6965 

round 12, average 3shot acc: [head: 0.0794, middle: 0.0064, tail: 0.0132] 

round 12, global 3shot acc: [head: 0.8487, middle: 0.7160, tail: 0.4740] 

l_head tensor([2.3193, 1.7421, 1.1554, 0.6850, 1.3961, 0.6086, 1.7159, 0.6307, 1.9708,
        0.6059], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.0788, 1.4409, 1.7525, 1.5014, 1.3438, 1.1007, 1.1249, 1.0718, 1.0463,
        1.1545], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.007462686567164179, middle:0.0, tail0
3shot of client 1:head:0.08771929824561403, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.037037037037037035, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.1484375, middle:0.0, tail0.0
3shot of client 7:head:0.002717391304347826, middle:0.0, tail0.0
3shot of client 8:head:0.16279069767441862, middle:0.009345794392523364, tail0.0
3shot of client 9:head:0.4382716049382716, middle:0.0, tail0.0
3shot of client 10:head:0.043701799485861184, middle:0.009174311926605505, tail0.0
3shot of client 11:head:0.023026315789473683, middle:0.0, tail0.0
3shot of client 12:head:0.15384615384615385, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.05555555555555555, middle:0.0625, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.08761329305135952, middle:0.018867924528301886, tail0.0
3shot of client 18:head:0.003424657534246575, middle:0.0, tail0.0
3shot of client 19:head:0.008264462809917356, middle:0.0, tail0.0
3shot of client 20:head:0.022727272727272728, middle:0.0, tail0.0
3shot of client 21:head:0.3108108108108108, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.10204081632653061, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.09359605911330049, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.6090909090909091, middle:0.0, tail0.0
3shot of client 29:head:0.2786885245901639, middle:0.0, tail0.1111111111111111
3shot of client 30:head:0.0036900369003690036, middle:0.0, tail0.1111111111111111
3shot of client 31:head:0.06036745406824147, middle:0.0, tail0.0
3shot of client 32:head:0.008310249307479225, middle:0.0, tail0.07142857142857142
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.01775147928994083, middle:0.0, tail0.0
3shot of client 35:head:0.05813953488372093, middle:0.0, tail0
3shot of client 36:head:0.09243697478991597, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.05555555555555555, tail0.0
3shot of client 38:head:0.0196078431372549, middle:0.07692307692307693, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 13, local average test acc  0.0681 

round 13, local macro average F1 score  0.0295 

round 13, local weighted average F1 score  0.0786 

round 13, global test acc  0.7059 

round 13, average 3shot acc: [head: 0.0782, middle: 0.0069, tail: 0.0077] 

round 13, global 3shot acc: [head: 0.8510, middle: 0.7033, tail: 0.5150] 

l_head tensor([2.3725, 1.7747, 1.1844, 0.6865, 1.4678, 0.6105, 1.7346, 0.6326, 2.0622,
        0.6078], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.1653, 1.4788, 1.8191, 1.5504, 1.3629, 1.1216, 1.1346, 1.0855, 1.0508,
        1.1719], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.007462686567164179, middle:0.0, tail0
3shot of client 1:head:0.07894736842105263, middle:0.0, tail0.0
3shot of client 2:head:0.0, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.002717391304347826, middle:0.0, tail0.0
3shot of client 8:head:0.1522198731501057, middle:0.0, tail0.0
3shot of client 9:head:0.4444444444444444, middle:0.0, tail0.0
3shot of client 10:head:0.04113110539845758, middle:0.03669724770642202, tail0.0
3shot of client 11:head:0.013157894736842105, middle:0.0, tail0.0
3shot of client 12:head:0.14137214137214138, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.044444444444444446, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.06948640483383686, middle:0.03773584905660377, tail0.09090909090909091
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.004132231404958678, middle:0.0, tail0.0
3shot of client 20:head:0.022727272727272728, middle:0.0, tail0.0
3shot of client 21:head:0.32432432432432434, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.10204081632653061, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.0812807881773399, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.6, middle:0.0, tail0.0
3shot of client 29:head:0.25901639344262295, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.025477707006369428, tail0.0
3shot of client 31:head:0.04199475065616798, middle:0.0, tail0.0
3shot of client 32:head:0.002770083102493075, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.037037037037037035, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.09302325581395349, middle:0.0, tail0
3shot of client 36:head:0.09243697478991597, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.05555555555555555, tail0.0
3shot of client 38:head:0.00980392156862745, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 14, local average test acc  0.0652 

round 14, local macro average F1 score  0.0212 

round 14, local weighted average F1 score  0.0633 

round 14, global test acc  0.7048 

round 14, average 3shot acc: [head: 0.0751, middle: 0.0049, tail: 0.0024] 

round 14, global 3shot acc: [head: 0.8555, middle: 0.6887, tail: 0.5200] 

l_head tensor([2.4547, 1.8009, 1.2009, 0.6880, 1.4790, 0.6126, 1.7777, 0.6347, 2.1228,
        0.6100], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.2443, 1.5021, 1.8891, 1.5991, 1.4159, 1.1361, 1.1516, 1.0909, 1.0534,
        1.1823], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.007462686567164179, middle:0.0, tail0
3shot of client 1:head:0.07017543859649122, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.15856236786469344, middle:0.009345794392523364, tail0.0
3shot of client 9:head:0.43209876543209874, middle:0.0, tail0.0
3shot of client 10:head:0.05398457583547558, middle:0.009174311926605505, tail0.0
3shot of client 11:head:0.013157894736842105, middle:0.0, tail0.0
3shot of client 12:head:0.14553014553014554, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.08333333333333333, tail0.0
3shot of client 14:head:0.007936507936507936, middle:0.0, tail0.0
3shot of client 15:head:0.044444444444444446, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.07854984894259819, middle:0.03773584905660377, tail0.09090909090909091
3shot of client 18:head:0.003424657534246575, middle:0.0, tail0.0
3shot of client 19:head:0.01652892561983471, middle:0.0, tail0.0
  3%|▎         | 16/500 [35:28<17:48:30, 132.46s/it]  3%|▎         | 17/500 [37:36<17:35:06, 131.07s/it]3shot of client 20:head:0.030303030303030304, middle:0.0, tail0.0
3shot of client 21:head:0.3108108108108108, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.09183673469387756, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.09113300492610837, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.5727272727272728, middle:0.0, tail0.0
3shot of client 29:head:0.2819672131147541, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.01910828025477707, tail0.0
3shot of client 31:head:0.047244094488188976, middle:0.021739130434782608, tail0.0
3shot of client 32:head:0.008310249307479225, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.005917159763313609, middle:0.0, tail0.0
3shot of client 35:head:0.023255813953488372, middle:0.0, tail0
3shot of client 36:head:0.1092436974789916, middle:0.0, tail0.0
3shot of client 37:head:0.016129032258064516, middle:0.0, tail0.0
3shot of client 38:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 39:head:0.0070921985815602835, middle:0.0, tail0.0
round 15, local average test acc  0.0652 

round 15, local macro average F1 score  0.0184 

round 15, local weighted average F1 score  0.0723 

round 15, global test acc  0.7016 

round 15, average 3shot acc: [head: 0.0754, middle: 0.0046, tail: 0.0024] 

round 15, global 3shot acc: [head: 0.8560, middle: 0.7030, tail: 0.4943] 

l_head tensor([2.5071, 1.7892, 1.2431, 0.6901, 1.5237, 0.6151, 1.7999, 0.6372, 2.2025,
        0.6125], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.2974, 1.5302, 1.9221, 1.6409, 1.4510, 1.1562, 1.1682, 1.1109, 1.0617,
        1.1945], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.007462686567164179, middle:0.0, tail0
3shot of client 1:head:0.08771929824561403, middle:0.0, tail0.14285714285714285
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.1484375, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.1733615221987315, middle:0.009345794392523364, tail0.0
3shot of client 9:head:0.42592592592592593, middle:0.0, tail0.0
3shot of client 10:head:0.06683804627249357, middle:0.0, tail0.0
3shot of client 11:head:0.023026315789473683, middle:0.0, tail0.0
3shot of client 12:head:0.16424116424116425, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.044444444444444446, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.06896551724137931, tail0.0
3shot of client 17:head:0.08761329305135952, middle:0.0, tail0.09090909090909091
3shot of client 18:head:0.003424657534246575, middle:0.0, tail0.0
3shot of client 19:head:0.012396694214876033, middle:0.0, tail0.0
3shot of client 20:head:0.030303030303030304, middle:0.0, tail0.0
3shot of client 21:head:0.3108108108108108, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.12244897959183673, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.10098522167487685, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.5818181818181818, middle:0.0, tail0.0
3shot of client 29:head:0.28524590163934427, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.025477707006369428, tail0.0
3shot of client 31:head:0.06299212598425197, middle:0.021739130434782608, tail0.0
3shot of client 32:head:0.0110803324099723, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.037037037037037035, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.046511627906976744, middle:0.0, tail0
3shot of client 36:head:0.15126050420168066, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.00980392156862745, middle:0.15384615384615385, tail0.0
3shot of client 39:head:0.0070921985815602835, middle:0.0, tail0.0
round 16, local average test acc  0.0695 

round 16, local macro average F1 score  0.0217 

round 16, local weighted average F1 score  0.0574 

round 16, global test acc  0.7076 

round 16, average 3shot acc: [head: 0.0798, middle: 0.0081, tail: 0.0062] 

round 16, global 3shot acc: [head: 0.8587, middle: 0.7147, tail: 0.4990] 

l_head tensor([2.5557, 1.8320, 1.3279, 0.6914, 1.5560, 0.6167, 1.8510, 0.6388, 2.2869,
        0.6142], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.3621, 1.5453, 1.9690, 1.6891, 1.4672, 1.1712, 1.1892, 1.1184, 1.0621,
        1.1905], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.007462686567164179, middle:0.0, tail0
3shot of client 1:head:0.07894736842105263, middle:0.0, tail0.0
3shot of client 2:head:0.0, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.1733615221987315, middle:0.0, tail0.0
3shot of client 9:head:0.43209876543209874, middle:0.0, tail0.0
3shot of client 10:head:0.06426735218508997, middle:0.009174311926605505, tail0.058823529411764705
3shot of client 11:head:0.03289473684210526, middle:0.0, tail0.0
3shot of client 12:head:0.15384615384615385, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.007936507936507936, middle:0.0, tail0.0
3shot of client 15:head:0.044444444444444446, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.07854984894259819, middle:0.018867924528301886, tail0.0
3shot of client 18:head:0.010273972602739725, middle:0.0, tail0.0
3shot of client 19:head:0.01652892561983471, middle:0.0, tail0.0
3shot of client 20:head:0.022727272727272728, middle:0.0, tail0.0
3shot of client 21:head:0.31756756756756754, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.11224489795918367, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.10591133004926108, middle:0, tail0.0
3shot of client 27:head:0.009433962264150943, middle:0.0, tail0.0
3shot of client 28:head:0.5818181818181818, middle:0.0, tail0.0
3shot of client 29:head:0.2819672131147541, middle:0.02040816326530612, tail0.0
3shot of client 30:head:0.0, middle:0.0, tail0.1111111111111111
3shot of client 31:head:0.06036745406824147, middle:0.0, tail0.0
3shot of client 32:head:0.002770083102493075, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.005917159763313609, middle:0.0, tail0.0
3shot of client 35:head:0.046511627906976744, middle:0.0, tail0
3shot of client 36:head:0.1092436974789916, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.0196078431372549, middle:0.07692307692307693, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 17, local average test acc  0.0679 

round 17, local macro average F1 score  0.0169 

round 17, local weighted average F1 score  0.0573 

round 17, global test acc  0.7025 

round 17, average 3shot acc: [head: 0.0788, middle: 0.0032, tail: 0.0045] 

round 17, global 3shot acc: [head: 0.8557, middle: 0.7050, tail: 0.4957] 

l_head tensor([2.6436, 1.8767, 1.3046, 0.6921, 1.5947, 0.6175, 1.9014, 0.6397, 2.4316,
        0.6150], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux   4%|▎         | 18/500 [39:52<17:44:28, 132.51s/it]  4%|▍         | 19/500 [42:12<18:00:14, 134.75s/it]  4%|▍         | 20/500 [44:28<18:01:02, 135.13s/it]tensor([2.4526, 1.5987, 2.0201, 1.7232, 1.5042, 1.1903, 1.2091, 1.1385, 1.0715,
        1.2166], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.007462686567164179, middle:0.0, tail0
3shot of client 1:head:0.10526315789473684, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.19027484143763213, middle:0.0, tail0.058823529411764705
3shot of client 9:head:0.41975308641975306, middle:0.0, tail0.0
3shot of client 10:head:0.07455012853470437, middle:0.01834862385321101, tail0.0
3shot of client 11:head:0.03289473684210526, middle:0.0, tail0.0
3shot of client 12:head:0.16632016632016633, middle:0.0, tail0.0
3shot of client 13:head:0.021052631578947368, middle:0.0, tail0.0
3shot of client 14:head:0.007936507936507936, middle:0.0, tail0.0
3shot of client 15:head:0.044444444444444446, middle:0.0, tail0.0
3shot of client 16:head:0.00819672131147541, middle:0.0, tail0.0
3shot of client 17:head:0.09063444108761329, middle:0.03773584905660377, tail0.0
3shot of client 18:head:0.003424657534246575, middle:0.0, tail0.0
3shot of client 19:head:0.01652892561983471, middle:0.047619047619047616, tail0.0
3shot of client 20:head:0.03787878787878788, middle:0.0, tail0.0
3shot of client 21:head:0.3108108108108108, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.1326530612244898, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.10344827586206896, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.5909090909090909, middle:0.0, tail0.0
3shot of client 29:head:0.30491803278688523, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.06299212598425197, middle:0.021739130434782608, tail0.0
3shot of client 32:head:0.013850415512465374, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.05813953488372093, middle:0.0, tail0
3shot of client 36:head:0.11764705882352941, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 18, local average test acc  0.0709 

round 18, local macro average F1 score  0.0212 

round 18, local weighted average F1 score  0.0675 

round 18, global test acc  0.7136 

round 18, average 3shot acc: [head: 0.0825, middle: 0.0032, tail: 0.0015] 

round 18, global 3shot acc: [head: 0.8500, middle: 0.7187, tail: 0.5267] 

l_head tensor([2.6980, 1.9483, 1.2883, 0.6937, 1.5966, 0.6192, 1.9606, 0.6415, 2.4418,
        0.6168], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.5133, 1.6193, 2.0880, 1.7575, 1.5432, 1.2151, 1.2201, 1.1542, 1.0902,
        1.2246], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.014925373134328358, middle:0.0, tail0
3shot of client 1:head:0.11403508771929824, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.037037037037037035, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.1484375, middle:0.0, tail0.0
3shot of client 7:head:0.005434782608695652, middle:0.0, tail0.0
3shot of client 8:head:0.19873150105708245, middle:0.0, tail0.0
3shot of client 9:head:0.43209876543209874, middle:0.0, tail0.0
3shot of client 10:head:0.08740359897172237, middle:0.009174311926605505, tail0.0
3shot of client 11:head:0.04276315789473684, middle:0.0, tail0.0
3shot of client 12:head:0.18295218295218296, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.044444444444444446, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.09969788519637462, middle:0.07547169811320754, tail0.0
3shot of client 18:head:0.003424657534246575, middle:0.0, tail0.0
3shot of client 19:head:0.02066115702479339, middle:0.0, tail0.0
3shot of client 20:head:0.06060606060606061, middle:0.06666666666666667, tail0.0
3shot of client 21:head:0.32432432432432434, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.12244897959183673, middle:0.0, tail0.0
3shot of client 24:head:0.03816793893129771, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.12315270935960591, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.5909090909090909, middle:0.0, tail0.0
3shot of client 29:head:0.3114754098360656, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.012738853503184714, tail0.1111111111111111
3shot of client 31:head:0.06299212598425197, middle:0.021739130434782608, tail0.0
3shot of client 32:head:0.0221606648199446, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.037037037037037035, tail0.0
3shot of client 34:head:0.005917159763313609, middle:0.0, tail0.0
3shot of client 35:head:0.011627906976744186, middle:0.0, tail0
3shot of client 36:head:0.15966386554621848, middle:0.0, tail0.0
3shot of client 37:head:0.03225806451612903, middle:0.0, tail0.0
3shot of client 38:head:0.029411764705882353, middle:0.15384615384615385, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.5
round 19, local average test acc  0.0758 

round 19, local macro average F1 score  0.0313 

round 19, local weighted average F1 score  0.0858 

round 19, global test acc  0.7151 

round 19, average 3shot acc: [head: 0.0872, middle: 0.0106, tail: 0.0161] 

round 19, global 3shot acc: [head: 0.8565, middle: 0.7057, tail: 0.5360] 

l_head tensor([2.8317, 2.0250, 1.2522, 0.6951, 1.5682, 0.6205, 2.0023, 0.6431, 2.6240,
        0.6184], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.5577, 1.6574, 2.1272, 1.7912, 1.5604, 1.2226, 1.2357, 1.1675, 1.1027,
        1.2396], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.014925373134328358, middle:0.0, tail0
3shot of client 1:head:0.07894736842105263, middle:0.0, tail0.14285714285714285
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.018518518518518517, tail0.0
3shot of client 4:head:0.005291005291005291, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.19661733615221988, middle:0.009345794392523364, tail0.0
3shot of client 9:head:0.42592592592592593, middle:0.0, tail0.0
3shot of client 10:head:0.07712082262210797, middle:0.009174311926605505, tail0.0
3shot of client 11:head:0.03618421052631579, middle:0.0, tail0.0
3shot of client 12:head:0.18087318087318088, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.007936507936507936, middle:0.0, tail0.0
3shot of client 15:head:0.05555555555555555, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.1027190332326284, middle:0.03773584905660377, tail0.0
3shot of client 18:head:0.003424657534246575, middle:0.0, tail0.0
3shot of client 19:head:0.008264462809917356, middle:0.023809523809523808, tail0.0
3shot of client 20:head:0.05303030303030303, middle:0.0, tail0.0
3shot of client 21:head:0.30405405405405406, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 24:head:0.03816793893129771, middle:0.0, tail0.0  4%|▍         | 21/500 [46:41<17:53:36, 134.48s/it]  4%|▍         | 22/500 [48:54<17:48:18, 134.10s/it]  5%|▍         | 23/500 [51:08<17:46:39, 134.17s/it]
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.12561576354679804, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.6, middle:0.0, tail0.0
3shot of client 29:head:0.3016393442622951, middle:0.0, tail0.0
3shot of client 30:head:0.0018450184501845018, middle:0.012738853503184714, tail0.0
3shot of client 31:head:0.08136482939632546, middle:0.0, tail0.0
3shot of client 32:head:0.019390581717451522, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.005917159763313609, middle:0.0, tail0.0
3shot of client 35:head:0.05813953488372093, middle:0.0, tail0
3shot of client 36:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.029411764705882353, middle:0.07692307692307693, tail0.0
3shot of client 39:head:0.0070921985815602835, middle:0.0, tail0.0
round 20, local average test acc  0.0743 

round 20, local macro average F1 score  0.0195 

round 20, local weighted average F1 score  0.0565 

round 20, global test acc  0.7155 

round 20, average 3shot acc: [head: 0.0860, middle: 0.0048, tail: 0.0038] 

round 20, global 3shot acc: [head: 0.8542, middle: 0.7143, tail: 0.5317] 

l_head tensor([2.8592, 1.9777, 1.2920, 0.6956, 1.6357, 0.6210, 2.0453, 0.6437, 2.6213,
        0.6190], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.6293, 1.6824, 2.1830, 1.8272, 1.5839, 1.2489, 1.2565, 1.1823, 1.0995,
        1.2391], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.014925373134328358, middle:0.0, tail0
3shot of client 1:head:0.06140350877192982, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.037037037037037035, tail0.0
3shot of client 4:head:0.005291005291005291, middle:0.0, tail0.0
3shot of client 5:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.1945031712473573, middle:0.0, tail0.0
3shot of client 9:head:0.41975308641975306, middle:0.0, tail0.0
3shot of client 10:head:0.06940874035989718, middle:0.009174311926605505, tail0.0
3shot of client 11:head:0.029605263157894735, middle:0.0, tail0.0
3shot of client 12:head:0.16632016632016633, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.007936507936507936, middle:0.0, tail0.0
3shot of client 15:head:0.044444444444444446, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.034482758620689655, tail0.0
3shot of client 17:head:0.09063444108761329, middle:0.03773584905660377, tail0.0
3shot of client 18:head:0.010273972602739725, middle:0.0, tail0.0
3shot of client 19:head:0.012396694214876033, middle:0.0, tail0.0
3shot of client 20:head:0.05303030303030303, middle:0.0, tail0.0
3shot of client 21:head:0.2972972972972973, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.1326530612244898, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.058823529411764705, middle:0.0, tail0.0
3shot of client 26:head:0.10098522167487685, middle:0, tail0.0
3shot of client 27:head:0.009433962264150943, middle:0.0, tail0.0
3shot of client 28:head:0.5818181818181818, middle:0.0, tail0.0
3shot of client 29:head:0.3114754098360656, middle:0.0, tail0.0
3shot of client 30:head:0.0018450184501845018, middle:0.01910828025477707, tail0.0
3shot of client 31:head:0.06561679790026247, middle:0.0, tail0.0
3shot of client 32:head:0.013850415512465374, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.06976744186046512, middle:0.0, tail0
3shot of client 36:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 37:head:0.016129032258064516, middle:0.05555555555555555, tail0.0
3shot of client 38:head:0.0196078431372549, middle:0.07692307692307693, tail0.0
3shot of client 39:head:0.0070921985815602835, middle:0.0, tail0.0
round 21, local average test acc  0.0735 

round 21, local macro average F1 score  0.0230 

round 21, local weighted average F1 score  0.0736 

round 21, global test acc  0.7077 

round 21, average 3shot acc: [head: 0.0849, middle: 0.0069, tail: 0.0000] 

round 21, global 3shot acc: [head: 0.8572, middle: 0.6990, tail: 0.5170] 

l_head tensor([2.8970, 1.9883, 1.3059, 0.6963, 1.5769, 0.6217, 2.0935, 0.6445, 2.6702,
        0.6198], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.7002, 1.7108, 2.2367, 1.8648, 1.5985, 1.2632, 1.2692, 1.1860, 1.1012,
        1.2557], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.022388059701492536, middle:0.0, tail0
3shot of client 1:head:0.08771929824561403, middle:0.0, tail0.14285714285714285
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.009009009009009009, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.041666666666666664, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.19661733615221988, middle:0.009345794392523364, tail0.0
3shot of client 9:head:0.41358024691358025, middle:0.0, tail0.0
3shot of client 10:head:0.08483290488431877, middle:0.0, tail0.0
3shot of client 11:head:0.03289473684210526, middle:0.0, tail0.0
3shot of client 12:head:0.18295218295218296, middle:0.0, tail0.0
3shot of client 13:head:0.021052631578947368, middle:0.0, tail0.0
3shot of client 14:head:0.007936507936507936, middle:0.0, tail0.0
3shot of client 15:head:0.06666666666666667, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.10876132930513595, middle:0.018867924528301886, tail0.0
3shot of client 18:head:0.0, middle:0.0, tail0.0
3shot of client 19:head:0.01652892561983471, middle:0.023809523809523808, tail0.0
3shot of client 20:head:0.06060606060606061, middle:0.0, tail0.0
3shot of client 21:head:0.2972972972972973, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.1326530612244898, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.12561576354679804, middle:0, tail0.0
3shot of client 27:head:0.009433962264150943, middle:0.0, tail0.0
3shot of client 28:head:0.5818181818181818, middle:0.0, tail0.0
3shot of client 29:head:0.3180327868852459, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.006369426751592357, tail0.0
3shot of client 31:head:0.08136482939632546, middle:0.0, tail0.0
3shot of client 32:head:0.01662049861495845, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.011834319526627219, middle:0.0, tail0.0
3shot of client 35:head:0.023255813953488372, middle:0.0, tail0
3shot of client 36:head:0.16806722689075632, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.029411764705882353, middle:0.15384615384615385, tail0.0
3shot of client 39:head:0.0070921985815602835, middle:0.0, tail0.0
round 22, local average test acc  0.0753 

round 22, local macro average F1 score  0.0270 

round 22, local weighted average F1 score  0.0866 

round 22, global test acc  0.7209 

round 22, average 3shot acc: [head: 0.0871, middle: 0.0065, tail: 0.0038] 

round 22, global 3shot acc: [head: 0.8550, middle: 0.7063, tail: 0.5567] 

l_head tensor([2.9810, 2.0084, 1.2771, 0.6970, 1.6230, 0.6225, 2.1345, 0.6453, 2.7719,
        0.6206], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.7426, 1.7294, 2.2766, 1.8860, 1.6304, 1.2881, 1.2888, 1.1991, 1.1062,
        1.2633], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.014925373134328358, middle:0.0, tail0
  5%|▍         | 24/500 [53:21<17:40:13, 133.64s/it]  5%|▌         | 25/500 [55:33<17:35:03, 133.27s/it]3shot of client 1:head:0.07894736842105263, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.018518518518518517, tail0.0
3shot of client 4:head:0.005291005291005291, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.1484375, middle:0.0, tail0.0
3shot of client 7:head:0.002717391304347826, middle:0.0, tail0.0
3shot of client 8:head:0.19873150105708245, middle:0.0, tail0.0
3shot of client 9:head:0.41358024691358025, middle:0.0, tail0.0
3shot of client 10:head:0.06683804627249357, middle:0.009174311926605505, tail0.0
3shot of client 11:head:0.023026315789473683, middle:0.0, tail0.0
3shot of client 12:head:0.16424116424116425, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.05555555555555555, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.09365558912386707, middle:0.0, tail0.0
3shot of client 18:head:0.003424657534246575, middle:0.0, tail0.0
3shot of client 19:head:0.01652892561983471, middle:0.023809523809523808, tail0.0
3shot of client 20:head:0.06060606060606061, middle:0.06666666666666667, tail0.0
3shot of client 21:head:0.30405405405405406, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.1326530612244898, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.11083743842364532, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.5727272727272728, middle:0.0, tail0.0
3shot of client 29:head:0.3114754098360656, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.006369426751592357, tail0.0
3shot of client 31:head:0.07349081364829396, middle:0.021739130434782608, tail0.0
3shot of client 32:head:0.019390581717451522, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.023255813953488372, middle:0.0, tail0
3shot of client 36:head:0.12605042016806722, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.05555555555555555, tail0.0
3shot of client 38:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 39:head:0.0070921985815602835, middle:0.0, tail0.0
round 23, local average test acc  0.0708 

round 23, local macro average F1 score  0.0243 

round 23, local weighted average F1 score  0.0796 

round 23, global test acc  0.7157 

round 23, average 3shot acc: [head: 0.0818, middle: 0.0052, tail: 0.0000] 

round 23, global 3shot acc: [head: 0.8605, middle: 0.6980, tail: 0.5403] 

l_head tensor([3.0030, 2.0149, 1.3255, 0.6978, 1.6421, 0.6234, 2.1612, 0.6464, 2.7853,
        0.6216], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.7962, 1.7510, 2.3128, 1.9232, 1.6426, 1.2912, 1.2975, 1.2164, 1.1088,
        1.2633], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.014925373134328358, middle:0.0, tail0
3shot of client 1:head:0.10526315789473684, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.018518518518518517, tail0.0
3shot of client 4:head:0.005291005291005291, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.1484375, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.19873150105708245, middle:0.0, tail0.0
3shot of client 9:head:0.4074074074074074, middle:0.0, tail0.0
3shot of client 10:head:0.07969151670951156, middle:0.0, tail0.0
3shot of client 11:head:0.03289473684210526, middle:0.0, tail0.0
3shot of client 12:head:0.1704781704781705, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.05555555555555555, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.1027190332326284, middle:0.03773584905660377, tail0.0
3shot of client 18:head:0.00684931506849315, middle:0.0, tail0.0
3shot of client 19:head:0.01652892561983471, middle:0.023809523809523808, tail0.0
3shot of client 20:head:0.05303030303030303, middle:0.0, tail0.0
3shot of client 21:head:0.2905405405405405, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.1326530612244898, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.058823529411764705, middle:0.0, tail0.0
3shot of client 26:head:0.11822660098522167, middle:0, tail0.0
3shot of client 27:head:0.018867924528301886, middle:0.0, tail0.0
3shot of client 28:head:0.5727272727272728, middle:0.0, tail0.0
3shot of client 29:head:0.33114754098360655, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.006369426751592357, tail0.0
3shot of client 31:head:0.05774278215223097, middle:0.0, tail0.0
3shot of client 32:head:0.0221606648199446, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.005917159763313609, middle:0.0, tail0.0
3shot of client 35:head:0.03488372093023256, middle:0.0, tail0
3shot of client 36:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.0, tail0.0
3shot of client 38:head:0.0196078431372549, middle:0.07692307692307693, tail0.2
3shot of client 39:head:0.0070921985815602835, middle:0.0, tail0.0
round 24, local average test acc  0.0740 

round 24, local macro average F1 score  0.0255 

round 24, local weighted average F1 score  0.0874 

round 24, global test acc  0.7120 

round 24, average 3shot acc: [head: 0.0859, middle: 0.0042, tail: 0.0053] 

round 24, global 3shot acc: [head: 0.8507, middle: 0.7093, tail: 0.5297] 

l_head tensor([3.0336, 2.0287, 1.2952, 0.6996, 1.6428, 0.6250, 2.1944, 0.6483, 2.8263,
        0.6233], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.8507, 1.7812, 2.3527, 1.9401, 1.6618, 1.2998, 1.3185, 1.2260, 1.1145,
        1.2696], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.007462686567164179, middle:0.0, tail0
3shot of client 1:head:0.07894736842105263, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.018518518518518517, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.002717391304347826, middle:0.0, tail0.0
3shot of client 8:head:0.20507399577167018, middle:0.0, tail0.0
3shot of client 9:head:0.41358024691358025, middle:0.0, tail0.0
3shot of client 10:head:0.06940874035989718, middle:0.009174311926605505, tail0.0
3shot of client 11:head:0.02631578947368421, middle:0.0, tail0.0
3shot of client 12:head:0.16424116424116425, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.06666666666666667, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.09969788519637462, middle:0.018867924528301886, tail0.0
3shot of client 18:head:0.00684931506849315, middle:0.0, tail0.0
3shot of client 19:head:0.01652892561983471, middle:0.0, tail0.0
3shot of client 20:head:0.03787878787878788, middle:0.0, tail0.0
3shot of client 21:head:0.28378378378378377, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.10591133004926108, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.5545454545454546, middle:0.0, tail0.0
  5%|▌         | 26/500 [57:46<17:32:21, 133.21s/it]  5%|▌         | 27/500 [1:00:05<17:43:58, 134.96s/it]  6%|▌         | 28/500 [1:02:20<17:40:10, 134.77s/it]3shot of client 29:head:0.32786885245901637, middle:0.04081632653061224, tail0.1111111111111111
3shot of client 30:head:0.0, middle:0.006369426751592357, tail0.0
3shot of client 31:head:0.06824146981627296, middle:0.0, tail0.0
3shot of client 32:head:0.019390581717451522, middle:0.0, tail0.0
3shot of client 33:head:0.007575757575757576, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.03488372093023256, middle:0.0, tail0
3shot of client 36:head:0.13445378151260504, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.05555555555555555, tail0.0
3shot of client 38:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 39:head:0.0070921985815602835, middle:0.0, tail0.0
round 25, local average test acc  0.0705 

round 25, local macro average F1 score  0.0213 

round 25, local weighted average F1 score  0.0664 

round 25, global test acc  0.7135 

round 25, average 3shot acc: [head: 0.0817, middle: 0.0038, tail: 0.0029] 

round 25, global 3shot acc: [head: 0.8435, middle: 0.7170, tail: 0.5367] 

l_head tensor([3.1196, 2.0443, 1.3104, 0.7007, 1.6188, 0.6263, 2.1820, 0.6496, 2.8784,
        0.6247], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.9119, 1.8103, 2.3880, 1.9615, 1.6925, 1.3232, 1.3233, 1.2395, 1.1122,
        1.2715], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.014925373134328358, middle:0.0, tail0
3shot of client 1:head:0.08771929824561403, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.0045045045045045045, middle:0.018518518518518517, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.002717391304347826, middle:0.0, tail0.0
3shot of client 8:head:0.21141649048625794, middle:0.0, tail0.0
3shot of client 9:head:0.38271604938271603, middle:0.0, tail0.0
3shot of client 10:head:0.07455012853470437, middle:0.01834862385321101, tail0.0
3shot of client 11:head:0.02631578947368421, middle:0.0, tail0.0
3shot of client 12:head:0.16424116424116425, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.05555555555555555, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.09365558912386707, middle:0.03773584905660377, tail0.0
3shot of client 18:head:0.010273972602739725, middle:0.0, tail0.0
3shot of client 19:head:0.01652892561983471, middle:0.023809523809523808, tail0.0
3shot of client 20:head:0.05303030303030303, middle:0.0, tail0.0
3shot of client 21:head:0.28378378378378377, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.1326530612244898, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.10591133004926108, middle:0, tail0.0
3shot of client 27:head:0.0, middle:0.0, tail0.0
3shot of client 28:head:0.5272727272727272, middle:0.0, tail0.0
3shot of client 29:head:0.32786885245901637, middle:0.0, tail0.0
3shot of client 30:head:0.0018450184501845018, middle:0.012738853503184714, tail0.0
3shot of client 31:head:0.07086614173228346, middle:0.0, tail0.0
3shot of client 32:head:0.0221606648199446, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.04, tail0.0
3shot of client 35:head:0.023255813953488372, middle:0.0, tail0
3shot of client 36:head:0.15966386554621848, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.05555555555555555, tail0.0
3shot of client 38:head:0.029411764705882353, middle:0.07692307692307693, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 26, local average test acc  0.0703 

round 26, local macro average F1 score  0.0210 

round 26, local weighted average F1 score  0.0662 

round 26, global test acc  0.7131 

round 26, average 3shot acc: [head: 0.0811, middle: 0.0073, tail: 0.0000] 

round 26, global 3shot acc: [head: 0.8500, middle: 0.7193, tail: 0.5243] 

l_head tensor([3.1230, 2.0814, 1.3068, 0.7021, 1.6171, 0.6278, 2.2369, 0.6513, 2.9241,
        0.6261], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.9612, 1.8268, 2.4431, 1.9837, 1.6984, 1.3381, 1.3395, 1.2462, 1.1198,
        1.2748], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.007462686567164179, middle:0.0, tail0
3shot of client 1:head:0.09649122807017543, middle:0.0, tail0.0
3shot of client 2:head:0.0, middle:0.0, tail0.0
3shot of client 3:head:0.009009009009009009, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.22832980972515857, middle:0.009345794392523364, tail0.0
3shot of client 9:head:0.37037037037037035, middle:0.0, tail0.0
3shot of client 10:head:0.07197943444730077, middle:0.01834862385321101, tail0.0
3shot of client 11:head:0.023026315789473683, middle:0.0, tail0.0
3shot of client 12:head:0.19334719334719336, middle:0.0, tail0.0
3shot of client 13:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.06666666666666667, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.1027190332326284, middle:0.0, tail0.0
3shot of client 18:head:0.0136986301369863, middle:0.0, tail0.0
3shot of client 19:head:0.01652892561983471, middle:0.0, tail0.0
3shot of client 20:head:0.06060606060606061, middle:0.0, tail0.0
3shot of client 21:head:0.27702702702702703, middle:0.0, tail0.0
3shot of client 22:head:0.16822429906542055, middle:0.0, tail0.0
3shot of client 23:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 24:head:0.030534351145038167, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0, tail0.0
3shot of client 26:head:0.12561576354679804, middle:0, tail0.0
3shot of client 27:head:0.009433962264150943, middle:0.0, tail0.0
3shot of client 28:head:0.5363636363636364, middle:0.0, tail0.0
3shot of client 29:head:0.3344262295081967, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.006369426751592357, tail0.1111111111111111
3shot of client 31:head:0.07611548556430446, middle:0.0, tail0.0
3shot of client 32:head:0.019390581717451522, middle:0.0, tail0.0
3shot of client 33:head:0.0, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.05813953488372093, middle:0.0, tail0
3shot of client 36:head:0.13445378151260504, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.05555555555555555, tail0.0
3shot of client 38:head:0.029411764705882353, middle:0.07692307692307693, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 27, local average test acc  0.0726 

round 27, local macro average F1 score  0.0177 

round 27, local weighted average F1 score  0.0652 

round 27, global test acc  0.7214 

round 27, average 3shot acc: [head: 0.0843, middle: 0.0043, tail: 0.0029] 

round 27, global 3shot acc: [head: 0.8507, middle: 0.7223, tail: 0.5480] 

l_head tensor([3.1984, 2.1429, 1.3053, 0.7029, 1.6212, 0.6286, 2.2743, 0.6522, 2.9688,
        0.6270], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([3.0137, 1.8465, 2.4866, 2.0141, 1.7380, 1.3656, 1.3492, 1.2650, 1.1286,
        1.2816], device='cuda:4', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.014925373134328358, middle:0.0, tail0
3shot of client 1:head:0.12280701754385964, middle:0.0, tail0.0
3shot of client 2:head:0.012658227848101266, middle:0.0, tail0.0
3shot of client 3:head:0.013513513513513514, middle:0.037037037037037035, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0196078431372549, middle:0.0, tail0.0
3shot of client 6:head:0.140625, middle:0.0, tail0.0
  6%|▌         | 29/500 [1:04:32<17:33:08, 134.16s/it]  6%|▌         | 30/500 [1:06:44<17:26:20, 133.57s/it]
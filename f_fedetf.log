nohup: ignoring input
./temp/fl_acc_cifar100_resnet34_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N20_100_seed3407_p1_dirichlet0.5_IF0.01_LossCE.txt
Files already downloaded and verified
[500, 477, 455, 434, 415, 396, 378, 361, 344, 328, 314, 299, 286, 273, 260, 248, 237, 226, 216, 206, 197, 188, 179, 171, 163, 156, 149, 142, 135, 129, 123, 118, 112, 107, 102, 98, 93, 89, 85, 81, 77, 74, 70, 67, 64, 61, 58, 56, 53, 51, 48, 46, 44, 42, 40, 38, 36, 35, 33, 32, 30, 29, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 15, 14, 13, 13, 12, 12, 11, 11, 10, 10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5]
10847
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[573, 766, 469, 733, 726, 766, 466, 320, 676, 410, 554, 546, 535, 512, 586, 396, 460, 448, 431, 474]
training set distribution:
[[  8   5  18   0  32  55  32   1  64   2   4  41   7   3  47  19   2   3
    0   6   0   3   5  14   6   4   9  50   0  11   3   0   2   0  38  12
   11   1  19   0   1   0   0   0   1  10   0   0   3   0   0   0   0   0
    1   0   2   2   0   0   1   0   2   0   2   4   0   0   0   0   0   0
    0   0   1   0   0   1   0   0   0   0   2   0   0   0   1   0   0   0
    0   0   0   0   0   1   1   0   0   0]
 [ 99   7  26  25  22   2  54  80   2  28  22  33   7  19 105   0   1   3
    4  13   2  26   9   3   0   4   4   4  37   0  18   1   2   6   5  16
    4   0  15  13   1   0   0   0   3   2   0   0   0   0   2   2   3   9
    1   0   2   0   2   1   0   0   3   0   0   0   0   0   0   7   0   0
    0   0   0   0   0   0   0   0   0   0   0   1   0   2   1   0   0   0
    0   2   0   1   0   0   0   0   0   0]
 [ 14  60   9  13   3  40   0   8   0   6  24  11  75  13  14   6  11   2
    2   7   0   0   0   0   0  10   0   4   0   3   7  10  11   3   5   0
    8   6   1   0   1   8   1   1   5   0   5   2   4   8   0   1   3   0
    2   1   1   1   3   3   2   2   0   0   0   0   0   0   0   0   2   0
    0   1   4   0   6   1   0   0   4   0   3   0   3   0   1   0   1   2
    0   0   0   0   0   0   0   1   0   0]
 [ 23  89  56   2  47   1   7   8  48  33   0  49   1  29   5  32   2  17
   76   5  13  10   0  12   0   0   2   0   9  19  16   2   0  18   2   0
    6   0   0   2   2   1  26   5  10   2   0   1   0   0   4   1   0   1
    1   0   0   0   0   1   3   0   0   8   3   2   0   1   3   0   1   0
    0   4   0   0   0   0   0   0   0   0   0   1   0   1   0   1   3   0
    3   0   1   0   2   0   0   0   0   0]
 [  9  95  66   3  48   7  41  15  36  24  65   1   2   1   0   2   4   8
    0   6  29   0   2  53   7   2  24  19  10  14   0   3   0  25   2   5
    0  30   3   0   4   0   4   7   7   4   0   0   8   4   3   1   0   0
    2   0   0   4   0   0   0   0   1   0   4   0   0   0   0   0   1   3
    1   0   0   1   0   0   2   1   0   0   1   0   0   0   1   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 22  45  14  67   2   2  54  10  18  22  47  12  10  71  16   1  52   4
    7   1  31  36  16   8  25  30   7   0   8   0   3   0   6   6   6  27
    0   0   0   0   4   0   0   0   2   5   4   5   9   1   5   3   3   0
    1   0   6  14   1   1   0   0   1   0   1   3   0   0   0   0   0   4
    1   2   0   0   0   1   0   1   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [  5   0   1  11  50   1  31  30  22  10   1   1   8   4   2   0   2   6
   31   0  15  46   1   7   9   1  18   0   0  10   5   0   7   2  24   2
    6   2   5  18   4   3   3   0   0   0   2   4   3   8   0   3   1   1
    0   2   4   3   0   0   0   6   0   2   0   2   0   2   0   2   3   0
    0   0   0   0   0   2   1   3   0   0   0   0   0   0   1   0   3   0
    0   0   0   2   0   0   1   0   0   1]
 [  0  19   5  26  11  14   5  14   2  11   1  12  20   2   7   6   0   0
    3   0  21   0   3   0   1   1  14   0   2  12   1   9   3   0   4   6
    1   1   5   0   2  10   1   4   1   2   6   0   2   2   1   4   3   1
    0  16   3   0   0   0   1   0   1   1   0   1   0   3   2   0   1   0
    0   1   1   2   0   1   1   2   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [ 44  21  72  58  46  20   1   1  52   0  37  46  14   5  10  11  17   8
    1   1   1   1   8  16  15  40   0   0   0  12   1  10   1   0   0   3
    9   0   5   3   6   5   6   2   7   0   0   5   0   0   2   1   0   0
    7  11   3   0   1   1   2   0   0   0   3   0   4   0   0   1   5   0
    1   0   0   0   0   0   1   0   2   1   0   0   0   0   2   2   0   1
    0   1   0   0   0   0   1   0   0   2]
 [  0  16   3   2  33  70   1  22   1   5  45   9   5   6   3   7   0  14
    7   5   8   5   2   0   1   4   2   5   0   0   1  12   1   7   0   2
    1   2  15  18   0   2   0   0   7  10   3   0   1   2   2   0   5   0
    1   0   7   0   2   0   0   1   0   0   0   0   1   0   0   0   3   1
    0   3   0   3   1   0   0   0   0   0   3   0   2   2   0   2   0   1
    0   1   0   1   0   1   0   0   0   2]
 [  0   0   0  28  16   3  89  14  43   6   9   7   0  12   0   2  62   0
    8  74   2   2   0  26   2   1   8   2   6   0   1   0   2   2   1   2
    5   1   1   0   8   2   0   1   4   7   0  18   0   2   1   0   0  13
    4   0   4   1   0   3   3   0   0   3   3   0   8   0   2   1   0   0
    9   1   2   3   0   1   4   0   1   0   0   1   0   2   0   0   0   0
    0   0   1   0   1   1   0   0   2   0]
 [ 90   0  30  51   5   0   4   3   1   5   1   1   8  11  23  84   0  23
    4   6   0   2   9   0   0   3   0   7   7  17   5   2  21   5   0   3
    0   2   0   2   0   0   0  10   0   1  13   3   0   7   1   2   3   1
    5   0   0   0   6   3   1   1   3   0   5  11   0  12   0   1   0   4
    1   0   4   0   0   0   0   0   1   0   0   3   0   0   0   1   0   1
    2   0   0   0   0   1   1   1   2   0]
 [  9  41   0  22   1  13   6   1   0  53  13   6  47  19   4   2   2  13
   10  15   3   0   0   0  67   8   7   2  37   0  35   0   0  11   0   4
    4   1   2   0   0   8   3   4   2   0   0   0   3   0   5   3   2   8
    5   1   0   5   1   0   1   0   3   0   2   0   0   0   7   0   0   2
    0   0   0   1   3   0   1   0   2   0   1   0   1   0   0   0   0   0
    0   1   0   0   1   0   1   0   0   0]
 [ 14  17   3  80   2  97  18   3   0  17   3   1  13  20   0   1   3   6
    0   0   1  24  40   6   2   1   2   8   0   7   5   1   0   2   1   0
    1   0   5   1  12   4   0  19   6   4   1   5   0   8   0   6   6   0
    2   3   0   0   1   5   0   1   1   6   0   0   0   0   0   1   1   2
    0   0   0   1   3   0   0   2   0   3   0   2   1   0   0   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 30  43   0  19   2   1  17 114   1  68   2   0   6   2   4   9   7  28
    0  11   2   0   7   2  11  12   5  14   9  12   3   2  10   7   0   2
    8   2   0   6  14   4   1   0   0   0  13   1   4   0   8   5   4   0
    6   0   0   4   0   0   2   7   7   2   0   1   2   0   2   3   0   2
    1   0   0   1   0   1   0   2   1   1   0   0   2   2   2   0   0   1
    0   0   0   0   0   1   0   0   1   0]
 [  3   5  43   6  25   7   1  18   0   8   2   2   7   0   0   1   0   0
   37  11   7   0   6   1   3   0  19   0   0   8   0  35  25   0   1  10
    4   0   1  11   6   0   0   4   4   8   5   0  11   9   2   3   0   2
    0   1   1   0   2   2   8   0   4   1   0   0   0   3   1   1   1   0
    0   2   1   2   0   1   0   0   0   3   0   0   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   0   0]
 [ 19   2  21  13   2   0   8  10   1   3  15  15   4  12  17  10  27  40
    1   2   6   1  62  18   2  11  21   7   6   1   0   1   1   1   2   4
   24  15   1   0   2   0   4   1   0   0   2  10   0   0   1   3   4   5
    0   3   0   0   0   0   0   3   0   0   1   0   2   0   0   0   0   0
    0   0   1   0   1   2   3   1   0   0   0   1   1   0   0   0   0   0
    0   1   0   0   2   0   0   0   0   0]
 [  7   5   3   5  21  54   9   0  10   9  20  45  36  35   3  12  23   8
    1   7   0  24   0   4   6  20   6  10   1   0   0   2   0   0   5   0
    0  22   0   6   1   0   0   1   0   0   4   0   3   0   1   0   1   0
    0   0   0   1   0   0   0   6   0   0   1   0   0   0   0   0   0   0
    1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   1
    1   1   1   1   0   0   0   1   0   0]
 [ 87   7  18   0  21   1   0   8   3   2   0   1   6   7   0  10   3  41
    4  35   2   7   7   0   1   2   0  10   3   1  17   2  20   0   0   0
    1   3   0   0   5  20  20   1   5   2   0   2   0   0   9   3   1   1
    2   0   1   0   1  11   1   1   0   3   0   0   3   1   0   3   1   0
    0   1   1   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   1   0   0   0   0]
 [ 17   0  67   3  26   8   0   1  40  16   3   6  10   2   0  33  19   2
   20   1  54   1   2   1   5   2   1   0   0   2   2  26   0  12   6   0
    0   1   7   1   4   7   1   7   0   4   0   0   2   0   1   5   5   0
    0   0   2   0  13   1   5   1   1   0   0   0   3   0   4   0   0   0
    2   0   0   1   0   1   0   0   0   3   0   1   0   0   0   1   0   0
    0   0   1   1   0   0   0   0   0   0]]
Total size of training set
10847
local test distribution:
[[  7   4  16   0  29  50  29   0  59   1   3  37   6   2  43  17   1   2
    0   5   0   2   4  12   5   3   8  46   0  10   2   0   1   0  35  11
   10   0  17   0   0   0   0   0   0   9   0   0   2   0   0   0   0   0
    0   0   1   1   0   0   0   0   1   0   1   3   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 91   6  23  23  20   1  49  73   1  25  20  30   6  17  96   0   0   2
    3  11   1  23   8   2   0   3   3   3  34   0  16   0   1   5   4  14
    3   0  13  11   0   0   0   0   2   1   0   0   0   0   1   1   2   8
    0   0   1   0   1   0   0   0   2   0   0   0   0   0   0   6   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0
    0   1   0   0   0   0   0   0   0   0]
 [ 12  55   8  11   2  36   0   7   0   5  22  10  69  11  12   5  10   1
    1   6   0   0   0   0   0   9   0   3   0   2   6   9  10   2   4   0
    7   5   0   0   0   7   0   0   4   0   4   1   3   7   0   0   2   0
    1   0   0   0   2   2   1   1   0   0   0   0   0   0   0   0   1   0
    0   0   3   0   5   0   0   0   3   0   2   0   2   0   0   0   0   1
    0   0   0   0   0   0   0   0   0   0]
 [ 21  82  51   1  43   0   6   7  44  30   0  45   0  26   4  29   1  15
   70   4  11   9   0  11   0   0   1   0   8  17  14   1   0  16   1   0
    5   0   0   1   1   0  23   4   9   1   0   0   0   0   3   0   0   0
    0   0   0   0   0   0   2   0   0   7   2   1   0   0   2   0   0   0
    0   3   0   0   0   0   0   0   0   0   0   0   0   0   0   0   2   0
    2   0   0   0   1   0   0   0   0   0]
 [  8  87  60   2  44   6  37  13  33  22  59   0   1   0   0   1   3   7
    0   5  26   0   1  48   6   1  22  17   9  12   0   2   0  23   1   4
    0  27   2   0   3   0   3   6   6   3   0   0   7   3   2   0   0   0
    1   0   0   3   0   0   0   0   0   0   3   0   0   0   0   0   0   2
    0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 20  41  12  61   1   1  49   9  16  20  43  11   9  65  14   0  47   3
    6   0  28  33  14   7  23  27   6   0   7   0   2   0   5   5   5  24
    0   0   0   0   3   0   0   0   1   4   3   4   8   0   4   2   2   0
    0   0   5  12   0   0   0   0   0   0   0   2   0   0   0   0   0   3
    0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  4   0   0  10  46   0  28  27  20   9   0   0   7   3   1   0   1   5
   28   0  13  42   0   6   8   0  16   0   0   9   4   0   6   1  22   1
    5   1   4  16   3   2   2   0   0   0   1   3   2   7   0   2   0   0
    0   1   3   2   0   0   0   5   0   1   0   1   0   1   0   1   2   0
    0   0   0   0   0   1   0   2   0   0   0   0   0   0   0   0   2   0
    0   0   0   1   0   0   0   0   0   0]
 [  0  17   4  23  10  12   4  12   1  10   0  11  18   1   6   5   0   0
    2   0  19   0   2   0   0   0  12   0   1  11   0   8   2   0   3   5
    0   0   4   0   1   9   0   3   0   1   5   0   1   1   0   3   2   0
    0  14   2   0   0   0   0   0   0   0   0   0   0   2   1   0   0   0
    0   0   0   1   0   0   0   1   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 40  19  66  53  42  18   0   0  47   0  34  42  12   4   9  10  15   7
    0   0   0   0   7  14  13  36   0   0   0  11   0   9   0   0   0   2
    8   0   4   2   5   4   5   1   6   0   0   4   0   0   1   0   0   0
    6  10   2   0   0   0   1   0   0   0   2   0   3   0   0   0   4   0
    0   0   0   0   0   0   0   0   1   0   0   0   0   0   1   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0  14   2   1  30  64   0  20   0   4  41   8   4   5   2   6   0  12
    6   4   7   4   1   0   0   3   1   4   0   0   0  11   0   6   0   1
    0   1  13  16   0   1   0   0   6   9   2   0   0   1   1   0   4   0
    0   0   6   0   1   0   0   0   0   0   0   0   0   0   0   0   2   0
    0   2   0   2   0   0   0   0   0   0   2   0   1   1   0   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0   0   0  25  14   2  82  12  39   5   8   6   0  11   0   1  57   0
    7  68   1   1   0  23   1   0   7   1   5   0   0   0   1   1   0   1
    4   0   0   0   7   1   0   0   3   6   0  16   0   1   0   0   0  11
    3   0   3   0   0   2   2   0   0   2   2   0   7   0   1   0   0   0
    8   0   1   2   0   0   3   0   0   0   0   0   0   1   0   0   0   0
    0   0   0   0   0   0   0   0   1   0]
 [ 82   0  27  47   4   0   3   2   0   4   0   0   7  10  21  77   0  21
    3   5   0   1   8   0   0   2   0   6   6  15   4   1  19   4   0   2
    0   1   0   1   0   0   0   9   0   0  11   2   0   6   0   1   2   0
    4   0   0   0   5   2   0   0   2   0   4  10   0  11   0   0   0   3
    0   0   3   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   1   0]
 [  8  37   0  20   0  11   5   0   0  48  11   5  43  17   3   1   1  11
    9  13   2   0   0   0  61   7   6   1  34   0  32   0   0  10   0   3
    3   0   1   0   0   7   2   3   1   0   0   0   2   0   4   2   1   7
    4   0   0   4   0   0   0   0   2   0   1   0   0   0   6   0   0   1
    0   0   0   0   2   0   0   0   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 12  15   2  73   1  89  16   2   0  15   2   0  11  18   0   0   2   5
    0   0   0  22  36   5   1   0   1   7   0   6   4   0   0   1   0   0
    0   0   4   0  11   3   0  17   5   3   0   4   0   7   0   5   5   0
    1   2   0   0   0   4   0   0   0   5   0   0   0   0   0   0   0   1
    0   0   0   0   2   0   0   1   0   2   0   1   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 27  39   0  17   1   0  15 105   0  62   1   0   5   1   3   8   6  25
    0  10   1   0   6   1  10  11   4  12   8  11   2   1   9   6   0   1
    7   1   0   5  12   3   0   0   0   0  11   0   3   0   7   4   3   0
    5   0   0   3   0   0   1   6   6   1   0   0   1   0   1   2   0   1
    0   0   0   0   0   0   0   1   0   0   0   0   1   1   1   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  2   4  39   5  23   6   0  16   0   7   1   1   6   0   0   0   0   0
   34  10   6   0   5   0   2   0  17   0   0   7   0  32  23   0   0   9
    3   0   0  10   5   0   0   3   3   7   4   0  10   8   1   2   0   1
    0   0   0   0   1   1   7   0   3   0   0   0   0   2   0   0   0   0
    0   1   0   1   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 17   1  19  11   1   0   7   9   0   2  13  13   3  11  15   9  24  36
    0   1   5   0  57  16   1  10  19   6   5   0   0   0   0   0   1   3
   22  13   0   0   1   0   3   0   0   0   1   9   0   0   0   2   3   4
    0   2   0   0   0   0   0   2   0   0   0   0   1   0   0   0   0   0
    0   0   0   0   0   1   2   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   1   0   0   0   0   0]
 [  6   4   2   4  19  49   8   0   9   8  18  41  33  32   2  11  21   7
    0   6   0  22   0   3   5  18   5   9   0   0   0   1   0   0   4   0
    0  20   0   5   0   0   0   0   0   0   3   0   2   0   0   0   0   0
    0   0   0   0   0   0   0   5   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 80   6  16   0  19   0   0   7   2   1   0   0   5   6   0   9   2  37
    3  32   1   6   6   0   0   1   0   9   2   0  15   1  18   0   0   0
    0   2   0   0   4  18  18   0   4   1   0   1   0   0   8   2   0   0
    1   0   0   0   0  10   0   0   0   2   0   0   2   0   0   2   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 15   0  61   2  23   7   0   0  36  14   2   5   9   1   0  30  17   1
   18   0  49   0   1   0   4   1   0   0   0   1   1  23   0  11   5   0
    0   0   6   0   3   6   0   6   0   3   0   0   1   0   0   4   4   0
    0   0   1   0  11   0   4   0   0   0   0   0   2   0   3   0   0   0
    1   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]]
Total size of testing set
9199
[452 431 408 389 372 352 338 321 307 292 278 265 254 241 231 219 208 197
 190 180 170 165 156 148 140 132 128 124 119 112 102  99  95  91  85  81
  77  71  68  67  59  61  56  52  50  48  45  44  41  41  32  30  30  31
  26  29  24  25  21  21  18  19  16  18  15  17  16  16  14  11   9  11
   9   7   7   6   9   2   6   5   5   6   5   3   4   4   2   2   4   1
   3   1   0   1   2   0   0   0   2   2]
20
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [04:15<35:23:11, 255.29s/it]  0%|          | 2/500 [08:24<34:47:32, 251.51s/it]3shot of client 0:head:0.0026455026455026454, middle:0.0, tail0.041666666666666664
3shot of client 1:head:0.009861932938856016, middle:0.0078125, tail0.0
3shot of client 2:head:0.0, middle:0.0, tail0.0
3shot of client 3:head:0.004158004158004158, middle:0.0, tail0.0
3shot of client 4:head:0.006147540983606557, middle:0.008695652173913044, tail0.0
3shot of client 5:head:0.0019569471624266144, middle:0.008, tail0.0
3shot of client 6:head:0.0, middle:0.02666666666666667, tail0.0
3shot of client 7:head:0.08333333333333333, middle:0.0, tail0.0
3shot of client 8:head:0.011389521640091117, middle:0.0, tail0.0
3shot of client 9:head:0.05179282868525897, middle:0.0, tail0.0
3shot of client 10:head:0.05307262569832402, middle:0.011627906976744186, tail0.0
3shot of client 11:head:0.014245014245014245, middle:0.0, tail0.0
3shot of client 12:head:0.0028735632183908046, middle:0.0, tail0.0
3shot of client 13:head:0.0030864197530864196, middle:0.0, tail0.0
3shot of client 14:head:0.0026954177897574125, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.0033783783783783786, middle:0.0, tail0.0
3shot of client 17:head:0.0034129692832764505, middle:0.0, tail0.0
3shot of client 18:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.010101010101010102, middle:0.0, tail0.0
round 0, local average test acc  0.0110 

round 0, local macro average F1 score  0.0050 

round 0, local weighted average F1 score  0.0076 

round 0, global test acc  0.3026 

round 0, average 3shot acc: [head: 0.0136, middle: 0.0031, tail: 0.0021] 

round 0, global 3shot acc: [head: 0.7196, middle: 0.3408, tail: 0.0419] 

l_head tensor([1.9808, 1.3229, 2.4620, 0.5818, 2.6884, 2.3855, 2.3206, 0.8639, 2.5915,
        1.1416, 1.4211, 2.8807, 1.1760, 1.4254, 2.6704, 2.2957, 1.3050, 1.1444,
        0.5788, 1.7753, 0.5862, 1.3291, 1.5082, 1.8442, 1.2456, 1.9524, 2.3003,
        2.9130, 0.5829, 2.4571, 1.6356, 0.5800, 1.3200, 0.5706, 2.9011, 2.4043,
        1.4515, 1.2968, 2.7502, 0.5941, 1.3203, 0.5599, 0.5765, 0.5790, 1.0832,
        2.8569, 0.5829, 0.5724, 1.8543, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        1.2693, 0.5970, 1.5957, 1.4077, 0.5762, 0.5941, 0.7930, 0.5795, 1.8933,
        0.5743, 1.6858, 1.9792, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 1.2835, 0.5860, 0.5857, 1.1199, 0.5626, 0.5870, 0.5775,
        0.5576, 1.5666, 0.5745, 0.5812, 0.5788, 1.3057, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 1.0685, 1.3104, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.3726, 1.3419, 1.4394, 1.7745, 1.7246, 1.3434, 1.3510, 1.4267, 1.1869,
        1.3493, 1.4522, 1.3963, 1.4305, 1.3252, 1.2145, 1.2939, 1.2436, 1.2460,
        1.1909, 1.3499, 0.9888, 1.0769, 1.0494, 0.9894, 1.0676, 1.4002, 1.2807,
        1.1286, 1.0761, 1.0792, 1.1018, 1.1286, 1.0457, 1.0698, 0.9562, 1.1670,
        1.0264, 1.0143, 1.0477, 0.8869, 1.1869, 0.9254, 0.9306, 1.0007, 0.9672,
        0.9638, 0.9447, 0.8542, 0.9027, 0.7952, 0.9333, 1.0293, 0.8450, 0.7416,
        0.9770, 0.7298, 0.8972, 0.7731, 0.8181, 0.7191, 0.7461, 0.7661, 0.8136,
        0.6801, 0.6835, 0.6261, 0.7244, 0.7270, 0.6307, 0.7619, 0.6977, 0.6907,
        0.6533, 0.6683, 0.6027, 0.7011, 0.6164, 0.5958, 0.6213, 0.6105, 0.6069,
        0.5907, 0.5897, 0.5793, 0.6172, 0.6173, 0.6281, 0.6210, 0.5967, 0.5858,
        0.5891, 0.6227, 0.5859, 0.5564, 0.5954, 0.5784, 0.5763, 0.6044, 0.5815,
        0.6163], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0026455026455026454, middle:0.0, tail0.0
3shot of client 1:head:0.005917159763313609, middle:0.0078125, tail0.0
3shot of client 2:head:0.0, middle:0.0, tail0.0
3shot of client 3:head:0.002079002079002079, middle:0.0, tail0.0
3shot of client 4:head:0.006147540983606557, middle:0.0, tail0.0
3shot of client 5:head:0.0019569471624266144, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.013333333333333334, tail0.0
3shot of client 7:head:0.078125, middle:0.0, tail0.0
3shot of client 8:head:0.00683371298405467, middle:0.0, tail0.0
3shot of client 9:head:0.05976095617529881, middle:0.0, tail0.0
3shot of client 10:head:0.055865921787709494, middle:0.0, tail0.0
3shot of client 11:head:0.011396011396011397, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.011904761904761904, tail0.0
3shot of client 13:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 14:head:0.005390835579514825, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.0033783783783783786, middle:0.0, tail0.0
3shot of client 17:head:0.006825938566552901, middle:0.0, tail0.0
3shot of client 18:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.006734006734006734, middle:0.0, tail0.0
round 1, local average test acc  0.0105 

round 1, local macro average F1 score  0.0029 

round 1, local weighted average F1 score  0.0061 

round 1, global test acc  0.3161 

round 1, average 3shot acc: [head: 0.0133, middle: 0.0017, tail: 0.0000] 

round 1, global 3shot acc: [head: 0.7244, middle: 0.3777, tail: 0.0474] 

l_head tensor([2.1414, 1.4845, 3.0972, 0.5818, 3.0005, 2.6669, 2.7227, 1.1200, 2.7589,
        1.4627, 1.7319, 3.2204, 1.4866, 1.6571, 2.9715, 2.6878, 1.4224, 1.3161,
        0.5788, 1.9252, 0.5862, 1.3266, 1.6712, 2.0247, 1.8012, 2.1227, 2.7348,
        3.6382, 0.5829, 2.7216, 1.8558, 0.5800, 1.5720, 0.5706, 3.2007, 2.6988,
        1.7658, 1.3550, 3.0993, 0.5941, 1.5248, 0.5599, 0.5765, 0.5790, 1.4226,
        3.3593, 0.5829, 0.5724, 2.0601, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        1.7685, 0.5970, 1.7325, 1.6227, 0.5762, 0.5941, 1.1365, 0.5795, 2.0389,
        0.5743, 2.1192, 2.5120, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 1.6924, 0.5860, 0.5857, 1.4722, 0.5626, 0.5870, 0.5775,
        0.5576, 1.9858, 0.5745, 0.5812, 0.5788, 1.5594, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 1.6082, 1.4375, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.6343, 1.5790, 1.6722, 2.0929, 1.9632, 1.5446, 1.5436, 1.6352, 1.4158,
        1.5982, 1.6872, 1.7289, 1.6715, 1.5533, 1.3999, 1.5077, 1.4887, 1.4391,
        1.4527, 1.5705, 1.1714, 1.2927, 1.2142, 1.1776, 1.2752, 1.6321, 1.5289,
        1.3649, 1.2821, 1.2877, 1.2554, 1.3185, 1.2907, 1.2575, 1.2235, 1.4399,
        1.1591, 1.2656, 1.3265, 1.0667, 1.3744, 1.1121, 1.1805, 1.3167, 1.2775,
        1.2677, 1.2468, 1.1452, 1.0573, 1.0727, 1.1800, 1.3610, 1.0215, 0.9200,
        1.2570, 0.9256, 1.1710, 1.0374, 1.0567, 0.8439, 0.8329, 0.9869, 0.9410,
        0.8348, 0.7911, 0.7108, 0.8397, 0.8716, 0.7725, 0.9240, 0.8918, 0.8130,
        0.7468, 0.7882, 0.6993, 0.8547, 0.7338, 0.6616, 0.6989, 0.6590, 0.6907,
        0.6354, 0.6638, 0.6241, 0.6761, 0.6532, 0.6809, 0.6764, 0.6410, 0.6381,
        0.6211, 0.6475, 0.6151, 0.5806, 0.6419, 0.6069, 0.6112, 0.6483, 0.6013,
        0.6449], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.0039447731755424065, middle:0.0, tail0.0
3shot of client 2:head:0.003355704697986577, middle:0.0, tail0.0
3shot of client 3:head:0.004158004158004158, middle:0.0, tail0.0
3shot of client 4:head:0.0020491803278688526, middle:0.0, tail0.0
3shot of client 5:head:0.0019569471624266144, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.078125, middle:0.0, tail0.0
3shot of client 8:head:0.00683371298405467, middle:0.0, tail0.0
3shot of client 9:head:0.05976095617529881, middle:0.0, tail0.0
3shot of client 10:head:0.05865921787709497, middle:0.0, tail0.0
3shot of client 11:head:0.008547008547008548, middle:0.0, tail0.0
3shot of client 12:head:0.005747126436781609, middle:0.0, tail0.0
3shot of client 13:head:0.0030864197530864196, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
  1%|          | 3/500 [12:24<34:02:49, 246.62s/it]  1%|          | 4/500 [16:14<33:04:28, 240.06s/it]3shot of client 18:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.006734006734006734, middle:0.0125, tail0.0
round 2, local average test acc  0.0098 

round 2, local macro average F1 score  0.0022 

round 2, local weighted average F1 score  0.0051 

round 2, global test acc  0.3261 

round 2, average 3shot acc: [head: 0.0125, middle: 0.0014, tail: 0.0000] 

round 2, global 3shot acc: [head: 0.7196, middle: 0.4104, tail: 0.0534] 

l_head tensor([2.3270, 1.7689, 3.1336, 0.5818, 2.9787, 2.6867, 2.8137, 1.3635, 3.2258,
        1.5809, 1.7837, 3.5204, 1.6768, 1.7046, 2.9738, 2.8020, 1.5539, 1.5367,
        0.5788, 2.3121, 0.5862, 1.3448, 1.8093, 2.0576, 2.0292, 2.1885, 2.7462,
        3.9778, 0.5829, 2.8355, 2.2889, 0.5800, 1.6709, 0.5706, 3.3478, 2.7883,
        2.1482, 1.4112, 3.1227, 0.5941, 1.5248, 0.5599, 0.5765, 0.5790, 1.7295,
        3.7462, 0.5829, 0.5724, 2.2603, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        1.8775, 0.5970, 1.9526, 1.6957, 0.5762, 0.5941, 1.1352, 0.5795, 2.4941,
        0.5743, 2.4375, 3.0646, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 1.7115, 0.5860, 0.5857, 1.5105, 0.5626, 0.5870, 0.5775,
        0.5576, 2.2513, 0.5745, 0.5812, 0.5788, 1.6821, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 1.5963, 1.5387, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8022, 1.6965, 1.8799, 2.2653, 2.1840, 1.6506, 1.6739, 1.7849, 1.5284,
        1.6913, 1.8483, 2.0188, 1.8430, 1.7137, 1.5348, 1.5970, 1.5886, 1.5659,
        1.5658, 1.7294, 1.2539, 1.3782, 1.3648, 1.2490, 1.4307, 1.7665, 1.7474,
        1.4226, 1.3296, 1.4473, 1.3493, 1.4809, 1.3886, 1.3247, 1.3836, 1.6060,
        1.3719, 1.3718, 1.4780, 1.1501, 1.4850, 1.1870, 1.3573, 1.4794, 1.3809,
        1.4662, 1.4189, 1.2874, 1.1067, 1.2172, 1.3108, 1.4680, 1.1428, 1.0496,
        1.3226, 1.1039, 1.2391, 1.1461, 1.1737, 1.0019, 1.0084, 1.0549, 1.0554,
        1.0213, 0.8726, 0.8087, 0.9597, 1.0112, 0.8745, 1.0657, 1.0886, 0.8888,
        0.8332, 0.8945, 0.7937, 0.9885, 0.8533, 0.7373, 0.7791, 0.7227, 0.7570,
        0.7031, 0.7384, 0.6772, 0.7371, 0.7019, 0.7476, 0.7498, 0.6706, 0.6756,
        0.6599, 0.7008, 0.6609, 0.6119, 0.6993, 0.6303, 0.6323, 0.6949, 0.6284,
        0.6954], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.005291005291005291, middle:0.0, tail0.041666666666666664
3shot of client 1:head:0.0039447731755424065, middle:0.0078125, tail0.0
3shot of client 2:head:0.0, middle:0.0, tail0.0
3shot of client 3:head:0.004158004158004158, middle:0.015873015873015872, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.013333333333333334, tail0.0
3shot of client 7:head:0.078125, middle:0.0, tail0.0
3shot of client 8:head:0.009111617312072893, middle:0.0, tail0.0
3shot of client 9:head:0.055776892430278883, middle:0.0, tail0.0
3shot of client 10:head:0.05865921787709497, middle:0.0, tail0.0
3shot of client 11:head:0.017094017094017096, middle:0.0, tail0.0
3shot of client 12:head:0.0028735632183908046, middle:0.0, tail0.0
3shot of client 13:head:0.0030864197530864196, middle:0.0, tail0.0
3shot of client 14:head:0.005390835579514825, middle:0.0, tail0.0
3shot of client 15:head:0.003968253968253968, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.011029411764705883, middle:0.0, tail0.0
3shot of client 19:head:0.010101010101010102, middle:0.0, tail0.0
round 3, local average test acc  0.0107 

round 3, local macro average F1 score  0.0038 

round 3, local weighted average F1 score  0.0064 

round 3, global test acc  0.3323 

round 3, average 3shot acc: [head: 0.0134, middle: 0.0019, tail: 0.0021] 

round 3, global 3shot acc: [head: 0.7156, middle: 0.4300, tail: 0.0581] 

l_head tensor([2.3759, 1.8937, 3.4095, 0.5818, 3.2525, 2.8000, 3.1235, 1.3642, 3.3958,
        1.5809, 2.0545, 3.4955, 1.7404, 1.7706, 3.1182, 2.9806, 1.6542, 1.5352,
        0.5788, 2.4013, 0.5862, 1.7361, 1.7977, 2.2288, 2.0328, 2.4430, 3.0590,
        4.1195, 0.5829, 3.0107, 2.4484, 0.5800, 1.8745, 0.5706, 3.7410, 2.8950,
        2.2567, 1.5158, 3.2944, 0.5941, 1.5247, 0.5599, 0.5765, 0.5790, 2.0561,
        3.8976, 0.5829, 0.5724, 2.3201, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        1.9518, 0.5970, 2.1626, 1.8340, 0.5762, 0.5941, 1.1336, 0.5795, 2.4792,
        0.5743, 2.6389, 3.3111, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 2.0058, 0.5860, 0.5857, 1.7669, 0.5626, 0.5870, 0.5775,
        0.5576, 2.6039, 0.5745, 0.5812, 0.5788, 1.7487, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 1.7941, 1.7038, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8781, 1.7621, 1.9661, 2.3701, 2.3466, 1.7392, 1.7755, 1.8671, 1.6021,
        1.7749, 1.9232, 2.1322, 1.9699, 1.8244, 1.5892, 1.6959, 1.7154, 1.6314,
        1.6278, 1.8148, 1.2997, 1.4667, 1.4831, 1.3489, 1.4977, 1.8268, 1.8120,
        1.5260, 1.3998, 1.4591, 1.3966, 1.6076, 1.5367, 1.3778, 1.4356, 1.7836,
        1.4149, 1.4657, 1.5481, 1.1699, 1.5580, 1.2299, 1.4876, 1.6407, 1.5104,
        1.5911, 1.5828, 1.4973, 1.2177, 1.2573, 1.4391, 1.5585, 1.2378, 1.1127,
        1.4443, 1.2200, 1.3392, 1.2112, 1.3138, 1.0533, 1.0648, 1.1500, 1.1643,
        1.1563, 0.9929, 0.8996, 1.1024, 1.0695, 0.9637, 1.1743, 1.1410, 0.9586,
        0.9573, 0.9839, 0.8989, 1.1117, 0.9374, 0.8160, 0.8486, 0.7762, 0.8326,
        0.7622, 0.8043, 0.7252, 0.7812, 0.7608, 0.7989, 0.8162, 0.7127, 0.7228,
        0.6820, 0.7496, 0.6933, 0.6362, 0.7412, 0.6715, 0.6503, 0.7445, 0.6716,
        0.7310], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.005917159763313609, middle:0.0, tail0.0
3shot of client 2:head:0.0, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.002079002079002079, middle:0.0, tail0.0
3shot of client 4:head:0.0020491803278688526, middle:0.008695652173913044, tail0.0
3shot of client 5:head:0.0019569471624266144, middle:0.0, tail0.0
3shot of client 6:head:0.003401360544217687, middle:0.013333333333333334, tail0.0
3shot of client 7:head:0.078125, middle:0.021739130434782608, tail0.0
3shot of client 8:head:0.004555808656036446, middle:0.0, tail0.0
3shot of client 9:head:0.05976095617529881, middle:0.0, tail0.0
3shot of client 10:head:0.061452513966480445, middle:0.0, tail0.0
3shot of client 11:head:0.017094017094017096, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.003968253968253968, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.006734006734006734, middle:0.0, tail0.0
round 4, local average test acc  0.0102 

round 4, local macro average F1 score  0.0033 

round 4, local weighted average F1 score  0.0055 

round 4, global test acc  0.3361 

round 4, average 3shot acc: [head: 0.0127, middle: 0.0028, tail: 0.0000] 

round 4, global 3shot acc: [head: 0.7170, middle: 0.4354, tail: 0.0623] 

l_head   1%|          | 5/500 [20:14<32:58:09, 239.78s/it]  1%|          | 6/500 [24:23<33:20:16, 242.95s/it]tensor([2.4205, 1.8938, 3.4360, 0.5818, 3.3617, 2.9261, 3.1066, 1.4303, 3.2855,
        1.5646, 2.0545, 3.6302, 1.7994, 1.7696, 3.1683, 3.1442, 1.8070, 1.5353,
        0.5788, 2.4013, 0.5862, 1.7361, 1.8868, 2.3863, 2.0369, 2.4599, 3.0664,
        4.2114, 0.5829, 3.0890, 2.6190, 0.5800, 1.8267, 0.5706, 3.9077, 3.1254,
        2.5032, 1.6666, 3.4218, 0.5941, 1.5248, 0.5599, 0.5765, 0.5790, 2.1078,
        3.8588, 0.5829, 0.5724, 2.4541, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        2.0760, 0.5970, 2.1180, 1.9581, 0.5762, 0.5941, 1.1333, 0.5795, 2.5862,
        0.5743, 2.9236, 3.4808, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 2.2860, 0.5860, 0.5857, 1.9583, 0.5626, 0.5870, 0.5775,
        0.5576, 2.7407, 0.5745, 0.5812, 0.5788, 1.7951, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 2.0093, 1.7010, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.9547, 1.8241, 2.0588, 2.4429, 2.4378, 1.8246, 1.8191, 1.9419, 1.6762,
        1.8582, 1.9721, 2.2096, 2.0355, 1.9001, 1.7005, 1.7961, 1.7964, 1.7255,
        1.7279, 1.8905, 1.3387, 1.5755, 1.5362, 1.3651, 1.5555, 1.8544, 1.9066,
        1.5988, 1.4638, 1.5154, 1.4508, 1.6506, 1.5854, 1.4376, 1.5199, 1.8260,
        1.4777, 1.5118, 1.6734, 1.2157, 1.6374, 1.3065, 1.5350, 1.7230, 1.5948,
        1.6605, 1.6308, 1.5823, 1.2429, 1.2950, 1.5385, 1.6343, 1.2764, 1.1818,
        1.5597, 1.3157, 1.3983, 1.2659, 1.4659, 1.1278, 1.1075, 1.1927, 1.2028,
        1.2221, 1.0763, 0.9502, 1.1864, 1.1637, 1.0600, 1.2251, 1.2684, 1.0234,
        1.0597, 1.0580, 0.9570, 1.2026, 1.0147, 0.8946, 0.9009, 0.8152, 0.9116,
        0.8295, 0.8852, 0.7983, 0.8498, 0.8501, 0.8416, 0.8897, 0.7445, 0.7794,
        0.7095, 0.7818, 0.7439, 0.6628, 0.7963, 0.6991, 0.6774, 0.7738, 0.7082,
        0.7818], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.010582010582010581, middle:0.0, tail0.0
3shot of client 1:head:0.005917159763313609, middle:0.0, tail0.0
3shot of client 2:head:0.0, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.004158004158004158, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0019569471624266144, middle:0.008, tail0.03125
3shot of client 6:head:0.006802721088435374, middle:0.013333333333333334, tail0.0
3shot of client 7:head:0.078125, middle:0.0, tail0.0
3shot of client 8:head:0.004555808656036446, middle:0.0, tail0.0
3shot of client 9:head:0.06772908366533864, middle:0.0, tail0.0
3shot of client 10:head:0.055865921787709494, middle:0.0, tail0.0
3shot of client 11:head:0.017094017094017096, middle:0.0, tail0.0
3shot of client 12:head:0.0028735632183908046, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0026954177897574125, middle:0.010526315789473684, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.013468013468013467, middle:0.0, tail0.0
round 5, local average test acc  0.0111 

round 5, local macro average F1 score  0.0038 

round 5, local weighted average F1 score  0.0073 

round 5, global test acc  0.3393 

round 5, average 3shot acc: [head: 0.0140, middle: 0.0023, tail: 0.0016] 

round 5, global 3shot acc: [head: 0.7126, middle: 0.4446, tail: 0.0666] 

l_head tensor([2.4201, 1.8806, 3.4699, 0.5818, 3.4064, 3.1075, 3.2493, 1.5029, 3.7428,
        1.6088, 2.0546, 3.7449, 1.8410, 1.9466, 3.3442, 3.1759, 1.8619, 1.5374,
        0.5788, 2.5357, 0.5862, 1.7139, 1.9695, 2.4348, 2.1393, 2.6096, 3.2026,
        4.4063, 0.5829, 3.1386, 2.6511, 0.5800, 1.8265, 0.5706, 3.8710, 3.2484,
        2.4374, 1.6635, 3.4753, 0.5941, 1.5581, 0.5599, 0.5765, 0.5790, 2.1076,
        3.9440, 0.5829, 0.5724, 2.4657, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        2.1573, 0.5970, 2.1270, 2.0758, 0.5762, 0.5941, 1.1317, 0.5795, 2.6486,
        0.5743, 3.0676, 3.6270, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 2.2864, 0.5860, 0.5857, 2.0527, 0.5626, 0.5870, 0.5775,
        0.5576, 2.7113, 0.5745, 0.5812, 0.5788, 1.9253, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 2.2355, 1.7031, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.0216, 1.9409, 2.1026, 2.4633, 2.4881, 1.8770, 1.8839, 1.9857, 1.6996,
        1.9467, 2.0427, 2.2637, 2.0956, 1.9410, 1.7408, 1.8557, 1.8352, 1.7888,
        1.7728, 1.9344, 1.3961, 1.5774, 1.5750, 1.4016, 1.6119, 1.8944, 1.9720,
        1.6588, 1.5090, 1.5723, 1.5172, 1.7029, 1.6286, 1.5045, 1.5856, 1.9047,
        1.5592, 1.5645, 1.7746, 1.2738, 1.7105, 1.3505, 1.6272, 1.8292, 1.6438,
        1.7260, 1.7334, 1.6477, 1.2856, 1.3453, 1.5787, 1.6833, 1.3541, 1.2186,
        1.6511, 1.3689, 1.4219, 1.3400, 1.5081, 1.1596, 1.1774, 1.2648, 1.3361,
        1.3472, 1.1708, 1.0044, 1.2818, 1.2102, 1.1361, 1.2867, 1.2844, 1.0270,
        1.1052, 1.0728, 1.0152, 1.2543, 1.0605, 0.9604, 0.9772, 0.8719, 0.9625,
        0.8784, 0.9521, 0.8481, 0.8996, 0.9194, 0.9021, 0.9302, 0.7858, 0.8251,
        0.7472, 0.8132, 0.7796, 0.6867, 0.8354, 0.7284, 0.6979, 0.8200, 0.7625,
        0.8072], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0026455026455026454, middle:0.0, tail0.0
3shot of client 1:head:0.007889546351084813, middle:0.0, tail0.0
3shot of client 2:head:0.003355704697986577, middle:0.0, tail0.0
3shot of client 3:head:0.002079002079002079, middle:0.0, tail0.0
3shot of client 4:head:0.0020491803278688526, middle:0.008695652173913044, tail0.0
3shot of client 5:head:0.0019569471624266144, middle:0.0, tail0.0
3shot of client 6:head:0.006802721088435374, middle:0.0, tail0.0
3shot of client 7:head:0.078125, middle:0.0, tail0.0
3shot of client 8:head:0.004555808656036446, middle:0.0, tail0.0
3shot of client 9:head:0.055776892430278883, middle:0.0, tail0.0
3shot of client 10:head:0.05307262569832402, middle:0.0, tail0.0
3shot of client 11:head:0.011396011396011397, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.0030864197530864196, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.003968253968253968, middle:0.0, tail0.0
3shot of client 16:head:0.010135135135135136, middle:0.0, tail0.0
3shot of client 17:head:0.0034129692832764505, middle:0.0, tail0.0
3shot of client 18:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.006734006734006734, middle:0.0, tail0.058823529411764705
round 6, local average test acc  0.0103 

round 6, local macro average F1 score  0.0040 

round 6, local weighted average F1 score  0.0057 

round 6, global test acc  0.3421 

round 6, average 3shot acc: [head: 0.0132, middle: 0.0004, tail: 0.0029] 

round 6, global 3shot acc: [head: 0.7089, middle: 0.4508, tail: 0.0713] 

l_head tensor([2.4166, 1.9354, 3.6648, 0.5818, 3.4226, 3.1055, 3.2995, 1.5841, 3.6737,
        1.7835, 2.0547, 3.7712, 1.8965, 1.9465, 3.2543, 3.2323, 1.8517, 1.5372,
        0.5788, 2.5492, 0.5862, 1.8282, 2.0172, 2.5338, 2.1403, 2.6698, 3.2303,
        4.4727, 0.5829, 3.0895, 2.7709, 0.5800, 1.9338, 0.5706, 3.9512, 3.2748,
        2.4385, 1.6446, 3.5712, 0.5941, 1.5902, 0.5599, 0.5765, 0.5790, 2.2475,
        4.1448, 0.5829, 0.5724, 2.6084, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        2.2146, 0.5970, 2.1771, 2.0371, 0.5762, 0.5941, 1.1308, 0.5795, 2.6623,
        0.5743, 3.0914, 3.8014, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 2.4465, 0.5860, 0.5857, 2.1544, 0.5626, 0.5870, 0.5775,
        0.5576, 2.7999, 0.5745, 0.5812, 0.5788, 1.9968, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 2.2716, 1.7628, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux   1%|▏         | 7/500 [28:13<32:42:06, 238.80s/it]  2%|▏         | 8/500 [31:48<31:34:28, 231.03s/it]  2%|▏         | 9/500 [35:35<31:20:40, 229.82s/it]tensor([2.1025, 2.0083, 2.2188, 2.5346, 2.5264, 1.9130, 1.9108, 2.0395, 1.7472,
        2.0067, 2.0588, 2.3164, 2.1294, 1.9871, 1.7860, 1.9026, 1.9006, 1.8373,
        1.8429, 1.9885, 1.4476, 1.6221, 1.6179, 1.4322, 1.6634, 1.9332, 2.0121,
        1.6571, 1.5507, 1.6490, 1.5634, 1.7950, 1.6830, 1.5490, 1.6338, 1.9444,
        1.5785, 1.6052, 1.7911, 1.2922, 1.7549, 1.3695, 1.6892, 1.8865, 1.6544,
        1.7823, 1.8017, 1.6897, 1.3329, 1.3886, 1.6230, 1.7623, 1.4463, 1.2609,
        1.7077, 1.4293, 1.4705, 1.3945, 1.5994, 1.2307, 1.1852, 1.3306, 1.3845,
        1.4208, 1.2326, 1.0388, 1.3449, 1.2558, 1.2282, 1.3376, 1.3855, 1.0844,
        1.1588, 1.1191, 1.0729, 1.3196, 1.1094, 1.0084, 1.0282, 0.9145, 0.9866,
        0.9129, 1.0111, 0.9052, 0.9399, 0.9804, 0.9404, 0.9617, 0.8181, 0.8594,
        0.7879, 0.8499, 0.8178, 0.7136, 0.8751, 0.7620, 0.7231, 0.8436, 0.7981,
        0.8515], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0026455026455026454, middle:0.0, tail0.0
3shot of client 1:head:0.007889546351084813, middle:0.0, tail0.0
3shot of client 2:head:0.0, middle:0.0, tail0.0
3shot of client 3:head:0.002079002079002079, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.008695652173913044, tail0.0
3shot of client 5:head:0.0, middle:0.008, tail0.03125
3shot of client 6:head:0.003401360544217687, middle:0.013333333333333334, tail0.0
3shot of client 7:head:0.078125, middle:0.021739130434782608, tail0.0
3shot of client 8:head:0.004555808656036446, middle:0.0, tail0.0
3shot of client 9:head:0.06374501992031872, middle:0.0, tail0.0
3shot of client 10:head:0.05307262569832402, middle:0.0, tail0.0
3shot of client 11:head:0.011396011396011397, middle:0.0, tail0.0
3shot of client 12:head:0.005747126436781609, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0026954177897574125, middle:0.010526315789473684, tail0.0
3shot of client 15:head:0.003968253968253968, middle:0.0, tail0.0
3shot of client 16:head:0.0033783783783783786, middle:0.0, tail0.0
3shot of client 17:head:0.0034129692832764505, middle:0.0, tail0.0
3shot of client 18:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.003367003367003367, middle:0.0, tail0.0
round 7, local average test acc  0.0104 

round 7, local macro average F1 score  0.0037 

round 7, local weighted average F1 score  0.0058 

round 7, global test acc  0.3435 

round 7, average 3shot acc: [head: 0.0128, middle: 0.0031, tail: 0.0016] 

round 7, global 3shot acc: [head: 0.7074, middle: 0.4523, tail: 0.0743] 

l_head tensor([2.4208, 1.9355, 3.6043, 0.5818, 3.5831, 3.2223, 3.3097, 1.5884, 3.7405,
        1.7166, 2.2020, 3.8928, 1.9914, 1.9390, 3.3685, 3.1922, 1.8493, 1.5872,
        0.5788, 2.6346, 0.5862, 1.8136, 2.0786, 2.5733, 2.1133, 2.6647, 3.3257,
        4.5949, 0.5829, 3.1267, 2.7871, 0.5800, 1.9338, 0.5706, 4.1016, 3.3543,
        2.5835, 1.7464, 3.5671, 0.5941, 1.5900, 0.5599, 0.5765, 0.5790, 2.3579,
        4.1525, 0.5829, 0.5724, 2.7199, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        2.2800, 0.5970, 2.2781, 2.0425, 0.5762, 0.5941, 1.1171, 0.5795, 2.8176,
        0.5743, 3.1976, 3.9681, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 2.5296, 0.5860, 0.5857, 2.1728, 0.5626, 0.5870, 0.5775,
        0.5576, 2.8053, 0.5745, 0.5812, 0.5788, 2.1035, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 2.3424, 1.8416, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.1627, 2.0348, 2.2168, 2.5774, 2.5479, 1.9643, 1.9445, 2.0909, 1.7796,
        2.0323, 2.0919, 2.3630, 2.1472, 1.9880, 1.8292, 1.9566, 1.9410, 1.8503,
        1.8800, 2.0342, 1.5015, 1.6545, 1.6654, 1.4789, 1.6992, 1.9829, 2.0448,
        1.7589, 1.5772, 1.6395, 1.6011, 1.8036, 1.7073, 1.5735, 1.6683, 1.9762,
        1.6236, 1.6851, 1.7912, 1.3462, 1.8004, 1.3874, 1.7584, 1.9775, 1.6940,
        1.8469, 1.8563, 1.7557, 1.3715, 1.4385, 1.6928, 1.8123, 1.5411, 1.3177,
        1.7632, 1.4764, 1.5043, 1.4356, 1.6398, 1.2612, 1.2681, 1.3933, 1.4457,
        1.4637, 1.2796, 1.0892, 1.3942, 1.3230, 1.2621, 1.3719, 1.4484, 1.0906,
        1.1949, 1.1524, 1.1163, 1.3887, 1.1462, 1.0701, 1.0656, 0.9474, 1.0056,
        0.9705, 1.0380, 0.9548, 0.9790, 1.0283, 0.9758, 1.0096, 0.8413, 0.8839,
        0.8427, 0.8808, 0.8586, 0.7427, 0.9240, 0.7953, 0.7528, 0.8612, 0.8204,
        0.8930], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0026455026455026454, middle:0.0, tail0.0
3shot of client 1:head:0.007889546351084813, middle:0.0, tail0.0
3shot of client 2:head:0.0, middle:0.0, tail0.0
3shot of client 3:head:0.0, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.003913894324853229, middle:0.008, tail0.03125
3shot of client 6:head:0.003401360544217687, middle:0.0, tail0.0
3shot of client 7:head:0.078125, middle:0.0, tail0.0
3shot of client 8:head:0.004555808656036446, middle:0.008547008547008548, tail0.0
3shot of client 9:head:0.05976095617529881, middle:0.0, tail0.0
3shot of client 10:head:0.061452513966480445, middle:0.0, tail0.0
3shot of client 11:head:0.014245014245014245, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.007936507936507936, middle:0.0, tail0.0
3shot of client 16:head:0.0033783783783783786, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.0034129692832764505, middle:0.0, tail0.0
3shot of client 18:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.006734006734006734, middle:0.0, tail0.0
round 8, local average test acc  0.0107 

round 8, local macro average F1 score  0.0039 

round 8, local weighted average F1 score  0.0065 

round 8, global test acc  0.3447 

round 8, average 3shot acc: [head: 0.0135, middle: 0.0016, tail: 0.0016] 

round 8, global 3shot acc: [head: 0.7048, middle: 0.4562, tail: 0.0762] 

l_head tensor([2.4384, 1.9934, 3.7152, 0.5818, 3.6421, 3.2511, 3.4598, 1.7285, 3.7226,
        1.7163, 2.2010, 3.7971, 2.0004, 1.9371, 3.3379, 3.2475, 1.8971, 1.6467,
        0.5788, 2.5584, 0.5862, 1.8052, 2.0648, 2.6301, 2.1611, 2.7191, 3.4945,
        4.5683, 0.5829, 3.1805, 2.7831, 0.5800, 2.0758, 0.5706, 3.9934, 3.6157,
        2.6143, 1.8343, 3.5192, 0.5941, 1.5905, 0.5599, 0.5765, 0.5790, 2.3293,
        4.3543, 0.5829, 0.5724, 2.6672, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        2.4352, 0.5970, 2.3196, 2.1226, 0.5762, 0.5941, 1.1373, 0.5795, 2.7958,
        0.5743, 3.3375, 4.0239, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 2.5714, 0.5860, 0.5857, 2.2756, 0.5626, 0.5870, 0.5775,
        0.5576, 3.0043, 0.5745, 0.5812, 0.5788, 2.1480, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 2.3483, 2.0288, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.1995, 2.0630, 2.2568, 2.6547, 2.5999, 1.9915, 1.9990, 2.1373, 1.8118,
        2.0757, 2.1311, 2.4035, 2.1902, 2.0309, 1.8653, 1.9878, 1.9955, 1.8835,
        1.9095, 2.0580, 1.5271, 1.7365, 1.7010, 1.5203, 1.7226, 2.0006, 2.0705,
        1.7670, 1.6072, 1.6800, 1.6305, 1.8661, 1.7425, 1.6205, 1.7460, 2.0153,
        1.6724, 1.7100, 1.8444, 1.3750, 1.8122, 1.4330, 1.7670, 2.0302, 1.7491,
        1.8905, 1.8868, 1.8081, 1.3738, 1.4741, 1.7085, 1.8404, 1.6058, 1.3457,
        1.7838, 1.5401, 1.5556, 1.4518, 1.7233, 1.2992, 1.2959, 1.4660, 1.5031,
        1.5386, 1.3232, 1.1336, 1.4464, 1.3597, 1.3163, 1.4358, 1.5046, 1.1400,
        1.2671, 1.2056, 1.1803, 1.4212, 1.1750, 1.1142, 1.1094, 0.9911, 1.0480,
        0.9961, 1.0821, 1.0212, 1.0302, 1.0627, 1.0054, 1.0355, 0.8827, 0.9086,
        0.8645, 0.9253, 0.8871, 0.7782, 0.9518, 0.8019, 0.7798, 0.8845, 0.8612,
        0.9327], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.005917159763313609, middle:0.0078125, tail0.0
3shot of client 2:head:0.0, middle:0.0, tail0.0
  2%|▏         | 10/500 [39:25<31:17:43, 229.93s/it]  2%|▏         | 11/500 [43:15<31:15:29, 230.12s/it]3shot of client 3:head:0.0, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.003913894324853229, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.078125, middle:0.0, tail0.0
3shot of client 8:head:0.002277904328018223, middle:0.0, tail0.0
3shot of client 9:head:0.055776892430278883, middle:0.0, tail0.0
3shot of client 10:head:0.061452513966480445, middle:0.011627906976744186, tail0.0
3shot of client 11:head:0.011396011396011397, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.011904761904761904, tail0.0
3shot of client 13:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 14:head:0.005390835579514825, middle:0.010526315789473684, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.0033783783783783786, middle:0.0, tail0.0
3shot of client 17:head:0.0034129692832764505, middle:0.0, tail0.0
3shot of client 18:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.006734006734006734, middle:0.0125, tail0.0
round 9, local average test acc  0.0101 

round 9, local macro average F1 score  0.0037 

round 9, local weighted average F1 score  0.0050 

round 9, global test acc  0.3471 

round 9, average 3shot acc: [head: 0.0126, middle: 0.0027, tail: 0.0000] 

round 9, global 3shot acc: [head: 0.7037, middle: 0.4569, tail: 0.0815] 

l_head tensor([2.4381, 2.1406, 3.7277, 0.5818, 3.7797, 3.2806, 3.4813, 1.7273, 3.7440,
        1.8029, 2.1885, 3.9535, 2.0006, 2.0068, 3.3762, 3.2825, 1.9078, 1.6448,
        0.5788, 2.5604, 0.5862, 1.9420, 2.1317, 2.6586, 2.1546, 2.7705, 3.5358,
        4.6836, 0.5829, 3.1846, 2.8453, 0.5800, 2.1356, 0.5706, 4.0439, 3.6445,
        2.6378, 1.8608, 3.5370, 0.5941, 1.7103, 0.5599, 0.5765, 0.5790, 2.3572,
        4.4388, 0.5829, 0.5724, 2.7298, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        2.4038, 0.5970, 2.4554, 2.1317, 0.5762, 0.5941, 1.1401, 0.5795, 2.8261,
        0.5743, 3.3795, 4.0634, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 2.6554, 0.5860, 0.5857, 2.3678, 0.5626, 0.5870, 0.5775,
        0.5576, 3.0921, 0.5745, 0.5812, 0.5788, 2.1678, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 2.4341, 2.0998, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.2364, 2.0692, 2.2776, 2.6362, 2.6252, 2.0229, 2.0569, 2.1809, 1.8188,
        2.1010, 2.1588, 2.4138, 2.2420, 2.0115, 1.8957, 2.0234, 1.9839, 1.8918,
        1.9154, 2.1425, 1.5608, 1.7512, 1.7343, 1.5366, 1.7448, 2.0441, 2.1226,
        1.8047, 1.6399, 1.7060, 1.6849, 1.8878, 1.8070, 1.6240, 1.7813, 2.0218,
        1.6931, 1.7416, 1.8629, 1.4156, 1.8415, 1.4460, 1.8022, 2.0774, 1.7263,
        1.9454, 1.9022, 1.8604, 1.4148, 1.5216, 1.7556, 1.8606, 1.6562, 1.3655,
        1.8444, 1.5642, 1.5596, 1.5003, 1.7397, 1.3571, 1.3500, 1.4952, 1.5453,
        1.5582, 1.3874, 1.1832, 1.4833, 1.3699, 1.3866, 1.4485, 1.5258, 1.1577,
        1.3243, 1.2528, 1.2127, 1.4673, 1.2172, 1.1325, 1.1543, 1.0379, 1.1116,
        1.0715, 1.1265, 1.0592, 1.0536, 1.1254, 1.0532, 1.0684, 0.9255, 0.9351,
        0.8803, 0.9550, 0.9135, 0.8054, 0.9729, 0.8351, 0.7987, 0.9059, 0.9012,
        0.9581], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.010638297872340425, tail0.0
3shot of client 1:head:0.005917159763313609, middle:0.0078125, tail0.0
3shot of client 2:head:0.0, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.004158004158004158, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.0, tail0.0
3shot of client 5:head:0.0019569471624266144, middle:0.0, tail0.0
3shot of client 6:head:0.006802721088435374, middle:0.0, tail0.0
3shot of client 7:head:0.078125, middle:0.0, tail0.0
3shot of client 8:head:0.004555808656036446, middle:0.0, tail0.0
3shot of client 9:head:0.055776892430278883, middle:0.0, tail0.0
3shot of client 10:head:0.05865921787709497, middle:0.0, tail0.0
3shot of client 11:head:0.011396011396011397, middle:0.011363636363636364, tail0.0
3shot of client 12:head:0.0028735632183908046, middle:0.0, tail0.0
3shot of client 13:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.007936507936507936, middle:0.0, tail0.0
3shot of client 16:head:0.0033783783783783786, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.003367003367003367, middle:0.0, tail0.0
round 10, local average test acc  0.0104 

round 10, local macro average F1 score  0.0031 

round 10, local weighted average F1 score  0.0058 

round 10, global test acc  0.3491 

round 10, average 3shot acc: [head: 0.0129, middle: 0.0029, tail: 0.0000] 

round 10, global 3shot acc: [head: 0.7052, middle: 0.4631, tail: 0.0815] 

l_head tensor([2.4324, 2.1397, 3.7856, 0.5818, 3.7610, 3.3246, 3.5257, 1.8089, 3.7638,
        1.7958, 2.1887, 3.8251, 2.0165, 1.9753, 3.4402, 3.3017, 1.9293, 1.6386,
        0.5788, 2.6501, 0.5862, 1.9413, 2.0970, 2.6316, 2.1584, 2.9065, 3.6516,
        4.7667, 0.5829, 3.1917, 2.9844, 0.5800, 2.0953, 0.5706, 4.2506, 3.6699,
        2.6570, 1.8583, 3.7123, 0.5941, 1.7072, 0.5599, 0.5765, 0.5790, 2.4907,
        4.5061, 0.5829, 0.5724, 2.7266, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        2.4685, 0.5970, 2.4013, 2.1434, 0.5762, 0.5941, 1.1520, 0.5795, 2.9195,
        0.5743, 3.5516, 4.0738, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 2.7144, 0.5860, 0.5857, 2.4098, 0.5626, 0.5870, 0.5775,
        0.5576, 3.1297, 0.5745, 0.5812, 0.5788, 2.2407, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 2.5037, 2.1378, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.2430, 2.0708, 2.3005, 2.6313, 2.6315, 2.0357, 2.0886, 2.2068, 1.8263,
        2.1262, 2.1599, 2.4398, 2.2776, 2.0775, 1.9145, 2.0440, 2.0096, 1.9515,
        1.9533, 2.1065, 1.5663, 1.7713, 1.7573, 1.5568, 1.7814, 2.0756, 2.1625,
        1.8289, 1.6756, 1.7146, 1.7033, 1.9285, 1.8466, 1.6508, 1.8259, 2.0617,
        1.6990, 1.7793, 1.9032, 1.4428, 1.8786, 1.4775, 1.8429, 2.0952, 1.7551,
        1.9758, 1.9288, 1.8960, 1.4458, 1.5301, 1.8291, 1.8803, 1.6977, 1.4054,
        1.9028, 1.6215, 1.5840, 1.5369, 1.7656, 1.4208, 1.3923, 1.5292, 1.5953,
        1.5948, 1.4146, 1.2035, 1.5185, 1.3924, 1.4051, 1.4857, 1.5541, 1.1917,
        1.3665, 1.2787, 1.2499, 1.5035, 1.2580, 1.1743, 1.2096, 1.0695, 1.1340,
        1.1084, 1.1495, 1.1202, 1.0934, 1.1457, 1.0857, 1.1118, 0.9497, 0.9757,
        0.9099, 0.9849, 0.9519, 0.8349, 1.0045, 0.8545, 0.8281, 0.9230, 0.9318,
        0.9782], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.007889546351084813, middle:0.0078125, tail0.0
3shot of client 2:head:0.003355704697986577, middle:0.0, tail0.0
3shot of client 3:head:0.002079002079002079, middle:0.0, tail0.0
3shot of client 4:head:0.004098360655737705, middle:0.0, tail0.0
3shot of client 5:head:0.003913894324853229, middle:0.008, tail0.0
3shot of client 6:head:0.006802721088435374, middle:0.0, tail0.0
3shot of client 7:head:0.08333333333333333, middle:0.0, tail0.0
3shot of client 8:head:0.011389521640091117, middle:0.008547008547008548, tail0.0
3shot of client 9:head:0.055776892430278883, middle:0.0, tail0.0
3shot of client 10:head:0.05307262569832402, middle:0.011627906976744186, tail0.0
3shot of client 11:head:0.014245014245014245, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.0030864197530864196, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.0033783783783783786, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.006734006734006734, middle:0.0, tail0.0
round 11, local average test acc  0.0106 

  2%|▏         | 12/500 [46:56<30:47:50, 227.19s/it]  3%|▎         | 13/500 [50:35<30:23:26, 224.65s/it]round 11, local macro average F1 score  0.0033 

round 11, local weighted average F1 score  0.0062 

round 11, global test acc  0.3521 

round 11, average 3shot acc: [head: 0.0133, middle: 0.0025, tail: 0.0000] 

round 11, global 3shot acc: [head: 0.7048, middle: 0.4646, tail: 0.0872] 

l_head tensor([2.4236, 2.1450, 3.7815, 0.5818, 3.7640, 3.3950, 3.5583, 1.7365, 3.7925,
        1.8020, 2.2715, 3.9607, 2.1377, 1.9712, 3.5328, 3.4363, 1.9215, 1.7423,
        0.5788, 2.5986, 0.5862, 1.9409, 2.1384, 2.6675, 2.2079, 2.9368, 3.7337,
        4.7731, 0.5829, 3.3806, 3.0920, 0.5800, 2.0970, 0.5706, 4.2059, 3.6573,
        2.6838, 1.8764, 3.8106, 0.5941, 1.7070, 0.5599, 0.5765, 0.5790, 2.4355,
        4.5171, 0.5829, 0.5724, 2.7589, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        2.4677, 0.5970, 2.4329, 2.1316, 0.5762, 0.5941, 1.2312, 0.5795, 2.9555,
        0.5743, 3.5319, 4.2506, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 2.7718, 0.5860, 0.5857, 2.4654, 0.5626, 0.5870, 0.5775,
        0.5576, 3.1318, 0.5745, 0.5812, 0.5788, 2.2677, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 2.5390, 2.1755, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.2389, 2.1014, 2.3188, 2.6311, 2.6798, 2.0703, 2.1094, 2.2083, 1.8423,
        2.1496, 2.1897, 2.4530, 2.3024, 2.1110, 1.9525, 2.0643, 2.0377, 1.9532,
        1.9935, 2.1156, 1.5717, 1.8343, 1.7779, 1.5819, 1.8131, 2.1132, 2.1776,
        1.8530, 1.7008, 1.7564, 1.7303, 1.9470, 1.8798, 1.6829, 1.8675, 2.1043,
        1.7829, 1.7972, 1.9246, 1.4582, 1.8887, 1.4862, 1.8710, 2.1332, 1.7685,
        1.9975, 1.9469, 1.9268, 1.4891, 1.5422, 1.8224, 1.9061, 1.7054, 1.4106,
        1.9570, 1.6502, 1.5940, 1.5769, 1.8139, 1.4510, 1.4314, 1.5734, 1.6537,
        1.6434, 1.4745, 1.2496, 1.5572, 1.4194, 1.4513, 1.5071, 1.5984, 1.2005,
        1.4168, 1.2828, 1.2753, 1.5245, 1.2842, 1.2004, 1.2682, 1.0992, 1.1557,
        1.1519, 1.1762, 1.1418, 1.1331, 1.1741, 1.1079, 1.1418, 0.9842, 1.0056,
        0.9283, 1.0168, 0.9761, 0.8578, 1.0318, 0.8803, 0.8618, 0.9360, 0.9600,
        1.0117], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0026455026455026454, middle:0.0, tail0.0
3shot of client 1:head:0.007889546351084813, middle:0.0078125, tail0.0
3shot of client 2:head:0.0, middle:0.0, tail0.0
3shot of client 3:head:0.0, middle:0.0, tail0.0
3shot of client 4:head:0.006147540983606557, middle:0.0, tail0.0
3shot of client 5:head:0.003913894324853229, middle:0.008, tail0.0
3shot of client 6:head:0.01020408163265306, middle:0.0, tail0.0
3shot of client 7:head:0.078125, middle:0.0, tail0.0
3shot of client 8:head:0.004555808656036446, middle:0.008547008547008548, tail0.0
3shot of client 9:head:0.055776892430278883, middle:0.0, tail0.0
3shot of client 10:head:0.055865921787709494, middle:0.0, tail0.0
3shot of client 11:head:0.014245014245014245, middle:0.0, tail0.0
3shot of client 12:head:0.0028735632183908046, middle:0.0, tail0.0
3shot of client 13:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.007936507936507936, middle:0.0, tail0.0
3shot of client 16:head:0.006756756756756757, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.006734006734006734, middle:0.0, tail0.0
round 12, local average test acc  0.0109 

round 12, local macro average F1 score  0.0035 

round 12, local weighted average F1 score  0.0068 

round 12, global test acc  0.3531 

round 12, average 3shot acc: [head: 0.0139, middle: 0.0020, tail: 0.0000] 

round 12, global 3shot acc: [head: 0.7041, middle: 0.4681, tail: 0.0879] 

l_head tensor([2.4293, 2.1412, 3.8214, 0.5818, 3.8839, 3.3982, 3.5980, 1.7803, 3.8029,
        1.8120, 2.2476, 3.9008, 2.1351, 1.9712, 3.5766, 3.3725, 2.0412, 1.7253,
        0.5788, 2.6221, 0.5862, 1.9510, 2.1418, 2.7081, 2.2083, 3.0228, 3.6759,
        4.8028, 0.5829, 3.4178, 3.1912, 0.5800, 2.0976, 0.5706, 4.3283, 3.7700,
        2.7263, 1.8809, 3.9475, 0.5941, 1.7056, 0.5599, 0.5765, 0.5790, 2.5046,
        4.5866, 0.5829, 0.5724, 2.8223, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        2.4758, 0.5970, 2.4460, 2.1319, 0.5762, 0.5941, 1.2311, 0.5795, 2.9303,
        0.5743, 3.5549, 4.2270, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 2.7523, 0.5860, 0.5857, 2.4980, 0.5626, 0.5870, 0.5775,
        0.5576, 3.2703, 0.5745, 0.5812, 0.5788, 2.2881, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 2.5757, 2.2617, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.2519, 2.1293, 2.3595, 2.6423, 2.6742, 2.0813, 2.1030, 2.2231, 1.8567,
        2.1771, 2.2091, 2.4899, 2.3350, 2.1263, 1.9660, 2.1028, 2.0697, 1.9587,
        1.9943, 2.1297, 1.5959, 1.8509, 1.8112, 1.5930, 1.8283, 2.1136, 2.1838,
        1.8718, 1.7422, 1.7721, 1.7735, 1.9714, 1.9070, 1.7080, 1.8831, 2.1057,
        1.7768, 1.8161, 1.9652, 1.4899, 1.9092, 1.4986, 1.9000, 2.1629, 1.8120,
        2.0181, 1.9972, 1.9521, 1.4987, 1.5522, 1.8678, 1.9214, 1.7478, 1.4521,
        1.9928, 1.6852, 1.6099, 1.5935, 1.8407, 1.4866, 1.4618, 1.5918, 1.6731,
        1.7146, 1.5235, 1.2895, 1.5824, 1.4445, 1.5028, 1.5175, 1.6338, 1.2268,
        1.4672, 1.3208, 1.3165, 1.5540, 1.3083, 1.2355, 1.3034, 1.1237, 1.1784,
        1.1851, 1.2136, 1.1844, 1.1622, 1.2191, 1.1167, 1.1644, 1.0115, 1.0247,
        0.9483, 1.0347, 0.9962, 0.8807, 1.0584, 0.8814, 0.8877, 0.9567, 0.9996,
        1.0365], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0026455026455026454, middle:0.0, tail0.0
3shot of client 1:head:0.0039447731755424065, middle:0.0078125, tail0.0
3shot of client 2:head:0.0, middle:0.0, tail0.0
3shot of client 3:head:0.0, middle:0.0, tail0.0
3shot of client 4:head:0.004098360655737705, middle:0.0, tail0.0
3shot of client 5:head:0.003913894324853229, middle:0.0, tail0.0
3shot of client 6:head:0.006802721088435374, middle:0.0, tail0.0
3shot of client 7:head:0.078125, middle:0.0, tail0.0
3shot of client 8:head:0.00683371298405467, middle:0.0, tail0.0
3shot of client 9:head:0.05976095617529881, middle:0.0, tail0.0
3shot of client 10:head:0.055865921787709494, middle:0.0, tail0.0
3shot of client 11:head:0.014245014245014245, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.016129032258064516, tail0.0
3shot of client 16:head:0.0033783783783783786, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.006734006734006734, middle:0.0, tail0.0
round 13, local average test acc  0.0101 

round 13, local macro average F1 score  0.0027 

round 13, local weighted average F1 score  0.0056 

round 13, global test acc  0.3542 

round 13, average 3shot acc: [head: 0.0130, middle: 0.0012, tail: 0.0000] 

round 13, global 3shot acc: [head: 0.7019, middle: 0.4669, tail: 0.0921] 

l_head   3%|▎         | 14/500 [54:11<29:59:40, 222.18s/it]  3%|▎         | 15/500 [57:54<29:57:20, 222.35s/it]tensor([2.4293, 2.1406, 3.9426, 0.5818, 3.8550, 3.3619, 3.5711, 1.7688, 3.7925,
        1.8127, 2.2978, 3.8808, 2.1142, 2.0363, 3.5447, 3.3685, 2.0408, 1.7250,
        0.5788, 2.6842, 0.5862, 1.9508, 2.1418, 2.7071, 2.2081, 3.0870, 3.6492,
        4.8064, 0.5829, 3.4405, 3.2173, 0.5800, 2.0976, 0.5706, 4.3422, 3.7999,
        2.7139, 1.9140, 3.9686, 0.5941, 1.7079, 0.5599, 0.5765, 0.5790, 2.5030,
        4.5430, 0.5829, 0.5724, 2.9118, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        2.4764, 0.5970, 2.5014, 2.1695, 0.5762, 0.5941, 1.2305, 0.5795, 3.0158,
        0.5743, 3.5943, 4.2370, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 2.7842, 0.5860, 0.5857, 2.5214, 0.5626, 0.5870, 0.5775,
        0.5576, 3.4020, 0.5745, 0.5812, 0.5788, 2.3597, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 2.6950, 2.2459, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.2650, 2.1369, 2.4001, 2.6528, 2.6693, 2.0915, 2.1436, 2.2298, 1.8782,
        2.1817, 2.2384, 2.5022, 2.3505, 2.1265, 1.9883, 2.0847, 2.1167, 1.9709,
        2.0047, 2.1484, 1.6226, 1.8717, 1.8204, 1.6304, 1.8338, 2.1355, 2.2118,
        1.8936, 1.7536, 1.7933, 1.8169, 1.9968, 1.9523, 1.7239, 1.9079, 2.0953,
        1.7778, 1.8248, 1.9797, 1.5198, 1.9427, 1.5099, 1.9285, 2.1830, 1.8312,
        2.0541, 2.0282, 1.9919, 1.5235, 1.5796, 1.9132, 1.9505, 1.7643, 1.4793,
        2.0143, 1.7274, 1.6220, 1.6248, 1.8584, 1.5306, 1.4810, 1.6179, 1.6755,
        1.7470, 1.5513, 1.3164, 1.6226, 1.4765, 1.5501, 1.5390, 1.6635, 1.2563,
        1.4920, 1.3423, 1.3575, 1.5855, 1.3313, 1.2928, 1.3373, 1.1556, 1.2079,
        1.2134, 1.2490, 1.2135, 1.1973, 1.2485, 1.1435, 1.1943, 1.0422, 1.0504,
        0.9809, 1.0670, 1.0316, 0.9073, 1.0817, 0.9077, 0.9046, 0.9909, 1.0341,
        1.0616], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.005917159763313609, middle:0.0, tail0.0
3shot of client 2:head:0.0, middle:0.0, tail0.0
3shot of client 3:head:0.002079002079002079, middle:0.0, tail0.0
3shot of client 4:head:0.004098360655737705, middle:0.008695652173913044, tail0.0
3shot of client 5:head:0.0019569471624266144, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.0, tail0.0
3shot of client 7:head:0.078125, middle:0.0, tail0.0
3shot of client 8:head:0.002277904328018223, middle:0.008547008547008548, tail0.0
3shot of client 9:head:0.05976095617529881, middle:0.0, tail0.0
3shot of client 10:head:0.05865921787709497, middle:0.0, tail0.0
3shot of client 11:head:0.014245014245014245, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.023529411764705882, tail0.0
3shot of client 14:head:0.0026954177897574125, middle:0.0, tail0.0
3shot of client 15:head:0.007936507936507936, middle:0.0, tail0.0
3shot of client 16:head:0.0033783783783783786, middle:0.0, tail0.0
3shot of client 17:head:0.0034129692832764505, middle:0.0, tail0.0
3shot of client 18:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.006734006734006734, middle:0.0, tail0.0
round 14, local average test acc  0.0103 

round 14, local macro average F1 score  0.0038 

round 14, local weighted average F1 score  0.0059 

round 14, global test acc  0.3542 

round 14, average 3shot acc: [head: 0.0129, middle: 0.0020, tail: 0.0000] 

round 14, global 3shot acc: [head: 0.6993, middle: 0.4654, tail: 0.0945] 

l_head tensor([2.4623, 2.1406, 3.9350, 0.5818, 3.8206, 3.3988, 3.5812, 1.7689, 3.7645,
        1.8127, 2.2978, 3.9986, 2.1140, 1.9967, 3.5097, 3.4065, 2.0403, 1.7254,
        0.5788, 2.7720, 0.5862, 1.9506, 2.2247, 2.7523, 2.2224, 3.0463, 3.6392,
        4.7611, 0.5829, 3.4698, 3.2741, 0.5800, 2.1000, 0.5706, 4.3650, 3.8348,
        2.7642, 1.9005, 3.9766, 0.5941, 1.7096, 0.5599, 0.5765, 0.5790, 2.5805,
        4.6071, 0.5829, 0.5724, 2.8908, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        2.5906, 0.5970, 2.4953, 2.1411, 0.5762, 0.5941, 1.2327, 0.5795, 3.0080,
        0.5743, 3.6136, 4.3321, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 2.8975, 0.5860, 0.5857, 2.5206, 0.5626, 0.5870, 0.5775,
        0.5576, 3.3572, 0.5745, 0.5812, 0.5788, 2.3569, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 2.7375, 2.2296, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.2819, 2.1397, 2.3741, 2.6388, 2.6741, 2.1114, 2.1475, 2.2216, 1.9289,
        2.1683, 2.2381, 2.5244, 2.3671, 2.1392, 1.9924, 2.1117, 2.1037, 1.9964,
        2.0163, 2.1568, 1.6343, 1.8938, 1.8684, 1.6369, 1.8565, 2.1815, 2.2363,
        1.9013, 1.7475, 1.8039, 1.8081, 2.0035, 1.9654, 1.7546, 1.9134, 2.1205,
        1.7817, 1.8569, 2.0070, 1.5398, 1.9572, 1.5349, 1.9390, 2.2065, 1.8506,
        2.0725, 2.0489, 2.0159, 1.5340, 1.5911, 1.9475, 1.9883, 1.8162, 1.4909,
        2.0541, 1.7646, 1.6395, 1.6427, 1.8904, 1.5405, 1.5087, 1.6285, 1.7187,
        1.7795, 1.5989, 1.3591, 1.6589, 1.4933, 1.5882, 1.5673, 1.6927, 1.2589,
        1.5135, 1.3700, 1.3968, 1.6238, 1.3596, 1.3148, 1.3743, 1.1895, 1.2438,
        1.2469, 1.2818, 1.2438, 1.2222, 1.2590, 1.1611, 1.2168, 1.0636, 1.0823,
        1.0024, 1.0934, 1.0552, 0.9230, 1.1066, 0.9216, 0.9232, 1.0136, 1.0509,
        1.0905], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.0, middle:0.0, tail0.0
3shot of client 1:head:0.0039447731755424065, middle:0.0, tail0.0
3shot of client 2:head:0.0, middle:0.0, tail0.0
3shot of client 3:head:0.0, middle:0.0, tail0.0
3shot of client 4:head:0.0, middle:0.008695652173913044, tail0.0
3shot of client 5:head:0.005870841487279843, middle:0.0, tail0.0
3shot of client 6:head:0.006802721088435374, middle:0.013333333333333334, tail0.0
3shot of client 7:head:0.078125, middle:0.0, tail0.0
3shot of client 8:head:0.004555808656036446, middle:0.0, tail0.0
3shot of client 9:head:0.055776892430278883, middle:0.0, tail0.0
3shot of client 10:head:0.055865921787709494, middle:0.0, tail0.0
3shot of client 11:head:0.014245014245014245, middle:0.0, tail0.0
3shot of client 12:head:0.0028735632183908046, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.011764705882352941, tail0.0
3shot of client 14:head:0.0026954177897574125, middle:0.010526315789473684, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.010135135135135136, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.0, tail0.0
3shot of client 18:head:0.007352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.003367003367003367, middle:0.0, tail0.0
round 15, local average test acc  0.0100 

round 15, local macro average F1 score  0.0030 

round 15, local weighted average F1 score  0.0056 

round 15, global test acc  0.3552 

round 15, average 3shot acc: [head: 0.0126, middle: 0.0022, tail: 0.0000] 

round 15, global 3shot acc: [head: 0.7004, middle: 0.4627, tail: 0.0974] 

l_head tensor([2.4555, 2.1407, 3.9091, 0.5818, 3.8550, 3.4447, 3.6158, 1.8110, 3.7830,
        1.8122, 2.2979, 4.0419, 2.1139, 1.9983, 3.5427, 3.3981, 2.0106, 1.7250,
        0.5788, 2.7620, 0.5862, 1.9537, 2.1938, 2.7666, 2.2683, 3.0400, 3.6686,
        4.7645, 0.5829, 3.5061, 3.3087, 0.5800, 2.1997, 0.5706, 4.3792, 3.9072,
        2.7797, 1.9049, 4.0563, 0.5941, 1.7212, 0.5599, 0.5765, 0.5790, 2.5705,
        4.6170, 0.5829, 0.5724, 2.8908, 0.5783, 0.5892, 0.5791, 0.5660, 0.5785,
        2.6861, 0.5970, 2.4965, 2.1972, 0.5762, 0.5941, 1.2442, 0.5795, 3.0175,
        0.5743, 3.7048, 4.3289, 0.5679, 0.5788, 0.5795, 0.5749, 0.5910, 0.5866,
        0.5625, 0.5778, 2.8826, 0.5860, 0.5857, 2.6391, 0.5626, 0.5870, 0.5775,
        0.5576, 3.3326, 0.5745, 0.5812, 0.5788, 2.3691, 0.5815, 0.5667, 0.5897,
        0.5721, 0.5576, 0.5563, 0.5843, 0.5777, 2.7394, 2.2959, 0.5643, 0.5847,
        0.5696], device='cuda:6', grad_fn=<LinalgVectorNormBackward0>)
g_aux   3%|▎         | 16/500 [1:01:29<29:37:12, 220.32s/it]  3%|▎         | 17/500 [1:05:00<29:10:29, 217.45s/it]
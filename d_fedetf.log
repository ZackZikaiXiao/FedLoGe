nohup: ignoring input
./temp/fl_acc_cifar10_resnet18_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N40_10_seed3407_p1_dirichlet1.0_IF0.01_LossCE.txt
Files already downloaded and verified
[5000, 2997, 1796, 1077, 645, 387, 232, 139, 83, 50]
12406
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[257, 284, 401, 688, 137, 360, 251, 282, 255, 443, 163, 390, 288, 184, 530, 169, 295, 376, 627, 386, 189, 195, 730, 261, 348, 298, 518, 126, 167, 240, 210, 195, 351, 229, 96, 224, 390, 483, 166, 224]
training set distribution:
[[127  47  21  36  13   3   0   9   1   0]
 [ 75  21 102  15   5  36  26   3   1   0]
 [150  95 109  11   0  16   6  14   0   0]
 [336  82 146  42  45  18  11   3   5   0]
 [ 57   4  53   7  12   0   1   2   1   0]
 [ 86 182  12  25   5  43   0   5   2   0]
 [119  56  48  14   1   1   5   1   3   3]
 [ 86  38  56  60  25   0  11   6   0   0]
 [111   1  39  64  28   5   5   1   1   0]
 [112 248  14   3  53   6   0   2   4   1]
 [ 29 100   0   8  11   1   3   9   1   1]
 [125 133  12  82  22   0   8   3   0   5]
 [172  78   3   3  11   7  13   0   0   1]
 [  5 159   4   1   8   1   5   1   0   0]
 [  7 275 188  29   5  15   1   5   1   4]
 [ 16  43  45  29   8   1  14   3   8   2]
 [160  63  38   0   7  14   6   5   2   0]
 [ 37  27 263  39   2   1   2   0   2   3]
 [401  90  28  56   8   8  32   0   1   3]
 [287   4  23  51  10   7   0   1   1   2]
 [  5  85  49  22   9  11   5   3   0   0]
 [  8  83  21  15   6  36   9  11   5   1]
 [347 225  56  40  47   4   1   7   3   0]
 [ 87  54  99   2   8   1   5   2   3   0]
 [242   1  14   6  45  18  12   2   8   0]
 [217  16  15   0  40   6   1   3   0   0]
 [413  41   5  22   2  25   3   3   4   0]
 [ 62  24   6   8  13   1   3   1   8   0]
 [ 61  12  14  37  19  15   0   5   0   4]
 [ 87  37  51  40   8   0  14   0   0   3]
 [ 43  37  36  22  53   7   6   2   4   0]
 [ 73 107   0   0   5   1   1   5   3   0]
 [ 80  74  39 132  18   2   2   0   4   0]
 [ 48  33 105  30   9   0   0   3   0   1]
 [ 14  22  13  16  12   2   0   5   5   7]
 [148  11   0  32  13  12   2   2   0   4]
 [305  17  16   9  22   5  12   2   1   1]
 [224 151  15  35  24  24   3   3   0   4]
 [ 26  82   1  17  11  21   1   6   1   0]
 [ 12 139  37  17   2  13   3   1   0   0]]
Total size of training set
12406
local test distribution:
[[102  37  16  29  10   2   0   7   0   0]
 [ 60  16  82  12   4  29  20   2   0   0]
 [120  76  87   8   0  12   4  11   0   0]
 [270  66 117  33  36  14   8   2   4   0]
 [ 45   3  42   5   9   0   0   1   0   0]
 [ 69 146   9  20   4  34   0   4   1   0]
 [ 95  45  38  11   0   0   4   0   2   2]
 [ 69  30  45  48  20   0   8   4   0   0]
 [ 89   0  31  51  22   4   4   0   0   0]
 [ 90 199  11   2  42   4   0   1   3   0]
 [ 23  80   0   6   8   0   2   7   0   0]
 [100 107   9  66  17   0   6   2   0   4]
 [138  62   2   2   8   5  10   0   0   0]
 [  4 128   3   0   6   0   4   0   0   0]
 [  5 221 151  23   4  12   0   4   0   3]
 [ 12  34  36  23   6   0  11   2   6   1]
 [128  50  30   0   5  11   4   4   1   0]
 [ 29  21 211  31   1   0   1   0   1   2]
 [323  72  22  45   6   6  25   0   0   2]
 [231   3  18  41   8   5   0   0   0   1]
 [  4  68  39  17   7   8   4   2   0   0]
 [  6  66  16  12   4  29   7   8   4   0]
 [279 181  45  32  37   3   0   5   2   0]
 [ 70  43  79   1   6   0   4   1   2   0]
 [195   0  11   4  36  14   9   1   6   0]
 [174  12  12   0  32   4   0   2   0   0]
 [332  33   4  17   1  20   2   2   3   0]
 [ 49  19   4   6  10   0   2   0   6   0]
 [ 49   9  11  29  15  12   0   4   0   3]
 [ 70  29  41  32   6   0  11   0   0   2]
 [ 34  29  29  17  42   5   4   1   3   0]
 [ 58  86   0   0   4   0   0   4   2   0]
 [ 64  59  31 106  14   1   1   0   3   0]
 [ 38  26  84  24   7   0   0   2   0   0]
 [ 11  17  10  12   9   1   0   4   4   5]
 [119   8   0  25  10   9   1   1   0   3]
 [245  13  12   7  17   4   9   1   0   0]
 [180 121  12  28  19  19   2   2   0   3]
 [ 20  66   0  13   8  16   0   4   0   0]
 [  9 112  29  13   1  10   2   0   0   0]]
Total size of testing set
9823
[4008 2393 1429  851  501  293  169   95   53   31]
40
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [02:14<18:36:26, 134.24s/it]  0%|          | 2/500 [04:19<17:47:55, 128.66s/it]3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 2:head:0.024734982332155476, middle:0.0, tail0.0
3shot of client 3:head:0.037527593818984545, middle:0.04819277108433735, tail0.0
3shot of client 4:head:0.04597701149425287, middle:0.0, tail0.0
3shot of client 5:head:0.01606425702811245, middle:0.0, tail0.0
3shot of client 6:head:0.03932584269662921, middle:0.0, tail0.125
3shot of client 7:head:0.015625, middle:0.0, tail0.0
3shot of client 8:head:0.005847953216374269, middle:0.045454545454545456, tail0.0
3shot of client 9:head:0.01384083044982699, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.03663003663003663, middle:0.0, tail0.0
3shot of client 12:head:0.08, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.005376344086021506, middle:0.0, tail0.0
3shot of client 15:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 16:head:0.06741573033707865, middle:0.0, tail0.0
3shot of client 17:head:0.008264462809917356, middle:0.02, tail0.0
3shot of client 18:head:0.06835443037974684, middle:0.0, tail0.0
3shot of client 19:head:0.09523809523809523, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.008130081300813009, middle:0.0, tail0.0
3shot of client 22:head:0.04782608695652174, middle:0.0, tail0.0
3shot of client 23:head:0.078125, middle:0.0, tail0.0
3shot of client 24:head:0.06493506493506493, middle:0.0, tail0.0
3shot of client 25:head:0.11650485436893204, middle:0.0, tail0.0
3shot of client 26:head:0.14759036144578314, middle:0.014285714285714285, tail0.0
3shot of client 27:head:0.038461538461538464, middle:0.0, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 29:head:0.005813953488372093, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.045454545454545456, tail0.0
3shot of client 31:head:0.04861111111111111, middle:0.0, tail0.0
3shot of client 32:head:0.013100436681222707, middle:0.022222222222222223, tail0.0
3shot of client 33:head:0.02702702702702703, middle:0.041666666666666664, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.09722222222222222, middle:0.0, tail0.0
3shot of client 36:head:0.12244897959183673, middle:0.0, tail0.0
3shot of client 37:head:0.03322259136212625, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0070921985815602835, middle:0.0, tail0.0
round 0, local average test acc  0.0315 

round 0, local macro average F1 score  0.0142 

round 0, local weighted average F1 score  0.0447 

round 0, global test acc  0.5635 

round 0, average 3shot acc: [head: 0.0369, middle: 0.0059, tail: 0.0031] 

round 0, global 3shot acc: [head: 0.9037, middle: 0.6743, tail: 0.2252] 

l_head tensor([1.5627, 1.2163, 1.2115, 1.2713, 1.5037, 0.9698, 0.5716, 0.9781, 0.6403,
        0.6530], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.2113, 1.1379, 0.9840, 0.9580, 0.9457, 0.7992, 0.7371, 0.7562, 0.6464,
        0.5941], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.011695906432748537, middle:0.0, tail0.0
3shot of client 2:head:0.028268551236749116, middle:0.0, tail0.0
3shot of client 3:head:0.037527593818984545, middle:0.0, tail0.0
3shot of client 4:head:0.04597701149425287, middle:0.0, tail0.0
3shot of client 5:head:0.004016064257028112, middle:0.0, tail0.0
3shot of client 6:head:0.033707865168539325, middle:0.0, tail0.0
3shot of client 7:head:0.026041666666666668, middle:0.0, tail0.0
3shot of client 8:head:0.011695906432748537, middle:0.045454545454545456, tail0.0
3shot of client 9:head:0.010380622837370242, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.029304029304029304, middle:0.0, tail0.0
3shot of client 12:head:0.08, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.002688172043010753, middle:0.0, tail0.0
3shot of client 15:head:0.009523809523809525, middle:0.043478260869565216, tail0.0
3shot of client 16:head:0.03932584269662921, middle:0.0, tail0.0
3shot of client 17:head:0.004132231404958678, middle:0.02, tail0.0
3shot of client 18:head:0.06835443037974684, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.09956709956709957, middle:0.0, tail0.0
3shot of client 20:head:0.008064516129032258, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.041304347826086954, middle:0.0, tail0.0
3shot of client 23:head:0.010416666666666666, middle:0.0, tail0.0
3shot of client 24:head:0.05627705627705628, middle:0.0, tail0.0
3shot of client 25:head:0.0970873786407767, middle:0.041666666666666664, tail0.0
3shot of client 26:head:0.13253012048192772, middle:0.014285714285714285, tail0.0
3shot of client 27:head:0.038461538461538464, middle:0.0, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 29:head:0.01744186046511628, middle:0.0, tail0.0
3shot of client 30:head:0.014925373134328358, middle:0.0, tail0.125
3shot of client 31:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 32:head:0.013100436681222707, middle:0.0, tail0.0
3shot of client 33:head:0.013513513513513514, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.09027777777777778, middle:0.0, tail0.0
3shot of client 36:head:0.11836734693877551, middle:0.0392156862745098, tail0.0
3shot of client 37:head:0.026578073089700997, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0070921985815602835, middle:0.0, tail0.0
round 1, local average test acc  0.0280 

round 1, local macro average F1 score  0.0169 

round 1, local weighted average F1 score  0.0428 

round 1, global test acc  0.5797 

round 1, average 3shot acc: [head: 0.0328, middle: 0.0054, tail: 0.0031] 

round 1, global 3shot acc: [head: 0.9057, middle: 0.6857, tail: 0.2557] 

l_head tensor([1.9160, 1.3448, 1.3587, 1.5113, 1.3550, 1.0207, 0.5718, 1.2895, 0.7710,
        0.6530], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.3642, 1.2615, 1.1064, 1.1145, 1.0510, 0.8860, 0.8791, 0.8536, 0.7417,
        0.6078], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 2:head:0.024734982332155476, middle:0.0, tail0.0
3shot of client 3:head:0.04194260485651214, middle:0.0, tail0.0
3shot of client 4:head:0.034482758620689655, middle:0.0, tail0.0
3shot of client 5:head:0.008032128514056224, middle:0.0, tail0.0
3shot of client 6:head:0.033707865168539325, middle:0.0, tail0.0
3shot of client 7:head:0.046875, middle:0.0, tail0.0
3shot of client 8:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 9:head:0.01730103806228374, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.014652014652014652, middle:0.0, tail0.0
3shot of client 12:head:0.08, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.02857142857142857, middle:0.043478260869565216, tail0.0
3shot of client 16:head:0.03932584269662921, middle:0.021739130434782608, tail0.0
3shot of client 17:head:0.004132231404958678, middle:0.02, tail0.0
3shot of client 18:head:0.06582278481012659, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.09090909090909091, middle:0.014925373134328358, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.008130081300813009, middle:0.0, tail0.0
3shot of client 22:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 23:head:0.026041666666666668, middle:0.0, tail0.125
3shot of client 24:head:0.06926406926406926, middle:0.029411764705882353, tail0.0
3shot of client 25:head:0.10679611650485436, middle:0.0, tail0.0
  1%|          | 3/500 [06:20<17:18:05, 125.32s/it]  1%|          | 4/500 [08:21<17:02:46, 123.72s/it]  1%|          | 5/500 [10:24<16:57:23, 123.32s/it]3shot of client 26:head:0.13855421686746988, middle:0.02857142857142857, tail0.0
3shot of client 27:head:0.038461538461538464, middle:0.0, tail0.0
3shot of client 28:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 29:head:0.005813953488372093, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.034722222222222224, middle:0.0, tail0.0
3shot of client 32:head:0.021834061135371178, middle:0.0, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.10416666666666667, middle:0.0, tail0.0
3shot of client 36:head:0.11428571428571428, middle:0.0, tail0.0
3shot of client 37:head:0.026578073089700997, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 2, local average test acc  0.0281 

round 2, local macro average F1 score  0.0132 

round 2, local weighted average F1 score  0.0382 

round 2, global test acc  0.5858 

round 2, average 3shot acc: [head: 0.0330, middle: 0.0042, tail: 0.0031] 

round 2, global 3shot acc: [head: 0.9053, middle: 0.6783, tail: 0.2767] 

l_head tensor([1.5792, 1.2870, 1.1680, 1.4944, 1.4580, 1.0428, 0.5721, 1.1988, 0.7424,
        0.6531], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.4963, 1.3342, 1.2010, 1.1951, 1.1290, 0.9417, 0.9443, 0.8913, 0.8317,
        0.6247], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.02976190476190476, middle:0.0, tail0.0
3shot of client 1:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 2:head:0.038869257950530034, middle:0.0, tail0.0
3shot of client 3:head:0.039735099337748346, middle:0.0, tail0.0
3shot of client 4:head:0.04597701149425287, middle:0.0, tail0.0
3shot of client 5:head:0.004016064257028112, middle:0.0, tail0.0
3shot of client 6:head:0.03932584269662921, middle:0.0, tail0.0
3shot of client 7:head:0.015625, middle:0.0, tail0.0
3shot of client 8:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 9:head:0.006920415224913495, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.014652014652014652, middle:0.0, tail0.0
3shot of client 12:head:0.085, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0380952380952381, middle:0.0, tail0.0
3shot of client 16:head:0.033707865168539325, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.02, tail0.0
3shot of client 18:head:0.06835443037974684, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.11255411255411256, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.05, middle:0.0, tail0.0
3shot of client 23:head:0.015625, middle:0.0, tail0.0
3shot of client 24:head:0.08658008658008658, middle:0.029411764705882353, tail0.0
3shot of client 25:head:0.11650485436893204, middle:0.0, tail0.0
3shot of client 26:head:0.14457831325301204, middle:0.014285714285714285, tail0.0
3shot of client 27:head:0.038461538461538464, middle:0.0, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 29:head:0.023255813953488372, middle:0.0, tail0.0
3shot of client 30:head:0.007462686567164179, middle:0.0, tail0.0
3shot of client 31:head:0.034722222222222224, middle:0.0, tail0.0
3shot of client 32:head:0.013100436681222707, middle:0.044444444444444446, tail0.0
3shot of client 33:head:0.02027027027027027, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.11805555555555555, middle:0.0, tail0.0
3shot of client 36:head:0.12653061224489795, middle:0.0392156862745098, tail0.0
3shot of client 37:head:0.03986710963455149, middle:0.0, tail0.05263157894736842
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 3, local average test acc  0.0303 

round 3, local macro average F1 score  0.0112 

round 3, local weighted average F1 score  0.0350 

round 3, global test acc  0.5879 

round 3, average 3shot acc: [head: 0.0360, middle: 0.0040, tail: 0.0013] 

round 3, global 3shot acc: [head: 0.9033, middle: 0.6853, tail: 0.2782] 

l_head tensor([1.8578, 1.3227, 1.2378, 1.6745, 1.4548, 1.1119, 0.5728, 1.1539, 0.7868,
        0.6532], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.6043, 1.3680, 1.2533, 1.2452, 1.1930, 0.9928, 0.9873, 0.9259, 0.9192,
        0.6481], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.011695906432748537, middle:0.0, tail0.0
3shot of client 2:head:0.024734982332155476, middle:0.0, tail0.0
3shot of client 3:head:0.037527593818984545, middle:0.024096385542168676, tail0.0
3shot of client 4:head:0.04597701149425287, middle:0.0, tail0.0
3shot of client 5:head:0.024096385542168676, middle:0.0, tail0.0
3shot of client 6:head:0.03932584269662921, middle:0.09090909090909091, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.0
3shot of client 8:head:0.011695906432748537, middle:0.0, tail0.0
3shot of client 9:head:0.010380622837370242, middle:0.0, tail0.0
3shot of client 10:head:0.009708737864077669, middle:0.0, tail0.0
3shot of client 11:head:0.014652014652014652, middle:0.0, tail0.0
3shot of client 12:head:0.085, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.002688172043010753, middle:0.0, tail0.0
3shot of client 15:head:0.01904761904761905, middle:0.043478260869565216, tail0.0
3shot of client 16:head:0.028089887640449437, middle:0.021739130434782608, tail0.0
3shot of client 17:head:0.004132231404958678, middle:0.02, tail0.0
3shot of client 18:head:0.06835443037974684, middle:0.0, tail0.0
3shot of client 19:head:0.10822510822510822, middle:0.014925373134328358, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.04565217391304348, middle:0.0, tail0.0
3shot of client 23:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 24:head:0.09090909090909091, middle:0.08823529411764706, tail0.0
3shot of client 25:head:0.10679611650485436, middle:0.08333333333333333, tail0.0
3shot of client 26:head:0.14156626506024098, middle:0.014285714285714285, tail0.0
3shot of client 27:head:0.038461538461538464, middle:0.0625, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.041666666666666664, tail0.0
3shot of client 29:head:0.011627906976744186, middle:0.0, tail0.0
3shot of client 30:head:0.007462686567164179, middle:0.0, tail0.0
3shot of client 31:head:0.04861111111111111, middle:0.0, tail0.0
3shot of client 32:head:0.017467248908296942, middle:0.06666666666666667, tail0.0
3shot of client 33:head:0.013513513513513514, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.1111111111111111, middle:0.0, tail0.0
3shot of client 36:head:0.1306122448979592, middle:0.0, tail0.08333333333333333
3shot of client 37:head:0.029900332225913623, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 4, local average test acc  0.0315 

round 4, local macro average F1 score  0.0178 

round 4, local weighted average F1 score  0.0459 

round 4, global test acc  0.5893 

round 4, average 3shot acc: [head: 0.0356, middle: 0.0143, tail: 0.0021] 

round 4, global 3shot acc: [head: 0.9027, middle: 0.6877, tail: 0.2805] 

l_head tensor([1.9098, 1.6606, 1.3029, 1.8994, 1.5303, 1.1458, 0.5738, 1.2295, 0.8876,
        0.6534], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.7145, 1.4188, 1.3276, 1.3228, 1.2440, 1.0467, 1.0260, 0.9590, 0.9983,
        0.6707], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.02976190476190476, middle:0.0, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.0
3shot of client 2:head:0.024734982332155476, middle:0.0, tail0.0
  1%|          | 6/500 [12:26<16:52:16, 122.95s/it]  1%|▏         | 7/500 [14:27<16:46:04, 122.44s/it]3shot of client 3:head:0.03532008830022075, middle:0.012048192771084338, tail0.0
3shot of client 4:head:0.04597701149425287, middle:0.0, tail0.0
3shot of client 5:head:0.012048192771084338, middle:0.0, tail0.0
3shot of client 6:head:0.03932584269662921, middle:0.0, tail0.0
3shot of client 7:head:0.005208333333333333, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.006920415224913495, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.02564102564102564, middle:0.0, tail0.0
3shot of client 12:head:0.085, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0380952380952381, middle:0.043478260869565216, tail0.0
3shot of client 16:head:0.03932584269662921, middle:0.0, tail0.0
3shot of client 17:head:0.004132231404958678, middle:0.02, tail0.0
3shot of client 18:head:0.06582278481012659, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.1038961038961039, middle:0.0, tail0.0
3shot of client 20:head:0.008064516129032258, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.0391304347826087, middle:0.0, tail0.0
3shot of client 23:head:0.036458333333333336, middle:0.0, tail0.0
3shot of client 24:head:0.09090909090909091, middle:0.058823529411764705, tail0.0
3shot of client 25:head:0.10679611650485436, middle:0.041666666666666664, tail0.0
3shot of client 26:head:0.13253012048192772, middle:0.02857142857142857, tail0.0
3shot of client 27:head:0.038461538461538464, middle:0.0625, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.041666666666666664, tail0.0
3shot of client 29:head:0.023255813953488372, middle:0.0, tail0.0
3shot of client 30:head:0.007462686567164179, middle:0.0, tail0.0
3shot of client 31:head:0.04861111111111111, middle:0.0, tail0.0
3shot of client 32:head:0.013100436681222707, middle:0.08888888888888889, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.1111111111111111, middle:0.0, tail0.0
3shot of client 36:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 37:head:0.03986710963455149, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 5, local average test acc  0.0311 

round 5, local macro average F1 score  0.0148 

round 5, local weighted average F1 score  0.0422 

round 5, global test acc  0.5913 

round 5, average 3shot acc: [head: 0.0356, middle: 0.0102, tail: 0.0000] 

round 5, global 3shot acc: [head: 0.8997, middle: 0.6803, tail: 0.2932] 

l_head tensor([2.1303, 1.8566, 1.3876, 1.8806, 1.5837, 1.2227, 0.5742, 1.4011, 0.8623,
        0.6535], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.7921, 1.4672, 1.4075, 1.3723, 1.2922, 1.0772, 1.0686, 0.9977, 1.0709,
        0.6950], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.0
3shot of client 2:head:0.0176678445229682, middle:0.0, tail0.0
3shot of client 3:head:0.039735099337748346, middle:0.012048192771084338, tail0.0
3shot of client 4:head:0.04597701149425287, middle:0.0, tail0.0
3shot of client 5:head:0.024096385542168676, middle:0.0, tail0.0
3shot of client 6:head:0.03932584269662921, middle:0.09090909090909091, tail0.0
3shot of client 7:head:0.03125, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.010380622837370242, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.014652014652014652, middle:0.0, tail0.0
3shot of client 12:head:0.085, middle:0.0, tail0.0
3shot of client 13:head:0.015625, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.02857142857142857, middle:0.0, tail0.0
3shot of client 16:head:0.03932584269662921, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.02, tail0.0
3shot of client 18:head:0.06835443037974684, middle:0.021739130434782608, tail0.0
3shot of client 19:head:0.1038961038961039, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.05217391304347826, middle:0.0, tail0.0
3shot of client 23:head:0.046875, middle:0.0, tail0.0
3shot of client 24:head:0.08225108225108226, middle:0.0, tail0.0
3shot of client 25:head:0.10679611650485436, middle:0.041666666666666664, tail0.0
3shot of client 26:head:0.13855421686746988, middle:0.02857142857142857, tail0.0
3shot of client 27:head:0.05128205128205128, middle:0.0, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.041666666666666664, tail0.0
3shot of client 29:head:0.011627906976744186, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.045454545454545456, tail0.0
3shot of client 31:head:0.04861111111111111, middle:0.0, tail0.0
3shot of client 32:head:0.004366812227074236, middle:0.06666666666666667, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.01694915254237288, middle:0.0, tail0.0
3shot of client 35:head:0.1111111111111111, middle:0.0, tail0.0
3shot of client 36:head:0.1306122448979592, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 6, local average test acc  0.0312 

round 6, local macro average F1 score  0.0136 

round 6, local weighted average F1 score  0.0422 

round 6, global test acc  0.5925 

round 6, average 3shot acc: [head: 0.0363, middle: 0.0092, tail: 0.0000] 

round 6, global 3shot acc: [head: 0.9023, middle: 0.6890, tail: 0.2877] 

l_head tensor([2.1412, 1.8402, 1.4654, 1.9657, 1.5818, 1.2904, 0.5751, 1.2991, 0.9232,
        0.6537], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8539, 1.5003, 1.4443, 1.4269, 1.3284, 1.1225, 1.0873, 1.0088, 1.1202,
        0.7129], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.011695906432748537, middle:0.0, tail0.0
3shot of client 2:head:0.028268551236749116, middle:0.0, tail0.0
3shot of client 3:head:0.04856512141280353, middle:0.012048192771084338, tail0.0
3shot of client 4:head:0.022988505747126436, middle:0.0, tail0.0
3shot of client 5:head:0.01606425702811245, middle:0.0, tail0.0
3shot of client 6:head:0.0449438202247191, middle:0.0, tail0.0
3shot of client 7:head:0.005208333333333333, middle:0.0, tail0.0
3shot of client 8:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 9:head:0.01730103806228374, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.02197802197802198, middle:0.0, tail0.0
3shot of client 12:head:0.085, middle:0.0, tail0.0
3shot of client 13:head:0.0078125, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.01904761904761905, middle:0.043478260869565216, tail0.0
3shot of client 16:head:0.033707865168539325, middle:0.0, tail0.0
3shot of client 17:head:0.004132231404958678, middle:0.02, tail0.0
3shot of client 18:head:0.06835443037974684, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.11255411255411256, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.05263157894736842, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.05652173913043478, middle:0.0, tail0.0
3shot of client 23:head:0.036458333333333336, middle:0.0, tail0.0
3shot of client 24:head:0.09523809523809523, middle:0.08823529411764706, tail0.0
3shot of client 25:head:0.11165048543689321, middle:0.0, tail0.0
3shot of client 26:head:0.14457831325301204, middle:0.014285714285714285, tail0.0
3shot of client 27:head:0.05128205128205128, middle:0.0625, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 29:head:0.011627906976744186, middle:0.0, tail0.0
  2%|▏         | 8/500 [16:28<16:40:37, 122.03s/it]  2%|▏         | 9/500 [18:33<16:45:48, 122.91s/it]  2%|▏         | 10/500 [20:33<16:36:19, 122.00s/it]3shot of client 30:head:0.0, middle:0.045454545454545456, tail0.0
3shot of client 31:head:0.04861111111111111, middle:0.0, tail0.0
3shot of client 32:head:0.004366812227074236, middle:0.08888888888888889, tail0.0
3shot of client 33:head:0.013513513513513514, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.11805555555555555, middle:0.0, tail0.0
3shot of client 36:head:0.13877551020408163, middle:0.0, tail0.0
3shot of client 37:head:0.03986710963455149, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 7, local average test acc  0.0319 

round 7, local macro average F1 score  0.0129 

round 7, local weighted average F1 score  0.0337 

round 7, global test acc  0.5923 

round 7, average 3shot acc: [head: 0.0367, middle: 0.0110, tail: 0.0000] 

round 7, global 3shot acc: [head: 0.9050, middle: 0.6853, tail: 0.2880] 

l_head tensor([2.1393, 1.9823, 1.6387, 2.0888, 1.5995, 1.2814, 0.5762, 1.3375, 0.9923,
        0.6541], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.9189, 1.5185, 1.4731, 1.4664, 1.3628, 1.1569, 1.1079, 1.0185, 1.1651,
        0.7405], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.0
3shot of client 2:head:0.02120141342756184, middle:0.0, tail0.0
3shot of client 3:head:0.037527593818984545, middle:0.0, tail0.0
3shot of client 4:head:0.022988505747126436, middle:0.0, tail0.0
3shot of client 5:head:0.01606425702811245, middle:0.0, tail0.0
3shot of client 6:head:0.03932584269662921, middle:0.0, tail0.0
3shot of client 7:head:0.010416666666666666, middle:0.0, tail0.0
3shot of client 8:head:0.017543859649122806, middle:0.0, tail0.0
3shot of client 9:head:0.006920415224913495, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.047619047619047616, tail0.0
3shot of client 11:head:0.040293040293040296, middle:0.0, tail0.0
3shot of client 12:head:0.085, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 16:head:0.028089887640449437, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.02, tail0.0
3shot of client 18:head:0.07088607594936709, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.11688311688311688, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.05263157894736842, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.03695652173913044, middle:0.0, tail0.0
3shot of client 23:head:0.057291666666666664, middle:0.0, tail0.0
3shot of client 24:head:0.08225108225108226, middle:0.058823529411764705, tail0.0
3shot of client 25:head:0.10679611650485436, middle:0.0, tail0.0
3shot of client 26:head:0.1566265060240964, middle:0.0, tail0.0
3shot of client 27:head:0.05128205128205128, middle:0.0, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.041666666666666664, tail0.0
3shot of client 29:head:0.005813953488372093, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.034722222222222224, middle:0.0, tail0.0
3shot of client 32:head:0.004366812227074236, middle:0.0, tail0.0
3shot of client 33:head:0.013513513513513514, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.13194444444444445, middle:0.0, tail0.0
3shot of client 36:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 37:head:0.04318936877076412, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0070921985815602835, middle:0.03125, tail0.0
round 8, local average test acc  0.0310 

round 8, local macro average F1 score  0.0115 

round 8, local weighted average F1 score  0.0375 

round 8, global test acc  0.5889 

round 8, average 3shot acc: [head: 0.0362, middle: 0.0066, tail: 0.0000] 

round 8, global 3shot acc: [head: 0.9067, middle: 0.6880, tail: 0.2762] 

l_head tensor([2.2229, 2.0301, 1.4880, 2.1505, 1.6654, 1.2892, 0.5767, 1.3609, 1.0472,
        0.6543], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.9691, 1.5463, 1.5189, 1.5102, 1.3919, 1.1804, 1.1174, 1.0193, 1.1974,
        0.7622], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.011695906432748537, middle:0.0, tail0.0
3shot of client 2:head:0.024734982332155476, middle:0.0, tail0.0
3shot of client 3:head:0.04856512141280353, middle:0.012048192771084338, tail0.0
3shot of client 4:head:0.034482758620689655, middle:0.0, tail0.0
3shot of client 5:head:0.008032128514056224, middle:0.0, tail0.0
3shot of client 6:head:0.0449438202247191, middle:0.09090909090909091, tail0.0
3shot of client 7:head:0.015625, middle:0.0, tail0.0
3shot of client 8:head:0.017543859649122806, middle:0.0, tail0.0
3shot of client 9:head:0.020761245674740483, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.018315018315018316, middle:0.0, tail0.0
3shot of client 12:head:0.085, middle:0.0, tail0.1111111111111111
3shot of client 13:head:0.0, middle:0.0, tail0.14285714285714285
3shot of client 14:head:0.002688172043010753, middle:0.0, tail0.0
3shot of client 15:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 16:head:0.03932584269662921, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.02, tail0.0
3shot of client 18:head:0.06835443037974684, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.12987012987012986, middle:0.014925373134328358, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.04565217391304348, middle:0.0, tail0.1
3shot of client 23:head:0.020833333333333332, middle:0.0, tail0.0
3shot of client 24:head:0.10822510822510822, middle:0.08823529411764706, tail0.0
3shot of client 25:head:0.11650485436893204, middle:0.0, tail0.0
3shot of client 26:head:0.1536144578313253, middle:0.04285714285714286, tail0.0
3shot of client 27:head:0.05128205128205128, middle:0.0, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 29:head:0.01744186046511628, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.045454545454545456, tail0.0
3shot of client 31:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 32:head:0.004366812227074236, middle:0.0, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.11805555555555555, middle:0.0, tail0.0
3shot of client 36:head:0.1469387755102041, middle:0.0, tail0.0
3shot of client 37:head:0.03986710963455149, middle:0.0, tail0.0
3shot of client 38:head:0.00980392156862745, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 9, local average test acc  0.0323 

round 9, local macro average F1 score  0.0145 

round 9, local weighted average F1 score  0.0389 

round 9, global test acc  0.5966 

round 9, average 3shot acc: [head: 0.0376, middle: 0.0081, tail: 0.0088] 

round 9, global 3shot acc: [head: 0.9030, middle: 0.6900, tail: 0.2967] 

l_head tensor([2.2695, 1.9845, 1.5187, 2.3102, 1.7175, 1.2808, 0.5772, 1.3983, 1.1072,
        0.6545], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.0114, 1.5729, 1.5466, 1.5468, 1.4227, 1.2149, 1.1546, 1.0434, 1.2234,
        0.7869], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.02976190476190476, middle:0.0, tail0.0
3shot of client 1:head:0.011695906432748537, middle:0.0, tail0.0
3shot of client 2:head:0.02120141342756184, middle:0.0, tail0.0
3shot of client 3:head:0.04415011037527594, middle:0.0, tail0.0
3shot of client 4:head:0.034482758620689655, middle:0.0, tail0.25
3shot of client 5:head:0.020080321285140562, middle:0.0, tail0.0
3shot of client 6:head:0.0449438202247191, middle:0.0, tail0.0
3shot of client 7:head:0.015625, middle:0.0, tail0.0
  2%|▏         | 11/500 [22:34<16:31:06, 121.61s/it]  2%|▏         | 12/500 [24:35<16:27:57, 121.47s/it]3shot of client 8:head:0.011695906432748537, middle:0.0, tail0.0
3shot of client 9:head:0.006920415224913495, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.02564102564102564, middle:0.0, tail0.0
3shot of client 12:head:0.085, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.009523809523809525, middle:0.043478260869565216, tail0.0
3shot of client 16:head:0.0449438202247191, middle:0.0, tail0.0
3shot of client 17:head:0.004132231404958678, middle:0.02, tail0.0
3shot of client 18:head:0.0759493670886076, middle:0.0, tail0.0
3shot of client 19:head:0.12987012987012986, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.05217391304347826, middle:0.0, tail0.0
3shot of client 23:head:0.03125, middle:0.0, tail0.0
3shot of client 24:head:0.10822510822510822, middle:0.0, tail0.0
3shot of client 25:head:0.12135922330097088, middle:0.041666666666666664, tail0.0
3shot of client 26:head:0.17771084337349397, middle:0.0, tail0.0
3shot of client 27:head:0.05128205128205128, middle:0.0, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 29:head:0.01744186046511628, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.13636363636363635, tail0.0
3shot of client 31:head:0.034722222222222224, middle:0.0, tail0.0
3shot of client 32:head:0.008733624454148471, middle:0.022222222222222223, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.14583333333333334, middle:0.0, tail0.0
3shot of client 36:head:0.15510204081632653, middle:0.0, tail0.0
3shot of client 37:head:0.03986710963455149, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.03125, tail0.0
round 10, local average test acc  0.0339 

round 10, local macro average F1 score  0.0156 

round 10, local weighted average F1 score  0.0378 

round 10, global test acc  0.5973 

round 10, average 3shot acc: [head: 0.0396, middle: 0.0074, tail: 0.0063] 

round 10, global 3shot acc: [head: 0.9003, middle: 0.6887, tail: 0.3015] 

l_head tensor([2.2819, 1.9360, 1.5688, 2.3163, 1.7559, 1.3223, 0.5778, 1.4178, 1.0947,
        0.6549], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.0631, 1.6071, 1.6042, 1.5902, 1.4556, 1.2387, 1.1723, 1.0487, 1.2537,
        0.8117], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.017543859649122806, middle:0.020833333333333332, tail0.0
3shot of client 2:head:0.014134275618374558, middle:0.0, tail0.0
3shot of client 3:head:0.03532008830022075, middle:0.012048192771084338, tail0.0
3shot of client 4:head:0.034482758620689655, middle:0.0, tail0.25
3shot of client 5:head:0.020080321285140562, middle:0.0, tail0.0
3shot of client 6:head:0.0449438202247191, middle:0.0, tail0.0
3shot of client 7:head:0.005208333333333333, middle:0.0, tail0.0
3shot of client 8:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 9:head:0.0034602076124567475, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.014652014652014652, middle:0.0, tail0.0
3shot of client 12:head:0.08, middle:0.0, tail0.1111111111111111
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 16:head:0.033707865168539325, middle:0.0, tail0.0
3shot of client 17:head:0.008264462809917356, middle:0.02, tail0.0
3shot of client 18:head:0.07341772151898734, middle:0.0, tail0.0
3shot of client 19:head:0.12554112554112554, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 23:head:0.015625, middle:0.0, tail0.0
3shot of client 24:head:0.09090909090909091, middle:0.029411764705882353, tail0.09090909090909091
3shot of client 25:head:0.0970873786407767, middle:0.0, tail0.0
3shot of client 26:head:0.1536144578313253, middle:0.014285714285714285, tail0.0
3shot of client 27:head:0.05128205128205128, middle:0.0, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 29:head:0.011627906976744186, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.045454545454545456, tail0.0
3shot of client 31:head:0.034722222222222224, middle:0.0, tail0.0
3shot of client 32:head:0.013100436681222707, middle:0.044444444444444446, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.11805555555555555, middle:0.0, tail0.0
3shot of client 36:head:0.1306122448979592, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0070921985815602835, middle:0.0, tail0.0
round 11, local average test acc  0.0297 

round 11, local macro average F1 score  0.0171 

round 11, local weighted average F1 score  0.0425 

round 11, global test acc  0.5925 

round 11, average 3shot acc: [head: 0.0347, middle: 0.0047, tail: 0.0113] 

round 11, global 3shot acc: [head: 0.8993, middle: 0.6907, tail: 0.2887] 

l_head tensor([2.3466, 1.9696, 1.6129, 2.4964, 1.8473, 1.3833, 0.5782, 1.4724, 1.1477,
        0.6551], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.1157, 1.6333, 1.6185, 1.6298, 1.4924, 1.2774, 1.1792, 1.0596, 1.2753,
        0.8432], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.005847953216374269, middle:0.020833333333333332, tail0.0
3shot of client 2:head:0.007067137809187279, middle:0.0, tail0.0
3shot of client 3:head:0.039735099337748346, middle:0.012048192771084338, tail0.0
3shot of client 4:head:0.022988505747126436, middle:0.0, tail0.0
3shot of client 5:head:0.012048192771084338, middle:0.0, tail0.0
3shot of client 6:head:0.033707865168539325, middle:0.0, tail0.0
3shot of client 7:head:0.010416666666666666, middle:0.0, tail0.0
3shot of client 8:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 9:head:0.010380622837370242, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.018315018315018316, middle:0.0, tail0.0
3shot of client 12:head:0.07, middle:0.0, tail0.0
3shot of client 13:head:0.0078125, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.05056179775280899, middle:0.0, tail0.0
3shot of client 17:head:0.004132231404958678, middle:0.02, tail0.0
3shot of client 18:head:0.07088607594936709, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.12987012987012986, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.04, tail0.0
3shot of client 22:head:0.030434782608695653, middle:0.0, tail0.0
3shot of client 23:head:0.020833333333333332, middle:0.0, tail0.0
3shot of client 24:head:0.08658008658008658, middle:0.11764705882352941, tail0.0
3shot of client 25:head:0.0970873786407767, middle:0.08333333333333333, tail0.0
3shot of client 26:head:0.14457831325301204, middle:0.014285714285714285, tail0.0
3shot of client 27:head:0.05128205128205128, middle:0.0, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 29:head:0.011627906976744186, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 32:head:0.004366812227074236, middle:0.044444444444444446, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.1111111111111111, middle:0.0, tail0.0
  3%|▎         | 13/500 [26:41<16:36:16, 122.74s/it]  3%|▎         | 14/500 [28:50<16:48:45, 124.54s/it]  3%|▎         | 15/500 [31:00<17:01:36, 126.39s/it]3shot of client 36:head:0.13877551020408163, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.0, tail0.05263157894736842
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0070921985815602835, middle:0.0, tail0.0
round 12, local average test acc  0.0287 

round 12, local macro average F1 score  0.0128 

round 12, local weighted average F1 score  0.0394 

round 12, global test acc  0.5928 

round 12, average 3shot acc: [head: 0.0333, middle: 0.0091, tail: 0.0013] 

round 12, global 3shot acc: [head: 0.8987, middle: 0.6860, tail: 0.2935] 

l_head tensor([2.5421, 2.0476, 1.6256, 2.5945, 1.8612, 1.5053, 0.5787, 1.5370, 1.2059,
        0.6553], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.1759, 1.6768, 1.6632, 1.6579, 1.5136, 1.3006, 1.2010, 1.0847, 1.2967,
        0.8684], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.017543859649122806, middle:0.0, tail0.0
3shot of client 2:head:0.0176678445229682, middle:0.0, tail0.0
3shot of client 3:head:0.039735099337748346, middle:0.0, tail0.0
3shot of client 4:head:0.034482758620689655, middle:0.0, tail0.25
3shot of client 5:head:0.008032128514056224, middle:0.0, tail0.0
3shot of client 6:head:0.033707865168539325, middle:0.0, tail0.0
3shot of client 7:head:0.010416666666666666, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.01384083044982699, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.029304029304029304, middle:0.0, tail0.0
3shot of client 12:head:0.08, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 16:head:0.0449438202247191, middle:0.0, tail0.0
3shot of client 17:head:0.012396694214876033, middle:0.02, tail0.0
3shot of client 18:head:0.06835443037974684, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.15151515151515152, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.0391304347826087, middle:0.0, tail0.0
3shot of client 23:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 24:head:0.09956709956709957, middle:0.029411764705882353, tail0.0
3shot of client 25:head:0.11165048543689321, middle:0.0, tail0.0
3shot of client 26:head:0.1686746987951807, middle:0.014285714285714285, tail0.0
3shot of client 27:head:0.05128205128205128, middle:0.125, tail0.0
3shot of client 28:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 29:head:0.011627906976744186, middle:0.0, tail0.0
3shot of client 30:head:0.007462686567164179, middle:0.09090909090909091, tail0.0
3shot of client 31:head:0.05555555555555555, middle:0.0, tail0.0
3shot of client 32:head:0.008733624454148471, middle:0.022222222222222223, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.01694915254237288, middle:0.0, tail0.0
3shot of client 35:head:0.125, middle:0.0, tail0.0
3shot of client 36:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.0, tail0.05263157894736842
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 13, local average test acc  0.0330 

round 13, local macro average F1 score  0.0182 

round 13, local weighted average F1 score  0.0493 

round 13, global test acc  0.5994 

round 13, average 3shot acc: [head: 0.0382, middle: 0.0078, tail: 0.0076] 

round 13, global 3shot acc: [head: 0.9050, middle: 0.6883, tail: 0.3035] 

l_head tensor([2.3932, 1.9725, 1.6502, 2.5087, 1.8959, 1.4469, 0.5789, 1.4616, 1.1297,
        0.6555], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.2474, 1.7145, 1.7110, 1.7097, 1.5366, 1.3324, 1.2276, 1.0835, 1.3224,
        0.8829], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.011695906432748537, middle:0.020833333333333332, tail0.0
3shot of client 2:head:0.028268551236749116, middle:0.0, tail0.0
3shot of client 3:head:0.04415011037527594, middle:0.0, tail0.0
3shot of client 4:head:0.04597701149425287, middle:0.0, tail0.25
3shot of client 5:head:0.004016064257028112, middle:0.0, tail0.0
3shot of client 6:head:0.03932584269662921, middle:0.0, tail0.0
3shot of client 7:head:0.010416666666666666, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.0034602076124567475, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.02197802197802198, middle:0.0, tail0.0
3shot of client 12:head:0.085, middle:0.0, tail0.1111111111111111
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 16:head:0.03932584269662921, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.02, tail0.0
3shot of client 18:head:0.06582278481012659, middle:0.0, tail0.0
3shot of client 19:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.05, middle:0.0, tail0.0
3shot of client 23:head:0.010416666666666666, middle:0.0, tail0.125
3shot of client 24:head:0.11255411255411256, middle:0.029411764705882353, tail0.0
3shot of client 25:head:0.13592233009708737, middle:0.08333333333333333, tail0.0
3shot of client 26:head:0.16265060240963855, middle:0.04285714285714286, tail0.0
3shot of client 27:head:0.05128205128205128, middle:0.0, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 29:head:0.01744186046511628, middle:0.0, tail0.0
3shot of client 30:head:0.014925373134328358, middle:0.045454545454545456, tail0.0
3shot of client 31:head:0.041666666666666664, middle:0.0, tail0.16666666666666666
3shot of client 32:head:0.008733624454148471, middle:0.022222222222222223, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.125, middle:0.0, tail0.0
3shot of client 36:head:0.15510204081632653, middle:0.0, tail0.0
3shot of client 37:head:0.03986710963455149, middle:0.0, tail0.05263157894736842
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.03125, tail0.0
round 14, local average test acc  0.0333 

round 14, local macro average F1 score  0.0228 

round 14, local weighted average F1 score  0.0387 

round 14, global test acc  0.5978 

round 14, average 3shot acc: [head: 0.0384, middle: 0.0074, tail: 0.0176] 

round 14, global 3shot acc: [head: 0.9047, middle: 0.6890, tail: 0.2992] 

l_head tensor([2.5505, 2.0105, 1.6911, 2.5535, 1.9164, 1.3849, 0.5806, 1.5510, 1.1875,
        0.6567], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.2922, 1.7380, 1.7320, 1.7371, 1.5816, 1.3596, 1.2300, 1.0992, 1.3457,
        0.9021], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.02976190476190476, middle:0.0, tail0.0
3shot of client 1:head:0.011695906432748537, middle:0.0, tail0.0
3shot of client 2:head:0.0176678445229682, middle:0.043478260869565216, tail0.0
3shot of client 3:head:0.037527593818984545, middle:0.012048192771084338, tail0.0
3shot of client 4:head:0.022988505747126436, middle:0.0, tail0.0
3shot of client 5:head:0.008032128514056224, middle:0.0, tail0.0
3shot of client 6:head:0.033707865168539325, middle:0.0, tail0.0
3shot of client 7:head:0.015625, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.010380622837370242, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.02197802197802198, middle:0.0, tail0.0
3shot of client 12:head:0.085, middle:0.0, tail0.1111111111111111
3shot of client 13:head:0.0, middle:0.0, tail0.0
  3%|▎         | 16/500 [33:07<17:01:36, 126.65s/it]  3%|▎         | 17/500 [35:09<16:46:52, 125.08s/it]3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 16:head:0.05056179775280899, middle:0.0, tail0.0
3shot of client 17:head:0.008264462809917356, middle:0.02, tail0.0
3shot of client 18:head:0.06582278481012659, middle:0.0, tail0.0
3shot of client 19:head:0.1341991341991342, middle:0.014925373134328358, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.04782608695652174, middle:0.0, tail0.0
3shot of client 23:head:0.015625, middle:0.16666666666666666, tail0.125
3shot of client 24:head:0.09956709956709957, middle:0.08823529411764706, tail0.0
3shot of client 25:head:0.10194174757281553, middle:0.08333333333333333, tail0.0
3shot of client 26:head:0.1566265060240964, middle:0.014285714285714285, tail0.0
3shot of client 27:head:0.0641025641025641, middle:0.0625, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 29:head:0.005813953488372093, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.034722222222222224, middle:0.0, tail0.0
3shot of client 32:head:0.008733624454148471, middle:0.0, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.01694915254237288, middle:0.0, tail0.0
3shot of client 35:head:0.125, middle:0.0, tail0.0
3shot of client 36:head:0.12653061224489795, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.03125, tail0.0
round 15, local average test acc  0.0309 

round 15, local macro average F1 score  0.0208 

round 15, local weighted average F1 score  0.0415 

round 15, global test acc  0.5964 

round 15, average 3shot acc: [head: 0.0357, middle: 0.0134, tail: 0.0059] 

round 15, global 3shot acc: [head: 0.8977, middle: 0.6960, tail: 0.2957] 

l_head tensor([2.5705, 1.9571, 1.6610, 2.5666, 1.9322, 1.3917, 0.5811, 1.5591, 1.2524,
        0.6570], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.3491, 1.7679, 1.7648, 1.7607, 1.6032, 1.3898, 1.2376, 1.1095, 1.3640,
        0.9264], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.0
3shot of client 2:head:0.02120141342756184, middle:0.0, tail0.0
3shot of client 3:head:0.037527593818984545, middle:0.0, tail0.0
3shot of client 4:head:0.034482758620689655, middle:0.0, tail0.0
3shot of client 5:head:0.004016064257028112, middle:0.0, tail0.0
3shot of client 6:head:0.03932584269662921, middle:0.0, tail0.125
3shot of client 7:head:0.005208333333333333, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.006920415224913495, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.03663003663003663, middle:0.0, tail0.0
3shot of client 12:head:0.075, middle:0.0, tail0.1111111111111111
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.0449438202247191, middle:0.0, tail0.0
3shot of client 17:head:0.004132231404958678, middle:0.02, tail0.0
3shot of client 18:head:0.06329113924050633, middle:0.0, tail0.0
3shot of client 19:head:0.1341991341991342, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.04565217391304348, middle:0.0, tail0.0
3shot of client 23:head:0.036458333333333336, middle:0.0, tail0.0
3shot of client 24:head:0.09523809523809523, middle:0.0, tail0.0
3shot of client 25:head:0.12135922330097088, middle:0.0, tail0.0
3shot of client 26:head:0.15060240963855423, middle:0.0, tail0.0
3shot of client 27:head:0.0641025641025641, middle:0.0625, tail0.0
3shot of client 28:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 29:head:0.01744186046511628, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.045454545454545456, tail0.0
3shot of client 31:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 32:head:0.008733624454148471, middle:0.0, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.1111111111111111, middle:0.0, tail0.0
3shot of client 36:head:0.1469387755102041, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.03125, tail0.0
round 16, local average test acc  0.0302 

round 16, local macro average F1 score  0.0135 

round 16, local weighted average F1 score  0.0410 

round 16, global test acc  0.5990 

round 16, average 3shot acc: [head: 0.0356, middle: 0.0040, tail: 0.0059] 

round 16, global 3shot acc: [head: 0.9000, middle: 0.6870, tail: 0.3072] 

l_head tensor([2.5975, 2.1051, 1.7151, 2.6023, 2.0068, 1.3762, 0.5833, 1.6724, 1.3358,
        0.6585], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.4036, 1.7931, 1.7913, 1.7934, 1.6445, 1.4100, 1.2623, 1.1225, 1.3809,
        0.9437], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 2:head:0.02120141342756184, middle:0.0, tail0.0
3shot of client 3:head:0.04415011037527594, middle:0.0, tail0.0
3shot of client 4:head:0.05747126436781609, middle:0.0, tail0.0
3shot of client 5:head:0.01606425702811245, middle:0.0, tail0.0
3shot of client 6:head:0.03932584269662921, middle:0.0, tail0.0
3shot of client 7:head:0.010416666666666666, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.006920415224913495, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.03663003663003663, middle:0.0, tail0.0
3shot of client 12:head:0.085, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.14285714285714285
3shot of client 14:head:0.002688172043010753, middle:0.0, tail0.0
3shot of client 15:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 16:head:0.03932584269662921, middle:0.0, tail0.0
3shot of client 17:head:0.008264462809917356, middle:0.02, tail0.0
3shot of client 18:head:0.06582278481012659, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.1341991341991342, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.04, tail0.0
3shot of client 22:head:0.04565217391304348, middle:0.0, tail0.0
3shot of client 23:head:0.026041666666666668, middle:0.0, tail0.0
3shot of client 24:head:0.1038961038961039, middle:0.08823529411764706, tail0.0
3shot of client 25:head:0.13592233009708737, middle:0.0, tail0.0
3shot of client 26:head:0.1536144578313253, middle:0.02857142857142857, tail0.0
3shot of client 27:head:0.0641025641025641, middle:0.0, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 29:head:0.011627906976744186, middle:0.0, tail0.0
3shot of client 30:head:0.007462686567164179, middle:0.045454545454545456, tail0.0
3shot of client 31:head:0.034722222222222224, middle:0.0, tail0.0
3shot of client 32:head:0.008733624454148471, middle:0.06666666666666667, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.125, middle:0.0, tail0.0
3shot of client 36:head:0.15510204081632653, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0070921985815602835, middle:0.0, tail0.0
round 17, local average test acc  0.0334 

round 17, local macro average F1 score  0.0163 

round 17, local weighted average F1 score  0.0409 

round 17, global test acc  0.6013 

  4%|▎         | 18/500 [37:11<16:37:34, 124.18s/it]  4%|▍         | 19/500 [39:15<16:35:27, 124.17s/it]  4%|▍         | 20/500 [41:18<16:31:06, 123.89s/it]round 17, average 3shot acc: [head: 0.0389, middle: 0.0075, tail: 0.0036] 

round 17, global 3shot acc: [head: 0.9007, middle: 0.6793, tail: 0.3182] 

l_head tensor([2.6306, 2.0412, 1.7863, 2.7250, 1.9652, 1.3646, 0.5837, 1.6483, 1.3385,
        0.6589], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.4609, 1.8238, 1.8116, 1.8200, 1.6670, 1.4335, 1.2803, 1.1273, 1.3984,
        0.9601], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.02976190476190476, middle:0.0, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.0
3shot of client 2:head:0.01060070671378092, middle:0.0, tail0.0
3shot of client 3:head:0.03532008830022075, middle:0.012048192771084338, tail0.0
3shot of client 4:head:0.034482758620689655, middle:0.0, tail0.0
3shot of client 5:head:0.020080321285140562, middle:0.0, tail0.0
3shot of client 6:head:0.033707865168539325, middle:0.0, tail0.0
3shot of client 7:head:0.010416666666666666, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.006920415224913495, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.01098901098901099, middle:0.0, tail0.0
3shot of client 12:head:0.08, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 16:head:0.0449438202247191, middle:0.0, tail0.0
3shot of client 17:head:0.008264462809917356, middle:0.02, tail0.0
3shot of client 18:head:0.06582278481012659, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.12554112554112554, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.03260869565217391, middle:0.0, tail0.0
3shot of client 23:head:0.015625, middle:0.0, tail0.0
3shot of client 24:head:0.09956709956709957, middle:0.11764705882352941, tail0.0
3shot of client 25:head:0.12135922330097088, middle:0.041666666666666664, tail0.0
3shot of client 26:head:0.1686746987951807, middle:0.0, tail0.0
3shot of client 27:head:0.038461538461538464, middle:0.0, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 29:head:0.011627906976744186, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.045454545454545456, tail0.0
3shot of client 31:head:0.04861111111111111, middle:0.0, tail0.0
3shot of client 32:head:0.004366812227074236, middle:0.022222222222222223, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.03389830508474576, middle:0.0, tail0.0
3shot of client 35:head:0.11805555555555555, middle:0.0, tail0.0
3shot of client 36:head:0.13877551020408163, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 18, local average test acc  0.0303 

round 18, local macro average F1 score  0.0135 

round 18, local weighted average F1 score  0.0442 

round 18, global test acc  0.6028 

round 18, average 3shot acc: [head: 0.0357, middle: 0.0067, tail: 0.0000] 

round 18, global 3shot acc: [head: 0.8937, middle: 0.7023, tail: 0.3100] 

l_head tensor([2.6342, 2.0351, 1.7862, 2.6087, 1.9500, 1.3685, 0.5839, 1.6482, 1.2820,
        0.6591], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.5141, 1.8430, 1.8409, 1.8538, 1.6969, 1.4598, 1.2839, 1.1267, 1.4074,
        0.9688], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 2:head:0.014134275618374558, middle:0.0, tail0.0
3shot of client 3:head:0.03532008830022075, middle:0.0, tail0.0
3shot of client 4:head:0.022988505747126436, middle:0.0, tail0.0
3shot of client 5:head:0.012048192771084338, middle:0.0, tail0.0
3shot of client 6:head:0.028089887640449437, middle:0.0, tail0.0
3shot of client 7:head:0.005208333333333333, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.006920415224913495, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.018315018315018316, middle:0.0, tail0.0
3shot of client 12:head:0.08, middle:0.0, tail0.1111111111111111
3shot of client 13:head:0.0078125, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 16:head:0.0449438202247191, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.02, tail0.0
3shot of client 18:head:0.06582278481012659, middle:0.021739130434782608, tail0.0
3shot of client 19:head:0.13852813852813853, middle:0.014925373134328358, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.04, tail0.0
3shot of client 22:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 23:head:0.020833333333333332, middle:0.0, tail0.0
3shot of client 24:head:0.10822510822510822, middle:0.11764705882352941, tail0.0
3shot of client 25:head:0.11650485436893204, middle:0.08333333333333333, tail0.0
3shot of client 26:head:0.16265060240963855, middle:0.014285714285714285, tail0.0
3shot of client 27:head:0.05128205128205128, middle:0.0, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 29:head:0.005813953488372093, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.045454545454545456, tail0.0
3shot of client 31:head:0.034722222222222224, middle:0.0, tail0.0
3shot of client 32:head:0.008733624454148471, middle:0.044444444444444446, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.03389830508474576, middle:0.0, tail0.0
3shot of client 35:head:0.1111111111111111, middle:0.0, tail0.0
3shot of client 36:head:0.15918367346938775, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 19, local average test acc  0.0312 

round 19, local macro average F1 score  0.0184 

round 19, local weighted average F1 score  0.0457 

round 19, global test acc  0.6004 

round 19, average 3shot acc: [head: 0.0362, middle: 0.0100, tail: 0.0028] 

round 19, global 3shot acc: [head: 0.8983, middle: 0.6890, tail: 0.3105] 

l_head tensor([2.6323, 2.0764, 1.8398, 2.6043, 1.9631, 1.3137, 0.5857, 1.7082, 1.3481,
        0.6604], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.5696, 1.8659, 1.8534, 1.8865, 1.7323, 1.4720, 1.3002, 1.1344, 1.4206,
        0.9826], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 2:head:0.0176678445229682, middle:0.0, tail0.0
3shot of client 3:head:0.04415011037527594, middle:0.0, tail0.0
3shot of client 4:head:0.022988505747126436, middle:0.0, tail0.0
3shot of client 5:head:0.004016064257028112, middle:0.0, tail0.0
3shot of client 6:head:0.0449438202247191, middle:0.0, tail0.0
3shot of client 7:head:0.005208333333333333, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.006920415224913495, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.040293040293040296, middle:0.0, tail0.0
3shot of client 12:head:0.1, middle:0.0, tail0.1111111111111111
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.002688172043010753, middle:0.0, tail0.0
3shot of client 15:head:0.02857142857142857, middle:0.0, tail0.0
3shot of client 16:head:0.0449438202247191, middle:0.021739130434782608, tail0.0
3shot of client 17:head:0.012396694214876033, middle:0.02, tail0.0
3shot of client 18:head:0.0759493670886076, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.1645021645021645, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
  4%|▍         | 21/500 [43:21<16:27:09, 123.65s/it]  4%|▍         | 22/500 [45:25<16:24:46, 123.61s/it]3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.05652173913043478, middle:0.0, tail0.0
3shot of client 23:head:0.015625, middle:0.0, tail0.0
3shot of client 24:head:0.12121212121212122, middle:0.058823529411764705, tail0.0
3shot of client 25:head:0.13592233009708737, middle:0.0, tail0.0
3shot of client 26:head:0.19879518072289157, middle:0.014285714285714285, tail0.0
3shot of client 27:head:0.05128205128205128, middle:0.0, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 29:head:0.005813953488372093, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.045454545454545456, tail0.0
3shot of client 31:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 32:head:0.004366812227074236, middle:0.044444444444444446, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.01694915254237288, middle:0.0, tail0.0
3shot of client 35:head:0.14583333333333334, middle:0.0, tail0.0
3shot of client 36:head:0.15918367346938775, middle:0.0, tail0.0
3shot of client 37:head:0.03986710963455149, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 20, local average test acc  0.0351 

round 20, local macro average F1 score  0.0121 

round 20, local weighted average F1 score  0.0391 

round 20, global test acc  0.6052 

round 20, average 3shot acc: [head: 0.0416, middle: 0.0054, tail: 0.0028] 

round 20, global 3shot acc: [head: 0.8997, middle: 0.6963, tail: 0.3160] 

l_head tensor([2.8356, 2.1778, 1.8222, 2.6131, 1.9888, 1.3857, 0.5865, 1.7302, 1.4126,
        0.6611], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.6287, 1.8917, 1.8963, 1.9299, 1.7501, 1.4990, 1.3171, 1.1560, 1.4315,
        0.9948], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 2:head:0.02120141342756184, middle:0.0, tail0.0
3shot of client 3:head:0.039735099337748346, middle:0.012048192771084338, tail0.0
3shot of client 4:head:0.022988505747126436, middle:0.0, tail0.0
3shot of client 5:head:0.008032128514056224, middle:0.0, tail0.0
3shot of client 6:head:0.033707865168539325, middle:0.0, tail0.0
3shot of client 7:head:0.005208333333333333, middle:0.0, tail0.0
3shot of client 8:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 9:head:0.006920415224913495, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.05128205128205128, middle:0.0, tail0.0
3shot of client 12:head:0.09, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.0449438202247191, middle:0.0, tail0.0
3shot of client 17:head:0.004132231404958678, middle:0.02, tail0.0
3shot of client 18:head:0.07088607594936709, middle:0.0, tail0.0
3shot of client 19:head:0.16017316017316016, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.04565217391304348, middle:0.0, tail0.0
3shot of client 23:head:0.015625, middle:0.0, tail0.0
3shot of client 24:head:0.10822510822510822, middle:0.029411764705882353, tail0.0
3shot of client 25:head:0.13592233009708737, middle:0.0, tail0.0
3shot of client 26:head:0.18674698795180722, middle:0.0, tail0.0
3shot of client 27:head:0.0641025641025641, middle:0.0, tail0.0
3shot of client 28:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 29:head:0.005813953488372093, middle:0.0, tail0.0
3shot of client 30:head:0.007462686567164179, middle:0.045454545454545456, tail0.0
3shot of client 31:head:0.034722222222222224, middle:0.0, tail0.0
3shot of client 32:head:0.008733624454148471, middle:0.022222222222222223, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.13194444444444445, middle:0.0, tail0.0
3shot of client 36:head:0.15918367346938775, middle:0.0, tail0.08333333333333333
3shot of client 37:head:0.036544850498338874, middle:0.0, tail0.05263157894736842
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 21, local average test acc  0.0327 

round 21, local macro average F1 score  0.0107 

round 21, local weighted average F1 score  0.0379 

round 21, global test acc  0.6056 

round 21, average 3shot acc: [head: 0.0390, middle: 0.0032, tail: 0.0034] 

round 21, global 3shot acc: [head: 0.9007, middle: 0.6967, tail: 0.3160] 

l_head tensor([2.7875, 2.2885, 1.7803, 2.7345, 2.0730, 1.3548, 0.5870, 1.7059, 1.4028,
        0.6614], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.6814, 1.9098, 1.9349, 1.9511, 1.7790, 1.5210, 1.3263, 1.1641, 1.4446,
        1.0173], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.0
3shot of client 2:head:0.024734982332155476, middle:0.0, tail0.0
3shot of client 3:head:0.04194260485651214, middle:0.012048192771084338, tail0.0
3shot of client 4:head:0.04597701149425287, middle:0.0, tail0.0
3shot of client 5:head:0.024096385542168676, middle:0.0, tail0.0
3shot of client 6:head:0.03932584269662921, middle:0.0, tail0.0
3shot of client 7:head:0.010416666666666666, middle:0.0, tail0.0
3shot of client 8:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 9:head:0.010380622837370242, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.029304029304029304, middle:0.0, tail0.0
3shot of client 12:head:0.085, middle:0.0, tail0.0
3shot of client 13:head:0.0078125, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 16:head:0.056179775280898875, middle:0.0, tail0.0
3shot of client 17:head:0.01652892561983471, middle:0.02, tail0.0
3shot of client 18:head:0.06835443037974684, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.04, tail0.0
3shot of client 22:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 23:head:0.036458333333333336, middle:0.16666666666666666, tail0.0
3shot of client 24:head:0.1038961038961039, middle:0.058823529411764705, tail0.0
3shot of client 25:head:0.1407766990291262, middle:0.125, tail0.0
3shot of client 26:head:0.1746987951807229, middle:0.0, tail0.0
3shot of client 27:head:0.05128205128205128, middle:0.0, tail0.0
3shot of client 28:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 29:head:0.01744186046511628, middle:0.0, tail0.0
3shot of client 30:head:0.007462686567164179, middle:0.045454545454545456, tail0.0
3shot of client 31:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 32:head:0.004366812227074236, middle:0.0, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.01694915254237288, middle:0.0, tail0.0
3shot of client 35:head:0.11805555555555555, middle:0.0, tail0.0
3shot of client 36:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 22, local average test acc  0.0340 

round 22, local macro average F1 score  0.0140 

round 22, local weighted average F1 score  0.0429 

round 22, global test acc  0.6044 

round 22, average 3shot acc: [head: 0.0399, middle: 0.0120, tail: 0.0000] 

round 22, global 3shot acc: [head: 0.9010, middle: 0.6997, tail: 0.3105] 

l_head tensor([2.8096, 2.2769, 1.8467, 2.7183, 2.1172, 1.4018, 0.5883, 1.8178, 1.4241,
        0.6624], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux   5%|▍         | 23/500 [47:28<16:21:24, 123.45s/it]  5%|▍         | 24/500 [49:32<16:21:40, 123.74s/it]  5%|▌         | 25/500 [51:36<16:19:32, 123.73s/it]tensor([2.7328, 1.9443, 1.9567, 1.9887, 1.8068, 1.5461, 1.3435, 1.1701, 1.4575,
        1.0360], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.011695906432748537, middle:0.020833333333333332, tail0.0
3shot of client 2:head:0.0176678445229682, middle:0.0, tail0.0
3shot of client 3:head:0.037527593818984545, middle:0.024096385542168676, tail0.0
3shot of client 4:head:0.05747126436781609, middle:0.0, tail0.0
3shot of client 5:head:0.008032128514056224, middle:0.0, tail0.0
3shot of client 6:head:0.03932584269662921, middle:0.0, tail0.0
3shot of client 7:head:0.010416666666666666, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.0034602076124567475, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.03663003663003663, middle:0.0, tail0.0
3shot of client 12:head:0.08, middle:0.0, tail0.0
3shot of client 13:head:0.0078125, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.043478260869565216, tail0.0
3shot of client 16:head:0.05056179775280899, middle:0.021739130434782608, tail0.0
3shot of client 17:head:0.008264462809917356, middle:0.02, tail0.0
3shot of client 18:head:0.06835443037974684, middle:0.021739130434782608, tail0.0
3shot of client 19:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.0391304347826087, middle:0.0, tail0.0
3shot of client 23:head:0.026041666666666668, middle:0.16666666666666666, tail0.0
3shot of client 24:head:0.1038961038961039, middle:0.058823529411764705, tail0.0
3shot of client 25:head:0.13106796116504854, middle:0.0, tail0.0
3shot of client 26:head:0.1536144578313253, middle:0.0, tail0.0
3shot of client 27:head:0.0641025641025641, middle:0.0, tail0.0
3shot of client 28:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 29:head:0.011627906976744186, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.034722222222222224, middle:0.0, tail0.0
3shot of client 32:head:0.013100436681222707, middle:0.0, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.01694915254237288, middle:0.0, tail0.0
3shot of client 35:head:0.1111111111111111, middle:0.0, tail0.0
3shot of client 36:head:0.16326530612244897, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.0, tail0.05263157894736842
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.03125, tail0.0
round 23, local average test acc  0.0326 

round 23, local macro average F1 score  0.0140 

round 23, local weighted average F1 score  0.0423 

round 23, global test acc  0.6040 

round 23, average 3shot acc: [head: 0.0381, middle: 0.0102, tail: 0.0013] 

round 23, global 3shot acc: [head: 0.8990, middle: 0.7000, tail: 0.3107] 

l_head tensor([2.9348, 2.2787, 1.8379, 2.7433, 2.1564, 1.4434, 0.5890, 1.8184, 1.4617,
        0.6631], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.7805, 1.9701, 1.9903, 2.0133, 1.8259, 1.5620, 1.3576, 1.1807, 1.4709,
        1.0474], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 2:head:0.02120141342756184, middle:0.0, tail0.0
3shot of client 3:head:0.04194260485651214, middle:0.012048192771084338, tail0.0
3shot of client 4:head:0.04597701149425287, middle:0.0, tail0.0
3shot of client 5:head:0.012048192771084338, middle:0.0, tail0.0
3shot of client 6:head:0.05056179775280899, middle:0.0, tail0.0
3shot of client 7:head:0.015625, middle:0.0, tail0.0
3shot of client 8:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 9:head:0.010380622837370242, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.018315018315018316, middle:0.0, tail0.0
3shot of client 12:head:0.09, middle:0.05555555555555555, tail0.1111111111111111
3shot of client 13:head:0.0078125, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.05056179775280899, middle:0.0, tail0.0
3shot of client 17:head:0.008264462809917356, middle:0.02, tail0.0
3shot of client 18:head:0.07088607594936709, middle:0.0, tail0.0
3shot of client 19:head:0.1645021645021645, middle:0.014925373134328358, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.04, tail0.0
3shot of client 22:head:0.05, middle:0.0, tail0.0
3shot of client 23:head:0.026041666666666668, middle:0.0, tail0.125
3shot of client 24:head:0.10822510822510822, middle:0.058823529411764705, tail0.0
3shot of client 25:head:0.13106796116504854, middle:0.041666666666666664, tail0.0
3shot of client 26:head:0.18072289156626506, middle:0.0, tail0.0
3shot of client 27:head:0.05128205128205128, middle:0.0, tail0.0
3shot of client 28:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 29:head:0.01744186046511628, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.045454545454545456, tail0.0
3shot of client 31:head:0.05555555555555555, middle:0.0, tail0.0
3shot of client 32:head:0.004366812227074236, middle:0.044444444444444446, tail0.0
3shot of client 33:head:0.013513513513513514, middle:0.0, tail0.0
3shot of client 34:head:0.03389830508474576, middle:0.0, tail0.0
3shot of client 35:head:0.13194444444444445, middle:0.0, tail0.0
3shot of client 36:head:0.16326530612244897, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.0, tail0.05263157894736842
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 24, local average test acc  0.0355 

round 24, local macro average F1 score  0.0188 

round 24, local weighted average F1 score  0.0416 

round 24, global test acc  0.6094 

round 24, average 3shot acc: [head: 0.0414, middle: 0.0083, tail: 0.0072] 

round 24, global 3shot acc: [head: 0.9023, middle: 0.6977, tail: 0.3235] 

l_head tensor([3.0927, 2.3554, 1.8779, 2.8546, 2.2162, 1.4536, 0.5898, 1.8619, 1.5068,
        0.6638], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.8224, 1.9834, 2.0199, 2.0424, 1.8381, 1.5882, 1.3738, 1.1914, 1.4765,
        1.0616], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 2:head:0.02120141342756184, middle:0.0, tail0.0
3shot of client 3:head:0.03532008830022075, middle:0.0, tail0.0
3shot of client 4:head:0.034482758620689655, middle:0.0, tail0.0
3shot of client 5:head:0.008032128514056224, middle:0.0, tail0.0
3shot of client 6:head:0.033707865168539325, middle:0.09090909090909091, tail0.0
3shot of client 7:head:0.010416666666666666, middle:0.0, tail0.0
3shot of client 8:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 9:head:0.0, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.029304029304029304, middle:0.0, tail0.0
3shot of client 12:head:0.085, middle:0.0, tail0.1111111111111111
3shot of client 13:head:0.0078125, middle:0.0, tail0.0
3shot of client 14:head:0.002688172043010753, middle:0.0, tail0.0
3shot of client 15:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 16:head:0.056179775280898875, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.02, tail0.0
3shot of client 18:head:0.060759493670886074, middle:0.0, tail0.0
3shot of client 19:head:0.13852813852813853, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.008130081300813009, middle:0.0, tail0.0
3shot of client 22:head:0.030434782608695653, middle:0.0, tail0.0
3shot of client 23:head:0.03125, middle:0.0, tail0.0
3shot of client 24:head:0.11255411255411256, middle:0.058823529411764705, tail0.0
  5%|▌         | 26/500 [53:40<16:16:50, 123.65s/it]  5%|▌         | 27/500 [55:40<16:06:11, 122.56s/it]  6%|▌         | 28/500 [57:42<16:04:12, 122.57s/it]3shot of client 25:head:0.11650485436893204, middle:0.0, tail0.0
3shot of client 26:head:0.16265060240963855, middle:0.0, tail0.0
3shot of client 27:head:0.038461538461538464, middle:0.0, tail0.0
3shot of client 28:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 29:head:0.01744186046511628, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 32:head:0.004366812227074236, middle:0.0, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.01694915254237288, middle:0.0, tail0.0
3shot of client 35:head:0.1111111111111111, middle:0.0, tail0.0
3shot of client 36:head:0.1469387755102041, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.015151515151515152, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 25, local average test acc  0.0306 

round 25, local macro average F1 score  0.0140 

round 25, local weighted average F1 score  0.0455 

round 25, global test acc  0.6045 

round 25, average 3shot acc: [head: 0.0365, middle: 0.0046, tail: 0.0028] 

round 25, global 3shot acc: [head: 0.8997, middle: 0.6980, tail: 0.3130] 

l_head tensor([3.1138, 2.0868, 1.8822, 2.8970, 2.1749, 1.4761, 0.5907, 1.8195, 1.5808,
        0.6645], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.8830, 2.0126, 2.0508, 2.0715, 1.8755, 1.6200, 1.3816, 1.1934, 1.4932,
        1.0723], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 2:head:0.01060070671378092, middle:0.0, tail0.0
3shot of client 3:head:0.039735099337748346, middle:0.0, tail0.0
3shot of client 4:head:0.034482758620689655, middle:0.0, tail0.0
3shot of client 5:head:0.008032128514056224, middle:0.0, tail0.0
3shot of client 6:head:0.03932584269662921, middle:0.0, tail0.0
3shot of client 7:head:0.015625, middle:0.0, tail0.0
3shot of client 8:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 9:head:0.0, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.03296703296703297, middle:0.0, tail0.0
3shot of client 12:head:0.08, middle:0.0, tail0.1111111111111111
3shot of client 13:head:0.015625, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.06741573033707865, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.02, tail0.0
3shot of client 18:head:0.07341772151898734, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.1471861471861472, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.05263157894736842, tail0.0
3shot of client 21:head:0.0, middle:0.04, tail0.0
3shot of client 22:head:0.03695652173913044, middle:0.0, tail0.0
3shot of client 23:head:0.036458333333333336, middle:0.0, tail0.0
3shot of client 24:head:0.1038961038961039, middle:0.058823529411764705, tail0.0
3shot of client 25:head:0.11650485436893204, middle:0.0, tail0.0
3shot of client 26:head:0.18072289156626506, middle:0.0, tail0.0
3shot of client 27:head:0.0641025641025641, middle:0.0, tail0.0
3shot of client 28:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 29:head:0.005813953488372093, middle:0.0, tail0.0
3shot of client 30:head:0.007462686567164179, middle:0.0, tail0.0
3shot of client 31:head:0.034722222222222224, middle:0.0, tail0.0
3shot of client 32:head:0.008733624454148471, middle:0.022222222222222223, tail0.0
3shot of client 33:head:0.013513513513513514, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.1111111111111111, middle:0.0, tail0.0
3shot of client 36:head:0.1510204081632653, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 26, local average test acc  0.0320 

round 26, local macro average F1 score  0.0141 

round 26, local weighted average F1 score  0.0484 

round 26, global test acc  0.6055 

round 26, average 3shot acc: [head: 0.0379, middle: 0.0051, tail: 0.0028] 

round 26, global 3shot acc: [head: 0.8980, middle: 0.6980, tail: 0.3167] 

l_head tensor([3.0958, 2.1279, 1.8906, 2.8875, 2.1925, 1.4272, 0.5915, 1.9014, 1.5702,
        0.6652], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.9383, 2.0338, 2.0807, 2.1012, 1.8921, 1.6264, 1.4012, 1.2034, 1.5073,
        1.0781], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.023809523809523808, middle:0.0, tail0.0
3shot of client 1:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 2:head:0.024734982332155476, middle:0.0, tail0.0
3shot of client 3:head:0.04415011037527594, middle:0.0, tail0.0
3shot of client 4:head:0.034482758620689655, middle:0.0, tail0.0
3shot of client 5:head:0.008032128514056224, middle:0.0, tail0.0
3shot of client 6:head:0.05056179775280899, middle:0.09090909090909091, tail0.0
3shot of client 7:head:0.005208333333333333, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.0034602076124567475, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.03663003663003663, middle:0.0, tail0.0
3shot of client 12:head:0.085, middle:0.0, tail0.1111111111111111
3shot of client 13:head:0.0234375, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 16:head:0.05056179775280899, middle:0.0, tail0.0
3shot of client 17:head:0.004132231404958678, middle:0.02, tail0.0
3shot of client 18:head:0.08354430379746836, middle:0.021739130434782608, tail0.0
3shot of client 19:head:0.16883116883116883, middle:0.0, tail0.1111111111111111
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.008130081300813009, middle:0.0, tail0.0
3shot of client 22:head:0.041304347826086954, middle:0.0, tail0.0
3shot of client 23:head:0.015625, middle:0.0, tail0.0
3shot of client 24:head:0.12121212121212122, middle:0.029411764705882353, tail0.0
3shot of client 25:head:0.1407766990291262, middle:0.0, tail0.0
3shot of client 26:head:0.18674698795180722, middle:0.0, tail0.0
3shot of client 27:head:0.05128205128205128, middle:0.0625, tail0.0
3shot of client 28:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 29:head:0.011627906976744186, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.034722222222222224, middle:0.0, tail0.0
3shot of client 32:head:0.004366812227074236, middle:0.022222222222222223, tail0.0
3shot of client 33:head:0.013513513513513514, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.11805555555555555, middle:0.0, tail0.0
3shot of client 36:head:0.15918367346938775, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.0, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 27, local average test acc  0.0341 

round 27, local macro average F1 score  0.0136 

round 27, local weighted average F1 score  0.0353 

round 27, global test acc  0.6097 

round 27, average 3shot acc: [head: 0.0404, middle: 0.0062, tail: 0.0056] 

round 27, global 3shot acc: [head: 0.9057, middle: 0.6897, tail: 0.3277] 

l_head tensor([3.1823, 2.1612, 1.9752, 2.9219, 2.2270, 1.5034, 0.5921, 1.8968, 1.6372,
        0.6657], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.9772, 2.0644, 2.1070, 2.1285, 1.9140, 1.6443, 1.4008, 1.2048, 1.5151,
        1.0942], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.011904761904761904, middle:0.0, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.0
3shot of client 2:head:0.007067137809187279, middle:0.043478260869565216, tail0.0
3shot of client 3:head:0.02869757174392936, middle:0.0, tail0.0
  6%|▌         | 29/500 [59:52<16:19:46, 124.81s/it]  6%|▌         | 30/500 [1:02:02<16:30:12, 126.41s/it]3shot of client 4:head:0.034482758620689655, middle:0.0, tail0.0
3shot of client 5:head:0.004016064257028112, middle:0.0, tail0.0
3shot of client 6:head:0.028089887640449437, middle:0.0, tail0.0
3shot of client 7:head:0.015625, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.0034602076124567475, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.03663003663003663, middle:0.0, tail0.0
3shot of client 12:head:0.07, middle:0.0, tail0.1111111111111111
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.03932584269662921, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.02, tail0.0
3shot of client 18:head:0.060759493670886074, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.12987012987012986, middle:0.014925373134328358, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.03260869565217391, middle:0.0, tail0.0
3shot of client 23:head:0.010416666666666666, middle:0.0, tail0.0
3shot of client 24:head:0.1038961038961039, middle:0.08823529411764706, tail0.0
3shot of client 25:head:0.12135922330097088, middle:0.041666666666666664, tail0.0
3shot of client 26:head:0.1566265060240964, middle:0.0, tail0.0
3shot of client 27:head:0.02564102564102564, middle:0.0625, tail0.0
3shot of client 28:head:0.009523809523809525, middle:0.041666666666666664, tail0.0
3shot of client 29:head:0.005813953488372093, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.027777777777777776, middle:0.0, tail0.0
3shot of client 32:head:0.004366812227074236, middle:0.022222222222222223, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.05084745762711865, middle:0.0, tail0.0
3shot of client 35:head:0.1111111111111111, middle:0.0, tail0.0
3shot of client 36:head:0.1306122448979592, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.015151515151515152, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 28, local average test acc  0.0281 

round 28, local macro average F1 score  0.0182 

round 28, local weighted average F1 score  0.0501 

round 28, global test acc  0.6032 

round 28, average 3shot acc: [head: 0.0326, middle: 0.0090, tail: 0.0028] 

round 28, global 3shot acc: [head: 0.8950, middle: 0.7010, tail: 0.3110] 

l_head tensor([3.1497, 2.1717, 2.0108, 2.9715, 2.2216, 1.4822, 0.5928, 1.9139, 1.6679,
        0.6663], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([3.0335, 2.0884, 2.1501, 2.1610, 1.9420, 1.6738, 1.4208, 1.2154, 1.5318,
        1.1187], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.011904761904761904, middle:0.0, tail0.0
3shot of client 1:head:0.0, middle:0.0, tail0.0
3shot of client 2:head:0.014134275618374558, middle:0.0, tail0.0
3shot of client 3:head:0.03090507726269316, middle:0.012048192771084338, tail0.0
3shot of client 4:head:0.04597701149425287, middle:0.0, tail0.0
3shot of client 5:head:0.008032128514056224, middle:0.0, tail0.0
3shot of client 6:head:0.033707865168539325, middle:0.0, tail0.0
3shot of client 7:head:0.005208333333333333, middle:0.0, tail0.0
3shot of client 8:head:0.0, middle:0.0, tail0.0
3shot of client 9:head:0.0, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.029304029304029304, middle:0.0, tail0.0
3shot of client 12:head:0.07, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 16:head:0.056179775280898875, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.02, tail0.0
3shot of client 18:head:0.06329113924050633, middle:0.010869565217391304, tail0.0
3shot of client 19:head:0.14285714285714285, middle:0.014925373134328358, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.008130081300813009, middle:0.04, tail0.0
3shot of client 22:head:0.041304347826086954, middle:0.0, tail0.0
3shot of client 23:head:0.010416666666666666, middle:0.0, tail0.0
3shot of client 24:head:0.10822510822510822, middle:0.029411764705882353, tail0.0
3shot of client 25:head:0.1262135922330097, middle:0.0, tail0.0
3shot of client 26:head:0.18072289156626506, middle:0.0, tail0.0
3shot of client 27:head:0.038461538461538464, middle:0.0, tail0.0
3shot of client 28:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 29:head:0.005813953488372093, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.04861111111111111, middle:0.0, tail0.0
3shot of client 32:head:0.008733624454148471, middle:0.0, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
3shot of client 34:head:0.03389830508474576, middle:0.0, tail0.0
3shot of client 35:head:0.1111111111111111, middle:0.0, tail0.0
3shot of client 36:head:0.15918367346938775, middle:0.0, tail0.0
3shot of client 37:head:0.036544850498338874, middle:0.015151515151515152, tail0.0
3shot of client 38:head:0.0, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.0, tail0.0
round 29, local average test acc  0.0304 

round 29, local macro average F1 score  0.0104 

round 29, local weighted average F1 score  0.0405 

round 29, global test acc  0.6073 

round 29, average 3shot acc: [head: 0.0364, middle: 0.0036, tail: 0.0000] 

round 29, global 3shot acc: [head: 0.8960, middle: 0.7017, tail: 0.3200] 

l_head tensor([3.1197, 2.1745, 1.9937, 2.9601, 2.2669, 1.4816, 0.5931, 1.9443, 1.6266,
        0.6666], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([3.0711, 2.1151, 2.1664, 2.1837, 1.9548, 1.7050, 1.4405, 1.2248, 1.5422,
        1.1301], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.017857142857142856, middle:0.0, tail0.0
3shot of client 1:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 2:head:0.007067137809187279, middle:0.0, tail0.0
3shot of client 3:head:0.037527593818984545, middle:0.024096385542168676, tail0.0
3shot of client 4:head:0.034482758620689655, middle:0.0, tail0.0
3shot of client 5:head:0.008032128514056224, middle:0.0, tail0.0
3shot of client 6:head:0.033707865168539325, middle:0.0, tail0.0
3shot of client 7:head:0.010416666666666666, middle:0.0, tail0.0
3shot of client 8:head:0.005847953216374269, middle:0.0, tail0.0
3shot of client 9:head:0.0, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.05128205128205128, middle:0.0, tail0.0
3shot of client 12:head:0.08, middle:0.0, tail0.0
3shot of client 13:head:0.0234375, middle:0.0, tail0.0
3shot of client 14:head:0.0, middle:0.0, tail0.0
3shot of client 15:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 16:head:0.056179775280898875, middle:0.0, tail0.0
3shot of client 17:head:0.008264462809917356, middle:0.02, tail0.0
3shot of client 18:head:0.07848101265822785, middle:0.0, tail0.0
3shot of client 19:head:0.15584415584415584, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.034782608695652174, middle:0.0, tail0.0
3shot of client 23:head:0.015625, middle:0.0, tail0.0
3shot of client 24:head:0.11255411255411256, middle:0.11764705882352941, tail0.0
3shot of client 25:head:0.12135922330097088, middle:0.0, tail0.0
3shot of client 26:head:0.1716867469879518, middle:0.0, tail0.0
3shot of client 27:head:0.0641025641025641, middle:0.0625, tail0.0
3shot of client 28:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 29:head:0.005813953488372093, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 32:head:0.008733624454148471, middle:0.0, tail0.0
3shot of client 33:head:0.006756756756756757, middle:0.0, tail0.0
  6%|▌         | 31/500 [1:04:07<16:23:06, 125.77s/it]  6%|▋         | 32/500 [1:06:11<16:17:22, 125.31s/it]
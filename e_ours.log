nohup: ignoring input
./temp/fl_acc_cifar100_resnet34_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N20_100_seed3407_p1_dirichlet0.5_IF0.02_LossCE.txt
Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to ./cifar_lt/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 32768/169001437 [00:00<21:43, 129581.64it/s]  0%|          | 65536/169001437 [00:00<21:53, 128610.22it/s]  0%|          | 98304/169001437 [00:00<21:52, 128661.09it/s]  0%|          | 229376/169001437 [00:01<10:01, 280518.65it/s]  0%|          | 458752/169001437 [00:01<05:35, 502981.87it/s]  1%|          | 917504/169001437 [00:01<02:58, 943221.31it/s]  1%|          | 1835008/169001437 [00:01<01:32, 1808802.31it/s]  2%|▏         | 3702784/169001437 [00:02<00:46, 3557864.85it/s]  4%|▍         | 6815744/169001437 [00:02<00:25, 6257438.34it/s]  6%|▌         | 9928704/169001437 [00:02<00:16, 9521220.65it/s]  7%|▋         | 11108352/169001437 [00:02<00:17, 8823374.30it/s]  8%|▊         | 13074432/169001437 [00:02<00:17, 9001917.59it/s] 10%|▉         | 16056320/169001437 [00:02<00:12, 12639271.69it/s] 10%|█         | 17661952/169001437 [00:03<00:13, 10957256.38it/s] 11%|█▏        | 19267584/169001437 [00:03<00:15, 9378523.47it/s]  13%|█▎        | 22347776/169001437 [00:03<00:14, 10239949.48it/s] 15%|█▌        | 25395200/169001437 [00:03<00:13, 10728001.34it/s] 17%|█▋        | 28475392/169001437 [00:04<00:12, 11077483.13it/s] 19%|█▊        | 31621120/169001437 [00:04<00:12, 11401248.56it/s] 21%|██        | 34766848/169001437 [00:04<00:11, 11603903.16it/s] 22%|██▏       | 37781504/169001437 [00:04<00:11, 11611153.79it/s] 24%|██▍       | 40927232/169001437 [00:05<00:10, 11761956.83it/s] 26%|██▌       | 43941888/169001437 [00:05<00:10, 11718646.66it/s] 28%|██▊       | 47087616/169001437 [00:05<00:10, 11807115.53it/s] 30%|██▉       | 50200576/169001437 [00:05<00:09, 11918854.66it/s] 32%|███▏      | 53313536/169001437 [00:06<00:09, 11839135.03it/s] 33%|███▎      | 56459264/169001437 [00:06<00:09, 11904325.16it/s] 35%|███▌      | 59572224/169001437 [00:06<00:09, 12054250.99it/s] 37%|███▋      | 62717952/169001437 [00:07<00:08, 12059766.38it/s] 39%|███▉      | 65830912/169001437 [00:07<00:08, 12163031.07it/s] 41%|████      | 68976640/169001437 [00:07<00:08, 11821802.80it/s] 43%|████▎     | 72089600/169001437 [00:07<00:07, 12313816.68it/s] 45%|████▍     | 75235328/169001437 [00:08<00:07, 11923971.21it/s] 46%|████▋     | 78348288/169001437 [00:08<00:07, 11820998.80it/s] 48%|████▊     | 81428480/169001437 [00:08<00:07, 11810558.79it/s] 50%|████▉     | 84279296/169001437 [00:08<00:06, 14110060.01it/s] 51%|█████     | 85950464/169001437 [00:08<00:06, 12104427.73it/s] 52%|█████▏    | 87457792/169001437 [00:09<00:07, 10636702.76it/s] 53%|█████▎    | 89915392/169001437 [00:09<00:08, 9086290.65it/s]  55%|█████▍    | 92864512/169001437 [00:09<00:06, 10971070.72it/s] 56%|█████▌    | 94142464/169001437 [00:09<00:07, 10435680.22it/s] 57%|█████▋    | 95977472/169001437 [00:09<00:06, 11659829.83it/s] 58%|█████▊    | 97320960/169001437 [00:10<00:06, 10411340.66it/s] 59%|█████▉    | 99319808/169001437 [00:10<00:06, 10743530.75it/s] 59%|█████▉    | 100499456/169001437 [00:10<00:06, 10661839.01it/s] 61%|██████    | 102432768/169001437 [00:10<00:05, 11487433.31it/s] 61%|██████▏   | 103645184/169001437 [00:10<00:05, 11274037.80it/s] 62%|██████▏   | 105447424/169001437 [00:10<00:06, 9812097.41it/s]  64%|██████▍   | 108593152/169001437 [00:11<00:05, 10773153.34it/s] 66%|██████▌   | 111181824/169001437 [00:11<00:04, 13489250.69it/s] 67%|██████▋   | 112754688/169001437 [00:11<00:04, 11980259.44it/s] 68%|██████▊   | 114720768/169001437 [00:11<00:05, 10400912.99it/s] 70%|██████▉   | 117800960/169001437 [00:11<00:04, 10901117.53it/s] 72%|███████▏  | 120913920/169001437 [00:12<00:04, 11245918.25it/s] 73%|███████▎  | 123699200/169001437 [00:12<00:03, 13860102.59it/s] 74%|███████▍  | 125370368/169001437 [00:12<00:03, 12652978.61it/s] 75%|███████▌  | 127139840/169001437 [00:12<00:03, 10656335.30it/s] 77%|███████▋  | 130187264/169001437 [00:12<00:03, 11011787.87it/s] 79%|███████▊  | 132907008/169001437 [00:13<00:02, 13634441.00it/s] 80%|███████▉  | 134578176/169001437 [00:13<00:02, 12397097.66it/s] 81%|████████  | 136413184/169001437 [00:13<00:03, 10566572.61it/s] 83%|████████▎ | 139493376/169001437 [00:13<00:02, 14100737.41it/s] 84%|████████▎ | 141295616/169001437 [00:13<00:02, 11484633.82it/s] 84%|████████▍ | 142770176/169001437 [00:13<00:02, 10600913.68it/s] 86%|████████▌ | 145358848/169001437 [00:14<00:01, 13418368.17it/s] 87%|████████▋ | 147030016/169001437 [00:14<00:01, 12230826.32it/s] 88%|████████▊ | 148537344/169001437 [00:14<00:02, 9874082.34it/s]  90%|████████▉ | 151617536/169001437 [00:14<00:01, 10599886.70it/s] 91%|█████████▏| 154402816/169001437 [00:14<00:01, 13510966.40it/s] 92%|█████████▏| 156106752/169001437 [00:15<00:01, 12306007.81it/s] 93%|█████████▎| 157843456/169001437 [00:15<00:00, 12806831.50it/s] 94%|█████████▍| 159318016/169001437 [00:15<00:00, 11906014.71it/s] 95%|█████████▌| 160956416/169001437 [00:15<00:00, 12766298.31it/s] 96%|█████████▌| 162365440/169001437 [00:15<00:00, 11735340.86it/s] 97%|█████████▋| 164069376/169001437 [00:15<00:00, 12716875.16it/s] 98%|█████████▊| 165445632/169001437 [00:15<00:00, 11319373.11it/s] 99%|█████████▉| 167247872/169001437 [00:16<00:00, 10295430.58it/s]100%|█████████▉| 168787968/169001437 [00:16<00:00, 11027961.69it/s]100%|██████████| 169001437/169001437 [00:16<00:00, 10454249.49it/s]
Extracting ./cifar_lt/cifar-100-python.tar.gz to ./cifar_lt/
[500, 480, 462, 444, 426, 410, 394, 379, 364, 350, 336, 323, 311, 299, 287, 276, 265, 255, 245, 235, 226, 218, 209, 201, 193, 186, 178, 172, 165, 158, 152, 146, 141, 135, 130, 125, 120, 115, 111, 107, 102, 98, 95, 91, 87, 84, 81, 78, 75, 72, 69, 66, 64, 61, 59, 56, 54, 52, 50, 48, 46, 44, 43, 41, 39, 38, 36, 35, 34, 32, 31, 30, 29, 27, 26, 25, 24, 23, 22, 22, 21, 20, 19, 18, 18, 17, 16, 16, 15, 14, 14, 13, 13, 12, 12, 11, 11, 10, 10, 10]
12608
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[557, 682, 644, 784, 649, 592, 581, 632, 626, 509, 613, 1030, 437, 665, 576, 487, 584, 708, 637, 615]
training set distribution:
[[  8   5   0  64  84   6   8  12  13  13   5   0   0  18   8  17   2   4
    6   0  13   0   1  18   0   5   5   3   0   3  21  17   1   1   1  16
    3   0   5   1   4  17   6  14  15   3   2   0   0  10   8   1   1  14
    9   1   1   0   1   2   0   0   0   1   2   1   2   0   1  16   0   3
    0   1   0   5   0   0   3   0   1   2   0   0   0   0   4   0   0   1
    0   0   2   1   3   0   0   5   1   6]
 [ 99   7   6   4  20  53  54  18  40   1   1   2   0  27   8   1   0  31
   11  16   6  17   0  36  24   0   0  20   6   5  10  28   6   0   8  25
    0   2   4   6   0   0   0   0   1   2   7   2   4   5   2   1   1   1
    2   0   6   4   0   1   1   0   0   6   4   0   3   1   2   0   0   0
    0   1   0   2   0   7   0   0   1   1   0   1   2   1   0   0   1   1
    0   0   3   0   1   0   2   0   0   0]
 [ 14  60  19  16   7 102  21  28  18  13   3   0   0   0   0  15  15   5
   30   1  22  16  11   9   3   1  24   0  23   6   7   4   1   2   4   5
    0   4   0  21   1   0   0   0   0   2  35   0   2   0   1  11  10   0
    1   1   0   8  12   0   5   4   0   0   1   3   0   0   0   1   0   0
    1   0   0   1   0   0   1   1   6   0   0   0   1   0   0   0   0   3
    0   0   2   0   0   0   0   0   0   0]
 [ 23  90 124  38   6   4  31   0  17  29   3   8  49   0   7   3   9  37
    2  20   0  11   2   4   2   1  28   0   3  21  10  17   1  12   0   3
   14   5  27   2   0   2   6   7   0  28   2   2   1   0   6   0   1   3
    1   2   0   2   0   1   2   0   9   1   1   2   1   1   0   2   2   1
    0   4   0   0   5   5   1   2   0   1   0   1   3   0   0   0   3   0
    1   1   0   3   0   0   0   1   4   0]
 [  9  95  11   2   8   0  11  13  37  40  10   0  43  20  18   3  10  31
    5   1   0   0   9   0   8   0   0  32  21   3   1  13   2   1  21  15
   47   1   0   1   9   4   1  16   1   1   1   2   0   0   0   4   0   3
    6   1   2   5   1   2  11   1   3   1   2   0   5   0   2   0   6   0
    0   0   0   2   0   1   0   4   2   0   0   0   1   1   1   0   0   0
    0   0   1   2   2   0   0   0   0   0]
 [ 22  45   0  29   1  79  18   0   6   5   5  11   5   5   9   9   5   0
    5  57  10   2  58   7  27   1   2   0   9   8   1   4   0   4   2   0
   10  15   0   1   1   3  11   4   5   1   0   1   2   0   8  11   3  12
    1   5   4   0   3   3   0   0   0   0   3   8   0   0   0   0   0   1
    1   1   1   2   7   0   0   4   0   0   0   0   1   0   1   0   0   0
    0   0   0   0   5   1   0   1   0   0]
 [  5   0  29  42  39  21   0  25   7   8   0  56   2   4   8  33   1   7
   24  83  20   5   0   0   1   0   8  10   0   1   0   1  17   0   3   9
    0   3   3   0  18  20   0   1   0   0   2   5   0   0   3   0   0   0
    4   0   7   4   4  16   5   0   0   0   0   3   0   0   0   0   2   0
    0   1   1   1   0   0   1   0   0   2   0   0   0   1   1   0   0   1
    1   0   0   1   0   1   0   0   0   0]
 [  0  19  30  11   1   4   4  21  14  34  21  60  39   0   0   1   6   2
   22   0  22  13   6   9   1  57   1  12   2   0   3   4  34   6   1   0
   11   8   0   7   4  12   7   0   0  12   0   2  28   5   1   3  15   0
    1   5   6   6   1   2   0   0   4   0   0   0   2   5   1   1   0   5
    2   1   0   0   0   0   0   3   2   0   3   0   0   0   0   2   0   1
    1   0   0   0   0   0   3   0   0   0]
 [ 44  21  13  68  65  11   3  12  15   2   0   5  40   5   0  26  10   4
   24  18  42   2   0   0   1   0   9   1  30   0   0   0   7   1   0   0
    4   2   0   0   0   0   6   1   3   4   7   4   8   1   0   1   3   3
    0   0   2  14   0   0   0  26   2   0   4   2   1   3   9   4   1   9
    1   0   6   0   1   1   0   1   0   0   2   0   0   1   2   1   1   0
    2   1   0   0   1   2   0   0   0   0]
 [  0  17  20  10  51  16   0  31  14   0  13   3   2   0   0   3   0   0
    3   0   3   0   2  30  31  23  14  33   6   1   0   0   5   1   0  23
    0   8   1  13  14  10   5   3   3   1   0   0   4   1   0   5  10   0
    0   0   1   2   7   0   7   1   3   0   1   1   2   7   2   0   1   7
    0   1   0   0   0   1   1   5   5   2   1   1   0   5   3   4   0   0
    0   2   0   0   0   0   0   0   3   0]
 [  0   0  21   3  46  45   0  29  34  35  29   0  12  47   9  10  24  33
    4   2   2  12   0   0   0  13   5   8   5  10  28   4   0   0   7   9
    1   6   4   1   9   1   3   7   0  10   1   0   0   5   0   1   6  12
    0   0   6   0   1   0   4   7   3   3   3   4   0   2   2   1   0   0
    0   5   2   2   0   1   0   0   0   1   2   0   1   3   0   0   1   3
    1   0   0   0   0   0   1   1   0   0]
 [ 90   0  49  11  20   0  27 122   0  13 120   6  11  94  62  34  14   1
    2   0   5  71   4   1   2  13   0  13  25   1   0   0  12   1  32   0
    0  31   7   7   9   1  13   5   1   0   1  10   0   0  33   0   0   0
    2   3   1   0   0   6   3   2   1   1   0   1   1   3   2   2   2   0
    0   1   0   0   0   1  10   1   0   0   1   0   0   0   0   3   1   2
    1   1   2   0   0   2   0   0   0   0]
 [  9  42   6   8  11   8   0   0   3   2  14  24   0   7   0   8   9  29
    0   0   0   9  18   7  21   0   5   8   4  37   1   7   4   5   0   1
    0   0   2   0   8   3   5   0   0   1   0  12   4   5   0  18   0   0
    1   1  13   2   4   1   0   0   6   0   2   0   2   0   5   0   0   1
    7   3   0   2   2   0   0   1   0   3   0   9   0   0   0   0   0   0
    0   0   0   1   0   0   3   0   0   3]
 [ 14  17  59   3   5  32 117   7  77   9   9   2   3   1  69   8  16   2
   11   0  15   9  26   0  21   6   0   0   7   0   2   5  12   0   1  12
    3   1   1   0   0   1   1   0   2   1   3   2   7   0   0   2   0   4
   11   0   2   0   0   0   0   0   0   5   1   4   0   1   0   2   0   0
    0   2   5   2   4   1   0   0   0   7   5   4   0   0   1   1   1   0
    0   1   0   0   0   0   0   0   0   0]
 [ 30  43   9   3   2   0  56   0   2  20   0   6  48  20  20  10   3   8
    6   8  20   1  20   4  12   0  21  10   1   6   5   0  17  14   2   0
   17   0   1   0   0   7   3   0   3   5   9   7   0  30   3   4   6   0
    2   4   0   0   3   4   6   0   2   0   2   0   3   1   0   1   6   0
    0   1   0   1   1   2   2   0   0   0   0   1   3   2   2   0   2   0
    0   2   1   0   0   0   0   0   0   0]
 [  3   5  12  70  23   8   1  11   0   6  22   1   9   0  14   0  33  25
    2   3   0  13   0   3   0   1   0   4   8   2   1   5  10  74   5   0
    0  10  27   0   0   9   4   1   1   1   0   9   0   0   0   0   3   2
    0   0   0   0   1   6   0   2   0   7   3   0   1   0   4   0   0   0
    1   2   5   1   1   2   0   0   1   1   0   0   0   1   0   0   1   2
    0   0   0   4   0   0   0   0   0   0]
 [ 19   2  14   2  11   5   4  22  10  15   3  39   0   1  31   1  15   7
   82   3   0   8   0  45   0   7  14   0   6   6  39   0   1   2   8   4
    1   9   0   5   3   0   0   0  24  11   0  17   0   2   1   0   1   6
   14  12   2   3   2   3   1   1   0   6   4   3   1   0   1   1   2   0
    0   2   2   1   0   0   1   0   0   0   1   1   1   0   1   0   0   0
    6   1   0   0   0   3   0   2   0   0]
 [  7   5  27   0  16   0  21   2   1   4  35  38  34  46   5  82  49   9
    5   4   0  28   1  27   3   6  14  17   5  28  18  23  10   2  29   0
    2   0   3   0   3   1  12   7  19   0   2   1   2   5   2   3   4   1
    2   1   0   2   9   0   1   0   0   2   1   4   4   0   0   0   2   2
    0   1   3   0   1   0   0   0   0   0   0   0   2   1   0   0   0   0
    0   1   1   0   0   0   0   0   0   0]
 [ 87   7  13  49   0   3  11   2   0   1  38  29  12   4  13  10   2  12
    1   0  46   1  19   0  29  52  24   1   2  12   3  13   0   8   6   3
    0  10  21   0  18   0   0  15   0   1   0   2  11   2   1   1   0   0
    0   2   0   0   0   0   0   0   3   5   3   2   7   3   1   0   0   0
    0   0   0   1   1   1   2   0   2   0   4   0   0   0   0   0   0   0
    0   3   0   0   0   0   1   0   1   0]
 [ 17   0   0  11  10  13   7  24  56 100   5  33   2   0   6   2  42   8
    0  19   0   0  32   1   7   0   4   0   2   8   2   1   1   1   0   0
    7   0   5  42   1   7  12  10   9   0   9   0   2   1   0   0   0   0
    2  18   1   0   1   1   0   0   7   3   2   0   1   8   2   1   7   1
   16   0   1   2   1   0   0   0   1   0   0   0   3   1   0   5   4   0
    1   0   1   0   0   2   1   0   1   1]]/data/zikai/aaPFL/pfedlt/util/etf_methods.py:130: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  sparse_etf = torch.tensor(sparse_etf, requires_grad=True)

Total size of training set
12608
local test distribution:
[[ 6  3  0 50 66  4  6  9 10 10  3  0  0 14  6 13  1  3  4  0 10  0  0 14
   0  3  3  2  0  2 16 13  0  0  0 12  2  0  3  0  3 13  4 11 11  2  1  0
   0  7  6  0  0 11  7  0  0  0  0  1  0  0  0  0  1  0  1  0  0 12  0  2
   0  0  0  3  0  0  2  0  0  1  0  0  0  0  3  0  0  0  0  0  1  0  2  0
   0  3  0  4]
 [78  5  4  3 15 42 42 14 31  0  0  1  0 21  6  0  0 24  8 12  4 13  0 28
  19  0  0 15  4  3  7 22  4  0  6 19  0  1  3  4  0  0  0  0  0  1  5  1
   3  3  1  0  0  0  1  0  4  3  0  0  0  0  0  4  3  0  2  0  1  0  0  0
   0  0  0  1  0  5  0  0  0  0  0  0  1  0  0  0  0  0  0  0  2  0  0  0
   1  0  0  0]
 [11 47 15 12  5 80 16 22 14 10  2  0  0  0  0 11 11  3 23  0 17 12  8  7
   2  0 19  0 18  4  5  3  0  1  3  3  0  3  0 16  0  0  0  0  0  1 27  0
   1  0  0  8  7  0  0  0  0  6  9  0  3  3  0  0  0  2  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0  2  0  0  1  0  0  0
   0  0  0  0]
 [18 71 98 30  4  3 24  0 13 23  2  6 38  0  5  2  7 29  1 15  0  8  1  3
   1  0 22  0  2 16  7 13  0  9  0  2 11  3 21  1  0  1  4  5  0 22  1  1
   0  0  4  0  0  2  0  1  0  1  0  0  1  0  7  0  0  1  0  0  0  1  1  0
   0  3  0  0  3  3  0  1  0  0  0  0  2  0  0  0  2  0  0  0  0  2  0  0
   0  0  3  0]
 [ 7 75  8  1  6  0  8 10 29 31  7  0 34 15 14  2  7 24  3  0  0  0  7  0
   6  0  0 25 16  2  0 10  1  0 16 11 37  0  0  0  7  3  0 12  0  0  0  1
   0  0  0  3  0  2  4  0  1  3  0  1  8  0  2  0  1  0  3  0  1  0  4  0
   0  0  0  1  0  0  0  3  1  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0
   0  0  0  0]
 [17 35  0 23  0 62 14  0  4  3  3  8  3  3  7  7  3  0  3 45  7  1 46  5
  21  0  1  0  7  6  0  3  0  3  1  0  7 11  0  0  0  2  8  3  3  0  0  0
   1  0  6  8  2  9  0  3  3  0  2  2  0  0  0  0  2  6  0  0  0  0  0  0
   0  0  0  1  5  0  0  3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  3  0
   0  0  0  0]
 [ 3  0 23 33 30 16  0 19  5  6  0 44  1  3  6 26  0  5 19 65 15  3  0  0
   0  0  6  7  0  0  0  0 13  0  2  7  0  2  2  0 14 15  0  0  0  0  1  3
   0  0  2  0  0  0  3  0  5  3  3 12  3  0  0  0  0  2  0  0  0  0  1  0
   0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0 15 23  8  0  3  3 16 11 26 16 47 30  0  0  0  4  1 17  0 17 10  4  7
   0 45  0  9  1  0  2  3 26  4  0  0  8  6  0  5  3  9  5  0  0  9  0  1
  22  3  0  2 11  0  0  3  4  4  0  1  0  0  3  0  0  0  1  3  0  0  0  3
   1  0  0  0  0  0  0  2  1  0  2  0  0  0  0  1  0  0  0  0  0  0  0  0
   2  0  0  0]
 [34 16 10 53 51  8  2  9 11  1  0  3 31  3  0 20  7  3 19 14 33  1  0  0
   0  0  7  0 23  0  0  0  5  0  0  0  3  1  0  0  0  0  4  0  2  3  5  3
   6  0  0  0  2  2  0  0  1 11  0  0  0 20  1  0  3  1  0  2  7  3  0  7
   0  0  4  0  0  0  0  0  0  0  1  0  0  0  1  0  0  0  1  0  0  0  0  1
   0  0  0  0]
 [ 0 13 15  7 40 12  0 24 11  0 10  2  1  0  0  2  0  0  2  0  2  0  1 23
  24 18 11 26  4  0  0  0  3  0  0 18  0  6  0 10 11  7  3  2  2  0  0  0
   3  0  0  3  7  0  0  0  0  1  5  0  5  0  2  0  0  0  1  5  1  0  0  5
   0  0  0  0  0  0  0  3  3  1  0  0  0  3  2  3  0  0  0  1  0  0  0  0
   0  0  2  0]
 [ 0  0 16  2 36 35  0 23 26 27 23  0  9 37  7  7 19 26  3  1  1  9  0  0
   0 10  3  6  3  7 22  3  0  0  5  7  0  4  3  0  7  0  2  5  0  7  0  0
   0  3  0  0  4  9  0  0  4  0  0  0  3  5  2  2  2  3  0  1  1  0  0  0
   0  3  1  1  0  0  0  0  0  0  1  0  0  2  0  0  0  2  0  0  0  0  0  0
   0  0  0  0]
 [71  0 38  8 15  0 21 96  0 10 95  4  8 74 49 26 11  0  1  0  3 56  3  0
   1 10  0 10 19  0  0  0  9  0 25  0  0 24  5  5  7  0 10  3  0  0  0  7
   0  0 26  0  0  0  1  2  0  0  0  4  2  1  0  0  0  0  0  2  1  1  1  0
   0  0  0  0  0  0  7  0  0  0  0  0  0  0  0  2  0  1  0  0  1  0  0  1
   0  0  0  0]
 [ 7 33  4  6  8  6  0  0  2  1 11 19  0  5  0  6  7 23  0  0  0  7 14  5
  16  0  3  6  3 29  0  5  3  3  0  0  0  0  1  0  6  2  3  0  0  0  0  9
   3  3  0 14  0  0  0  0 10  1  3  0  0  0  4  0  1  0  1  0  3  0  0  0
   5  2  0  1  1  0  0  0  0  2  0  7  0  0  0  0  0  0  0  0  0  0  0  0
   2  0  0  2]
 [11 13 46  2  3 25 92  5 61  7  7  1  2  0 54  6 12  1  8  0 11  7 20  0
  16  4  0  0  5  0  1  3  9  0  0  9  2  0  0  0  0  0  0  0  1  0  2  1
   5  0  0  1  0  3  8  0  1  0  0  0  0  0  0  3  0  3  0  0  0  1  0  0
   0  1  3  1  3  0  0  0  0  5  3  3  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [23 34  7  2  1  0 44  0  1 15  0  4 38 15 15  7  2  6  4  6 15  0 15  3
   9  0 16  7  0  4  3  0 13 11  1  0 13  0  0  0  0  5  2  0  2  3  7  5
   0 23  2  3  4  0  1  3  0  0  2  3  4  0  1  0  1  0  2  0  0  0  4  0
   0  0  0  0  0  1  1  0  0  0  0  0  2  1  1  0  1  0  0  1  0  0  0  0
   0  0  0  0]
 [ 2  3  9 55 18  6  0  8  0  4 17  0  7  0 11  0 26 19  1  2  0 10  0  2
   0  0  0  3  6  1  0  3  7 58  3  0  0  7 21  0  0  7  3  0  0  0  0  7
   0  0  0  0  2  1  0  0  0  0  0  4  0  1  0  5  2  0  0  0  3  0  0  0
   0  1  3  0  0  1  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  3  0  0
   0  0  0  0]
 [15  1 11  1  8  3  3 17  7 11  2 30  0  0 24  0 11  5 65  2  0  6  0 35
   0  5 11  0  4  4 30  0  0  1  6  3  0  7  0  3  2  0  0  0 19  8  0 13
   0  1  0  0  0  4 11  9  1  2  1  2  0  0  0  4  3  2  0  0  0  0  1  0
   0  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  4  0  0  0  0  2
   0  1  0  0]
 [ 5  3 21  0 12  0 16  1  0  3 27 30 26 36  3 65 38  7  3  3  0 22  0 21
   2  4 11 13  3 22 14 18  7  1 23  0  1  0  2  0  2  0  9  5 15  0  1  0
   1  3  1  2  3  0  1  0  0  1  7  0  0  0  0  1  0  3  3  0  0  0  1  1
   0  0  2  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [69  5 10 38  0  2  8  1  0  0 30 23  9  3 10  7  1  9  0  0 36  0 15  0
  23 41 19  0  1  9  2 10  0  6  4  2  0  7 16  0 14  0  0 11  0  0  0  1
   8  1  0  0  0  0  0  1  0  0  0  0  0  0  2  3  2  1  5  2  0  0  0  0
   0  0  0  0  0  0  1  0  1  0  3  0  0  0  0  0  0  0  0  2  0  0  0  0
   0  0  0  0]
 [13  0  0  8  7 10  5 19 44 79  3 26  1  0  4  1 33  6  0 15  0  0 25  0
   5  0  3  0  1  6  1  0  0  0  0  0  5  0  3 33  0  5  9  7  7  0  7  0
   1  0  0  0  0  0  1 14  0  0  0  0  0  0  5  2  1  0  0  6  1  0  5  0
  12  0  0  1  0  0  0  0  0  0  0  0  2  0  0  3  3  0  0  0  0  0  0  1
   0  0  0  0]]
Total size of testing set
9261
[390 372 358 342 325 317 304 293 280 267 258 248 238 229 221 208 200 194
 184 180 171 165 159 153 145 140 135 129 120 115 110 109 100  97  95  93
  89  82  80  77  76  69  66  64  62  56  57  53  54  47  48  44  42  43
  38  36  34  36  32  30  29  30  29  24  22  24  19  21  19  18  18  18
  18  11  14  10  12  10  11  12  10  10  10  10   8   6   7   9   6   6
   5   4   5   6   6   5   5   4   5   6]
20
Step 0, Loss 27.355628967285156
Step 100, Loss 16.60973358154297
Step 200, Loss 9.674871444702148
Step 300, Loss 5.250049591064453
Step 400, Loss 2.4743640422821045
Step 500, Loss 0.7704576253890991
Step 600, Loss -0.2490227222442627
Step 700, Loss -0.8423057794570923
Step 800, Loss -1.178240180015564
Step 900, Loss -1.3633421659469604
Step 1000, Loss -1.4629876613616943
Step 1100, Loss -1.515540599822998
Step 1200, Loss -1.5431041717529297
Step 1300, Loss -1.5575213432312012
Step 1400, Loss -1.5655105113983154
Step 1500, Loss -1.5700610876083374
Step 1600, Loss -1.5727992057800293
Step 1700, Loss -1.5745488405227661
Step 1800, Loss -1.575580358505249
Step 1900, Loss -1.5763167142868042
Step 2000, Loss -1.5767087936401367
Step 2100, Loss -1.5770447254180908
Step 2200, Loss -1.577018141746521
Step 2300, Loss -1.5770992040634155
Step 2400, Loss -1.577258586883545
Step 2500, Loss -1.5771347284317017
Step 2600, Loss -1.5771270990371704
Step 2700, Loss -1.577014684677124
Step 2800, Loss -1.5770723819732666
Step 2900, Loss -1.5768734216690063
Step 3000, Loss -1.5769121646881104
Step 3100, Loss -1.5768561363220215
Step 3200, Loss -1.5768741369247437
Step 3300, Loss -1.5767759084701538
Step 3400, Loss -1.5766690969467163
Step 3500, Loss -1.576790690422058
Step 3600, Loss -1.5766339302062988
Step 3700, Loss -1.5766000747680664
Step 3800, Loss -1.5765576362609863
Step 3900, Loss -1.5765784978866577
Step 4000, Loss -1.57637619972229
Step 4100, Loss -1.5764192342758179
Step 4200, Loss -1.5763863325119019
Step 4300, Loss -1.5763187408447266
Step 4400, Loss -1.5763071775436401
Step 4500, Loss -1.576416015625
Step 4600, Loss -1.5761934518814087
Step 4700, Loss -1.5762805938720703
Step 4800, Loss -1.5763212442398071
Step 4900, Loss -1.576132893562317
Step 5000, Loss -1.5761457681655884
Step 5100, Loss -1.5761759281158447
Step 5200, Loss -1.576148509979248
Step 5300, Loss -1.5761637687683105
Step 5400, Loss -1.575950026512146
Step 5500, Loss -1.5760955810546875
Step 5600, Loss -1.5760759115219116
Step 5700, Loss -1.575990080833435
Step 5800, Loss -1.5760246515274048
Step 5900, Loss -1.5759788751602173
Step 6000, Loss -1.5759074687957764
Step 6100, Loss -1.575985312461853
Step 6200, Loss -1.5758689641952515
Step 6300, Loss -1.5760138034820557
Step 6400, Loss -1.5759414434432983
Step 6500, Loss -1.575939416885376
Step 6600, Loss -1.5758849382400513
Step 6700, Loss -1.5759446620941162
Step 6800, Loss -1.5759390592575073
Step 6900, Loss -1.5758771896362305
Step 7000, Loss -1.5758241415023804
Step 7100, Loss -1.575896978378296
Step 7200, Loss -1.575927972793579
Step 7300, Loss -1.5759170055389404
Step 7400, Loss -1.5759453773498535
Step 7500, Loss -1.575939416885376
Step 7600, Loss -1.5759479999542236
Step 7700, Loss -1.5757759809494019
Step 7800, Loss -1.5758846998214722
Step 7900, Loss -1.5759588479995728
Step 8000, Loss -1.5758463144302368
Step 8100, Loss -1.575894832611084
Step 8200, Loss -1.575897216796875
Step 8300, Loss -1.575930118560791
Step 8400, Loss -1.5759018659591675
Step 8500, Loss -1.5758273601531982
Step 8600, Loss -1.5759283304214478
Step 8700, Loss -1.575969934463501
Step 8800, Loss -1.5759681463241577
Step 8900, Loss -1.5760396718978882
Step 9000, Loss -1.5758421421051025
Step 9100, Loss -1.5758970975875854
Step 9200, Loss -1.575915813446045
Step 9300, Loss -1.5758249759674072
Step 9400, Loss -1.5758435726165771
Step 9500, Loss -1.575903058052063
Step 9600, Loss -1.5758850574493408
Step 9700, Loss -1.575976014137268
Step 9800, Loss -1.5759036540985107
Step 9900, Loss -1.5760186910629272
Angle Mean: 90.57801818847656, Angle Variance: 0.04306474328041077
Norm Mean: 0.10024339705705643, Norm Variance: 2.2041140024242623e-09
  0%|          | 0/500 [00:00<?, ?it/s]
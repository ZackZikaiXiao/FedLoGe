nohup: ignoring input
/data/zikai/aaPFL/pfedlt/util/etf_methods.py:130: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  sparse_etf = torch.tensor(sparse_etf, requires_grad=True)
./temp/fl_acc_cifar10_resnet18_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N40_10_seed3407_p1_dirichlet1.0_IF0.02_LossCE.txt
Files already downloaded and verified
[5000, 3237, 2096, 1357, 878, 568, 368, 238, 154, 100]
13996
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[265, 279, 338, 591, 172, 409, 312, 232, 279, 477, 176, 429, 333, 411, 584, 232, 421, 272, 720, 416, 259, 196, 674, 238, 312, 303, 589, 331, 154, 215, 204, 284, 372, 384, 146, 430, 472, 449, 308, 328]
training set distribution:
[[127  56   2  49   3   1   9  10   2   6]
 [ 75  21  22  64  83   0   0   8   6   0]
 [150 102  20  38   2   2   5  12   3   4]
 [336  88  59   5  53  27  21   0   1   1]
 [ 57   4  51  17   8  22   7   2   3   1]
 [ 86 196   4  65   5   4  23  21   3   2]
 [119  59  26  28   4  50   3  20   2   1]
 [ 86  41  21  27  22   1  33   1   0   0]
 [111   1 123  28   6   5   1   2   2   0]
 [112 275  41  25  12   2   2   7   0   1]
 [ 29 106   2   1  20   3   0  11   4   0]
 [125 146 107   7  22  15   3   2   0   2]
 [172  80  24  13   7  11   3  19   3   1]
 [  5 175 119  16  16  37  36   4   0   3]
 [  7 296 153  93   2   5   8  12   3   5]
 [ 16  44   2  39  74  33   0   5  16   3]
 [160  68  76  46  21   8  29   7   6   0]
 [ 37  29 119  32  10  27   4   6   6   2]
 [401  98  92  60  52  12   3   0   1   1]
 [287   4  30  41  12   4  19   7   8   4]
 [  5  91  60  78   1   2   4   1   2  15]
 [  8  90  39  18  11  20   1   0   8   1]
 [347 247  32   1  20  10   1   6  10   0]
 [ 87  55  45  14   4  20   0  11   0   2]
 [242   1  15  16   7   4   7  15   0   5]
 [217  18  26   9  12   8   5   0   8   0]
 [413  42  33  39  35   9   1   6   1  10]
 [ 62  25  81  33  83  31   4  10   2   0]
 [ 61  13   9   2  12  34   7   2   0  14]
 [ 87  39   2  18  39  20   2   0   6   2]
 [ 43  38   7  51  20  36   3   3   2   1]
 [ 73 116  40  11   9  16  11   2   6   0]
 [ 80  83 136  16  26  21   5   4   0   1]
 [ 48  36 221  19  47   3   4   1   4   1]
 [ 14  24  32  37   2   6  18   5   7   1]
 [148  13 108 116   1   9  24   4   7   0]
 [305  17  47  62  21   3   7   1   6   3]
 [224 158  29   9   2   3  15   5   4   0]
 [ 26  88  20  75  29  38  12   4  10   6]
 [ 12 154  21  39  63   6  28   2   2   1]]
Total size of training set
13996
local test distribution:
[[ 90  40   1  35   2   0   6   7   1   4]
 [ 53  15  15  45  59   0   0   5   4   0]
 [107  72  14  27   1   1   3   8   2   2]
 [240  62  42   3  37  19  15   0   0   0]
 [ 40   2  36  12   5  15   5   1   2   0]
 [ 61 140   2  46   3   2  16  15   2   1]
 [ 85  42  18  20   2  35   2  14   1   0]
 [ 61  29  15  19  15   0  23   0   0   0]
 [ 79   0  87  20   4   3   0   1   1   0]
 [ 80 196  29  17   8   1   1   5   0   0]
 [ 20  75   1   0  14   2   0   7   2   0]
 [ 89 104  76   5  15  10   2   1   0   1]
 [122  57  17   9   5   7   2  13   2   0]
 [  3 125  85  11  11  26  25   2   0   2]
 [  5 211 109  66   1   3   5   8   2   3]
 [ 11  31   1  27  52  23   0   3  11   2]
 [114  48  54  32  15   5  20   5   4   0]
 [ 26  20  85  22   7  19   2   4   4   1]
 [286  70  65  42  37   8   2   0   0   0]
 [205   2  21  29   8   2  13   5   5   2]
 [  3  65  42  55   0   1   2   0   1  10]
 [  5  64  27  12   7  14   0   0   5   0]
 [247 176  22   0  14   7   0   4   7   0]
 [ 62  39  32  10   2  14   0   7   0   1]
 [172   0  10  11   5   2   5  10   0   3]
 [155  12  18   6   8   5   3   0   5   0]
 [295  30  23  27  25   6   0   4   0   7]
 [ 44  17  57  23  59  22   2   7   1   0]
 [ 43   9   6   1   8  24   5   1   0  10]
 [ 62  27   1  12  27  14   1   0   4   1]
 [ 30  27   5  36  14  25   2   2   1   0]
 [ 52  82  28   7   6  11   7   1   4   0]
 [ 57  59  97  11  18  15   3   2   0   0]
 [ 34  25 157  13  33   2   2   0   2   0]
 [ 10  17  22  26   1   4  12   3   5   0]
 [105   9  77  82   0   6  17   2   5   0]
 [217  12  33  44  15   2   5   0   4   2]
 [160 112  20   6   1   2  10   3   2   0]
 [ 18  62  14  53  20  27   8   2   7   4]
 [  8 110  15  27  45   4  20   1   1   0]]
Total size of testing set
9828
[3556 2295 1479  949  609  388  246  153   97   56]
40
Step 0, Loss 1.202033281326294
Step 100, Loss 0.16688382625579834
Step 200, Loss -0.5065922737121582
Step 300, Loss -0.9409308433532715
Step 400, Loss -1.2218012809753418
Step 500, Loss -1.3996047973632812
Step 600, Loss -1.5115269422531128
Step 700, Loss -1.58123779296875
Step 800, Loss -1.6241532564163208
Step 900, Loss -1.6492525339126587
Step 1000, Loss -1.6632418632507324
Step 1100, Loss -1.6715240478515625
Step 1200, Loss -1.6749677658081055
Step 1300, Loss -1.6770155429840088
Step 1400, Loss -1.6784871816635132
Step 1500, Loss -1.6794180870056152
Step 1600, Loss -1.6797624826431274
Step 1700, Loss -1.680137276649475
Step 1800, Loss -1.6801702976226807
Step 1900, Loss -1.6797689199447632
Step 2000, Loss -1.6803607940673828
Step 2100, Loss -1.680274486541748
Step 2200, Loss -1.6800925731658936
Step 2300, Loss -1.6803163290023804
Step 2400, Loss -1.6802014112472534
Step 2500, Loss -1.6804020404815674
Step 2600, Loss -1.6802453994750977
Step 2700, Loss -1.6804357767105103
Step 2800, Loss -1.6802352666854858
Step 2900, Loss -1.6805342435836792
Step 3000, Loss -1.6806902885437012
Step 3100, Loss -1.6803748607635498
Step 3200, Loss -1.6806002855300903
Step 3300, Loss -1.6804760694503784
Step 3400, Loss -1.6804895401000977
Step 3500, Loss -1.6804181337356567
Step 3600, Loss -1.6806836128234863
Step 3700, Loss -1.6803303956985474
Step 3800, Loss -1.6806330680847168
Step 3900, Loss -1.6804808378219604
Step 4000, Loss -1.6800642013549805
Step 4100, Loss -1.6804596185684204
Step 4200, Loss -1.6806508302688599
Step 4300, Loss -1.6805877685546875
Step 4400, Loss -1.6804275512695312
Step 4500, Loss -1.6807692050933838
Step 4600, Loss -1.68059504032135
Step 4700, Loss -1.6803737878799438
Step 4800, Loss -1.680566668510437
Step 4900, Loss -1.68018639087677
Step 5000, Loss -1.68020498752594
Step 5100, Loss -1.6806660890579224
Step 5200, Loss -1.6807669401168823
Step 5300, Loss -1.680361032485962
Step 5400, Loss -1.6806070804595947
Step 5500, Loss -1.68044114112854
Step 5600, Loss -1.6805118322372437
Step 5700, Loss -1.6805356740951538
Step 5800, Loss -1.6804298162460327
Step 5900, Loss -1.680533766746521
Step 6000, Loss -1.6808276176452637
Step 6100, Loss -1.680433750152588
Step 6200, Loss -1.6804766654968262
Step 6300, Loss -1.6806877851486206
Step 6400, Loss -1.6805630922317505
Step 6500, Loss -1.6806045770645142
Step 6600, Loss -1.6806895732879639
Step 6700, Loss -1.680808186531067
Step 6800, Loss -1.680597186088562
Step 6900, Loss -1.6804126501083374
Step 7000, Loss -1.6806284189224243
Step 7100, Loss -1.6809052228927612
Step 7200, Loss -1.680418848991394
Step 7300, Loss -1.6805635690689087
Step 7400, Loss -1.6805646419525146
Step 7500, Loss -1.6804159879684448
Step 7600, Loss -1.6808160543441772
Step 7700, Loss -1.6807183027267456
Step 7800, Loss -1.6804792881011963
Step 7900, Loss -1.6807061433792114
Step 8000, Loss -1.6805814504623413
Step 8100, Loss -1.6808046102523804
Step 8200, Loss -1.6806488037109375
Step 8300, Loss -1.6805683374404907
Step 8400, Loss -1.6807942390441895
Step 8500, Loss -1.680551290512085
Step 8600, Loss -1.6806628704071045
Step 8700, Loss -1.6807540655136108
Step 8800, Loss -1.6805315017700195
Step 8900, Loss -1.6806790828704834
Step 9000, Loss -1.680652141571045
Step 9100, Loss -1.680993676185608
Step 9200, Loss -1.680727481842041
Step 9300, Loss -1.6806501150131226
Step 9400, Loss -1.6805684566497803
Step 9500, Loss -1.6804933547973633
Step 9600, Loss -1.680806279182434
Step 9700, Loss -1.680518388748169
Step 9800, Loss -1.6805509328842163
Step 9900, Loss -1.680612564086914
Angle Mean: 96.37889862060547, Angle Variance: 0.007330520078539848
Norm Mean: 0.10059825330972672, Norm Variance: 2.577642543855063e-09
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [02:10<18:08:00, 130.82s/it]  0%|          | 2/500 [04:09<17:05:11, 123.52s/it]
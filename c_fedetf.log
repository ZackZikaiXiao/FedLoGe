nohup: ignoring input
./temp/fl_acc_cifar10_resnet18_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N40_10_seed3407_p1_dirichlet1.0_IF0.02_LossCE.txt
Files already downloaded and verified
[5000, 3237, 2096, 1357, 878, 568, 368, 238, 154, 100]
13996
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[265, 279, 338, 591, 172, 409, 312, 232, 279, 477, 176, 429, 333, 411, 584, 232, 421, 272, 720, 416, 259, 196, 674, 238, 312, 303, 589, 331, 154, 215, 204, 284, 372, 384, 146, 430, 472, 449, 308, 328]
training set distribution:
[[127  56   2  49   3   1   9  10   2   6]
 [ 75  21  22  64  83   0   0   8   6   0]
 [150 102  20  38   2   2   5  12   3   4]
 [336  88  59   5  53  27  21   0   1   1]
 [ 57   4  51  17   8  22   7   2   3   1]
 [ 86 196   4  65   5   4  23  21   3   2]
 [119  59  26  28   4  50   3  20   2   1]
 [ 86  41  21  27  22   1  33   1   0   0]
 [111   1 123  28   6   5   1   2   2   0]
 [112 275  41  25  12   2   2   7   0   1]
 [ 29 106   2   1  20   3   0  11   4   0]
 [125 146 107   7  22  15   3   2   0   2]
 [172  80  24  13   7  11   3  19   3   1]
 [  5 175 119  16  16  37  36   4   0   3]
 [  7 296 153  93   2   5   8  12   3   5]
 [ 16  44   2  39  74  33   0   5  16   3]
 [160  68  76  46  21   8  29   7   6   0]
 [ 37  29 119  32  10  27   4   6   6   2]
 [401  98  92  60  52  12   3   0   1   1]
 [287   4  30  41  12   4  19   7   8   4]
 [  5  91  60  78   1   2   4   1   2  15]
 [  8  90  39  18  11  20   1   0   8   1]
 [347 247  32   1  20  10   1   6  10   0]
 [ 87  55  45  14   4  20   0  11   0   2]
 [242   1  15  16   7   4   7  15   0   5]
 [217  18  26   9  12   8   5   0   8   0]
 [413  42  33  39  35   9   1   6   1  10]
 [ 62  25  81  33  83  31   4  10   2   0]
 [ 61  13   9   2  12  34   7   2   0  14]
 [ 87  39   2  18  39  20   2   0   6   2]
 [ 43  38   7  51  20  36   3   3   2   1]
 [ 73 116  40  11   9  16  11   2   6   0]
 [ 80  83 136  16  26  21   5   4   0   1]
 [ 48  36 221  19  47   3   4   1   4   1]
 [ 14  24  32  37   2   6  18   5   7   1]
 [148  13 108 116   1   9  24   4   7   0]
 [305  17  47  62  21   3   7   1   6   3]
 [224 158  29   9   2   3  15   5   4   0]
 [ 26  88  20  75  29  38  12   4  10   6]
 [ 12 154  21  39  63   6  28   2   2   1]]
Total size of training set
13996
local test distribution:
[[ 90  40   1  35   2   0   6   7   1   4]
 [ 53  15  15  45  59   0   0   5   4   0]
 [107  72  14  27   1   1   3   8   2   2]
 [240  62  42   3  37  19  15   0   0   0]
 [ 40   2  36  12   5  15   5   1   2   0]
 [ 61 140   2  46   3   2  16  15   2   1]
 [ 85  42  18  20   2  35   2  14   1   0]
 [ 61  29  15  19  15   0  23   0   0   0]
 [ 79   0  87  20   4   3   0   1   1   0]
 [ 80 196  29  17   8   1   1   5   0   0]
 [ 20  75   1   0  14   2   0   7   2   0]
 [ 89 104  76   5  15  10   2   1   0   1]
 [122  57  17   9   5   7   2  13   2   0]
 [  3 125  85  11  11  26  25   2   0   2]
 [  5 211 109  66   1   3   5   8   2   3]
 [ 11  31   1  27  52  23   0   3  11   2]
 [114  48  54  32  15   5  20   5   4   0]
 [ 26  20  85  22   7  19   2   4   4   1]
 [286  70  65  42  37   8   2   0   0   0]
 [205   2  21  29   8   2  13   5   5   2]
 [  3  65  42  55   0   1   2   0   1  10]
 [  5  64  27  12   7  14   0   0   5   0]
 [247 176  22   0  14   7   0   4   7   0]
 [ 62  39  32  10   2  14   0   7   0   1]
 [172   0  10  11   5   2   5  10   0   3]
 [155  12  18   6   8   5   3   0   5   0]
 [295  30  23  27  25   6   0   4   0   7]
 [ 44  17  57  23  59  22   2   7   1   0]
 [ 43   9   6   1   8  24   5   1   0  10]
 [ 62  27   1  12  27  14   1   0   4   1]
 [ 30  27   5  36  14  25   2   2   1   0]
 [ 52  82  28   7   6  11   7   1   4   0]
 [ 57  59  97  11  18  15   3   2   0   0]
 [ 34  25 157  13  33   2   2   0   2   0]
 [ 10  17  22  26   1   4  12   3   5   0]
 [105   9  77  82   0   6  17   2   5   0]
 [217  12  33  44  15   2   5   0   4   2]
 [160 112  20   6   1   2  10   3   2   0]
 [ 18  62  14  53  20  27   8   2   7   4]
 [  8 110  15  27  45   4  20   1   1   0]]
Total size of testing set
9828
[3556 2295 1479  949  609  388  246  153   97   56]
40
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [02:21<19:39:57, 141.88s/it]  0%|          | 2/500 [04:36<19:03:28, 137.77s/it]3shot of client 0:head:0.024242424242424242, middle:0.07692307692307693, tail0.0
3shot of client 1:head:0.006369426751592357, middle:0.0, tail0.0
3shot of client 2:head:0.8994413407821229, middle:0.6938775510204082, tail0.5555555555555556
3shot of client 3:head:0.040697674418604654, middle:0.017857142857142856, tail0.0
3shot of client 4:head:0.04395604395604396, middle:0.045454545454545456, tail0.0
3shot of client 5:head:0.8866396761133604, middle:0.5483870967741935, tail0.7
3shot of client 6:head:0.016483516483516484, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.024096385542168676, middle:0.0, tail0.0
3shot of client 9:head:0.028985507246376812, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.007434944237918215, middle:0.0, tail0.0
3shot of client 12:head:0.03910614525139665, middle:0.0, tail0.0
3shot of client 13:head:0.025423728813559324, middle:0.0, tail0.0
3shot of client 14:head:0.8875, middle:0.7162162162162162, tail0.5789473684210527
3shot of client 15:head:0.015037593984962405, middle:0.0, tail0.0
3shot of client 16:head:0.012096774193548387, middle:0.0, tail0.0
3shot of client 17:head:0.8235294117647058, middle:0.8, tail0.2857142857142857
3shot of client 18:head:0.035629453681710214, middle:0.02531645569620253, tail0.1
3shot of client 19:head:0.7521367521367521, middle:0.8723404255319149, tail0.8181818181818182
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 22:head:0.028368794326241134, middle:0.0, tail0.0
3shot of client 23:head:0.007518796992481203, middle:0.0, tail0.0
3shot of client 24:head:0.1511627906976744, middle:0.027777777777777776, tail0.1
3shot of client 25:head:0.10404624277456648, middle:0.03225806451612903, tail0.0
3shot of client 26:head:0.06153846153846154, middle:0.013333333333333334, tail0.0
3shot of client 27:head:0.01092896174863388, middle:0.02564102564102564, tail0.0
3shot of client 28:head:0.023255813953488372, middle:0.0, tail0.0
3shot of client 29:head:0.008620689655172414, middle:0.0, tail0.0
3shot of client 30:head:0.01694915254237288, middle:0.0, tail0.0
3shot of client 31:head:0.024691358024691357, middle:0.0, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.0, tail0.0
3shot of client 33:head:0.013392857142857142, middle:0.02631578947368421, tail0.0
3shot of client 34:head:0.012987012987012988, middle:0.0, tail0.0
3shot of client 35:head:0.03409090909090909, middle:0.038461538461538464, tail0.0
3shot of client 36:head:0.08045977011494253, middle:0.06666666666666667, tail0.0
3shot of client 37:head:0.022058823529411766, middle:0.0, tail0.0
3shot of client 38:head:0.8024691358024691, middle:0.8085106382978723, tail0.5
3shot of client 39:head:0.005494505494505495, middle:0.023255813953488372, tail0.0
round 0, local average test acc  0.1438 

round 0, local macro average F1 score  0.1173 

round 0, local weighted average F1 score  0.1706 

round 0, global test acc  0.6400 

round 0, average 3shot acc: [head: 0.1506, middle: 0.1215, tail: 0.0933] 

round 0, global 3shot acc: [head: 0.8780, middle: 0.6900, tail: 0.2727] 

l_head tensor([2.2024, 1.7191, 0.7854, 1.4888, 0.9899, 0.8051, 1.1140, 1.3009, 0.9195,
        1.1698], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.2681, 1.0744, 1.0961, 1.0092, 0.9480, 0.9052, 0.8344, 0.7709, 0.7983,
        0.7270], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.030303030303030304, middle:0.0, tail0.0
3shot of client 1:head:0.006369426751592357, middle:0.0, tail0.0
3shot of client 2:head:0.888268156424581, middle:0.6938775510204082, tail0.5555555555555556
3shot of client 3:head:0.046511627906976744, middle:0.017857142857142856, tail0.0
3shot of client 4:head:0.03296703296703297, middle:0.0, tail0.0
3shot of client 5:head:0.8704453441295547, middle:0.6129032258064516, tail0.8
3shot of client 6:head:0.02197802197802198, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.018072289156626505, middle:0.0, tail0.0
3shot of client 9:head:0.028985507246376812, middle:0.0, tail0.06666666666666667
3shot of client 10:head:0.0, middle:0.047619047619047616, tail0.0
3shot of client 11:head:0.011152416356877323, middle:0.0, tail0.0
3shot of client 12:head:0.027932960893854747, middle:0.0, tail0.0
3shot of client 13:head:0.00847457627118644, middle:0.0, tail0.0
3shot of client 14:head:0.878125, middle:0.7567567567567568, tail0.631578947368421
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.016129032258064516, middle:0.02857142857142857, tail0.0
3shot of client 17:head:0.7973856209150327, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.035629453681710214, middle:0.012658227848101266, tail0.0
3shot of client 19:head:0.688034188034188, middle:0.8936170212765957, tail0.8181818181818182
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 22:head:0.026004728132387706, middle:0.0, tail0.0
3shot of client 23:head:0.03759398496240601, middle:0.0, tail0.0
3shot of client 24:head:0.14534883720930233, middle:0.0, tail0.0
3shot of client 25:head:0.09826589595375723, middle:0.0, tail0.0
3shot of client 26:head:0.07692307692307693, middle:0.04, tail0.0
3shot of client 27:head:0.01092896174863388, middle:0.02564102564102564, tail0.1
3shot of client 28:head:0.011627906976744186, middle:0.0, tail0.0
3shot of client 29:head:0.02586206896551724, middle:0.0, tail0.0
3shot of client 30:head:0.00847457627118644, middle:0.0, tail0.0
3shot of client 31:head:0.024691358024691357, middle:0.03225806451612903, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.0, tail0.0
3shot of client 33:head:0.022321428571428572, middle:0.02631578947368421, tail0.0
3shot of client 34:head:0.05194805194805195, middle:0.0, tail0.0
3shot of client 35:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 36:head:0.08812260536398467, middle:0.03333333333333333, tail0.0
3shot of client 37:head:0.01838235294117647, middle:0.0, tail0.0
3shot of client 38:head:0.7901234567901234, middle:0.8085106382978723, tail0.5
3shot of client 39:head:0.005494505494505495, middle:0.023255813953488372, tail0.0
round 1, local average test acc  0.1426 

round 1, local macro average F1 score  0.0986 

round 1, local weighted average F1 score  0.1345 

round 1, global test acc  0.6835 

round 1, average 3shot acc: [head: 0.1484, middle: 0.1213, tail: 0.1037] 

round 1, global 3shot acc: [head: 0.8725, middle: 0.7147, tail: 0.4003] 

l_head tensor([2.1124, 1.7086, 0.9091, 1.6452, 1.0510, 0.8936, 1.0849, 1.1859, 1.0026,
        1.3583], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.4223, 1.1947, 1.2223, 1.1016, 1.0528, 0.9634, 0.8890, 0.8380, 0.9880,
        0.8500], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.012738853503184714, middle:0.0, tail0.0
3shot of client 2:head:0.8659217877094972, middle:0.6326530612244898, tail0.5555555555555556
3shot of client 3:head:0.04941860465116279, middle:0.0, tail0.0
3shot of client 4:head:0.03296703296703297, middle:0.0, tail0.0
3shot of client 5:head:0.8704453441295547, middle:0.5806451612903226, tail0.9
3shot of client 6:head:0.01098901098901099, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.018072289156626505, middle:0.0, tail0.0
3shot of client 9:head:0.036231884057971016, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.04, tail0.1111111111111111
3shot of client 12:head:0.0446927374301676, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.875, middle:0.7162162162162162, tail0.6842105263157895
3shot of client 15:head:0.022556390977443608, middle:0.0, tail0.0
3shot of client 16:head:0.020161290322580645, middle:0.02857142857142857, tail0.0
  1%|          | 3/500 [06:48<18:39:33, 135.16s/it]  1%|          | 4/500 [09:00<18:25:37, 133.75s/it]3shot of client 17:head:0.7908496732026143, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.03800475059382423, middle:0.0, tail0.0
3shot of client 19:head:0.6538461538461539, middle:0.8723404255319149, tail0.8181818181818182
3shot of client 20:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.030732860520094562, middle:0.027777777777777776, tail0.0
3shot of client 23:head:0.05263157894736842, middle:0.0, tail0.0
3shot of client 24:head:0.16279069767441862, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.10404624277456648, middle:0.0, tail0.125
3shot of client 26:head:0.08307692307692308, middle:0.04, tail0.11764705882352941
3shot of client 27:head:0.01092896174863388, middle:0.0, tail0.0
3shot of client 28:head:0.011627906976744186, middle:0.0, tail0.0
3shot of client 29:head:0.008620689655172414, middle:0.0, tail0.14285714285714285
3shot of client 30:head:0.00847457627118644, middle:0.05263157894736842, tail0.0
3shot of client 31:head:0.012345679012345678, middle:0.0, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.022727272727272728, tail0.0
3shot of client 33:head:0.013392857142857142, middle:0.02631578947368421, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.03787878787878788, middle:0.0, tail0.0
3shot of client 36:head:0.09195402298850575, middle:0.0, tail0.0
3shot of client 37:head:0.014705882352941176, middle:0.0, tail0.0
3shot of client 38:head:0.7962962962962963, middle:0.8085106382978723, tail0.5
3shot of client 39:head:0.005494505494505495, middle:0.023255813953488372, tail0.0
round 2, local average test acc  0.1406 

round 2, local macro average F1 score  0.1174 

round 2, local weighted average F1 score  0.1522 

round 2, global test acc  0.7022 

round 2, average 3shot acc: [head: 0.1464, middle: 0.1175, tail: 0.1161] 

round 2, global 3shot acc: [head: 0.8667, middle: 0.7250, tail: 0.4600] 

l_head tensor([2.3741, 1.9448, 0.9308, 1.7314, 1.1056, 0.9598, 1.1712, 1.3365, 1.0583,
        1.3223], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.4744, 1.2615, 1.2909, 1.1794, 1.0675, 1.0223, 0.9070, 0.8751, 1.0392,
        0.9263], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.006369426751592357, middle:0.0, tail0.0
3shot of client 2:head:0.8715083798882681, middle:0.6326530612244898, tail0.5555555555555556
3shot of client 3:head:0.0436046511627907, middle:0.0, tail0.05555555555555555
3shot of client 4:head:0.03296703296703297, middle:0.09090909090909091, tail0.0
3shot of client 5:head:0.8623481781376519, middle:0.6129032258064516, tail0.9
3shot of client 6:head:0.02197802197802198, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.018072289156626505, middle:0.0, tail0.0
3shot of client 9:head:0.010869565217391304, middle:0.0, tail0.0
3shot of client 10:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.04, tail0.1111111111111111
3shot of client 12:head:0.0223463687150838, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.853125, middle:0.7027027027027027, tail0.6842105263157895
3shot of client 15:head:0.0, middle:0.0, tail0.16666666666666666
3shot of client 16:head:0.016129032258064516, middle:0.0, tail0.0
3shot of client 17:head:0.803921568627451, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.03800475059382423, middle:0.0, tail0.0
3shot of client 19:head:0.6794871794871795, middle:0.851063829787234, tail0.8181818181818182
3shot of client 20:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.030732860520094562, middle:0.0, tail0.0
3shot of client 23:head:0.022556390977443608, middle:0.0, tail0.0
3shot of client 24:head:0.1569767441860465, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.08670520231213873, middle:0.0, tail0.0
3shot of client 26:head:0.07384615384615385, middle:0.013333333333333334, tail0.0
3shot of client 27:head:0.0273224043715847, middle:0.0, tail0.0
3shot of client 28:head:0.011627906976744186, middle:0.0, tail0.0
3shot of client 29:head:0.017241379310344827, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.05263157894736842, tail0.0
3shot of client 31:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 32:head:0.009389671361502348, middle:0.022727272727272728, tail0.0
3shot of client 33:head:0.026785714285714284, middle:0.02631578947368421, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 36:head:0.07662835249042145, middle:0.03333333333333333, tail0.0
3shot of client 37:head:0.01838235294117647, middle:0.0, tail0.0
3shot of client 38:head:0.7839506172839507, middle:0.8085106382978723, tail0.5
3shot of client 39:head:0.02197802197802198, middle:0.023255813953488372, tail0.0
round 3, local average test acc  0.1387 

round 3, local macro average F1 score  0.1070 

round 3, local weighted average F1 score  0.1617 

round 3, global test acc  0.7056 

round 3, average 3shot acc: [head: 0.1439, middle: 0.1185, tail: 0.1119] 

round 3, global 3shot acc: [head: 0.8702, middle: 0.7217, tail: 0.4700] 

l_head tensor([2.4126, 2.0149, 0.9836, 1.9123, 1.1545, 0.9829, 1.2483, 1.4014, 1.0804,
        1.3563], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.5298, 1.2864, 1.3431, 1.2416, 1.1081, 1.0748, 0.9482, 0.9033, 1.0751,
        0.9559], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.012738853503184714, middle:0.0, tail0.0
3shot of client 2:head:0.8715083798882681, middle:0.6326530612244898, tail0.5555555555555556
3shot of client 3:head:0.046511627906976744, middle:0.0, tail0.0
3shot of client 4:head:0.03296703296703297, middle:0.0, tail0.0
3shot of client 5:head:0.8623481781376519, middle:0.5806451612903226, tail0.9
3shot of client 6:head:0.005494505494505495, middle:0.0, tail0.0
3shot of client 7:head:0.015151515151515152, middle:0.0, tail0
3shot of client 8:head:0.012048192771084338, middle:0.0, tail0.0
3shot of client 9:head:0.007246376811594203, middle:0.0, tail0.0
3shot of client 10:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.1111111111111111
3shot of client 12:head:0.0335195530726257, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.853125, middle:0.7162162162162162, tail0.6842105263157895
3shot of client 15:head:0.007518796992481203, middle:0.0, tail0.0
3shot of client 16:head:0.016129032258064516, middle:0.0, tail0.0
3shot of client 17:head:0.7973856209150327, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.03800475059382423, middle:0.0, tail0.0
3shot of client 19:head:0.6709401709401709, middle:0.8723404255319149, tail0.8181818181818182
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.030732860520094562, middle:0.0, tail0.0
3shot of client 23:head:0.03759398496240601, middle:0.0, tail0.0
3shot of client 24:head:0.1569767441860465, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.08670520231213873, middle:0.0, tail0.125
3shot of client 26:head:0.07692307692307693, middle:0.0, tail0.0
3shot of client 27:head:0.0273224043715847, middle:0.0, tail0.0
3shot of client 28:head:0.011627906976744186, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.008620689655172414, middle:0.0, tail0.0
3shot of client 30:head:0.00847457627118644, middle:0.05263157894736842, tail0.0
3shot of client 31:head:0.006172839506172839, middle:0.03225806451612903, tail0.0
3shot of client 32:head:0.009389671361502348, middle:0.0, tail0.0
3shot of client 33:head:0.013392857142857142, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
  1%|          | 5/500 [11:13<18:20:28, 133.39s/it]  1%|          | 6/500 [13:24<18:12:08, 132.65s/it]  1%|▏         | 7/500 [15:33<18:01:13, 131.59s/it]3shot of client 35:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 36:head:0.09578544061302682, middle:0.05, tail0.0
3shot of client 37:head:0.011029411764705883, middle:0.0, tail0.0
3shot of client 38:head:0.808641975308642, middle:0.8085106382978723, tail0.5
3shot of client 39:head:0.01098901098901099, middle:0.023255813953488372, tail0.0
round 4, local average test acc  0.1383 

round 4, local macro average F1 score  0.0787 

round 4, local weighted average F1 score  0.1157 

round 4, global test acc  0.7109 

round 4, average 3shot acc: [head: 0.1440, middle: 0.1162, tail: 0.1094] 

round 4, global 3shot acc: [head: 0.8662, middle: 0.7320, tail: 0.4827] 

l_head tensor([2.4460, 2.1648, 0.9799, 1.8829, 1.2108, 0.9817, 1.5762, 1.3798, 1.2042,
        1.5738], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.5778, 1.3050, 1.4038, 1.2834, 1.1259, 1.1072, 0.9614, 0.9231, 1.0981,
        0.9935], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.006369426751592357, middle:0.0, tail0.0
3shot of client 2:head:0.8659217877094972, middle:0.5918367346938775, tail0.5555555555555556
3shot of client 3:head:0.061046511627906974, middle:0.0, tail0.0
3shot of client 4:head:0.04395604395604396, middle:0.0, tail0.0
3shot of client 5:head:0.8421052631578947, middle:0.5806451612903226, tail0.9
3shot of client 6:head:0.01098901098901099, middle:0.0, tail0.0
3shot of client 7:head:0.015151515151515152, middle:0.0, tail0
3shot of client 8:head:0.030120481927710843, middle:0.0, tail0.0
3shot of client 9:head:0.010869565217391304, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0446927374301676, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.85625, middle:0.7297297297297297, tail0.6842105263157895
3shot of client 15:head:0.007518796992481203, middle:0.0, tail0.0
3shot of client 16:head:0.020161290322580645, middle:0.0, tail0.0
3shot of client 17:head:0.7973856209150327, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.040380047505938245, middle:0.0, tail0.0
3shot of client 19:head:0.6538461538461539, middle:0.9148936170212766, tail0.8181818181818182
3shot of client 20:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.030732860520094562, middle:0.0, tail0.0
3shot of client 23:head:0.045112781954887216, middle:0.0, tail0.0
3shot of client 24:head:0.18023255813953487, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.10404624277456648, middle:0.0, tail0.0
3shot of client 26:head:0.08307692307692308, middle:0.0, tail0.0
3shot of client 27:head:0.02185792349726776, middle:0.0, tail0.1
3shot of client 28:head:0.03488372093023256, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.017241379310344827, middle:0.0, tail0.14285714285714285
3shot of client 30:head:0.0, middle:0.05263157894736842, tail0.0
3shot of client 31:head:0.012345679012345678, middle:0.03225806451612903, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.0, tail0.0
3shot of client 33:head:0.013392857142857142, middle:0.02631578947368421, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.03409090909090909, middle:0.0, tail0.0
3shot of client 36:head:0.09195402298850575, middle:0.03333333333333333, tail0.0
3shot of client 37:head:0.01838235294117647, middle:0.0, tail0.07142857142857142
3shot of client 38:head:0.7962962962962963, middle:0.7872340425531915, tail0.5
3shot of client 39:head:0.02197802197802198, middle:0.023255813953488372, tail0.0
round 5, local average test acc  0.1404 

round 5, local macro average F1 score  0.1130 

round 5, local weighted average F1 score  0.1637 

round 5, global test acc  0.7201 

round 5, average 3shot acc: [head: 0.1464, middle: 0.1163, tail: 0.1114] 

round 5, global 3shot acc: [head: 0.8667, middle: 0.7303, tail: 0.5143] 

l_head tensor([2.6091, 2.3458, 1.1593, 1.9851, 1.2214, 1.0185, 1.5685, 1.3978, 1.3022,
        1.7487], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.6368, 1.3305, 1.4553, 1.3316, 1.1563, 1.1428, 0.9887, 0.9461, 1.1089,
        1.0273], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.012738853503184714, middle:0.0, tail0.0
3shot of client 2:head:0.888268156424581, middle:0.6326530612244898, tail0.5555555555555556
3shot of client 3:head:0.046511627906976744, middle:0.0, tail0.0
3shot of client 4:head:0.03296703296703297, middle:0.0, tail0.0
3shot of client 5:head:0.8502024291497976, middle:0.6129032258064516, tail0.9
3shot of client 6:head:0.01098901098901099, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.024096385542168676, middle:0.0, tail0.0
3shot of client 9:head:0.010869565217391304, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0335195530726257, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.85625, middle:0.7297297297297297, tail0.6842105263157895
3shot of client 15:head:0.015037593984962405, middle:0.0, tail0.0
3shot of client 16:head:0.024193548387096774, middle:0.0, tail0.0
3shot of client 17:head:0.8300653594771242, middle:0.7666666666666667, tail0.5714285714285714
3shot of client 18:head:0.040380047505938245, middle:0.0, tail0.0
3shot of client 19:head:0.6581196581196581, middle:0.8936170212765957, tail0.8181818181818182
3shot of client 20:head:0.018518518518518517, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.030732860520094562, middle:0.0, tail0.0
3shot of client 23:head:0.022556390977443608, middle:0.0, tail0.0
3shot of client 24:head:0.1569767441860465, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.10404624277456648, middle:0.0, tail0.0
3shot of client 26:head:0.08, middle:0.0, tail0.0
3shot of client 27:head:0.01092896174863388, middle:0.0, tail0.1
3shot of client 28:head:0.011627906976744186, middle:0.0, tail0.0
3shot of client 29:head:0.008620689655172414, middle:0.0, tail0.14285714285714285
3shot of client 30:head:0.00847457627118644, middle:0.0, tail0.0
3shot of client 31:head:0.018518518518518517, middle:0.03225806451612903, tail0.0
3shot of client 32:head:0.009389671361502348, middle:0.022727272727272728, tail0.0
3shot of client 33:head:0.013392857142857142, middle:0.02631578947368421, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.03787878787878788, middle:0.0, tail0.0
3shot of client 36:head:0.09195402298850575, middle:0.016666666666666666, tail0.07692307692307693
3shot of client 37:head:0.011029411764705883, middle:0.0, tail0.0
3shot of client 38:head:0.8024691358024691, middle:0.851063829787234, tail0.5
3shot of client 39:head:0.016483516483516484, middle:0.023255813953488372, tail0.0
round 6, local average test acc  0.1400 

round 6, local macro average F1 score  0.1162 

round 6, local weighted average F1 score  0.1645 

round 6, global test acc  0.7199 

round 6, average 3shot acc: [head: 0.1459, middle: 0.1159, tail: 0.1115] 

round 6, global 3shot acc: [head: 0.8682, middle: 0.7283, tail: 0.5137] 

l_head tensor([2.4978, 2.2956, 1.1395, 2.0448, 1.2013, 1.0366, 1.5387, 1.4279, 1.2987,
        1.7284], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.6660, 1.3402, 1.4830, 1.3761, 1.1852, 1.1756, 1.0214, 0.9550, 1.1324,
        1.0484], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.006369426751592357, middle:0.0, tail0.0
3shot of client 2:head:0.8715083798882681, middle:0.6530612244897959, tail0.5555555555555556
3shot of client 3:head:0.05232558139534884, middle:0.0, tail0.0
3shot of client 4:head:0.04395604395604396, middle:0.0, tail0.0
  2%|▏         | 8/500 [17:46<18:02:23, 132.00s/it]  2%|▏         | 9/500 [19:59<18:01:47, 132.19s/it]3shot of client 5:head:0.8582995951417004, middle:0.5806451612903226, tail0.8
3shot of client 6:head:0.016483516483516484, middle:0.0, tail0.0
3shot of client 7:head:0.015151515151515152, middle:0.0, tail0
3shot of client 8:head:0.024096385542168676, middle:0.0, tail0.0
3shot of client 9:head:0.014492753623188406, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0446927374301676, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.14285714285714285
3shot of client 14:head:0.85, middle:0.7297297297297297, tail0.6842105263157895
3shot of client 15:head:0.007518796992481203, middle:0.0, tail0.0
3shot of client 16:head:0.012096774193548387, middle:0.0, tail0.0
3shot of client 17:head:0.803921568627451, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.040380047505938245, middle:0.0, tail0.0
3shot of client 19:head:0.688034188034188, middle:0.8723404255319149, tail0.8181818181818182
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.030732860520094562, middle:0.0, tail0.0
3shot of client 23:head:0.03007518796992481, middle:0.0, tail0.0
3shot of client 24:head:0.18604651162790697, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.10982658959537572, middle:0.0, tail0.0
3shot of client 26:head:0.08307692307692308, middle:0.013333333333333334, tail0.0
3shot of client 27:head:0.01639344262295082, middle:0.02564102564102564, tail0.0
3shot of client 28:head:0.023255813953488372, middle:0.10526315789473684, tail0.0
3shot of client 29:head:0.008620689655172414, middle:0.0, tail0.14285714285714285
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.045454545454545456, tail0.0
3shot of client 33:head:0.013392857142857142, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.030303030303030304, middle:0.0, tail0.0
3shot of client 36:head:0.09961685823754789, middle:0.016666666666666666, tail0.0
3shot of client 37:head:0.014705882352941176, middle:0.0, tail0.0
3shot of client 38:head:0.8024691358024691, middle:0.851063829787234, tail0.5
3shot of client 39:head:0.0, middle:0.023255813953488372, tail0.0
round 7, local average test acc  0.1405 

round 7, local macro average F1 score  0.1233 

round 7, local weighted average F1 score  0.1795 

round 7, global test acc  0.7164 

round 7, average 3shot acc: [head: 0.1461, middle: 0.1186, tail: 0.1081] 

round 7, global 3shot acc: [head: 0.8687, middle: 0.7203, tail: 0.5093] 

l_head tensor([2.5522, 2.3362, 1.1334, 2.0587, 1.2292, 1.0602, 1.5611, 1.4386, 1.3728,
        1.7038], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.7234, 1.3525, 1.5222, 1.4247, 1.2131, 1.2075, 1.0313, 0.9776, 1.1486,
        1.0690], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.006369426751592357, middle:0.0, tail0.0
3shot of client 2:head:0.8659217877094972, middle:0.5918367346938775, tail0.5555555555555556
3shot of client 3:head:0.05232558139534884, middle:0.0, tail0.0
3shot of client 4:head:0.04395604395604396, middle:0.0, tail0.0
3shot of client 5:head:0.8502024291497976, middle:0.5806451612903226, tail0.8
3shot of client 6:head:0.01098901098901099, middle:0.0, tail0.0
3shot of client 7:head:0.015151515151515152, middle:0.0, tail0
3shot of client 8:head:0.012048192771084338, middle:0.0, tail0.0
3shot of client 9:head:0.021739130434782608, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0335195530726257, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.85625, middle:0.7432432432432432, tail0.6842105263157895
3shot of client 15:head:0.022556390977443608, middle:0.0, tail0.0
3shot of client 16:head:0.04032258064516129, middle:0.0, tail0.0
3shot of client 17:head:0.8104575163398693, middle:0.8333333333333334, tail0.5714285714285714
3shot of client 18:head:0.04275534441805225, middle:0.0, tail0.0
3shot of client 19:head:0.7008547008547008, middle:0.8936170212765957, tail0.8181818181818182
3shot of client 20:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.030732860520094562, middle:0.0, tail0.0
3shot of client 23:head:0.045112781954887216, middle:0.0, tail0.0
3shot of client 24:head:0.19767441860465115, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.12138728323699421, middle:0.0, tail0.0
3shot of client 26:head:0.08923076923076922, middle:0.013333333333333334, tail0.0
3shot of client 27:head:0.0273224043715847, middle:0.0, tail0.0
3shot of client 28:head:0.03488372093023256, middle:0.0, tail0.0
3shot of client 29:head:0.017241379310344827, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.012345679012345678, middle:0.0, tail0.0
3shot of client 32:head:0.009389671361502348, middle:0.022727272727272728, tail0.0
3shot of client 33:head:0.013392857142857142, middle:0.02631578947368421, tail0.0
3shot of client 34:head:0.012987012987012988, middle:0.0, tail0.0
3shot of client 35:head:0.03409090909090909, middle:0.0, tail0.0
3shot of client 36:head:0.09195402298850575, middle:0.016666666666666666, tail0.0
3shot of client 37:head:0.014705882352941176, middle:0.0, tail0.0
3shot of client 38:head:0.7962962962962963, middle:0.851063829787234, tail0.5
3shot of client 39:head:0.0, middle:0.023255813953488372, tail0.0
round 8, local average test acc  0.1421 

round 8, local macro average F1 score  0.1301 

round 8, local weighted average F1 score  0.1900 

round 8, global test acc  0.7194 

round 8, average 3shot acc: [head: 0.1491, middle: 0.1156, tail: 0.1008] 

round 8, global 3shot acc: [head: 0.8655, middle: 0.7297, tail: 0.5143] 

l_head tensor([2.7180, 2.3297, 1.0730, 2.0967, 1.2657, 1.1416, 1.5902, 1.5324, 1.3841,
        1.7737], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.7686, 1.3471, 1.5544, 1.4490, 1.2444, 1.2342, 1.0552, 0.9848, 1.1682,
        1.0844], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.006369426751592357, middle:0.0, tail0.0
3shot of client 2:head:0.8770949720670391, middle:0.6530612244897959, tail0.4444444444444444
3shot of client 3:head:0.05232558139534884, middle:0.0, tail0.0
3shot of client 4:head:0.04395604395604396, middle:0.0, tail0.0
3shot of client 5:head:0.854251012145749, middle:0.5806451612903226, tail0.8
3shot of client 6:head:0.005494505494505495, middle:0.0, tail0.0
3shot of client 7:head:0.015151515151515152, middle:0.0, tail0
3shot of client 8:head:0.030120481927710843, middle:0.0, tail0.0
3shot of client 9:head:0.025362318840579712, middle:0.0, tail0.06666666666666667
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0335195530726257, middle:0.0, tail0.1111111111111111
3shot of client 13:head:0.0, middle:0.0, tail0.14285714285714285
3shot of client 14:head:0.8625, middle:0.7162162162162162, tail0.6842105263157895
3shot of client 15:head:0.03759398496240601, middle:0.0, tail0.0
3shot of client 16:head:0.020161290322580645, middle:0.0, tail0.0
3shot of client 17:head:0.7973856209150327, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.03800475059382423, middle:0.0, tail0.0
3shot of client 19:head:0.7051282051282052, middle:0.851063829787234, tail0.7272727272727273
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.03309692671394799, middle:0.0, tail0.0
3shot of client 23:head:0.03007518796992481, middle:0.0, tail0.0
3shot of client 24:head:0.18023255813953487, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.11560693641618497, middle:0.0, tail0.0
  2%|▏         | 10/500 [22:09<17:55:04, 131.64s/it]  2%|▏         | 11/500 [24:21<17:52:32, 131.60s/it]3shot of client 26:head:0.08615384615384615, middle:0.0, tail0.0
3shot of client 27:head:0.02185792349726776, middle:0.02564102564102564, tail0.0
3shot of client 28:head:0.023255813953488372, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.017241379310344827, middle:0.0, tail0.14285714285714285
3shot of client 30:head:0.00847457627118644, middle:0.0, tail0.0
3shot of client 31:head:0.012345679012345678, middle:0.0, tail0.0
3shot of client 32:head:0.009389671361502348, middle:0.022727272727272728, tail0.0
3shot of client 33:head:0.017857142857142856, middle:0.02631578947368421, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.03787878787878788, middle:0.0, tail0.0
3shot of client 36:head:0.09578544061302682, middle:0.03333333333333333, tail0.0
3shot of client 37:head:0.014705882352941176, middle:0.0, tail0.0
3shot of client 38:head:0.7962962962962963, middle:0.8297872340425532, tail0.5
3shot of client 39:head:0.01098901098901099, middle:0.023255813953488372, tail0.0
round 9, local average test acc  0.1420 

round 9, local macro average F1 score  0.1000 

round 9, local weighted average F1 score  0.1495 

round 9, global test acc  0.7204 

round 9, average 3shot acc: [head: 0.1485, middle: 0.1161, tail: 0.1075] 

round 9, global 3shot acc: [head: 0.8687, middle: 0.7263, tail: 0.5167] 

l_head tensor([2.7081, 2.3467, 1.1518, 2.3197, 1.2371, 1.1584, 1.6704, 1.5518, 1.4567,
        1.7828], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8178, 1.3659, 1.5881, 1.4894, 1.2592, 1.2635, 1.0646, 1.0032, 1.1826,
        1.1104], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.012738853503184714, middle:0.0, tail0.0
3shot of client 2:head:0.8659217877094972, middle:0.673469387755102, tail0.5555555555555556
3shot of client 3:head:0.055232558139534885, middle:0.017857142857142856, tail0.0
3shot of client 4:head:0.04395604395604396, middle:0.0, tail0.0
3shot of client 5:head:0.854251012145749, middle:0.5806451612903226, tail0.9
3shot of client 6:head:0.016483516483516484, middle:0.0, tail0.0
3shot of client 7:head:0.015151515151515152, middle:0.0, tail0
3shot of client 8:head:0.030120481927710843, middle:0.0, tail0.0
3shot of client 9:head:0.025362318840579712, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.1111111111111111
3shot of client 12:head:0.05027932960893855, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.02127659574468085, tail0.0
3shot of client 14:head:0.846875, middle:0.7297297297297297, tail0.6842105263157895
3shot of client 15:head:0.015037593984962405, middle:0.0, tail0.0
3shot of client 16:head:0.020161290322580645, middle:0.0, tail0.0
3shot of client 17:head:0.7973856209150327, middle:0.8333333333333334, tail0.5714285714285714
3shot of client 18:head:0.04513064133016627, middle:0.0, tail0.0
3shot of client 19:head:0.6666666666666666, middle:0.851063829787234, tail0.7272727272727273
3shot of client 20:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.028368794326241134, middle:0.0, tail0.0
3shot of client 23:head:0.06015037593984962, middle:0.0, tail0.0
3shot of client 24:head:0.19186046511627908, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.10982658959537572, middle:0.0, tail0.0
3shot of client 26:head:0.09846153846153846, middle:0.0, tail0.0
3shot of client 27:head:0.01639344262295082, middle:0.02564102564102564, tail0.0
3shot of client 28:head:0.03488372093023256, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.008620689655172414, middle:0.0, tail0.14285714285714285
3shot of client 30:head:0.01694915254237288, middle:0.0, tail0.0
3shot of client 31:head:0.024691358024691357, middle:0.0, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.022727272727272728, tail0.0
3shot of client 33:head:0.017857142857142856, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.03409090909090909, middle:0.0, tail0.0
3shot of client 36:head:0.11494252873563218, middle:0.03333333333333333, tail0.07692307692307693
3shot of client 37:head:0.01838235294117647, middle:0.03333333333333333, tail0.0
3shot of client 38:head:0.8024691358024691, middle:0.8297872340425532, tail0.5
3shot of client 39:head:0.027472527472527472, middle:0.023255813953488372, tail0.0
round 10, local average test acc  0.1439 

round 10, local macro average F1 score  0.1081 

round 10, local weighted average F1 score  0.1670 

round 10, global test acc  0.7169 

round 10, average 3shot acc: [head: 0.1503, middle: 0.1189, tail: 0.1095] 

round 10, global 3shot acc: [head: 0.8687, middle: 0.7293, tail: 0.5020] 

l_head tensor([2.8749, 2.5294, 1.1444, 2.3495, 1.3360, 1.1789, 1.6948, 1.6440, 1.4694,
        1.7895], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8640, 1.3876, 1.6207, 1.5236, 1.2893, 1.2828, 1.0818, 1.0056, 1.2010,
        1.1177], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.006369426751592357, middle:0.0, tail0.0
3shot of client 2:head:0.8715083798882681, middle:0.5918367346938775, tail0.4444444444444444
3shot of client 3:head:0.046511627906976744, middle:0.017857142857142856, tail0.0
3shot of client 4:head:0.04395604395604396, middle:0.0, tail0.0
3shot of client 5:head:0.8421052631578947, middle:0.5483870967741935, tail0.9
3shot of client 6:head:0.02197802197802198, middle:0.0, tail0.0
3shot of client 7:head:0.015151515151515152, middle:0.0, tail0
3shot of client 8:head:0.024096385542168676, middle:0.0, tail0.0
3shot of client 9:head:0.025362318840579712, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.03910614525139665, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0425531914893617, tail0.0
3shot of client 14:head:0.85, middle:0.7297297297297297, tail0.6842105263157895
3shot of client 15:head:0.05263157894736842, middle:0.0, tail0.0
3shot of client 16:head:0.03225806451612903, middle:0.0, tail0.0
3shot of client 17:head:0.8366013071895425, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.047505938242280284, middle:0.0, tail0.0
3shot of client 19:head:0.688034188034188, middle:0.8297872340425532, tail0.8181818181818182
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.028368794326241134, middle:0.0, tail0.0
3shot of client 23:head:0.022556390977443608, middle:0.0, tail0.0
3shot of client 24:head:0.21511627906976744, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.11560693641618497, middle:0.03225806451612903, tail0.0
3shot of client 26:head:0.08615384615384615, middle:0.0, tail0.0
3shot of client 27:head:0.01092896174863388, middle:0.02564102564102564, tail0.1
3shot of client 28:head:0.03488372093023256, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.008620689655172414, middle:0.0, tail0.0
3shot of client 30:head:0.00847457627118644, middle:0.0, tail0.0
3shot of client 31:head:0.018518518518518517, middle:0.0, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.022727272727272728, tail0.0
3shot of client 33:head:0.013392857142857142, middle:0.02631578947368421, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.03409090909090909, middle:0.0, tail0.0
3shot of client 36:head:0.1111111111111111, middle:0.03333333333333333, tail0.0
3shot of client 37:head:0.011029411764705883, middle:0.0, tail0.0
3shot of client 38:head:0.8024691358024691, middle:0.8297872340425532, tail0.5
3shot of client 39:head:0.016483516483516484, middle:0.023255813953488372, tail0.0
round 11, local average test acc  0.1433 

round 11, local macro average F1 score  0.0822 

round 11, local weighted average F1 score  0.1288 

round 11, global test acc  0.7197 

  2%|▏         | 12/500 [26:34<17:55:09, 132.19s/it]  3%|▎         | 13/500 [28:50<18:01:56, 133.30s/it]  3%|▎         | 14/500 [31:07<18:08:53, 134.43s/it]round 11, average 3shot acc: [head: 0.1505, middle: 0.1158, tail: 0.1030] 

round 11, global 3shot acc: [head: 0.8672, middle: 0.7237, tail: 0.5190] 

l_head tensor([2.8790, 2.4494, 1.2250, 2.4004, 1.3443, 1.1667, 1.6309, 1.6325, 1.4902,
        1.8425], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.8981, 1.3964, 1.6554, 1.5420, 1.2966, 1.3020, 1.0941, 1.0252, 1.2176,
        1.1339], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.006369426751592357, middle:0.0, tail0.0
3shot of client 2:head:0.8770949720670391, middle:0.6530612244897959, tail0.4444444444444444
3shot of client 3:head:0.04941860465116279, middle:0.0, tail0.0
3shot of client 4:head:0.04395604395604396, middle:0.0, tail0.0
3shot of client 5:head:0.8340080971659919, middle:0.5806451612903226, tail0.9
3shot of client 6:head:0.016483516483516484, middle:0.0, tail0.0
3shot of client 7:head:0.030303030303030304, middle:0.0, tail0
3shot of client 8:head:0.030120481927710843, middle:0.0, tail0.0
3shot of client 9:head:0.03260869565217391, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0037174721189591076, middle:0.0, tail0.1111111111111111
3shot of client 12:head:0.03910614525139665, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.02127659574468085, tail0.0
3shot of client 14:head:0.853125, middle:0.7297297297297297, tail0.6842105263157895
3shot of client 15:head:0.03007518796992481, middle:0.0, tail0.0
3shot of client 16:head:0.024193548387096774, middle:0.0, tail0.0
3shot of client 17:head:0.8169934640522876, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.04275534441805225, middle:0.0, tail0.0
3shot of client 19:head:0.688034188034188, middle:0.8723404255319149, tail0.8181818181818182
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 22:head:0.028368794326241134, middle:0.0, tail0.0
3shot of client 23:head:0.022556390977443608, middle:0.0, tail0.0
3shot of client 24:head:0.18604651162790697, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.10982658959537572, middle:0.0, tail0.0
3shot of client 26:head:0.09230769230769231, middle:0.0, tail0.0
3shot of client 27:head:0.01092896174863388, middle:0.02564102564102564, tail0.0
3shot of client 28:head:0.046511627906976744, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.008620689655172414, middle:0.0, tail0.0
3shot of client 30:head:0.01694915254237288, middle:0.0, tail0.0
3shot of client 31:head:0.024691358024691357, middle:0.0, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.0, tail0.0
3shot of client 33:head:0.017857142857142856, middle:0.02631578947368421, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.03409090909090909, middle:0.0, tail0.0
3shot of client 36:head:0.10727969348659004, middle:0.03333333333333333, tail0.0
3shot of client 37:head:0.01838235294117647, middle:0.03333333333333333, tail0.0
3shot of client 38:head:0.8024691358024691, middle:0.8297872340425532, tail0.5
3shot of client 39:head:0.005494505494505495, middle:0.023255813953488372, tail0.0
round 12, local average test acc  0.1432 

round 12, local macro average F1 score  0.1100 

round 12, local weighted average F1 score  0.1630 

round 12, global test acc  0.7228 

round 12, average 3shot acc: [head: 0.1500, middle: 0.1177, tail: 0.1033] 

round 12, global 3shot acc: [head: 0.8640, middle: 0.7313, tail: 0.5260] 

l_head tensor([2.8240, 2.5226, 1.2574, 2.4065, 1.3273, 1.1785, 1.6480, 1.7142, 1.5184,
        1.9006], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.9424, 1.4092, 1.6900, 1.5745, 1.3187, 1.3135, 1.1137, 1.0398, 1.2207,
        1.1480], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.025477707006369428, middle:0.0, tail0.0
3shot of client 2:head:0.8547486033519553, middle:0.673469387755102, tail0.5555555555555556
3shot of client 3:head:0.055232558139534885, middle:0.0, tail0.0
3shot of client 4:head:0.04395604395604396, middle:0.0, tail0.0
3shot of client 5:head:0.854251012145749, middle:0.5483870967741935, tail0.8
3shot of client 6:head:0.01098901098901099, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.04216867469879518, middle:0.0, tail0.0
3shot of client 9:head:0.010869565217391304, middle:0.0, tail0.06666666666666667
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.1111111111111111
3shot of client 12:head:0.0446927374301676, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0425531914893617, tail0.0
3shot of client 14:head:0.853125, middle:0.7162162162162162, tail0.6842105263157895
3shot of client 15:head:0.015037593984962405, middle:0.0, tail0.0
3shot of client 16:head:0.024193548387096774, middle:0.0, tail0.0
3shot of client 17:head:0.8104575163398693, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.047505938242280284, middle:0.0, tail0.1
3shot of client 19:head:0.688034188034188, middle:0.851063829787234, tail0.8181818181818182
3shot of client 20:head:0.012345679012345678, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.030732860520094562, middle:0.0, tail0.0
3shot of client 23:head:0.022556390977443608, middle:0.0, tail0.0
3shot of client 24:head:0.19767441860465115, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.12138728323699421, middle:0.0, tail0.0
3shot of client 26:head:0.08615384615384615, middle:0.0, tail0.0
3shot of client 27:head:0.01092896174863388, middle:0.02564102564102564, tail0.0
3shot of client 28:head:0.03488372093023256, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.017241379310344827, middle:0.0, tail0.14285714285714285
3shot of client 30:head:0.00847457627118644, middle:0.0, tail0.0
3shot of client 31:head:0.012345679012345678, middle:0.0, tail0.0
3shot of client 32:head:0.009389671361502348, middle:0.022727272727272728, tail0.0
3shot of client 33:head:0.017857142857142856, middle:0.02631578947368421, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.03409090909090909, middle:0.0, tail0.0
3shot of client 36:head:0.11877394636015326, middle:0.016666666666666666, tail0.0
3shot of client 37:head:0.022058823529411766, middle:0.0, tail0.0
3shot of client 38:head:0.8148148148148148, middle:0.8723404255319149, tail0.5
3shot of client 39:head:0.038461538461538464, middle:0.023255813953488372, tail0.0
round 13, local average test acc  0.1445 

round 13, local macro average F1 score  0.0907 

round 13, local weighted average F1 score  0.1312 

round 13, global test acc  0.7306 

round 13, average 3shot acc: [head: 0.1509, middle: 0.1175, tail: 0.1115] 

round 13, global 3shot acc: [head: 0.8667, middle: 0.7387, tail: 0.5410] 

l_head tensor([3.0399, 2.4820, 1.2297, 2.4603, 1.4445, 1.1704, 1.6878, 1.6319, 1.4571,
        1.9241], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([1.9824, 1.4208, 1.7122, 1.6064, 1.3337, 1.3429, 1.1332, 1.0442, 1.2328,
        1.1470], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.030303030303030304, middle:0.0, tail0.0
3shot of client 1:head:0.01910828025477707, middle:0.0, tail0.0
3shot of client 2:head:0.8715083798882681, middle:0.6530612244897959, tail0.5555555555555556
3shot of client 3:head:0.05813953488372093, middle:0.0, tail0.0
3shot of client 4:head:0.04395604395604396, middle:0.0, tail0.0
3shot of client 5:head:0.8340080971659919, middle:0.6129032258064516, tail0.9
3shot of client 6:head:0.016483516483516484, middle:0.0, tail0.0
3shot of client 7:head:0.015151515151515152, middle:0.0, tail0
3shot of client 8:head:0.03614457831325301, middle:0.0, tail0.0
3shot of client 9:head:0.025362318840579712, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.1111111111111111
  3%|▎         | 15/500 [33:25<18:14:01, 135.34s/it]  3%|▎         | 16/500 [35:37<18:05:11, 134.53s/it]3shot of client 12:head:0.03910614525139665, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0425531914893617, tail0.0
3shot of client 14:head:0.85, middle:0.7162162162162162, tail0.6842105263157895
3shot of client 15:head:0.022556390977443608, middle:0.0, tail0.0
3shot of client 16:head:0.04032258064516129, middle:0.0, tail0.0
3shot of client 17:head:0.8235294117647058, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.047505938242280284, middle:0.012658227848101266, tail0.0
3shot of client 19:head:0.6837606837606838, middle:0.9148936170212766, tail0.8181818181818182
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.01904761904761905, middle:0.0, tail0.0
3shot of client 22:head:0.028368794326241134, middle:0.0, tail0.0
3shot of client 23:head:0.015037593984962405, middle:0.06451612903225806, tail0.0
3shot of client 24:head:0.19767441860465115, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.11560693641618497, middle:0.0, tail0.0
3shot of client 26:head:0.09538461538461539, middle:0.013333333333333334, tail0.0
3shot of client 27:head:0.00546448087431694, middle:0.02564102564102564, tail0.0
3shot of client 28:head:0.023255813953488372, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.017241379310344827, middle:0.0, tail0.0
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.0, middle:0.03225806451612903, tail0.0
3shot of client 32:head:0.009389671361502348, middle:0.045454545454545456, tail0.0
3shot of client 33:head:0.017857142857142856, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.03787878787878788, middle:0.0, tail0.0
3shot of client 36:head:0.09961685823754789, middle:0.016666666666666666, tail0.07692307692307693
3shot of client 37:head:0.022058823529411766, middle:0.0, tail0.07142857142857142
3shot of client 38:head:0.808641975308642, middle:0.8723404255319149, tail0.5
3shot of client 39:head:0.016483516483516484, middle:0.023255813953488372, tail0.0
round 14, local average test acc  0.1442 

round 14, local macro average F1 score  0.1119 

round 14, local weighted average F1 score  0.1622 

round 14, global test acc  0.7279 

round 14, average 3shot acc: [head: 0.1496, middle: 0.1232, tail: 0.1100] 

round 14, global 3shot acc: [head: 0.8707, middle: 0.7303, tail: 0.5350] 

l_head tensor([3.0031, 2.5037, 1.2580, 2.4600, 1.3785, 1.2188, 1.6952, 1.6888, 1.5254,
        1.9666], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.0309, 1.4266, 1.7474, 1.6348, 1.3596, 1.3574, 1.1473, 1.0577, 1.2455,
        1.1628], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.012738853503184714, middle:0.0, tail0.0
3shot of client 2:head:0.88268156424581, middle:0.6326530612244898, tail0.5555555555555556
3shot of client 3:head:0.055232558139534885, middle:0.0, tail0.0
3shot of client 4:head:0.04395604395604396, middle:0.0, tail0.0
3shot of client 5:head:0.8582995951417004, middle:0.5806451612903226, tail0.9
3shot of client 6:head:0.016483516483516484, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.03614457831325301, middle:0.0, tail0.0
3shot of client 9:head:0.021739130434782608, middle:0.0, tail0.0
3shot of client 10:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 11:head:0.0037174721189591076, middle:0.0, tail0.1111111111111111
3shot of client 12:head:0.03910614525139665, middle:0.0, tail0.0
3shot of client 13:head:0.00423728813559322, middle:0.02127659574468085, tail0.0
3shot of client 14:head:0.85, middle:0.7027027027027027, tail0.6842105263157895
3shot of client 15:head:0.007518796992481203, middle:0.0, tail0.0
3shot of client 16:head:0.024193548387096774, middle:0.0, tail0.0
3shot of client 17:head:0.8104575163398693, middle:0.7333333333333333, tail0.5714285714285714
3shot of client 18:head:0.047505938242280284, middle:0.0, tail0.0
3shot of client 19:head:0.688034188034188, middle:0.851063829787234, tail0.8181818181818182
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.028368794326241134, middle:0.0, tail0.0
3shot of client 23:head:0.015037593984962405, middle:0.0, tail0.0
3shot of client 24:head:0.20348837209302326, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.12138728323699421, middle:0.0, tail0.0
3shot of client 26:head:0.08307692307692308, middle:0.0, tail0.0
3shot of client 27:head:0.00546448087431694, middle:0.05128205128205128, tail0.0
3shot of client 28:head:0.03488372093023256, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.008620689655172414, middle:0.038461538461538464, tail0.0
3shot of client 30:head:0.00847457627118644, middle:0.0, tail0.0
3shot of client 31:head:0.018518518518518517, middle:0.0, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.0, tail0.0
3shot of client 33:head:0.013392857142857142, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.03787878787878788, middle:0.0, tail0.0
3shot of client 36:head:0.11494252873563218, middle:0.016666666666666666, tail0.07692307692307693
3shot of client 37:head:0.022058823529411766, middle:0.0, tail0.0
3shot of client 38:head:0.808641975308642, middle:0.851063829787234, tail0.5
3shot of client 39:head:0.027472527472527472, middle:0.023255813953488372, tail0.0
round 15, local average test acc  0.1435 

round 15, local macro average F1 score  0.1051 

round 15, local weighted average F1 score  0.1633 

round 15, global test acc  0.7275 

round 15, average 3shot acc: [head: 0.1506, middle: 0.1146, tail: 0.1081] 

round 15, global 3shot acc: [head: 0.8672, middle: 0.7323, tail: 0.5363] 

l_head tensor([3.0528, 2.5648, 1.2048, 2.4895, 1.3418, 1.1940, 1.7136, 1.6837, 1.4868,
        1.9333], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.0831, 1.4413, 1.7732, 1.6611, 1.3858, 1.3777, 1.1584, 1.0759, 1.2521,
        1.1696], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.01910828025477707, middle:0.0, tail0.0
3shot of client 2:head:0.8603351955307262, middle:0.5918367346938775, tail0.5555555555555556
3shot of client 3:head:0.05813953488372093, middle:0.0, tail0.0
3shot of client 4:head:0.054945054945054944, middle:0.0, tail0.0
3shot of client 5:head:0.8380566801619433, middle:0.6129032258064516, tail0.9
3shot of client 6:head:0.02197802197802198, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.030120481927710843, middle:0.0, tail0.0
3shot of client 9:head:0.018115942028985508, middle:0.0, tail0.0
3shot of client 10:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.04, tail0.1111111111111111
3shot of client 12:head:0.027932960893854747, middle:0.021739130434782608, tail0.0
3shot of client 13:head:0.00423728813559322, middle:0.02127659574468085, tail0.0
3shot of client 14:head:0.85625, middle:0.7297297297297297, tail0.6842105263157895
3shot of client 15:head:0.015037593984962405, middle:0.0, tail0.0
3shot of client 16:head:0.03225806451612903, middle:0.0, tail0.0
3shot of client 17:head:0.8300653594771242, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.047505938242280284, middle:0.0, tail0.0
3shot of client 19:head:0.6923076923076923, middle:0.7659574468085106, tail0.7272727272727273
3shot of client 20:head:0.012345679012345678, middle:0.0, tail0.0
3shot of client 21:head:0.009523809523809525, middle:0.0, tail0.0
3shot of client 22:head:0.028368794326241134, middle:0.0, tail0.0
3shot of client 23:head:0.03007518796992481, middle:0.0, tail0.0
3shot of client 24:head:0.20348837209302326, middle:0.027777777777777776, tail0.1
3shot of client 25:head:0.1329479768786127, middle:0.0, tail0.0
3shot of client 26:head:0.09230769230769231, middle:0.0, tail0.0
3shot of client 27:head:0.00546448087431694, middle:0.05128205128205128, tail0.0
  3%|▎         | 17/500 [37:51<18:00:17, 134.20s/it]  4%|▎         | 18/500 [40:07<18:02:48, 134.79s/it]3shot of client 28:head:0.03488372093023256, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.008620689655172414, middle:0.0, tail0.0
3shot of client 30:head:0.01694915254237288, middle:0.0, tail0.0
3shot of client 31:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.022727272727272728, tail0.0
3shot of client 33:head:0.017857142857142856, middle:0.0, tail0.0
3shot of client 34:head:0.012987012987012988, middle:0.0, tail0.0
3shot of client 35:head:0.03409090909090909, middle:0.0, tail0.0
3shot of client 36:head:0.11494252873563218, middle:0.016666666666666666, tail0.07692307692307693
3shot of client 37:head:0.011029411764705883, middle:0.0, tail0.0
3shot of client 38:head:0.8209876543209876, middle:0.851063829787234, tail0.5
3shot of client 39:head:0.016483516483516484, middle:0.023255813953488372, tail0.0
round 16, local average test acc  0.1448 

round 16, local macro average F1 score  0.1055 

round 16, local weighted average F1 score  0.1556 

round 16, global test acc  0.7270 

round 16, average 3shot acc: [head: 0.1522, middle: 0.1157, tail: 0.1084] 

round 16, global 3shot acc: [head: 0.8665, middle: 0.7337, tail: 0.5343] 

l_head tensor([3.0252, 2.5270, 1.2152, 2.5438, 1.3127, 1.1408, 1.6797, 1.7610, 1.4820,
        1.9385], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.1184, 1.4472, 1.8044, 1.6910, 1.3933, 1.3921, 1.1644, 1.0824, 1.2621,
        1.1792], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.030303030303030304, middle:0.0, tail0.0
3shot of client 1:head:0.01910828025477707, middle:0.0, tail0.0
3shot of client 2:head:0.8659217877094972, middle:0.6326530612244898, tail0.5555555555555556
3shot of client 3:head:0.05813953488372093, middle:0.0, tail0.0
3shot of client 4:head:0.054945054945054944, middle:0.0, tail0.0
3shot of client 5:head:0.8461538461538461, middle:0.5806451612903226, tail0.9
3shot of client 6:head:0.016483516483516484, middle:0.0, tail0.0
3shot of client 7:head:0.030303030303030304, middle:0.0, tail0
3shot of client 8:head:0.04216867469879518, middle:0.0, tail0.0
3shot of client 9:head:0.014492753623188406, middle:0.021739130434782608, tail0.0
3shot of client 10:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.04, tail0.0
3shot of client 12:head:0.03910614525139665, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.02127659574468085, tail0.0
3shot of client 14:head:0.859375, middle:0.7027027027027027, tail0.6842105263157895
3shot of client 15:head:0.007518796992481203, middle:0.0, tail0.0
3shot of client 16:head:0.03225806451612903, middle:0.0, tail0.0
3shot of client 17:head:0.8300653594771242, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.047505938242280284, middle:0.0, tail0.0
3shot of client 19:head:0.688034188034188, middle:0.8936170212765957, tail0.8181818181818182
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.030732860520094562, middle:0.0, tail0.0
3shot of client 23:head:0.03007518796992481, middle:0.03225806451612903, tail0.0
3shot of client 24:head:0.22093023255813954, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.1329479768786127, middle:0.0, tail0.0
3shot of client 26:head:0.09538461538461539, middle:0.0, tail0.0
3shot of client 27:head:0.01092896174863388, middle:0.07692307692307693, tail0.0
3shot of client 28:head:0.03488372093023256, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.008620689655172414, middle:0.0, tail0.14285714285714285
3shot of client 30:head:0.025423728813559324, middle:0.0, tail0.0
3shot of client 31:head:0.018518518518518517, middle:0.0, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.022727272727272728, tail0.0
3shot of client 33:head:0.008928571428571428, middle:0.02631578947368421, tail0.0
3shot of client 34:head:0.012987012987012988, middle:0.0, tail0.0
3shot of client 35:head:0.03409090909090909, middle:0.0, tail0.0
3shot of client 36:head:0.10344827586206896, middle:0.016666666666666666, tail0.07692307692307693
3shot of client 37:head:0.022058823529411766, middle:0.0, tail0.0
3shot of client 38:head:0.808641975308642, middle:0.8297872340425532, tail0.5
3shot of client 39:head:0.02197802197802198, middle:0.023255813953488372, tail0.0
round 17, local average test acc  0.1464 

round 17, local macro average F1 score  0.1352 

round 17, local weighted average F1 score  0.1942 

round 17, global test acc  0.7251 

round 17, average 3shot acc: [head: 0.1532, middle: 0.1200, tail: 0.1090] 

round 17, global 3shot acc: [head: 0.8710, middle: 0.7230, tail: 0.5327] 

l_head tensor([3.0407, 2.5436, 1.1944, 2.6705, 1.3502, 1.1682, 1.7078, 1.7807, 1.4890,
        2.0683], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.1563, 1.4506, 1.8355, 1.7285, 1.4044, 1.4147, 1.1810, 1.0986, 1.2756,
        1.2003], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.012738853503184714, middle:0.0, tail0.0
3shot of client 2:head:0.8603351955307262, middle:0.6530612244897959, tail0.5555555555555556
3shot of client 3:head:0.05813953488372093, middle:0.0, tail0.0
3shot of client 4:head:0.054945054945054944, middle:0.0, tail0.0
3shot of client 5:head:0.8502024291497976, middle:0.5806451612903226, tail0.9
3shot of client 6:head:0.02197802197802198, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.04216867469879518, middle:0.0, tail0.0
3shot of client 9:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.04, tail0.0
3shot of client 12:head:0.05027932960893855, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.02127659574468085, tail0.0
3shot of client 14:head:0.84375, middle:0.7162162162162162, tail0.6842105263157895
3shot of client 15:head:0.007518796992481203, middle:0.0, tail0.0
3shot of client 16:head:0.03225806451612903, middle:0.0, tail0.0
3shot of client 17:head:0.8169934640522876, middle:0.8333333333333334, tail0.5714285714285714
3shot of client 18:head:0.0498812351543943, middle:0.012658227848101266, tail0.0
3shot of client 19:head:0.7051282051282052, middle:0.8723404255319149, tail0.8181818181818182
3shot of client 20:head:0.012345679012345678, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.030732860520094562, middle:0.0, tail0.0
3shot of client 23:head:0.015037593984962405, middle:0.0, tail0.0
3shot of client 24:head:0.20930232558139536, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.12716763005780346, middle:0.0, tail0.0
3shot of client 26:head:0.10461538461538461, middle:0.0, tail0.0
3shot of client 27:head:0.00546448087431694, middle:0.02564102564102564, tail0.0
3shot of client 28:head:0.046511627906976744, middle:0.0, tail0.0
3shot of client 29:head:0.017241379310344827, middle:0.0, tail0.14285714285714285
3shot of client 30:head:0.01694915254237288, middle:0.0, tail0.0
3shot of client 31:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 32:head:0.009389671361502348, middle:0.0, tail0.0
3shot of client 33:head:0.026785714285714284, middle:0.0, tail0.0
3shot of client 34:head:0.012987012987012988, middle:0.0, tail0.0
3shot of client 35:head:0.03409090909090909, middle:0.0, tail0.0
3shot of client 36:head:0.11877394636015326, middle:0.05, tail0.0
3shot of client 37:head:0.025735294117647058, middle:0.03333333333333333, tail0.0
3shot of client 38:head:0.808641975308642, middle:0.8297872340425532, tail0.5
3shot of client 39:head:0.016483516483516484, middle:0.023255813953488372, tail0.0
round 18, local average test acc  0.1463 

round 18, local macro average F1 score  0.1253 

round 18, local weighted average F1 score  0.1772 

round 18, global test acc  0.7315 

round 18, average 3shot acc: [head: 0.1535, middle: 0.1180, tail: 0.1070] 

round 18, global 3shot acc: [head: 0.8692, middle: 0.7320, tail: 0.5473] 

l_head   4%|▍         | 19/500 [42:18<17:52:35, 133.80s/it]  4%|▍         | 20/500 [44:30<17:45:30, 133.19s/it]  4%|▍         | 21/500 [46:41<17:38:20, 132.57s/it]tensor([2.9971, 2.5785, 1.2261, 2.6444, 1.4013, 1.1974, 1.6666, 1.8370, 1.5135,
        2.0222], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.1956, 1.4591, 1.8608, 1.7516, 1.4164, 1.4291, 1.1890, 1.0927, 1.2731,
        1.1897], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.006369426751592357, middle:0.0, tail0.0
3shot of client 2:head:0.8770949720670391, middle:0.6938775510204082, tail0.4444444444444444
3shot of client 3:head:0.055232558139534885, middle:0.0, tail0.0
3shot of client 4:head:0.054945054945054944, middle:0.0, tail0.0
3shot of client 5:head:0.8380566801619433, middle:0.5806451612903226, tail0.9
3shot of client 6:head:0.01098901098901099, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.04216867469879518, middle:0.0, tail0.0
3shot of client 9:head:0.028985507246376812, middle:0.0, tail0.0
3shot of client 10:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.12, tail0.1111111111111111
3shot of client 12:head:0.03910614525139665, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.853125, middle:0.7162162162162162, tail0.6842105263157895
3shot of client 15:head:0.015037593984962405, middle:0.0, tail0.0
3shot of client 16:head:0.024193548387096774, middle:0.0, tail0.0
3shot of client 17:head:0.8169934640522876, middle:0.8333333333333334, tail0.5714285714285714
3shot of client 18:head:0.0498812351543943, middle:0.0, tail0.0
3shot of client 19:head:0.7051282051282052, middle:0.851063829787234, tail0.8181818181818182
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.03309692671394799, middle:0.0, tail0.0
3shot of client 23:head:0.03759398496240601, middle:0.0, tail0.0
3shot of client 24:head:0.21511627906976744, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.12138728323699421, middle:0.0, tail0.0
3shot of client 26:head:0.10461538461538461, middle:0.0, tail0.0
3shot of client 27:head:0.01092896174863388, middle:0.02564102564102564, tail0.0
3shot of client 28:head:0.03488372093023256, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.017241379310344827, middle:0.0, tail0.0
3shot of client 30:head:0.00847457627118644, middle:0.0, tail0.0
3shot of client 31:head:0.0, middle:0.0, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.0, tail0.0
3shot of client 33:head:0.026785714285714284, middle:0.0, tail0.0
3shot of client 34:head:0.012987012987012988, middle:0.0, tail0.0
3shot of client 35:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 36:head:0.1111111111111111, middle:0.016666666666666666, tail0.0
3shot of client 37:head:0.01838235294117647, middle:0.0, tail0.0
3shot of client 38:head:0.8148148148148148, middle:0.851063829787234, tail0.5
3shot of client 39:head:0.005494505494505495, middle:0.023255813953488372, tail0.0
round 19, local average test acc  0.1455 

round 19, local macro average F1 score  0.0884 

round 19, local weighted average F1 score  0.1343 

round 19, global test acc  0.7225 

round 19, average 3shot acc: [head: 0.1526, middle: 0.1198, tail: 0.1033] 

round 19, global 3shot acc: [head: 0.8707, middle: 0.7303, tail: 0.5170] 

l_head tensor([3.0364, 2.5653, 1.2285, 2.6657, 1.4091, 1.1959, 1.6748, 1.7759, 1.5037,
        2.0020], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.2368, 1.4705, 1.8858, 1.7813, 1.4351, 1.4514, 1.1978, 1.0993, 1.2722,
        1.1880], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.012738853503184714, middle:0.0, tail0.0
3shot of client 2:head:0.8770949720670391, middle:0.6530612244897959, tail0.4444444444444444
3shot of client 3:head:0.05813953488372093, middle:0.0, tail0.0
3shot of client 4:head:0.054945054945054944, middle:0.0, tail0.0
3shot of client 5:head:0.8421052631578947, middle:0.5806451612903226, tail0.9
3shot of client 6:head:0.01098901098901099, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.03333333333333333, tail0
3shot of client 8:head:0.05421686746987952, middle:0.0, tail0.0
3shot of client 9:head:0.025362318840579712, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.04, tail0.1111111111111111
3shot of client 12:head:0.03910614525139665, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.02127659574468085, tail0.0
3shot of client 14:head:0.834375, middle:0.7027027027027027, tail0.6842105263157895
3shot of client 15:head:0.007518796992481203, middle:0.0, tail0.0
3shot of client 16:head:0.028225806451612902, middle:0.0, tail0.0
3shot of client 17:head:0.8104575163398693, middle:0.7666666666666667, tail0.5714285714285714
3shot of client 18:head:0.052256532066508314, middle:0.0, tail0.0
3shot of client 19:head:0.688034188034188, middle:0.8297872340425532, tail0.8181818181818182
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.028368794326241134, middle:0.0, tail0.0
3shot of client 23:head:0.022556390977443608, middle:0.0, tail0.0
3shot of client 24:head:0.22674418604651161, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.12716763005780346, middle:0.0, tail0.0
3shot of client 26:head:0.09846153846153846, middle:0.0, tail0.0
3shot of client 27:head:0.00546448087431694, middle:0.0, tail0.0
3shot of client 28:head:0.03488372093023256, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.008620689655172414, middle:0.0, tail0.14285714285714285
3shot of client 30:head:0.01694915254237288, middle:0.05263157894736842, tail0.0
3shot of client 31:head:0.0, middle:0.0, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.0, tail0.0
3shot of client 33:head:0.022321428571428572, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.0
3shot of client 35:head:0.04924242424242424, middle:0.0, tail0.07692307692307693
3shot of client 36:head:0.12643678160919541, middle:0.03333333333333333, tail0.0
3shot of client 37:head:0.022058823529411766, middle:0.0, tail0.0
3shot of client 38:head:0.808641975308642, middle:0.851063829787234, tail0.5
3shot of client 39:head:0.02197802197802198, middle:0.023255813953488372, tail0.0
round 20, local average test acc  0.1449 

round 20, local macro average F1 score  0.1081 

round 20, local weighted average F1 score  0.1594 

round 20, global test acc  0.7245 

round 20, average 3shot acc: [head: 0.1519, middle: 0.1167, tail: 0.1090] 

round 20, global 3shot acc: [head: 0.8692, middle: 0.7313, tail: 0.5247] 

l_head tensor([3.1415, 2.5649, 1.2617, 2.6943, 1.3649, 1.2581, 1.8016, 1.8202, 1.5754,
        2.0142], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.2829, 1.4811, 1.9146, 1.8107, 1.4424, 1.4632, 1.2112, 1.1077, 1.2740,
        1.1987], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.012738853503184714, middle:0.0, tail0.0
3shot of client 2:head:0.8659217877094972, middle:0.6938775510204082, tail0.4444444444444444
3shot of client 3:head:0.055232558139534885, middle:0.03571428571428571, tail0.0
3shot of client 4:head:0.054945054945054944, middle:0.0, tail0.0
3shot of client 5:head:0.8582995951417004, middle:0.5806451612903226, tail0.8
3shot of client 6:head:0.016483516483516484, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.04819277108433735, middle:0.0, tail0.0
3shot of client 9:head:0.014492753623188406, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.04, tail0.0
3shot of client 12:head:0.03910614525139665, middle:0.021739130434782608, tail0.0
3shot of client 13:head:0.0, middle:0.0425531914893617, tail0.0
3shot of client 14:head:0.85625, middle:0.7567567567567568, tail0.6842105263157895
  4%|▍         | 22/500 [48:54<17:37:11, 132.70s/it]  5%|▍         | 23/500 [51:06<17:32:45, 132.42s/it]3shot of client 15:head:0.007518796992481203, middle:0.0, tail0.0
3shot of client 16:head:0.012096774193548387, middle:0.0, tail0.0
3shot of client 17:head:0.8300653594771242, middle:0.6666666666666666, tail0.5714285714285714
3shot of client 18:head:0.047505938242280284, middle:0.012658227848101266, tail0.0
3shot of client 19:head:0.7051282051282052, middle:0.8936170212765957, tail0.8181818181818182
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.028368794326241134, middle:0.0, tail0.0
3shot of client 23:head:0.007518796992481203, middle:0.0, tail0.0
3shot of client 24:head:0.22674418604651161, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.12716763005780346, middle:0.0, tail0.0
3shot of client 26:head:0.1076923076923077, middle:0.0, tail0.0
3shot of client 27:head:0.00546448087431694, middle:0.02564102564102564, tail0.0
3shot of client 28:head:0.03488372093023256, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.017241379310344827, middle:0.0, tail0.14285714285714285
3shot of client 30:head:0.01694915254237288, middle:0.05263157894736842, tail0.0
3shot of client 31:head:0.0, middle:0.0, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.022727272727272728, tail0.0
3shot of client 33:head:0.026785714285714284, middle:0.0, tail0.0
3shot of client 34:head:0.012987012987012988, middle:0.0, tail0.0
3shot of client 35:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 36:head:0.12643678160919541, middle:0.05, tail0.0
3shot of client 37:head:0.01838235294117647, middle:0.0, tail0.0
3shot of client 38:head:0.8024691358024691, middle:0.851063829787234, tail0.5
3shot of client 39:head:0.02197802197802198, middle:0.023255813953488372, tail0.0
round 21, local average test acc  0.1460 

round 21, local macro average F1 score  0.1090 

round 21, local weighted average F1 score  0.1624 

round 21, global test acc  0.7292 

round 21, average 3shot acc: [head: 0.1527, middle: 0.1212, tail: 0.1016] 

round 21, global 3shot acc: [head: 0.8715, middle: 0.7167, tail: 0.5520] 

l_head tensor([3.1135, 2.5840, 1.2170, 2.7221, 1.4278, 1.2152, 1.7617, 1.8086, 1.5294,
        2.0585], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.3255, 1.4976, 1.9427, 1.8415, 1.4566, 1.4789, 1.2276, 1.1161, 1.2797,
        1.2117], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.012738853503184714, middle:0.0, tail0.0
3shot of client 2:head:0.8659217877094972, middle:0.6122448979591837, tail0.5555555555555556
3shot of client 3:head:0.05813953488372093, middle:0.017857142857142856, tail0.0
3shot of client 4:head:0.054945054945054944, middle:0.0, tail0.0
3shot of client 5:head:0.8421052631578947, middle:0.5806451612903226, tail0.8
3shot of client 6:head:0.01098901098901099, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.04819277108433735, middle:0.0, tail0.0
3shot of client 9:head:0.010869565217391304, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0335195530726257, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.02127659574468085, tail0.0
3shot of client 14:head:0.85625, middle:0.7162162162162162, tail0.6842105263157895
3shot of client 15:head:0.015037593984962405, middle:0.0, tail0.0
3shot of client 16:head:0.024193548387096774, middle:0.0, tail0.0
3shot of client 17:head:0.8300653594771242, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.0498812351543943, middle:0.0, tail0.0
3shot of client 19:head:0.7051282051282052, middle:0.8936170212765957, tail0.8181818181818182
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.030732860520094562, middle:0.0, tail0.0
3shot of client 23:head:0.022556390977443608, middle:0.03225806451612903, tail0.0
3shot of client 24:head:0.23255813953488372, middle:0.027777777777777776, tail0.1
3shot of client 25:head:0.12716763005780346, middle:0.03225806451612903, tail0.0
3shot of client 26:head:0.10153846153846154, middle:0.0, tail0.0
3shot of client 27:head:0.01639344262295082, middle:0.0, tail0.0
3shot of client 28:head:0.03488372093023256, middle:0.0, tail0.0
3shot of client 29:head:0.017241379310344827, middle:0.0, tail0.14285714285714285
3shot of client 30:head:0.01694915254237288, middle:0.05263157894736842, tail0.0
3shot of client 31:head:0.018518518518518517, middle:0.03225806451612903, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.022727272727272728, tail0.0
3shot of client 33:head:0.017857142857142856, middle:0.0, tail0.0
3shot of client 34:head:0.012987012987012988, middle:0.0, tail0.0
3shot of client 35:head:0.03409090909090909, middle:0.0, tail0.0
3shot of client 36:head:0.11877394636015326, middle:0.016666666666666666, tail0.0
3shot of client 37:head:0.01838235294117647, middle:0.0, tail0.0
3shot of client 38:head:0.8148148148148148, middle:0.8297872340425532, tail0.5
3shot of client 39:head:0.03296703296703297, middle:0.023255813953488372, tail0.0
round 22, local average test acc  0.1463 

round 22, local macro average F1 score  0.0874 

round 22, local weighted average F1 score  0.1288 

round 22, global test acc  0.7281 

round 22, average 3shot acc: [head: 0.1537, middle: 0.1178, tail: 0.1070] 

round 22, global 3shot acc: [head: 0.8677, middle: 0.7390, tail: 0.5310] 

l_head tensor([3.1138, 2.6643, 1.2843, 2.7691, 1.3847, 1.2484, 1.7063, 1.8556, 1.5430,
        2.0445], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.3734, 1.5027, 1.9738, 1.8666, 1.4831, 1.5027, 1.2466, 1.1187, 1.2798,
        1.2148], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.012738853503184714, middle:0.0, tail0.0
3shot of client 2:head:0.8770949720670391, middle:0.6938775510204082, tail0.5555555555555556
3shot of client 3:head:0.06395348837209303, middle:0.0, tail0.0
3shot of client 4:head:0.054945054945054944, middle:0.0, tail0.0
3shot of client 5:head:0.8461538461538461, middle:0.5806451612903226, tail0.8
3shot of client 6:head:0.016483516483516484, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.04819277108433735, middle:0.0, tail0.0
3shot of client 9:head:0.007246376811594203, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.1111111111111111
3shot of client 12:head:0.05027932960893855, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.02127659574468085, tail0.0
3shot of client 14:head:0.853125, middle:0.7432432432432432, tail0.6842105263157895
3shot of client 15:head:0.03007518796992481, middle:0.0, tail0.0
3shot of client 16:head:0.03225806451612903, middle:0.0, tail0.0
3shot of client 17:head:0.8235294117647058, middle:0.7666666666666667, tail0.5714285714285714
3shot of client 18:head:0.05463182897862233, middle:0.0, tail0.0
3shot of client 19:head:0.7008547008547008, middle:0.8723404255319149, tail0.8181818181818182
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.03309692671394799, middle:0.0, tail0.0
3shot of client 23:head:0.03759398496240601, middle:0.0, tail0.0
3shot of client 24:head:0.2441860465116279, middle:0.027777777777777776, tail0.2
3shot of client 25:head:0.1329479768786127, middle:0.0, tail0.0
3shot of client 26:head:0.11076923076923077, middle:0.0, tail0.0
3shot of client 27:head:0.01092896174863388, middle:0.02564102564102564, tail0.0
3shot of client 28:head:0.03488372093023256, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.017241379310344827, middle:0.0, tail0.0
3shot of client 30:head:0.00847457627118644, middle:0.05263157894736842, tail0.0
3shot of client 31:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 32:head:0.018779342723004695, middle:0.0, tail0.0
  5%|▍         | 24/500 [53:18<17:29:05, 132.24s/it]  5%|▌         | 25/500 [55:28<17:21:15, 131.53s/it]  5%|▌         | 26/500 [57:37<17:14:34, 130.96s/it]3shot of client 33:head:0.013392857142857142, middle:0.0, tail0.0
3shot of client 34:head:0.025974025974025976, middle:0.0, tail0.0
3shot of client 35:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 36:head:0.13026819923371646, middle:0.016666666666666666, tail0.07692307692307693
3shot of client 37:head:0.01838235294117647, middle:0.0, tail0.0
3shot of client 38:head:0.8209876543209876, middle:0.8297872340425532, tail0.5
3shot of client 39:head:0.016483516483516484, middle:0.023255813953488372, tail0.0
round 23, local average test acc  0.1484 

round 23, local macro average F1 score  0.1037 

round 23, local weighted average F1 score  0.1519 

round 23, global test acc  0.7258 

round 23, average 3shot acc: [head: 0.1560, middle: 0.1177, tail: 0.1107] 

round 23, global 3shot acc: [head: 0.8710, middle: 0.7267, tail: 0.5313] 

l_head tensor([3.1078, 2.6074, 1.3357, 2.7840, 1.4247, 1.3044, 1.7887, 1.7968, 1.5315,
        2.0694], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.4046, 1.5161, 1.9961, 1.8960, 1.4959, 1.5181, 1.2497, 1.1387, 1.2813,
        1.2181], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.030303030303030304, middle:0.0, tail0.0
3shot of client 1:head:0.012738853503184714, middle:0.0, tail0.0
3shot of client 2:head:0.8715083798882681, middle:0.6530612244897959, tail0.4444444444444444
3shot of client 3:head:0.061046511627906974, middle:0.0, tail0.0
3shot of client 4:head:0.054945054945054944, middle:0.0, tail0.0
3shot of client 5:head:0.8299595141700404, middle:0.5806451612903226, tail0.9
3shot of client 6:head:0.03296703296703297, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.04216867469879518, middle:0.0, tail0.0
3shot of client 9:head:0.04710144927536232, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0335195530726257, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.846875, middle:0.7162162162162162, tail0.6842105263157895
3shot of client 15:head:0.022556390977443608, middle:0.0, tail0.0
3shot of client 16:head:0.03225806451612903, middle:0.0, tail0.0
3shot of client 17:head:0.8300653594771242, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.05463182897862233, middle:0.0, tail0.0
3shot of client 19:head:0.6837606837606838, middle:0.8723404255319149, tail0.8181818181818182
3shot of client 20:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.030732860520094562, middle:0.0, tail0.0
3shot of client 23:head:0.03759398496240601, middle:0.0, tail0.0
3shot of client 24:head:0.23255813953488372, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.1329479768786127, middle:0.06451612903225806, tail0.0
3shot of client 26:head:0.1076923076923077, middle:0.0, tail0.0
3shot of client 27:head:0.00546448087431694, middle:0.05128205128205128, tail0.0
3shot of client 28:head:0.03488372093023256, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.02586206896551724, middle:0.0, tail0.14285714285714285
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.0, middle:0.03225806451612903, tail0.0
3shot of client 32:head:0.018779342723004695, middle:0.0, tail0.0
3shot of client 33:head:0.026785714285714284, middle:0.0, tail0.0
3shot of client 34:head:0.012987012987012988, middle:0.0, tail0.0
3shot of client 35:head:0.05303030303030303, middle:0.0, tail0.07692307692307693
3shot of client 36:head:0.13409961685823754, middle:0.06666666666666667, tail0.07692307692307693
3shot of client 37:head:0.01838235294117647, middle:0.0, tail0.0
3shot of client 38:head:0.8209876543209876, middle:0.851063829787234, tail0.5
3shot of client 39:head:0.016483516483516484, middle:0.023255813953488372, tail0.0
round 24, local average test acc  0.1484 

round 24, local macro average F1 score  0.1475 

round 24, local weighted average F1 score  0.2055 

round 24, global test acc  0.7264 

round 24, average 3shot acc: [head: 0.1556, middle: 0.1198, tail: 0.1081] 

round 24, global 3shot acc: [head: 0.8697, middle: 0.7227, tail: 0.5390] 

l_head tensor([3.1805, 2.6083, 1.3238, 2.8174, 1.4005, 1.2801, 1.7826, 1.8316, 1.6152,
        2.0782], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.4575, 1.5314, 2.0239, 1.9248, 1.5235, 1.5335, 1.2653, 1.1399, 1.2805,
        1.2285], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.012738853503184714, middle:0.0, tail0.0
3shot of client 2:head:0.8659217877094972, middle:0.673469387755102, tail0.4444444444444444
3shot of client 3:head:0.05813953488372093, middle:0.0, tail0.0
3shot of client 4:head:0.054945054945054944, middle:0.0, tail0.0
3shot of client 5:head:0.854251012145749, middle:0.5806451612903226, tail0.8
3shot of client 6:head:0.02197802197802198, middle:0.0, tail0.0
3shot of client 7:head:0.015151515151515152, middle:0.0, tail0
3shot of client 8:head:0.05421686746987952, middle:0.0, tail0.0
3shot of client 9:head:0.0036231884057971015, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.047619047619047616, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0335195530726257, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.02127659574468085, tail0.0
3shot of client 14:head:0.8125, middle:0.7027027027027027, tail0.6842105263157895
3shot of client 15:head:0.007518796992481203, middle:0.0, tail0.0
3shot of client 16:head:0.024193548387096774, middle:0.0, tail0.0
3shot of client 17:head:0.8431372549019608, middle:0.8, tail0.5714285714285714
3shot of client 18:head:0.052256532066508314, middle:0.0, tail0.0
3shot of client 19:head:0.6495726495726496, middle:0.851063829787234, tail0.8181818181818182
3shot of client 20:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.028368794326241134, middle:0.0, tail0.0
3shot of client 23:head:0.007518796992481203, middle:0.0, tail0.0
3shot of client 24:head:0.2441860465116279, middle:0.027777777777777776, tail0.0
3shot of client 25:head:0.14450867052023122, middle:0.0, tail0.0
3shot of client 26:head:0.1076923076923077, middle:0.0, tail0.0
3shot of client 27:head:0.01639344262295082, middle:0.02564102564102564, tail0.0
3shot of client 28:head:0.03488372093023256, middle:0.0, tail0.0
3shot of client 29:head:0.034482758620689655, middle:0.0, tail0.2857142857142857
3shot of client 30:head:0.0, middle:0.0, tail0.0
3shot of client 31:head:0.0, middle:0.0, tail0.0
3shot of client 32:head:0.014084507042253521, middle:0.0, tail0.0
3shot of client 33:head:0.008928571428571428, middle:0.0, tail0.0
3shot of client 34:head:0.025974025974025976, middle:0.0, tail0.0
3shot of client 35:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 36:head:0.13793103448275862, middle:0.06666666666666667, tail0.07692307692307693
3shot of client 37:head:0.022058823529411766, middle:0.0, tail0.0
3shot of client 38:head:0.7901234567901234, middle:0.8297872340425532, tail0.5
3shot of client 39:head:0.02197802197802198, middle:0.023255813953488372, tail0.0
round 25, local average test acc  0.1448 

round 25, local macro average F1 score  0.1546 

round 25, local weighted average F1 score  0.2219 

round 25, global test acc  0.7303 

round 25, average 3shot acc: [head: 0.1519, middle: 0.1162, tail: 0.1072] 

round 25, global 3shot acc: [head: 0.8765, middle: 0.7127, tail: 0.5530] 

l_head tensor([3.2814, 2.7005, 1.2965, 2.8202, 1.4307, 1.2359, 1.8703, 1.9366, 1.5383,
        2.1305], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.4898, 1.5416, 2.0514, 1.9605, 1.5312, 1.5469, 1.2812, 1.1459, 1.2883,
        1.2348], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.01910828025477707, middle:0.0, tail0.0
  5%|▌         | 27/500 [59:57<17:32:28, 133.51s/it]  6%|▌         | 28/500 [1:02:16<17:43:28, 135.19s/it]3shot of client 2:head:0.8547486033519553, middle:0.6530612244897959, tail0.4444444444444444
3shot of client 3:head:0.06976744186046512, middle:0.03571428571428571, tail0.0
3shot of client 4:head:0.054945054945054944, middle:0.0, tail0.0
3shot of client 5:head:0.8340080971659919, middle:0.5806451612903226, tail0.9
3shot of client 6:head:0.02197802197802198, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.06626506024096386, middle:0.0, tail0.0
3shot of client 9:head:0.025362318840579712, middle:0.0, tail0.0
3shot of client 10:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0446927374301676, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0425531914893617, tail0.0
3shot of client 14:head:0.846875, middle:0.7432432432432432, tail0.6842105263157895
3shot of client 15:head:0.0, middle:0.0, tail0.0
3shot of client 16:head:0.036290322580645164, middle:0.0, tail0.0
3shot of client 17:head:0.8235294117647058, middle:0.7666666666666667, tail0.5714285714285714
3shot of client 18:head:0.05463182897862233, middle:0.0, tail0.0
3shot of client 19:head:0.6794871794871795, middle:0.7872340425531915, tail0.8181818181818182
3shot of client 20:head:0.0, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.030732860520094562, middle:0.0, tail0.0
3shot of client 23:head:0.03007518796992481, middle:0.0, tail0.0
3shot of client 24:head:0.2441860465116279, middle:0.027777777777777776, tail0.1
3shot of client 25:head:0.15028901734104047, middle:0.0, tail0.0
3shot of client 26:head:0.11076923076923077, middle:0.0, tail0.0
3shot of client 27:head:0.00546448087431694, middle:0.02564102564102564, tail0.0
3shot of client 28:head:0.046511627906976744, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.017241379310344827, middle:0.0, tail0.2857142857142857
3shot of client 30:head:0.00847457627118644, middle:0.05263157894736842, tail0.0
3shot of client 31:head:0.006172839506172839, middle:0.03225806451612903, tail0.0
3shot of client 32:head:0.018779342723004695, middle:0.0, tail0.0
3shot of client 33:head:0.017857142857142856, middle:0.0, tail0.0
3shot of client 34:head:0.025974025974025976, middle:0.0, tail0.0
3shot of client 35:head:0.04924242424242424, middle:0.0, tail0.0
3shot of client 36:head:0.13026819923371646, middle:0.06666666666666667, tail0.0
3shot of client 37:head:0.01838235294117647, middle:0.0, tail0.0
3shot of client 38:head:0.8148148148148148, middle:0.851063829787234, tail0.5
3shot of client 39:head:0.016483516483516484, middle:0.023255813953488372, tail0.0
round 26, local average test acc  0.1484 

round 26, local macro average F1 score  0.1091 

round 26, local weighted average F1 score  0.1576 

round 26, global test acc  0.7316 

round 26, average 3shot acc: [head: 0.1558, middle: 0.1185, tail: 0.1104] 

round 26, global 3shot acc: [head: 0.8727, middle: 0.7240, tail: 0.5510] 

l_head tensor([3.3909, 2.7158, 1.3375, 2.8835, 1.3926, 1.2503, 1.8611, 1.9142, 1.4667,
        2.0959], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.5187, 1.5430, 2.0827, 1.9804, 1.5500, 1.5554, 1.2941, 1.1472, 1.2924,
        1.2426], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.024242424242424242, middle:0.0, tail0.0
3shot of client 1:head:0.01910828025477707, middle:0.0, tail0.0
3shot of client 2:head:0.8715083798882681, middle:0.6938775510204082, tail0.5555555555555556
3shot of client 3:head:0.05813953488372093, middle:0.0, tail0.0
3shot of client 4:head:0.054945054945054944, middle:0.0, tail0.0
3shot of client 5:head:0.8421052631578947, middle:0.5806451612903226, tail0.8
3shot of client 6:head:0.02197802197802198, middle:0.0, tail0.0
3shot of client 7:head:0.015151515151515152, middle:0.0, tail0
3shot of client 8:head:0.05421686746987952, middle:0.0, tail0.0
3shot of client 9:head:0.018115942028985508, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.047619047619047616, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.0335195530726257, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.02127659574468085, tail0.0
3shot of client 14:head:0.834375, middle:0.7297297297297297, tail0.6842105263157895
3shot of client 15:head:0.015037593984962405, middle:0.0, tail0.0
3shot of client 16:head:0.028225806451612902, middle:0.0, tail0.0
3shot of client 17:head:0.8300653594771242, middle:0.7333333333333333, tail0.5714285714285714
3shot of client 18:head:0.052256532066508314, middle:0.012658227848101266, tail0.0
3shot of client 19:head:0.7393162393162394, middle:0.8723404255319149, tail0.8181818181818182
3shot of client 20:head:0.006172839506172839, middle:0.0, tail0.0
3shot of client 21:head:0.0, middle:0.0, tail0.0
3shot of client 22:head:0.028368794326241134, middle:0.0, tail0.0
3shot of client 23:head:0.022556390977443608, middle:0.03225806451612903, tail0.0
3shot of client 24:head:0.25, middle:0.027777777777777776, tail0.1
3shot of client 25:head:0.1329479768786127, middle:0.0, tail0.0
3shot of client 26:head:0.11384615384615385, middle:0.0, tail0.0
3shot of client 27:head:0.01092896174863388, middle:0.02564102564102564, tail0.0
3shot of client 28:head:0.046511627906976744, middle:0.05263157894736842, tail0.0
3shot of client 29:head:0.017241379310344827, middle:0.0, tail0.14285714285714285
3shot of client 30:head:0.01694915254237288, middle:0.10526315789473684, tail0.0
3shot of client 31:head:0.0, middle:0.0, tail0.0
3shot of client 32:head:0.018779342723004695, middle:0.0, tail0.0
3shot of client 33:head:0.017857142857142856, middle:0.0, tail0.0
3shot of client 34:head:0.012987012987012988, middle:0.0, tail0.0
3shot of client 35:head:0.03787878787878788, middle:0.0, tail0.07692307692307693
3shot of client 36:head:0.12643678160919541, middle:0.0, tail0.0
3shot of client 37:head:0.01838235294117647, middle:0.0, tail0.0
3shot of client 38:head:0.8209876543209876, middle:0.851063829787234, tail0.5
3shot of client 39:head:0.016483516483516484, middle:0.023255813953488372, tail0.0
round 27, local average test acc  0.1486 

round 27, local macro average F1 score  0.1043 

round 27, local weighted average F1 score  0.1488 

round 27, global test acc  0.7261 

round 27, average 3shot acc: [head: 0.1557, middle: 0.1202, tail: 0.1090] 

round 27, global 3shot acc: [head: 0.8727, middle: 0.7247, tail: 0.5320] 

l_head tensor([3.3651, 2.7238, 1.3566, 2.9308, 1.4436, 1.2359, 1.8707, 1.9348, 1.5040,
        2.1064], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
g_aux tensor([2.5635, 1.5669, 2.1025, 2.0069, 1.5739, 1.5639, 1.3094, 1.1602, 1.2929,
        1.2515], device='cuda:5', grad_fn=<LinalgVectorNormBackward0>)
3shot of client 0:head:0.030303030303030304, middle:0.0, tail0.0
3shot of client 1:head:0.012738853503184714, middle:0.0, tail0.0
3shot of client 2:head:0.8659217877094972, middle:0.5714285714285714, tail0.5555555555555556
3shot of client 3:head:0.06976744186046512, middle:0.03571428571428571, tail0.0
3shot of client 4:head:0.04395604395604396, middle:0.0, tail0.0
3shot of client 5:head:0.8340080971659919, middle:0.5806451612903226, tail0.8
3shot of client 6:head:0.016483516483516484, middle:0.0, tail0.0
3shot of client 7:head:0.022727272727272728, middle:0.0, tail0
3shot of client 8:head:0.05421686746987952, middle:0.0, tail0.0
3shot of client 9:head:0.014492753623188406, middle:0.021739130434782608, tail0.0
3shot of client 10:head:0.010526315789473684, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.0
3shot of client 12:head:0.03910614525139665, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.0, tail0.0
3shot of client 14:head:0.83125, middle:0.7162162162162162, tail0.6842105263157895
3shot of client 15:head:0.022556390977443608, middle:0.0, tail0.0
3shot of client 16:head:0.024193548387096774, middle:0.0, tail0.0
3shot of client 17:head:0.8235294117647058, middle:0.7333333333333333, tail0.5714285714285714
3shot of client 18:head:0.05938242280285035, middle:0.0, tail0.0
  6%|▌         | 29/500 [1:04:33<17:45:32, 135.74s/it]  6%|▌         | 30/500 [1:06:47<17:39:43, 135.28s/it]
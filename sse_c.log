nohup: ignoring input
./temp/fl_acc_cifar100_resnet34_cons_frac0.3_iidFalse_iter500_ep5_lr0.03_N40_100_seed3407_p1_dirichlet0.5_IF0.01_LossCE.txt
Files already downloaded and verified
[500, 477, 455, 434, 415, 396, 378, 361, 344, 328, 314, 299, 286, 273, 260, 248, 237, 226, 216, 206, 197, 188, 179, 171, 163, 156, 149, 142, 135, 129, 123, 118, 112, 107, 102, 98, 93, 89, 85, 81, 77, 74, 70, 67, 64, 61, 58, 56, 53, 51, 48, 46, 44, 42, 40, 38, 36, 35, 33, 32, 30, 29, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 15, 14, 13, 13, 12, 12, 11, 11, 10, 10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5]
10847
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[264, 285, 233, 378, 283, 185, 318, 263, 231, 256, 187, 218, 317, 207, 306, 213, 270, 263, 406, 383, 297, 368, 255, 297, 233, 224, 202, 230, 330, 325, 196, 315, 186, 299, 265, 199, 289, 305, 244, 322]
training set distribution:
[[ 0  0 27 14  2  9 15 24 24  0  4  0  0  5  9 11  4  0  0  1  3  4  0  3
   0 14  4 27  2  0  6  7  3  9  1  0  0  0  0  2  2  0  0  2  2  0  1  0
   2  1  0  1  0  1  1  0  1  1  1  0  0  0  1  0  0  0  0  2  0  3  0  1
   0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0
   1  0  1  2]
 [70  0 40  1 21  0  6  0 19 29  0  2 12  0 21  1  0  2  3  2  1  1  5  1
   0  2  2  1  1  0  0  2  1  1  0  0  2  2  0  1  0  0  0  0  0  5  0  0
   0  9  0  5  1  0  0  0  0  0  0  7  0  0  0  1  0  0  1  0  0  1  0  0
   0  0  0  0  0  0  0  0  1  0  0  2  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [11  2 10  9  4  7  1  0 20  0  4  6  3  0  3  3  3 14  6  3 11  5  1  3
   0 12 15  0  0  1  4  1  0  2  0  2  5  1  0  2  0  9  0  2  2  8  0  0
   0  5  0  0  3  0  0  2  0  0  4  1  0  0  0  0  4  1  3  1  0  0  0  1
   0  2  0  4  0  2  1  0  0  0  1  0  0  0  1  0  0  0  0  0  1  0  0  0
   0  0  1  0]
 [ 0  7 12 54  6  1 76 52  2 13  2 12 10  0  4  2  0  0  7  0 10 10  2  0
   3  4  3  0  0  1  0  7  5  5  2  0  2  2 22  2  0  1  4  0  0  0  0  0
   0  4  4  0  6  2  1  3  0  0  0  2  1  0  0  0  1  2  0  1  1  1  0  1
   0  0  0  0  0  1  0  0  0  0  1  0  0  0  1  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [12 27 41  0 13  1  1  6  5  0  0 27  5 12 14 10  0  3  0  0 20  0  4  0
   1  1  0  0  9  1 11 10  0  0  0  1  1 14  0  1  0  0  3  2  2  4  0  4
   0  0  1  0  0  1  0  3  1  0  1  0  1  0  0  0  0  2  0  3  0  0  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  1  0
   0  0  0  0]
 [ 0  1  0 14  3  1 37  2 10  2  0  5  0  0 10  5  0  2  0 17  3  0  0  7
   4  3  0  1  2  5  0  0  1  0  0  0  2  2  7  0  8  5  2  0  1  2  0  0
   1  0  3  0  1  3  0  0  2  0  1  0  0  0  1  0  1  0  2  0  0  0  0  0
   1  0  0  0  0  1  0  0  2  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0
   0  0  1  0]
 [11 28  9 11  0  6 16 51 12  0 45  3  8  0 17  6  1  0  0  0  1 17  0  1
   2  6  0  9  4  0  3  0  1  0 10  5  0  0  0  9  0  0  3  1  7  0  0  1
   0  4  3  0  3  0  0  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  1  0 46  1 13 10  5  5  5 14  9  2 16  4 27  0  2  0  0  0  0  1  5
   8  0  4  1  3  2  3  3 12  0  6  5  2  0  0  4  4  1  1  0  0  5  7  1
   0  0  3  2  3  0  1  2  0  1  0  0  0  0  0  2  0  0  0  0  0  3  1  0
   0  0  1  0  0  0  0  0  0  0  0  1  2  0  0  0  0  0  0  0  2  0  0  0
   0  0  1  0]
 [ 0  0  0  0  0 43  2  1  3  2 12  2 12  5 21  0  0  4  3 19  8  1  3  7
   2  0  4  3  1  0  1  1  0  1  0 14  5  0  0 15  1  7  4  2  0  0  1  0
   0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  2  5  0  2  0  0  2
   0  0  0  2  1  0  0  0  1  1  0  1  1  0  0  1  0  0  0  1  0  0  0  0
   0  0  0  0]
 [ 1  0  3  8 24 21  1 11 15  0  1  5  3  0  5  0 45  1  5  4  7  1  0  1
   2  3 13  0  4  0  0  0  2  1  8  0  2  4  2  1  1  0  0  6 11  1  1  3
   4  0  1  1  0  1 10  0  2  1  0  0  0  0  2  0  0  0  0  0  2  0  0  0
   0  0  1  0  1  0  0  0  0  0  0  0  0  2  0  0  0  0  1  0  0  0  0  0
   0  0  0  0]
 [14 21  7  0  1  4  3  5  0  6  2  0  1  2  0 14  0  6  6  7  2 17  5  7
   7  0  7  0 10  2  0  0  0  0  0  1  0  0  1  0  2  3  0  4  2  0  0  1
   1  0  1  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  2  1  1  1  1
   0  0  2  2  0  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0
   0  0  0  0]
 [ 0 44  0  6  6  0  4  2  1  2  8  3 21  0  3  1 24  1  0  1  8  7  1  0
   7  1  0  9  0  0  1  6  1  3  1  0  0  1  0  0  6  5  1  0  5  0  0  0
   2  2  0  0  0  0  0  0  1  4  0  1  1  0  1  1  0  0  0  0  1  4  0  0
   4  0  1  0  1  0  0  0  0  1  0  0  0  0  1  0  0  0  0  1  0  0  0  0
   1  0  0  0]
 [24  3  9  4 10 10 37  6  3 49  7  1  0  0  3  2 10  5  1  1 15  3  0 21
   0  3  0 16  6  2  3  0  0  0  3  4  0  0  1  6  2  0  0  1  3  0  4  1
   4  0  1  1  3  1  2  2  0  1  1  0  3  0  3  0  0  1  0  1  2  1  0  1
   1  1  0  0  0  0  1  0  0  0  0  0  0  0  0  4  0  0  1  0  0  1  0  0
   0  0  1  0]
 [ 4  5  3  0  0  1  0  2 13  0  0 21  0  0  4  0 13  0 19  1  3  3  4  1
  23  9  5  9  7  0  5  1  2  0  5  0  0  4  5  2  3  0  2  1  2  0  0  0
   0  1  0  0  3  2  2  0  2  0  1  0  0  5  0  2  0  1  0  0  0  0  0  0
   0  1  0  0  0  0  0  1  1  1  1  0  0  0  0  0  1  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0 50 13  1  0 31  1  6 19  0  0  0  2 12 22  1  0  0 32  0 12  0 10  0
   0  0 13  0  5  1  0 15  4  5  3  8  2  3  4  0  0  1  8  0  0  1  0  0
   1  0  2  0  0  0  0  0  2  2  2  0  0  0  0  0  0  2  1  1  0  0  0  0
   0  0  0  2  1  0  0  0  1  1  1  0  0  0  0  0  1  1  0  0  0  0  0  0
   0  0  0  0]
 [ 0  3  7  4 11 29  3  0 13 23  0  0  2  1  2  8  3  1  3  6  5  3  3  1
   0  2  0  0  4  4  9  3  0  4  4  0  0  0  0  2  0  9  1  2  0  0  1  8
   4  1  0  3  1  0  2  0  3  1  0  1  0  1  1  1  0  2  0  0  0  0  1  0
   1  0  0  0  0  0  1  0  0  0  0  0  0  2  0  0  0  1  0  0  0  0  0  0
   1  1  0  0]
 [12 42  0  0  0 10  0  2  4 25  4  0 28 28  5  3  0  2  1  7  2  3  6  8
   0  2  2 15  2  1  0  0  1  1  0  2  0  6  2  2  7  0  0  7  2  1  0  0
   3  0  1  1  0  0  2  0  0  0  1  1  1  2  0  0  1  1  0  0  0  0  3  0
   0  1  1  0  1  0  0  1  0  0  0  0  0  1  0  0  0  0  1  2  0  0  0  0
   0  0  0  0]
 [ 3  8  2  0 59  0  9  2 14 32  1  0  1  1  0  0  6  1  6  3  0  5  1  0
   4 25  1  8  4  1  1  0  4  2 14  0  1  4  0  0  0  0  3  5  0  0  1  0
   1  0  2  0  0  2  6  0  4  0  0  1  0  0  3  0  0  0  2  0  0  0  1  2
   0  0  0  0  0  0  0  0  1  0  0  0  0  0  2  0  0  0  0  0  0  2  0  0
   0  2  0  0]
 [19 75 32  4  0  2  6 13  1  4 21 22 11 21 43  0  6  0  4  6  2 18  0  2
   4  4  0  0  1  7 17  0  6  1 10  1  0 14  3  0  0  6  3  0  1  0  0  2
   1  0  3  0  1  0  1  0  0  0  0  0  1  0  1  0  0  0  0  0  0  0  1  1
   0  0  0  0  0  0  0  0  1  0  2  0  0  0  0  0  0  0  0  0  0  0  1  0
   0  0  0  0]
 [26  3 37 60  0 19  0  5  0  2  0 19  2  3  2 38  3  1 15  2  0 24  9 10
   0  2  0  0  7  4  2 10 23  4  0  2  0  1  0  1  1  4 10  0  1  1  3  0
   0  0  1  3  1  0  0  2  3  0  0  0  0  0  0  0  0  0  1  3  0  0  2  0
   0  0  1  0  2  0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  0  0  0  3
   1  0  0  1]
 [22  4  7 39 20 21  1 11 15  3  0  0  2  1  0  6 49  2  0  7  2  3 17  2
   5  2  0  2  2  3  1  0  0  1  0  0  6  0  0  5  3  0  1  0  0  2  9  0
   0  2  0  0  1  0  0  0  2  0  0  0  0  3  0  1  0  0  0  3  1  0  2  0
   0  0  0  0  0  1  0  3  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  0 28  0  5  0  1 37  0 22 35 18 25  7  0 12  0 17  8  1  1  0  3 13
   0  5  1  2 28 26  0  0  2  8  1  0  2  0  1  3  0  0  1  4  0  4  0  8
   0  0  0  0  1 11  0  0  1  4  0  6  0  1  0  0  0  0  0  0  0  0  1  0
   0  1  0  0  0  3  4  0  0  0  0  1  2  1  1  1  0  0  0  0  0  0  0  0
   0  0  0  0]
 [21 14  2  1 16  1 24 23  3  9  5  2  3  0  0  5 17  0  1  2  0  1  2  0
   2  1 10  0  1  0  3  7  5  8  0 23  0  0  0  1  1  6  3  2  0  0  0 11
   0  2  0  2  0  0  0  1  1  0  6  1  1  0  0  0  0  1  2  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [12  5 35 10 12 11  4  7 14  7  9  0 12 13  9  6  0 21  4  2  3  0  0  6
   0 10  0  0  0 11  3  0  5  0  2  2  0  6  7  0  0  0  6  1  4  4  1  5
   1  0  2  0  0  2  0  1  0  0  3  0  1  0  0  4  0  0  0  0  2  0  0  4
   1  0  3  1  1  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   1  0  0  0]
 [10  0  4  8 40  5  3  0  2  5 16  0  3  1  0  0 12  1  8  4  7  7  1  1
   7  4  2  0  0  0 15 14  0  0  5  0  3  4  2  0  5  1  1  0  3  1  1  0
   1  0  0  3  0  0  1  0  3  2  0  1  0  1  4  0  5  0  0  0  0  1  0  1
   2  0  0  0  0  0  0  1  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [30  0  5  4  5  1  4  1  1  9  6 12 10 24  0 14  1  5  2  1  1  4  4 15
   4  4  3  0  0  3  4  3  3  0  0  0  0  4  1  1  0  0  0  6  0  0  1  1
   1  0  2  0  2  1  0  0  0  1  0  5  0  1  0  0  0  0  0  4  2  1  0  0
   0  0  1  0  1  0  0  0  0  0  0  0  0  0  0  0  1  1  0  1  1  0  0  0
   0  1  0  0]
 [13 31 23  0  1  4  1  0  0  1  7  2  5  0  1 10  1  0  1  0  5  5  0  5
   3  0 26  0  0  2  3  0  0  6  0  6  0  0  3  2  0  0  0  3  6  3  1  4
   0  1  0  1  0  2  1  0  0  0  2  0  0  0  0  0  0  0  1  0  3  0  1  0
   0  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0  1  0  1  0  1  0  0  0
   0  0  0  1]
 [ 4  0  2 13  1  7 18  8  9 14  8  0  0  0  7  0  0  5 13 19  0 11 15  5
   1 14  2  0  1  2 12  0  0  1  0  4  1  0  1  5  0  0  2  0  0  0  1  0
   0  3  1  1  0  0  0  0  1  2  0  0  0  0  1  2  1  1  1  0  0  1  0  0
   1  0  1  0  0  1  0  0  0  0  2  1  1  0  0  0  0  1  0  0  0  0  0  0
   0  1  0  0]
 [32 10  0  1 13 15  3 16  3  0  8  2 50 10  9  0 13 11  0  2 17  5  1 12
   4  0  0  1  2  2  0  2 14  0  0  4  0  6  1  6  6  0  0  3  0  0  9  0
   6  2  2  2  1  0  0  1  0  1  3  0  0  3  1  4  2  2  0  0  0  1  0  0
   0  0  0  1  0  0  0  3  0  0  0  0  0  0  0  0  0  0  0  1  0  1  0  0
   0  0  0  0]
 [47  7  1  7  0 43 10  0  9 20 27 11  2 18  0  1  0  1  1 33  5  1  0  2
  20  6  0  0  3  1  0  1  0 11  5  0  5  0  1  0  1  1  0  0  0  0  0  0
   0  2  3  1  4  0  3  1  1  1  0  0  0  0  1  1  0  0  1  0  1  0  1  3
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 1  8  4  3  0  5  0 12  0  1  6 11  1  5 14  4  9  3  9  0  0  0  9  1
   1  0  0  5  0  1  3  1  0  0  1  0 26  1  0  2 10  0  3  2  0 11  3  3
   1  0  0  1  2  1  0  1  0  0  0  2  0  0  0  0  0  1  0  0  0  0  1  0
   2  0  0  1  0  0  0  0  0  0  1  0  0  1  0  0  0  0  0  0  0  0  0  2
   0  0  0  0]
 [26  0  5  2 14  0  7 20 48  1 50  7  2  0  6 22  2  4  6  0  4 11  6  1
   1  0  1  1  2  0  0  1  9  1  1  7  0  3  0  0  0  3  0  2  2  0  0  0
   1  4  0  0  1  0  0  3  0  4  0  0  6  1  0  2  0  4  2  0  0  0  1  0
   1  0  0  0  1  1  0  0  0  0  1  0  0  1  0  0  1  0  2  0  0  0  0  0
   0  0  0  0]
 [ 1  0 24  4  2  0  7  0  1 16  0  1 11  0  1 13  0  4  2  7  2  0  9  2
   2  0  8  0  0  1  1  1  0  0  0  0  0  1  0  0  4  5  3  1  0  7  4  0
   1  2  0  8  2  0  2  3  0  1  1  0  0  4  0  0  1  0  0  1  0  0  0  0
   0  4  0  1  1  0  0  0  1  5  0  0  2  0  0  0  0  0  0  0  0  0  1  0
   0  0  0  0]
 [27  0  4 32 33 18 25  1  5  0  0  2  2  1  2  9  0  1  4  5  8  4 25 16
   5  0 10  0  3 12  1  3  1  6  1  1  0  0  1  0  1  2  1  0  0  0  3  0
   3  0  0  1  0  0  0  3  2  0  0  0  6  3  0  0  0  0  0  0  0  0  1  0
   0  0  0  1  0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0
   0  0  0  1]
 [29  1  1  1  4 38  7 23  7  5  2 14  3  9  3  1  7 15  1  0  0  4  0  0
   4  8  6  5  0 10  0  1  1  8  3  0  5  0  0  0  2  0  0  4  1  0  0  1
   2  0  4  0  3  0  0  0  0  8  0  0  0  0  4  0  0  1  0  0  0  0  0  0
   0  2  0  0  1  0  0  1  1  0  1  0  0  0  0  0  1  0  0  0  1  0  0  1
   0  0  0  0]
 [ 4  6 29  1  0  7  9  4  0  0  0 13  9  2  0  1  5  6  0 15  7  0  1  0
   6  0  0  7  1  6  4  0  2  0  0  3  2  3  1  1  0  0  0  2  1  0  2  0
  12  4  4  4  1  2  0  3  2  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  2  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  1  1  0
   0  0  0  0]
 [ 4 45  5 29 16  1  1  2 17 10  7  8  3  0 10  1  1 14 21  0  1  0 15 10
   4  0  4  2  2  0  0  5  0  0  8  0  2  0  8  0  0  1  0  0  4  0  2  2
   0  0  2  4  0  2  0  2  0  0  1  1  0  1  0  1  0  0  1  0  0  0  0  0
   0  0  2  0  1  2  0  1  0  0  0  0  1  0  0  0  0  2  0  0  0  0  0  0
   0  0  0  0]
 [ 5  7 16 23 40  0 17  0  4  2  0 18  1 11  1 11  0 41  0  0  3  9 15  0
   0  6  0 16  0 11  2  6  0  5  1  0 14  1  0  0  1  1  0  0  0  0  1  0
   0  0  2  0  0  0  0  0  0  0  0  0  1  2  0  0  2  0  0  0  3  2  0  0
   2  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 5 16  3  7  0  6  5  1  4  1  0  3  0 56  0  0  2 14  0  7  1  0  0  1
  15  0  3  0 17  1  4  6  4  4  7  2  2  2 10  1  1  0  1  1  2  1  0  0
   0  0  0  0  0  8  5  4  2  0  0  2  0  0  3  0  0  0  0  0  0  0  0  0
   0  0  0  0  1  0  0  0  1  1  0  0  0  1  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  3  5 13 32  5  3  0 19  8  3 38 19  9  5  0  0 16 24 21 17  1  1  1
  12  3  0  2  1  5  1  1  0  9  0  1  1  0  1  4  5  3  3  1  0  0  1  0
   0  2  0  1  0  0  0  0  0  0  3  0  6  0  0  3  6  0  0  0  0  0  1  0
   0  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  1  0
   0  0  0  0]]
Total size of training set
10847
local test distribution:
[[ 0  0 24 12  1  8 13 22 22  0  3  0  0  4  8 10  3  0  0  0  2  3  0  2
   0 12  3 24  1  0  5  6  2  8  0  0  0  0  0  1  1  0  0  1  1  0  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  2  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0
   0  0  0  1]
 [64  0 36  0 19  0  5  0 17 26  0  1 11  0 19  0  0  1  2  1  0  0  4  0
   0  1  1  0  0  0  0  1  0  0  0  0  1  1  0  0  0  0  0  0  0  4  0  0
   0  8  0  4  0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [10  1  9  8  3  6  0  0 18  0  3  5  2  0  2  2  2 12  5  2 10  4  0  2
   0 11 13  0  0  0  3  0  0  1  0  1  4  0  0  1  0  8  0  1  1  7  0  0
   0  4  0  0  2  0  0  1  0  0  3  0  0  0  0  0  3  0  2  0  0  0  0  0
   0  1  0  3  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  6 11 49  5  0 70 47  1 11  1 11  9  0  3  1  0  0  6  0  9  9  1  0
   2  3  2  0  0  0  0  6  4  4  1  0  1  1 20  1  0  0  3  0  0  0  0  0
   0  3  3  0  5  1  0  2  0  0  0  1  0  0  0  0  0  1  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [11 24 37  0 11  0  0  5  4  0  0 24  4 11 12  9  0  2  0  0 18  0  3  0
   0  0  0  0  8  0 10  9  0  0  0  0  0 12  0  0  0  0  2  1  1  3  0  3
   0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0  1  0  2  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  0  0 12  2  0 34  1  9  1  0  4  0  0  9  4  0  1  0 15  2  0  0  6
   3  2  0  0  1  4  0  0  0  0  0  0  1  1  6  0  7  4  1  0  0  1  0  0
   0  0  2  0  0  2  0  0  1  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0
   0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [10 25  8 10  0  5 14 47 11  0 41  2  7  0 15  5  0  0  0  0  0 15  0  0
   1  5  0  8  3  0  2  0  0  0  9  4  0  0  0  8  0  0  2  0  6  0  0  0
   0  3  2  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  0  0 42  0 11  9  4  4  4 12  8  1 14  3 24  0  1  0  0  0  0  0  4
   7  0  3  0  2  1  2  2 11  0  5  4  1  0  0  3  3  0  0  0  0  4  6  0
   0  0  2  1  2  0  0  1  0  0  0  0  0  0  0  1  0  0  0  0  0  2  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  1  0  0  0
   0  0  0  0]
 [ 0  0  0  0  0 39  1  0  2  1 11  1 11  4 19  0  0  3  2 17  7  0  2  6
   1  0  3  2  0  0  0  0  0  0  0 12  4  0  0 13  0  6  3  1  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  4  0  1  0  0  1
   0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  0  2  7 22 19  0 10 13  0  0  4  2  0  4  0 41  0  4  3  6  0  0  0
   1  2 11  0  3  0  0  0  1  0  7  0  1  3  1  0  0  0  0  5 10  0  0  2
   3  0  0  0  0  0  9  0  1  0  0  0  0  0  1  0  0  0  0  0  1  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [12 19  6  0  0  3  2  4  0  5  1  0  0  1  0 12  0  5  5  6  1 15  4  6
   6  0  6  0  9  1  0  0  0  0  0  0  0  0  0  0  1  2  0  3  1  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0
   0  0  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0 40  0  5  5  0  3  1  0  1  7  2 19  0  2  0 22  0  0  0  7  6  0  0
   6  0  0  8  0  0  0  5  0  2  0  0  0  0  0  0  5  4  0  0  4  0  0  0
   1  1  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0  0  0  3  0  0
   3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [22  2  8  3  9  9 34  5  2 45  6  0  0  0  2  1  9  4  0  0 13  2  0 19
   0  2  0 14  5  1  2  0  0  0  2  3  0  0  0  5  1  0  0  0  2  0  3  0
   3  0  0  0  2  0  1  1  0  0  0  0  2  0  2  0  0  0  0  0  1  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 3  4  2  0  0  0  0  1 11  0  0 19  0  0  3  0 11  0 17  0  2  2  3  0
  21  8  4  8  6  0  4  0  1  0  4  0  0  3  4  1  2  0  1  0  1  0  0  0
   0  0  0  0  2  1  1  0  1  0  0  0  0  4  0  1  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0 46 11  0  0 28  0  5 17  0  0  0  1 11 20  0  0  0 29  0 11  0  9  0
   0  0 11  0  4  0  0 13  3  4  2  7  1  2  3  0  0  0  7  0  0  0  0  0
   0  0  1  0  0  0  0  0  1  1  1  0  0  0  0  0  0  1  0  0  0  0  0  0
   0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  2  6  3 10 26  2  0 11 21  0  0  1  0  1  7  2  0  2  5  4  2  2  0
   0  1  0  0  3  3  8  2  0  3  3  0  0  0  0  1  0  8  0  1  0  0  0  7
   3  0  0  2  0  0  1  0  2  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [11 38  0  0  0  9  0  1  3 23  3  0 25 25  4  2  0  1  0  6  1  2  5  7
   0  1  1 13  1  0  0  0  0  0  0  1  0  5  1  1  6  0  0  6  1  0  0  0
   2  0  0  0  0  0  1  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  2  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0
   0  0  0  0]
 [ 2  7  1  0 54  0  8  1 12 29  0  0  0  0  0  0  5  0  5  2  0  4  0  0
   3 23  0  7  3  0  0  0  3  1 12  0  0  3  0  0  0  0  2  4  0  0  0  0
   0  0  1  0  0  1  5  0  3  0  0  0  0  0  2  0  0  0  1  0  0  0  0  1
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  1  0  0
   0  1  0  0]
 [17 69 29  3  0  1  5 11  0  3 19 20 10 19 39  0  5  0  3  5  1 16  0  1
   3  3  0  0  0  6 15  0  5  0  9  0  0 12  2  0  0  5  2  0  0  0  0  1
   0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [23  2 34 55  0 17  0  4  0  1  0 17  1  2  1 35  2  0 13  1  0 22  8  9
   0  1  0  0  6  3  1  9 21  3  0  1  0  0  0  0  0  3  9  0  0  0  2  0
   0  0  0  2  0  0  0  1  2  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0
   0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2
   0  0  0  0]
 [20  3  6 35 18 19  0 10 13  2  0  0  1  0  0  5 45  1  0  6  1  2 15  1
   4  1  0  1  1  2  0  0  0  0  0  0  5  0  0  4  2  0  0  0  0  1  8  0
   0  1  0  0  0  0  0  0  1  0  0  0  0  2  0  0  0  0  0  2  0  0  1  0
   0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  0 25  0  4  0  0 34  0 20 32 16 23  6  0 11  0 15  7  0  0  0  2 11
   0  4  0  1 25 23  0  0  1  7  0  0  1  0  0  2  0  0  0  3  0  3  0  7
   0  0  0  0  0 10  0  0  0  3  0  5  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  2  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [19 12  1  0 14  0 22 21  2  8  4  1  2  0  0  4 15  0  0  1  0  0  1  0
   1  0  9  0  0  0  2  6  4  7  0 21  0  0  0  0  0  5  2  1  0  0  0 10
   0  1  0  1  0  0  0  0  0  0  5  0  0  0  0  0  0  0  1  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [11  4 32  9 11 10  3  6 12  6  8  0 11 11  8  5  0 19  3  1  2  0  0  5
   0  9  0  0  0 10  2  0  4  0  1  1  0  5  6  0  0  0  5  0  3  3  0  4
   0  0  1  0  0  1  0  0  0  0  2  0  0  0  0  3  0  0  0  0  1  0  0  3
   0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 9  0  3  7 36  4  2  0  1  4 14  0  2  0  0  0 11  0  7  3  6  6  0  0
   6  3  1  0  0  0 13 12  0  0  4  0  2  3  1  0  4  0  0  0  2  0  0  0
   0  0  0  2  0  0  0  0  2  1  0  0  0  0  3  0  4  0  0  0  0  0  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [27  0  4  3  4  0  3  0  0  8  5 11  9 22  0 12  0  4  1  0  0  3  3 13
   3  3  2  0  0  2  3  2  2  0  0  0  0  3  0  0  0  0  0  5  0  0  0  0
   0  0  1  0  1  0  0  0  0  0  0  4  0  0  0  0  0  0  0  3  1  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [11 28 21  0  0  3  0  0  0  0  6  1  4  0  0  9  0  0  0  0  4  4  0  4
   2  0 23  0  0  1  2  0  0  5  0  5  0  0  2  1  0  0  0  2  5  2  0  3
   0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0  2  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 3  0  1 11  0  6 16  7  8 12  7  0  0  0  6  0  0  4 11 17  0 10 13  4
   0 12  1  0  0  1 11  0  0  0  0  3  0  0  0  4  0  0  1  0  0  0  0  0
   0  2  0  0  0  0  0  0  0  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [29  9  0  0 11 13  2 14  2  0  7  1 46  9  8  0 11 10  0  1 15  4  0 11
   3  0  0  0  1  1  0  1 12  0  0  3  0  5  0  5  5  0  0  2  0  0  8  0
   5  1  1  1  0  0  0  0  0  0  2  0  0  2  0  3  1  1  0  0  0  0  0  0
   0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [43  6  0  6  0 39  9  0  8 18 24 10  1 16  0  0  0  0  0 30  4  0  0  1
  18  5  0  0  2  0  0  0  0 10  4  0  4  0  0  0  0  0  0  0  0  0  0  0
   0  1  2  0  3  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  7  3  2  0  4  0 11  0  0  5 10  0  4 12  3  8  2  8  0  0  0  8  0
   0  0  0  4  0  0  2  0  0  0  0  0 23  0  0  1  9  0  2  1  0 10  2  2
   0  0  0  0  1  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1
   0  0  0  0]
 [23  0  4  1 12  0  6 18 44  0 46  6  1  0  5 20  1  3  5  0  3 10  5  0
   0  0  0  0  1  0  0  0  8  0  0  6  0  2  0  0  0  2  0  1  1  0  0  0
   0  3  0  0  0  0  0  2  0  3  0  0  5  0  0  1  0  3  1  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0
   0  0  0  0]
 [ 0  0 22  3  1  0  6  0  0 14  0  0 10  0  0 11  0  3  1  6  1  0  8  1
   1  0  7  0  0  0  0  0  0  0  0  0  0  0  0  0  3  4  2  0  0  6  3  0
   0  1  0  7  1  0  1  2  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0  0
   0  3  0  0  0  0  0  0  0  4  0  0  1  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [24  0  3 29 30 16 23  0  4  0  0  1  1  0  1  8  0  0  3  4  7  3 23 14
   4  0  9  0  2 11  0  2  0  5  0  0  0  0  0  0  0  1  0  0  0  0  2  0
   2  0  0  0  0  0  0  2  1  0  0  0  5  2  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [26  0  0  0  3 35  6 21  6  4  1 12  2  8  2  0  6 13  0  0  0  3  0  0
   3  7  5  4  0  9  0  0  0  7  2  0  4  0  0  0  1  0  0  3  0  0  0  0
   1  0  3  0  2  0  0  0  0  7  0  0  0  0  3  0  0  0  0  0  0  0  0  0
   0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 3  5 26  0  0  6  8  3  0  0  0 11  8  1  0  0  4  5  0 13  6  0  0  0
   5  0  0  6  0  5  3  0  1  0  0  2  1  2  0  0  0  0  0  1  0  0  1  0
  11  3  3  3  0  1  0  2  1  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 3 41  4 26 14  0  0  1 15  9  6  7  2  0  9  0  0 12 19  0  0  0 13  9
   3  0  3  1  1  0  0  4  0  0  7  0  1  0  7  0  0  0  0  0  3  0  1  1
   0  0  1  3  0  1  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  1  0  0  1  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0
   0  0  0  0]
 [ 4  6 14 21 36  0 15  0  3  1  0 16  0 10  0 10  0 37  0  0  2  8 13  0
   0  5  0 14  0 10  1  5  0  4  0  0 12  0  0  0  0  0  0  0  0  0  0  0
   0  0  1  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  2  1  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 4 14  2  6  0  5  4  0  3  0  0  2  0 51  0  0  1 12  0  6  0  0  0  0
  13  0  2  0 15  0  3  5  3  3  6  1  1  1  9  0  0  0  0  0  1  0  0  0
   0  0  0  0  0  7  4  3  1  0  0  1  0  0  2  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  2  4 11 29  4  2  0 17  7  2 35 17  8  4  0  0 14 22 19 15  0  0  0
  11  2  0  1  0  4  0  0  0  8  0  0  0  0  0  3  4  2  2  0  0  0  0  0
   0  1  0  0  0  0  0  0  0  0  2  0  5  0  0  2  5  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]]/home/jianhui/anaconda3/envs/FedLLM/lib/python3.7/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/jianhui/anaconda3/envs/FedLLM/lib/python3.7/site-packages/torchvision/image.so: undefined symbol: _ZN2at4_ops19empty_memory_format4callEN3c108ArrayRefIlEENS2_8optionalINS2_10ScalarTypeEEENS5_INS2_6LayoutEEENS5_INS2_6DeviceEEENS5_IbEENS5_INS2_12MemoryFormatEEE
  warn(f"Failed to load image Python extension: {e}")
/data/jianhui/FedLoGe/util/etf_methods.py:134: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  sparse_etf = torch.tensor(sparse_etf, requires_grad=True)

Total size of testing set
8636
[444 422 399 379 364 345 327 315 295 284 274 258 244 237 221 210 204 184
 180 170 160 155 145 136 131 126 120 116 103  98  94  90  86  82  78  75
  68  64  62  55  54  54  46  42  43  44  36  40  32  33  26  26  23  26
  25  20  17  19  17  18  17  15  13  12  14   9  10  11   9   8   4   7
   6   6   4   6   1   4   4   4   1   4   2   2   3   2   2   4   1   1
   1   1   1   1   0   3   0   1   0   1]
40
Step 0, Loss 26.707042694091797
Step 100, Loss 16.122817993164062
Step 200, Loss 9.328774452209473
Step 300, Loss 5.0143256187438965
Step 400, Loss 2.319241523742676
Step 500, Loss 0.6721667051315308
Step 600, Loss -0.3084346055984497
Step 700, Loss -0.8770543336868286
Step 800, Loss -1.1979626417160034
Step 900, Loss -1.3741819858551025
Step 1000, Loss -1.468639612197876
Step 1100, Loss -1.5183303356170654
Step 1200, Loss -1.5444430112838745
Step 1300, Loss -1.5582386255264282
Step 1400, Loss -1.5658588409423828
Step 1500, Loss -1.5702534914016724
Step 1600, Loss -1.573004961013794
Step 1700, Loss -1.5746220350265503
Step 1800, Loss -1.5755937099456787
Step 1900, Loss -1.5763685703277588
Step 2000, Loss -1.5766655206680298
Step 2100, Loss -1.5769119262695312
Step 2200, Loss -1.5770058631896973
Step 2300, Loss -1.577066421508789
Step 2400, Loss -1.577109932899475
Step 2500, Loss -1.5771899223327637
Step 2600, Loss -1.5770494937896729
Step 2700, Loss -1.5769699811935425
Step 2800, Loss -1.5770304203033447
Step 2900, Loss -1.576891541481018
Step 3000, Loss -1.5768898725509644
Step 3100, Loss -1.5767631530761719
Step 3200, Loss -1.5768394470214844
Step 3300, Loss -1.576735019683838
Step 3400, Loss -1.5767710208892822
Step 3500, Loss -1.5766890048980713
Step 3600, Loss -1.5766385793685913
Step 3700, Loss -1.5765390396118164
Step 3800, Loss -1.5765506029129028
Step 3900, Loss -1.5765495300292969
Step 4000, Loss -1.5764702558517456
Step 4100, Loss -1.5763863325119019
Step 4200, Loss -1.5763828754425049
Step 4300, Loss -1.5763123035430908
Step 4400, Loss -1.5762789249420166
Step 4500, Loss -1.5762110948562622
Step 4600, Loss -1.5761919021606445
Step 4700, Loss -1.5762277841567993
Step 4800, Loss -1.5762481689453125
Step 4900, Loss -1.576088786125183
Step 5000, Loss -1.5761018991470337
Step 5100, Loss -1.5761808156967163
Step 5200, Loss -1.5761219263076782
Step 5300, Loss -1.5761094093322754
Step 5400, Loss -1.5760401487350464
Step 5500, Loss -1.5759962797164917
Step 5600, Loss -1.576080322265625
Step 5700, Loss -1.5761257410049438
Step 5800, Loss -1.576088309288025
Step 5900, Loss -1.5759828090667725
Step 6000, Loss -1.5760302543640137
Step 6100, Loss -1.576082468032837
Step 6200, Loss -1.5759607553482056
Step 6300, Loss -1.5759472846984863
Step 6400, Loss -1.575944423675537
Step 6500, Loss -1.575966715812683
Step 6600, Loss -1.5759642124176025
Step 6700, Loss -1.575973629951477
Step 6800, Loss -1.575981855392456
Step 6900, Loss -1.5759774446487427
Step 7000, Loss -1.575956106185913
Step 7100, Loss -1.5757426023483276
Step 7200, Loss -1.575937032699585
Step 7300, Loss -1.5759222507476807
Step 7400, Loss -1.5759332180023193
Step 7500, Loss -1.575863003730774
Step 7600, Loss -1.5758898258209229
Step 7700, Loss -1.575886607170105
Step 7800, Loss -1.5758919715881348
Step 7900, Loss -1.5759611129760742
Step 8000, Loss -1.5758798122406006
Step 8100, Loss -1.5759239196777344
Step 8200, Loss -1.5757964849472046
Step 8300, Loss -1.576015830039978
Step 8400, Loss -1.575979232788086
Step 8500, Loss -1.5759261846542358
Step 8600, Loss -1.575936198234558
Step 8700, Loss -1.5758062601089478
Step 8800, Loss -1.5758730173110962
Step 8900, Loss -1.5759665966033936
Step 9000, Loss -1.5758702754974365
Step 9100, Loss -1.5758799314498901
Step 9200, Loss -1.575838327407837
Step 9300, Loss -1.575832486152649
Step 9400, Loss -1.5758777856826782
Step 9500, Loss -1.575838327407837
Step 9600, Loss -1.5760245323181152
Step 9700, Loss -1.575888752937317
Step 9800, Loss -1.5758763551712036
Step 9900, Loss -1.575890064239502
Angle Mean: 90.57780456542969, Angle Variance: 0.042339928448200226
Norm Mean: 0.10025106370449066, Norm Variance: 2.5868063247003192e-09
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [01:17<10:46:26, 77.73s/it]The value of constant scaler:  tensor([2.3407], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.0736196319018405, middle:0.0, tail0.0
3shot of client 1:head:0.143646408839779, middle:0.0, tail0.0
3shot of client 2:head:0.05970149253731343, middle:0.0, tail0.0
3shot of client 3:head:0.0, middle:0.0, tail0.06666666666666667
3shot of client 4:head:0.0670391061452514, middle:0.0, tail0.0
3shot of client 5:head:0.11320754716981132, middle:0.0, tail0.0
3shot of client 6:head:0.04878048780487805, middle:0.0, tail0.0
3shot of client 7:head:0.267515923566879, middle:0.0, tail0.0
3shot of client 8:head:0.28888888888888886, middle:0.0, tail0.0
3shot of client 9:head:0.04516129032258064, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.07692307692307693, tail0.0
3shot of client 11:head:0.04, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.06, tail0.0
3shot of client 13:head:0.0, middle:0.09375, tail0.0
3shot of client 14:head:0.233502538071066, middle:0.0, tail0.0
3shot of client 15:head:0.058823529411764705, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.34394904458598724, middle:0.0, tail0.0
3shot of client 18:head:0.14661654135338345, middle:0.0, tail0.0
3shot of client 19:head:0.22357723577235772, middle:0.0, tail0.0
3shot of client 20:head:0.1912568306010929, middle:0.0, tail0.0
3shot of client 21:head:0.04680851063829787, middle:0.0, tail0.0
3shot of client 22:head:0.0, middle:0.1111111111111111, tail0.0
3shot of client 23:head:0.04891304347826087, middle:0.0, tail0.0
3shot of client 24:head:0.05185185185185185, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0967741935483871, tail0.0
3shot of client 26:head:0.03418803418803419, middle:0.0, tail0.0
3shot of client 27:head:0.08148148148148149, middle:0.0, tail0.0
3shot of client 28:head:0.05339805825242718, middle:0.0, tail0.0
3shot of client 29:head:0.0, middle:0.12244897959183673, tail0.0
3shot of client 30:head:0.0, middle:0.06666666666666667, tail0.0
3shot of client 31:head:0.22797927461139897, middle:0.0, tail0.0
3shot of client 32:head:0.10476190476190476, middle:0.0, tail0.0
3shot of client 33:head:0.15508021390374332, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.08108108108108109, tail0.0
3shot of client 35:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 36:head:0.14942528735632185, middle:0.0, tail0.0
3shot of client 37:head:0.10101010101010101, middle:0.0, tail0.0
3shot of client 38:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 39:head:0.14646464646464646, middle:0.0, tail0.0
round 0, local average test acc  0.0734 

round 0, local macro average F1 score  0.0052 

round 0, local weighted average F1 score  0.0225 

round 0, global test acc  0.0100 

round 0, average 3shot acc: [head: 0.0908, middle: 0.0204, tail: 0.0017] 

round 0, global 3shot acc: [head: 0.0400, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.5873, 0.5766, 1.0912, 0.7906, 0.6658, 0.7752, 0.9557, 0.8664, 0.7917,
        0.5830, 0.7320, 0.5647, 0.5694, 0.6618, 0.8172, 0.8186, 0.7526, 0.5678,
        0.5810, 0.6135, 0.6791, 0.6740, 0.5789, 0.6358, 0.5806, 0.8586, 0.7231,
        0.9325, 0.6214, 0.5963, 0.6741, 0.7602, 0.7027, 0.7181, 0.6067, 0.5538,
        0.5936, 0.5846, 0.5788, 0.6642, 0.6497, 0.5801, 0.5838, 0.7223, 0.6456,
        0.5712, 0.5811, 0.5914, 0.5999, 0.6061, 0.5729, 0.6274, 0.5844, 0.6690,
        0.6310, 0.5717, 0.5618, 0.6384, 0.5937, 0.5643, 0.5767, 0.5928, 0.7705,
        0.5857, 0.5827, 0.5836, 0.5866, 0.6677, 0.5917, 0.6496, 0.5847, 0.5661,
        0.5643, 0.5669, 0.5806, 0.5858, 0.5944, 0.5905, 0.6024, 0.5741, 0.5781,
        0.5745, 0.5625, 0.5901, 0.5816, 0.5835, 0.5655, 0.6735, 0.5865, 0.5891,
        0.5831, 0.5842, 0.5879, 0.5676, 0.5842, 0.5835, 0.6345, 0.5767, 0.6056,
        0.6429], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.6447, 0.6107, 0.6526, 0.6152, 0.6003, 0.5942, 0.5975, 0.5939, 0.6198,
        0.6122, 0.5973, 0.6340, 0.5707, 0.5922, 0.6016, 0.6279, 0.6104, 0.5707,
        0.5951, 0.5923, 0.6040, 0.6029, 0.6044, 0.5909, 0.5705, 0.5896, 0.5772,
        0.5706, 0.5900, 0.5861, 0.5934, 0.5794, 0.6130, 0.5756, 0.5781, 0.5993,
        0.5929, 0.6008, 0.5782, 0.5865, 0.5767, 0.5707, 0.5802, 0.5819, 0.5840,
        0.5907, 0.5830, 0.5722, 0.5644, 0.5876, 0.5917, 0.5821, 0.5707, 0.5865,
        0.5838, 0.5998, 0.5686, 0.5663, 0.5777, 0.6000, 0.5692, 0.5801, 0.5815,
        0.5725, 0.5793, 0.5873, 0.5733, 0.5799, 0.5861, 0.5787, 0.5924, 0.5884,
        0.5639, 0.5812, 0.5761, 0.5878, 0.5901, 0.5756, 0.5650, 0.5900, 0.5779,
        0.5593, 0.5803, 0.5758, 0.5883, 0.5863, 0.5759, 0.5850, 0.5664, 0.5903,
        0.5732, 0.5599, 0.5615, 0.5837, 0.5768, 0.5853, 0.5748, 0.5687, 0.5853,
        0.5758], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([3.1981], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.0736196319018405, middle:0.0, tail0.0
3shot of client 1:head:0.143646408839779, middle:0.0, tail0.0
3shot of client 2:head:0.08955223880597014, middle:0.0, tail0.0
3shot of client 3:head:0.0, middle:0.16129032258064516, tail0.0
3shot of client 4:head:0.0, middle:0.1951219512195122, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.16666666666666666
3shot of client 6:head:0.07317073170731707, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.1111111111111111
3shot of client 8:head:0.14074074074074075, middle:0.0, tail0.0
3shot of client 9:head:0.0, middle:0.11428571428571428, tail0.0
3shot of client 10:head:0.11214953271028037, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.25
3shot of client 12:head:0.0, middle:0.04, tail0.0
3shot of client 13:head:0.1452991452991453, middle:0.0, tail0.0
3shot of client 14:head:0.233502538071066, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.0, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.18471337579617833, middle:0.0, tail0.0
3shot of client 18:head:0.07518796992481203, middle:0.0, tail0.0
3shot of client 19:head:0.14227642276422764, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0425531914893617, tail0.0
3shot of client 21:head:0.06808510638297872, middle:0.0, tail0.0
3shot of client 22:head:0.0, middle:0.0, tail0.1
3shot of client 23:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 24:head:0.044444444444444446, middle:0.0, tail0.0
3shot of client 25:head:0.0703125, middle:0.0, tail0.0
3shot of client 26:head:0.03418803418803419, middle:0.0, tail0.0
3shot of client 27:head:0.1259259259259259, middle:0.0, tail0.0
3shot of client 28:head:0.22330097087378642, middle:0.0, tail0.0
3shot of client 29:head:0.04807692307692308, middle:0.0, tail0.0
3shot of client 30:head:0.10810810810810811, middle:0.0, tail0.0
3shot of client 31:head:0.22797927461139897, middle:0.0, tail0.0
3shot of client 32:head:0.20952380952380953, middle:0.0, tail0.0
3shot of client 33:head:0.15508021390374332, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.2
3shot of client 35:head:0.0, middle:0.0, tail0.14285714285714285
3shot of client 36:head:0.05172413793103448, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.17777777777777778, tail0.0
3shot of client 38:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 39:head:0.17676767676767677, middle:0.0, tail0.0
round 1, local average test acc  0.0635 

round 1, local macro average F1 score  0.0035 

round 1, local weighted average F1 score  0.0065 

round 1, global test acc  0.0102 

round 1, average 3shot acc: [head: 0.0761, middle: 0.0226, tail: 0.0243] 

round 1, global 3shot acc: [head: 0.0408, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.5873, 0.5766, 1.0912, 0.7906, 0.6658, 0.7752, 0.9557, 0.8664, 0.7917,
        0.5830, 0.7320, 0.5647, 0.5694, 0.6618, 0.8172, 0.8186, 0.7526, 0.5678,
        0.5810, 0.6135, 0.6791, 0.6740, 0.5789, 0.6358, 0.5806, 0.8586, 0.7231,
        0.9325, 0.6214, 0.5963, 0.6741, 0.7602, 0.7027, 0.7181, 0.6067, 0.5538,
        0.5936, 0.5846, 0.5788, 0.6642, 0.6497, 0.5801, 0.5838, 0.7223, 0.6456,
        0.5712, 0.5811, 0.5914, 0.5999, 0.6061, 0.5729, 0.6274, 0.5844, 0.6690,
        0.6310, 0.5717, 0.5618, 0.6384, 0.5937, 0.5643, 0.5767, 0.5928, 0.7705,
        0.5857, 0.5827, 0.5836, 0.5866, 0.6677, 0.5917, 0.6496, 0.5847, 0.5661,
        0.5643, 0.5669, 0.5806, 0.5858, 0.5944, 0.5905, 0.6024, 0.5741, 0.5781,
        0.5745, 0.5625, 0.5901, 0.5816, 0.5835, 0.5655, 0.6735, 0.5865, 0.5891,
        0.5831, 0.5842, 0.5879, 0.5676, 0.5842, 0.5835, 0.6345, 0.5767, 0.6056,
        0.6429], device='cuda:4', grad_fn=<NormBackward1>)  0%|          | 2/500 [02:28<10:09:38, 73.45s/it]  1%|          | 3/500 [03:42<10:10:25, 73.69s/it]
g_aux tensor([0.7436, 0.6681, 0.7879, 0.6329, 0.6351, 0.6294, 0.6443, 0.6506, 0.6658,
        0.6661, 0.6471, 0.7474, 0.6157, 0.6557, 0.6786, 0.6585, 0.6255, 0.5994,
        0.6279, 0.6176, 0.6518, 0.6679, 0.6509, 0.6173, 0.6162, 0.6335, 0.5847,
        0.5826, 0.6163, 0.6196, 0.6217, 0.5840, 0.6558, 0.5866, 0.5939, 0.6047,
        0.5976, 0.6149, 0.5795, 0.5861, 0.5816, 0.6019, 0.5829, 0.5772, 0.5827,
        0.5935, 0.5878, 0.5778, 0.5644, 0.5963, 0.5935, 0.5829, 0.5752, 0.5902,
        0.5907, 0.6023, 0.5729, 0.5661, 0.5778, 0.6036, 0.5664, 0.5781, 0.5834,
        0.5714, 0.5778, 0.5858, 0.5736, 0.5803, 0.5873, 0.5779, 0.5922, 0.5902,
        0.5663, 0.5809, 0.5731, 0.5870, 0.5950, 0.5758, 0.5654, 0.5875, 0.5794,
        0.5587, 0.5801, 0.5779, 0.5870, 0.5886, 0.5805, 0.5878, 0.5685, 0.5893,
        0.5738, 0.5600, 0.5633, 0.5834, 0.5773, 0.5854, 0.5762, 0.5679, 0.5847,
        0.5795], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([4.0054], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.10429447852760736, middle:0.0, tail0.0
3shot of client 1:head:0.027624309392265192, middle:0.09523809523809523, tail0.0
3shot of client 2:head:0.08955223880597014, middle:0.0, tail0.0
3shot of client 3:head:0.19831223628691982, middle:0.0, tail0.0
3shot of client 4:head:0.1340782122905028, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.16666666666666666
3shot of client 6:head:0.09268292682926829, middle:0.0, tail0.0
3shot of client 7:head:0.267515923566879, middle:0.0, tail0.0
3shot of client 8:head:0.06666666666666667, middle:0.027777777777777776, tail0.0
3shot of client 9:head:0.0064516129032258064, middle:0.11428571428571428, tail0.0
3shot of client 10:head:0.11214953271028037, middle:0.0, tail0.0
3shot of client 11:head:0.04, middle:0.0, tail0.0
3shot of client 12:head:0.010638297872340425, middle:0.04, tail0.0
3shot of client 13:head:0.23076923076923078, middle:0.0, tail0.0
3shot of client 14:head:0.233502538071066, middle:0.0, tail0.0
3shot of client 15:head:0.008403361344537815, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.0, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.15286624203821655, middle:0.0, tail0.0
3shot of client 18:head:0.10902255639097744, middle:0.0, tail0.0
3shot of client 19:head:0.14227642276422764, middle:0.0, tail0.0
3shot of client 20:head:0.20765027322404372, middle:0.0, tail0.0
3shot of client 21:head:0.06382978723404255, middle:0.0, tail0.0
3shot of client 22:head:0.03164556962025317, middle:0.05555555555555555, tail0.0
3shot of client 23:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 24:head:0.26666666666666666, middle:0.0, tail0.0
3shot of client 25:head:0.171875, middle:0.0, tail0.0
3shot of client 26:head:0.09401709401709402, middle:0.0, tail0.0
3shot of client 27:head:0.1259259259259259, middle:0.0, tail0.0
3shot of client 28:head:0.06796116504854369, middle:0.0, tail0.0
3shot of client 29:head:0.1201923076923077, middle:0.0, tail0.0
3shot of client 30:head:0.04504504504504504, middle:0.0, tail0.0
3shot of client 31:head:0.21761658031088082, middle:0.0, tail0.0
3shot of client 32:head:0.0761904761904762, middle:0.0, tail0.16666666666666666
3shot of client 33:head:0.16042780748663102, middle:0.0, tail0.0
3shot of client 34:head:0.049079754601226995, middle:0.0, tail0.0
3shot of client 35:head:0.21739130434782608, middle:0.0, tail0.0
3shot of client 36:head:0.005747126436781609, middle:0.021739130434782608, tail0.0
3shot of client 37:head:0.0, middle:0.17777777777777778, tail0.0
3shot of client 38:head:0.3680555555555556, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.037037037037037035, tail0.0
round 2, local average test acc  0.0870 

round 2, local macro average F1 score  0.0065 

round 2, local weighted average F1 score  0.0200 

round 2, global test acc  0.0134 

round 2, average 3shot acc: [head: 0.1090, middle: 0.0186, tail: 0.0083] 

round 2, global 3shot acc: [head: 0.0536, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.5873, 0.5766, 1.0912, 0.7906, 0.6658, 0.7752, 0.9557, 0.8664, 0.7917,
        0.5830, 0.7320, 0.5647, 0.5694, 0.6618, 0.8172, 0.8186, 0.7526, 0.5678,
        0.5810, 0.6135, 0.6791, 0.6740, 0.5789, 0.6358, 0.5806, 0.8586, 0.7231,
        0.9325, 0.6214, 0.5963, 0.6741, 0.7602, 0.7027, 0.7181, 0.6067, 0.5538,
        0.5936, 0.5846, 0.5788, 0.6642, 0.6497, 0.5801, 0.5838, 0.7223, 0.6456,
        0.5712, 0.5811, 0.5914, 0.5999, 0.6061, 0.5729, 0.6274, 0.5844, 0.6690,
        0.6310, 0.5717, 0.5618, 0.6384, 0.5937, 0.5643, 0.5767, 0.5928, 0.7705,
        0.5857, 0.5827, 0.5836, 0.5866, 0.6677, 0.5917, 0.6496, 0.5847, 0.5661,
        0.5643, 0.5669, 0.5806, 0.5858, 0.5944, 0.5905, 0.6024, 0.5741, 0.5781,
        0.5745, 0.5625, 0.5901, 0.5816, 0.5835, 0.5655, 0.6735, 0.5865, 0.5891,
        0.5831, 0.5842, 0.5879, 0.5676, 0.5842, 0.5835, 0.6345, 0.5767, 0.6056,
        0.6429], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.8331, 0.7059, 0.9783, 0.7135, 0.7639, 0.7004, 0.7680, 0.7949, 0.7351,
        0.7815, 0.7411, 0.8374, 0.7221, 0.7537, 0.7321, 0.7136, 0.6457, 0.6764,
        0.6413, 0.6414, 0.7269, 0.6803, 0.7082, 0.6807, 0.6686, 0.6607, 0.6069,
        0.5907, 0.6707, 0.6935, 0.6475, 0.6078, 0.7053, 0.6066, 0.6139, 0.6071,
        0.5997, 0.6319, 0.5986, 0.5951, 0.5876, 0.6143, 0.5929, 0.5867, 0.5854,
        0.6078, 0.5921, 0.5842, 0.5789, 0.6137, 0.5965, 0.5898, 0.5842, 0.6193,
        0.5985, 0.6179, 0.5742, 0.5664, 0.5825, 0.6058, 0.5669, 0.5852, 0.5880,
        0.5705, 0.5784, 0.5861, 0.5739, 0.5825, 0.5905, 0.5761, 0.5931, 0.5884,
        0.5673, 0.5824, 0.5743, 0.5882, 0.5939, 0.5765, 0.5664, 0.5878, 0.5804,
        0.5589, 0.5819, 0.5780, 0.5879, 0.5857, 0.5791, 0.5863, 0.5702, 0.5909,
        0.5755, 0.5620, 0.5622, 0.5841, 0.5793, 0.5870, 0.5768, 0.5696, 0.5862,
        0.5790], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([4.5413], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.10429447852760736, middle:0.0, tail0.0
3shot of client 1:head:0.09944751381215469, middle:0.2619047619047619, tail0.0
3shot of client 2:head:0.08955223880597014, middle:0.0, tail0.0
3shot of client 3:head:0.05907172995780591, middle:0.04838709677419355, tail0.0
3shot of client 4:head:0.0670391061452514, middle:0.0, tail0.2
3shot of client 5:head:0.32075471698113206, middle:0.0, tail0.0
3shot of client 6:head:0.08292682926829269, middle:0.0, tail0.0
3shot of client 7:head:0.29936305732484075, middle:0.0, tail0.0
3shot of client 8:head:0.28888888888888886, middle:0.0, tail0.0
3shot of client 9:head:0.06451612903225806, middle:0.05714285714285714, tail0.0
3shot of client 10:head:0.11214953271028037, middle:0.0, tail0.0
3shot of client 11:head:0.088, middle:0.0, tail0.0
3shot of client 12:head:0.0851063829787234, middle:0.06, tail0.0
3shot of client 13:head:0.27350427350427353, middle:0.0, tail0.0
3shot of client 14:head:0.06091370558375635, middle:0.0, tail0.08333333333333333
3shot of client 15:head:0.08403361344537816, middle:0.0, tail0.0
3shot of client 16:head:0.09202453987730061, middle:0.05405405405405406, tail0.0
3shot of client 17:head:0.05732484076433121, middle:0.0, tail0.0
3shot of client 18:head:0.10526315789473684, middle:0.03389830508474576, tail0.0
3shot of client 19:head:0.24796747967479674, middle:0.0, tail0.0
3shot of client 20:head:0.18579234972677597, middle:0.0, tail0.16666666666666666
3shot of client 21:head:0.14042553191489363, middle:0.01694915254237288, tail0.0
3shot of client 22:head:0.056962025316455694, middle:0.027777777777777776, tail0.0
3shot of client 23:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 24:head:0.26666666666666666, middle:0.0, tail0.0
3shot of client 25:head:0.0546875, middle:0.0967741935483871, tail0.0
3shot of client 26:head:0.18803418803418803, middle:0.0, tail0.0
3shot of client 27:head:0.11851851851851852, middle:0.0625, tail0.0
3shot of client 28:head:0.16019417475728157, middle:0.04, tail0.0
3shot of client 29:head:0.057692307692307696, middle:0.10204081632653061, tail0.0
3shot of client 30:head:0.036036036036036036, middle:0.06666666666666667, tail0.16666666666666666  1%|          | 4/500 [04:51<9:56:06, 72.11s/it]   1%|          | 5/500 [06:05<10:00:18, 72.77s/it]
3shot of client 31:head:0.17098445595854922, middle:0.0, tail0.0
3shot of client 32:head:0.17142857142857143, middle:0.0, tail0.0
3shot of client 33:head:0.1657754010695187, middle:0.0, tail0.0
3shot of client 34:head:0.04294478527607362, middle:0.02702702702702703, tail0.0
3shot of client 35:head:0.19130434782608696, middle:0.0, tail0.0
3shot of client 36:head:0.0, middle:0.06521739130434782, tail0.0
3shot of client 37:head:0.06565656565656566, middle:0.13333333333333333, tail0.0
3shot of client 38:head:0.3819444444444444, middle:0.02631578947368421, tail0.0
3shot of client 39:head:0.07575757575757576, middle:0.05555555555555555, tail0.0
round 3, local average test acc  0.1068 

round 3, local macro average F1 score  0.0135 

round 3, local weighted average F1 score  0.0445 

round 3, global test acc  0.0236 

round 3, average 3shot acc: [head: 0.1314, middle: 0.0309, tail: 0.0154] 

round 3, global 3shot acc: [head: 0.0944, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.5873, 0.5766, 1.0912, 0.7906, 0.6658, 0.7752, 0.9557, 0.8664, 0.7917,
        0.5830, 0.7320, 0.5647, 0.5694, 0.6618, 0.8172, 0.8186, 0.7526, 0.5678,
        0.5810, 0.6135, 0.6791, 0.6740, 0.5789, 0.6358, 0.5806, 0.8586, 0.7231,
        0.9325, 0.6214, 0.5963, 0.6741, 0.7602, 0.7027, 0.7181, 0.6067, 0.5538,
        0.5936, 0.5846, 0.5788, 0.6642, 0.6497, 0.5801, 0.5838, 0.7223, 0.6456,
        0.5712, 0.5811, 0.5914, 0.5999, 0.6061, 0.5729, 0.6274, 0.5844, 0.6690,
        0.6310, 0.5717, 0.5618, 0.6384, 0.5937, 0.5643, 0.5767, 0.5928, 0.7705,
        0.5857, 0.5827, 0.5836, 0.5866, 0.6677, 0.5917, 0.6496, 0.5847, 0.5661,
        0.5643, 0.5669, 0.5806, 0.5858, 0.5944, 0.5905, 0.6024, 0.5741, 0.5781,
        0.5745, 0.5625, 0.5901, 0.5816, 0.5835, 0.5655, 0.6735, 0.5865, 0.5891,
        0.5831, 0.5842, 0.5879, 0.5676, 0.5842, 0.5835, 0.6345, 0.5767, 0.6056,
        0.6429], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.8509, 0.8200, 1.0809, 0.7642, 0.8722, 0.7685, 0.9095, 0.9401, 0.8344,
        0.8688, 0.8465, 0.9187, 0.7996, 0.8125, 0.8367, 0.7657, 0.6818, 0.6989,
        0.7035, 0.6758, 0.8538, 0.7167, 0.7738, 0.7254, 0.7277, 0.6894, 0.6349,
        0.6031, 0.6972, 0.6886, 0.6788, 0.6484, 0.7347, 0.6188, 0.6298, 0.6365,
        0.6117, 0.6670, 0.6127, 0.6046, 0.5993, 0.6431, 0.6166, 0.6013, 0.5868,
        0.6193, 0.5942, 0.5915, 0.5782, 0.6356, 0.6187, 0.5892, 0.5974, 0.6368,
        0.6010, 0.6259, 0.5808, 0.5718, 0.5893, 0.6125, 0.5839, 0.5920, 0.5933,
        0.5717, 0.5782, 0.5859, 0.5903, 0.5913, 0.5906, 0.5751, 0.5929, 0.5936,
        0.5701, 0.5852, 0.5755, 0.5871, 0.5951, 0.5793, 0.5676, 0.5889, 0.5798,
        0.5613, 0.5874, 0.5798, 0.5933, 0.5878, 0.5821, 0.5851, 0.5652, 0.5915,
        0.5759, 0.5600, 0.5653, 0.5873, 0.5803, 0.5869, 0.5781, 0.5697, 0.5859,
        0.5801], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([5.0417], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.0736196319018405, middle:0.05714285714285714, tail0.0
3shot of client 1:head:0.10497237569060773, middle:0.2619047619047619, tail0.0
3shot of client 2:head:0.09701492537313433, middle:0.0, tail0.0
3shot of client 3:head:0.0759493670886076, middle:0.03225806451612903, tail0.0
3shot of client 4:head:0.22346368715083798, middle:0.0, tail0.0
3shot of client 5:head:0.32075471698113206, middle:0.0, tail0.0
3shot of client 6:head:0.22926829268292684, middle:0.0, tail0.0
3shot of client 7:head:0.25477707006369427, middle:0.0, tail0.0
3shot of client 8:head:0.2814814814814815, middle:0.027777777777777776, tail0.0
3shot of client 9:head:0.13548387096774195, middle:0.08571428571428572, tail0.0
3shot of client 10:head:0.14018691588785046, middle:0.0, tail0.0
3shot of client 11:head:0.096, middle:0.0, tail0.0
3shot of client 12:head:0.14361702127659576, middle:0.08, tail0.0
3shot of client 13:head:0.2905982905982906, middle:0.0, tail0.0
3shot of client 14:head:0.06091370558375635, middle:0.0, tail0.08333333333333333
3shot of client 15:head:0.025210084033613446, middle:0.12903225806451613, tail0.0
3shot of client 16:head:0.17177914110429449, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.08917197452229299, middle:0.0, tail0.0
3shot of client 18:head:0.16165413533834586, middle:0.06779661016949153, tail0.0
3shot of client 19:head:0.16666666666666666, middle:0.0, tail0.0
3shot of client 20:head:0.0273224043715847, middle:0.10638297872340426, tail0.08333333333333333
3shot of client 21:head:0.09787234042553192, middle:0.0847457627118644, tail0.0
3shot of client 22:head:0.2088607594936709, middle:0.08333333333333333, tail0.0
3shot of client 23:head:0.06521739130434782, middle:0.0, tail0.0
3shot of client 24:head:0.05925925925925926, middle:0.0, tail0.0
3shot of client 25:head:0.109375, middle:0.12903225806451613, tail0.0
3shot of client 26:head:0.17094017094017094, middle:0.07142857142857142, tail0.0
3shot of client 27:head:0.1037037037037037, middle:0.125, tail0.0
3shot of client 28:head:0.23786407766990292, middle:0.02, tail0.0
3shot of client 29:head:0.1201923076923077, middle:0.061224489795918366, tail0.0
3shot of client 30:head:0.0990990990990991, middle:0.03333333333333333, tail0.16666666666666666
3shot of client 31:head:0.17616580310880828, middle:0.0, tail0.0
3shot of client 32:head:0.14285714285714285, middle:0.08, tail0.0
3shot of client 33:head:0.13903743315508021, middle:0.045454545454545456, tail0.0
3shot of client 34:head:0.13496932515337423, middle:0.0, tail0.0
3shot of client 35:head:0.14782608695652175, middle:0.03333333333333333, tail0.0
3shot of client 36:head:0.25287356321839083, middle:0.0, tail0.0
3shot of client 37:head:0.06060606060606061, middle:0.0, tail0.0
3shot of client 38:head:0.4236111111111111, middle:0.0, tail0.0
3shot of client 39:head:0.16161616161616163, middle:0.018518518518518517, tail0.0
round 4, local average test acc  0.1247 

round 4, local macro average F1 score  0.0238 

round 4, local weighted average F1 score  0.0673 

round 4, global test acc  0.0394 

round 4, average 3shot acc: [head: 0.1520, middle: 0.0435, tail: 0.0083] 

round 4, global 3shot acc: [head: 0.1436, middle: 0.0140, tail: 0.0000] 

l_head tensor([0.5873, 0.5766, 1.0912, 0.7906, 0.6658, 0.7752, 0.9557, 0.8664, 0.7917,
        0.5830, 0.7320, 0.5647, 0.5694, 0.6618, 0.8172, 0.8186, 0.7526, 0.5678,
        0.5810, 0.6135, 0.6791, 0.6740, 0.5789, 0.6358, 0.5806, 0.8586, 0.7231,
        0.9325, 0.6214, 0.5963, 0.6741, 0.7602, 0.7027, 0.7181, 0.6067, 0.5538,
        0.5936, 0.5846, 0.5788, 0.6642, 0.6497, 0.5801, 0.5838, 0.7223, 0.6456,
        0.5712, 0.5811, 0.5914, 0.5999, 0.6061, 0.5729, 0.6274, 0.5844, 0.6690,
        0.6310, 0.5717, 0.5618, 0.6384, 0.5937, 0.5643, 0.5767, 0.5928, 0.7705,
        0.5857, 0.5827, 0.5836, 0.5866, 0.6677, 0.5917, 0.6496, 0.5847, 0.5661,
        0.5643, 0.5669, 0.5806, 0.5858, 0.5944, 0.5905, 0.6024, 0.5741, 0.5781,
        0.5745, 0.5625, 0.5901, 0.5816, 0.5835, 0.5655, 0.6735, 0.5865, 0.5891,
        0.5831, 0.5842, 0.5879, 0.5676, 0.5842, 0.5835, 0.6345, 0.5767, 0.6056,
        0.6429], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.9372, 0.9698, 1.1939, 0.8267, 0.9900, 0.8176, 0.9472, 1.0871, 0.9294,
        0.9668, 0.9741, 1.0740, 0.9017, 0.8968, 0.9081, 0.8326, 0.7164, 0.8294,
        0.7708, 0.7264, 0.9190, 0.7530, 0.8382, 0.7765, 0.8189, 0.7312, 0.6564,
        0.6284, 0.7552, 0.7625, 0.7541, 0.6884, 0.7474, 0.6485, 0.6590, 0.6604,
        0.6416, 0.6895, 0.6204, 0.6266, 0.6104, 0.6633, 0.6199, 0.6190, 0.5985,
        0.6308, 0.6005, 0.6242, 0.5865, 0.6618, 0.6291, 0.5921, 0.6105, 0.6799,
        0.6039, 0.6205, 0.5817, 0.5749, 0.5920, 0.6238, 0.6011, 0.5969, 0.6008,
        0.5750, 0.5827, 0.5874, 0.5934, 0.6073, 0.5940, 0.5799, 0.5983, 0.5961,
        0.5736, 0.5892, 0.5739, 0.5865, 0.5975, 0.5813, 0.5717, 0.5876, 0.5807,
        0.5620, 0.5887, 0.5820, 0.5925, 0.5866, 0.5866, 0.5841, 0.5657, 0.5890,
        0.5768, 0.5595, 0.5638, 0.5864, 0.5805, 0.5884, 0.5791, 0.5703, 0.5869,
        0.5811], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([5.5911], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.10429447852760736, middle:0.2, tail0.0  1%|          | 6/500 [08:27<13:13:06, 96.33s/it]
3shot of client 1:head:0.3701657458563536, middle:0.047619047619047616, tail0.0
3shot of client 2:head:0.11194029850746269, middle:0.0, tail0.0
3shot of client 3:head:0.08016877637130802, middle:0.03225806451612903, tail0.0
3shot of client 4:head:0.18994413407821228, middle:0.0, tail0.0
3shot of client 5:head:0.11320754716981132, middle:0.0, tail0.0
3shot of client 6:head:0.22439024390243903, middle:0.018518518518518517, tail0.0
3shot of client 7:head:0.267515923566879, middle:0.025, tail0.0
3shot of client 8:head:0.28888888888888886, middle:0.0, tail0.0
3shot of client 9:head:0.12903225806451613, middle:0.14285714285714285, tail0.0
3shot of client 10:head:0.19626168224299065, middle:0.038461538461538464, tail0.0
3shot of client 11:head:0.088, middle:0.0, tail0.0
3shot of client 12:head:0.17553191489361702, middle:0.0, tail0.0
3shot of client 13:head:0.2905982905982906, middle:0.0, tail0.0
3shot of client 14:head:0.07614213197969544, middle:0.0, tail0.0
3shot of client 15:head:0.10084033613445378, middle:0.0, tail0.0
3shot of client 16:head:0.1656441717791411, middle:0.02702702702702703, tail0.0
3shot of client 17:head:0.07643312101910828, middle:0.0, tail0.0
3shot of client 18:head:0.06766917293233082, middle:0.13559322033898305, tail0.0
3shot of client 19:head:0.14634146341463414, middle:0.0, tail0.0
3shot of client 20:head:0.06557377049180328, middle:0.14893617021276595, tail0.08333333333333333
3shot of client 21:head:0.1829787234042553, middle:0.03389830508474576, tail0.07692307692307693
3shot of client 22:head:0.24050632911392406, middle:0.08333333333333333, tail0.0
3shot of client 23:head:0.07608695652173914, middle:0.0, tail0.0
3shot of client 24:head:0.014814814814814815, middle:0.08108108108108109, tail0.2857142857142857
3shot of client 25:head:0.2265625, middle:0.03225806451612903, tail0.0
3shot of client 26:head:0.1452991452991453, middle:0.0, tail0.0
3shot of client 27:head:0.11851851851851852, middle:0.0625, tail0.0
3shot of client 28:head:0.23786407766990292, middle:0.0, tail0.0
3shot of client 29:head:0.24519230769230768, middle:0.12244897959183673, tail0.0
3shot of client 30:head:0.06306306306306306, middle:0.0, tail0.16666666666666666
3shot of client 31:head:0.15025906735751296, middle:0.0, tail0.09090909090909091
3shot of client 32:head:0.18095238095238095, middle:0.0, tail0.0
3shot of client 33:head:0.1711229946524064, middle:0.045454545454545456, tail0.0
3shot of client 34:head:0.049079754601226995, middle:0.0, tail0.1
3shot of client 35:head:0.1391304347826087, middle:0.1, tail0.0
3shot of client 36:head:0.2471264367816092, middle:0.0, tail0.0
3shot of client 37:head:0.08080808080808081, middle:0.0, tail0.0
3shot of client 38:head:0.3958333333333333, middle:0.02631578947368421, tail0.0
3shot of client 39:head:0.16666666666666666, middle:0.0, tail0.0
round 5, local average test acc  0.1308 

round 5, local macro average F1 score  0.0312 

round 5, local weighted average F1 score  0.0879 

round 5, global test acc  0.0446 

round 5, average 3shot acc: [head: 0.1615, middle: 0.0351, tail: 0.0201] 

round 5, global 3shot acc: [head: 0.1784, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.5873, 0.5766, 1.0912, 0.7906, 0.6658, 0.7752, 0.9557, 0.8664, 0.7917,
        0.5830, 0.7320, 0.5647, 0.5694, 0.6618, 0.8172, 0.8186, 0.7526, 0.5678,
        0.5810, 0.6135, 0.6791, 0.6740, 0.5789, 0.6358, 0.5806, 0.8586, 0.7231,
        0.9325, 0.6214, 0.5963, 0.6741, 0.7602, 0.7027, 0.7181, 0.6067, 0.5538,
        0.5936, 0.5846, 0.5788, 0.6642, 0.6497, 0.5801, 0.5838, 0.7223, 0.6456,
        0.5712, 0.5811, 0.5914, 0.5999, 0.6061, 0.5729, 0.6274, 0.5844, 0.6690,
        0.6310, 0.5717, 0.5618, 0.6384, 0.5937, 0.5643, 0.5767, 0.5928, 0.7705,
        0.5857, 0.5827, 0.5836, 0.5866, 0.6677, 0.5917, 0.6496, 0.5847, 0.5661,
        0.5643, 0.5669, 0.5806, 0.5858, 0.5944, 0.5905, 0.6024, 0.5741, 0.5781,
        0.5745, 0.5625, 0.5901, 0.5816, 0.5835, 0.5655, 0.6735, 0.5865, 0.5891,
        0.5831, 0.5842, 0.5879, 0.5676, 0.5842, 0.5835, 0.6345, 0.5767, 0.6056,
        0.6429], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.0596, 0.9991, 1.3439, 0.8571, 1.1099, 0.8850, 1.0361, 1.1876, 1.0262,
        1.0956, 1.1284, 1.1677, 0.9779, 0.9644, 0.9385, 0.9117, 0.7523, 0.9107,
        0.8061, 0.7931, 0.9954, 0.8004, 0.8855, 0.8827, 0.8847, 0.7650, 0.6769,
        0.6759, 0.8050, 0.8330, 0.7849, 0.7056, 0.7607, 0.7012, 0.6771, 0.6693,
        0.6525, 0.6988, 0.6329, 0.6403, 0.6212, 0.6650, 0.6209, 0.6328, 0.6033,
        0.6407, 0.6094, 0.6449, 0.6027, 0.6999, 0.6406, 0.5973, 0.6386, 0.7222,
        0.6034, 0.6273, 0.5844, 0.5883, 0.5974, 0.6416, 0.6238, 0.6104, 0.6148,
        0.5745, 0.5873, 0.5899, 0.5947, 0.6072, 0.5934, 0.5841, 0.6093, 0.6028,
        0.5737, 0.6033, 0.5727, 0.5869, 0.6013, 0.5809, 0.5750, 0.5867, 0.5803,
        0.5636, 0.5937, 0.5905, 0.5912, 0.5852, 0.5881, 0.5844, 0.5664, 0.5895,
        0.5733, 0.5595, 0.5642, 0.5844, 0.5813, 0.5896, 0.5799, 0.5709, 0.5862,
        0.5833], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([6.0160], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.2085889570552147, middle:0.08571428571428572, tail0.0
3shot of client 1:head:0.26519337016574585, middle:0.023809523809523808, tail0.0
3shot of client 2:head:0.1044776119402985, middle:0.0, tail0.0
3shot of client 3:head:0.0970464135021097, middle:0.03225806451612903, tail0.0
3shot of client 4:head:0.18435754189944134, middle:0.0, tail0.0
3shot of client 5:head:0.10377358490566038, middle:0.0, tail0.0
3shot of client 6:head:0.21951219512195122, middle:0.037037037037037035, tail0.0
3shot of client 7:head:0.06369426751592357, middle:0.025, tail0.0
3shot of client 8:head:0.2962962962962963, middle:0.0, tail0.0
3shot of client 9:head:0.06451612903225806, middle:0.14285714285714285, tail0.0
3shot of client 10:head:0.11214953271028037, middle:0.07692307692307693, tail0.0
3shot of client 11:head:0.08, middle:0.0625, tail0.0
3shot of client 12:head:0.19148936170212766, middle:0.0, tail0.0
3shot of client 13:head:0.06837606837606838, middle:0.0, tail0.0
3shot of client 14:head:0.15228426395939088, middle:0.07142857142857142, tail0.0
3shot of client 15:head:0.13445378151260504, middle:0.03225806451612903, tail0.0
3shot of client 16:head:0.12883435582822086, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.044585987261146494, middle:0.0, tail0.0
3shot of client 18:head:0.14661654135338345, middle:0.1694915254237288, tail0.0
3shot of client 19:head:0.12195121951219512, middle:0.17543859649122806, tail0.0
3shot of client 20:head:0.01092896174863388, middle:0.0425531914893617, tail0.25
3shot of client 21:head:0.06382978723404255, middle:0.0847457627118644, tail0.0
3shot of client 22:head:0.21518987341772153, middle:0.027777777777777776, tail0.0
3shot of client 23:head:0.06521739130434782, middle:0.0, tail0.0
3shot of client 24:head:0.0, middle:0.08108108108108109, tail0.2857142857142857
3shot of client 25:head:0.234375, middle:0.06451612903225806, tail0.0
3shot of client 26:head:0.15384615384615385, middle:0.03571428571428571, tail0.0
3shot of client 27:head:0.1111111111111111, middle:0.0625, tail0.0
3shot of client 28:head:0.24757281553398058, middle:0.0, tail0.0
3shot of client 29:head:0.1971153846153846, middle:0.16326530612244897, tail0.0
3shot of client 30:head:0.0990990990990991, middle:0.13333333333333333, tail0.16666666666666666
3shot of client 31:head:0.12953367875647667, middle:0.02040816326530612, tail0.09090909090909091
3shot of client 32:head:0.19047619047619047, middle:0.04, tail0.0
3shot of client 33:head:0.13903743315508021, middle:0.045454545454545456, tail0.0
3shot of client 34:head:0.012269938650306749, middle:0.0, tail0.1
3shot of client 35:head:0.13043478260869565, middle:0.0, tail0.0
3shot of client 36:head:0.2471264367816092, middle:0.0, tail0.0
3shot of client 37:head:0.13131313131313133, middle:0.0, tail0.0
3shot of client 38:head:0.3819444444444444, middle:0.0, tail0.0
3shot of client 39:head:0.14646464646464646, middle:0.0, tail0.0
round 6, local average test acc  0.1185 

round 6, local macro average F1 score  0.0324 

round 6, local weighted average F1 score  0.0785 
  1%|         | 7/500 [10:55<15:29:27, 113.12s/it]  2%|         | 8/500 [13:22<16:54:45, 123.75s/it]
round 6, global test acc  0.0515 

round 6, average 3shot acc: [head: 0.1424, middle: 0.0461, tail: 0.0223] 

round 6, global 3shot acc: [head: 0.1796, middle: 0.0264, tail: 0.0000] 

l_head tensor([0.5875, 0.5768, 1.3700, 0.9302, 0.6792, 0.8404, 1.3389, 1.2787, 1.1032,
        0.5833, 0.7896, 0.5650, 0.5697, 0.7975, 0.9731, 0.9684, 0.8680, 0.5680,
        0.5812, 0.6320, 0.8475, 0.7769, 0.5791, 0.8101, 0.5809, 1.0813, 0.8121,
        1.2590, 0.6949, 0.5966, 0.8239, 0.8973, 0.7738, 0.9021, 0.6288, 0.5540,
        0.5939, 0.5849, 0.5791, 0.7239, 0.6819, 0.5803, 0.5840, 0.7382, 0.7047,
        0.5714, 0.6132, 0.5916, 0.6374, 0.6566, 0.5731, 0.6672, 0.5846, 0.7341,
        0.6438, 0.5720, 0.5706, 0.6696, 0.6650, 0.5646, 0.5769, 0.5931, 0.7891,
        0.5860, 0.5830, 0.5838, 0.5868, 0.7306, 0.5920, 0.6899, 0.5850, 0.6036,
        0.5646, 0.5672, 0.5809, 0.5860, 0.5947, 0.5907, 0.6342, 0.5744, 0.5784,
        0.5748, 0.5628, 0.5904, 0.5819, 0.5837, 0.5657, 0.7264, 0.5867, 0.5893,
        0.5833, 0.5845, 0.5881, 0.5679, 0.5844, 0.5838, 0.6446, 0.5770, 0.6582,
        0.7413], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.0943, 1.1143, 1.4304, 0.9721, 1.1660, 0.9754, 1.0977, 1.2808, 1.1114,
        1.1430, 1.2201, 1.2797, 1.0232, 1.0516, 1.0549, 0.9946, 0.7911, 0.9612,
        0.9402, 0.8447, 1.0640, 0.8572, 0.9668, 0.9896, 0.9444, 0.7801, 0.7135,
        0.6964, 0.8575, 0.8932, 0.8595, 0.7307, 0.8036, 0.7461, 0.7138, 0.6903,
        0.6594, 0.7323, 0.6492, 0.6602, 0.6292, 0.6908, 0.6596, 0.6373, 0.6101,
        0.6484, 0.6266, 0.6633, 0.5978, 0.7314, 0.6461, 0.6075, 0.6462, 0.7515,
        0.6073, 0.6311, 0.5887, 0.5999, 0.6073, 0.6498, 0.6609, 0.6106, 0.6234,
        0.5759, 0.5910, 0.5914, 0.5986, 0.6130, 0.5955, 0.5887, 0.6289, 0.6062,
        0.5767, 0.6074, 0.5756, 0.5882, 0.6103, 0.5832, 0.5805, 0.5887, 0.5818,
        0.5628, 0.5966, 0.5990, 0.5902, 0.5849, 0.5914, 0.5843, 0.5664, 0.5907,
        0.5716, 0.5596, 0.5715, 0.5838, 0.5816, 0.5941, 0.5798, 0.5715, 0.5854,
        0.5879], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([6.4425], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.25766871165644173, middle:0.2, tail0.0
3shot of client 1:head:0.3867403314917127, middle:0.07142857142857142, tail0.0
3shot of client 2:head:0.1417910447761194, middle:0.0, tail0.0
3shot of client 3:head:0.3080168776371308, middle:0.0, tail0.0
3shot of client 4:head:0.18435754189944134, middle:0.024390243902439025, tail0.0
3shot of client 5:head:0.11320754716981132, middle:0.0, tail0.0
3shot of client 6:head:0.2, middle:0.09259259259259259, tail0.0
3shot of client 7:head:0.20382165605095542, middle:0.125, tail0.1111111111111111
3shot of client 8:head:0.2740740740740741, middle:0.027777777777777776, tail0.0
3shot of client 9:head:0.06451612903225806, middle:0.08571428571428572, tail0.1
3shot of client 10:head:0.19626168224299065, middle:0.07692307692307693, tail0.0
3shot of client 11:head:0.232, middle:0.03125, tail0.0
3shot of client 12:head:0.18085106382978725, middle:0.1, tail0.0
3shot of client 13:head:0.23931623931623933, middle:0.03125, tail0.0
3shot of client 14:head:0.14720812182741116, middle:0.047619047619047616, tail0.0
3shot of client 15:head:0.15966386554621848, middle:0.0, tail0.0
3shot of client 16:head:0.3067484662576687, middle:0.0, tail0.0
3shot of client 17:head:0.06369426751592357, middle:0.0, tail0.0
3shot of client 18:head:0.17293233082706766, middle:0.2542372881355932, tail0.0
3shot of client 19:head:0.23170731707317074, middle:0.05263157894736842, tail0.0
3shot of client 20:head:0.23497267759562843, middle:0.0425531914893617, tail0.16666666666666666
3shot of client 21:head:0.14893617021276595, middle:0.05084745762711865, tail0.0
3shot of client 22:head:0.25316455696202533, middle:0.08333333333333333, tail0.0
3shot of client 23:head:0.03260869565217391, middle:0.0, tail0.08333333333333333
3shot of client 24:head:0.007407407407407408, middle:0.10810810810810811, tail0.2857142857142857
3shot of client 25:head:0.34375, middle:0.06451612903225806, tail0.0
3shot of client 26:head:0.11965811965811966, middle:0.07142857142857142, tail0.0
3shot of client 27:head:0.08888888888888889, middle:0.09375, tail0.14285714285714285
3shot of client 28:head:0.22330097087378642, middle:0.0, tail0.0
3shot of client 29:head:0.28846153846153844, middle:0.04081632653061224, tail0.0
3shot of client 30:head:0.09009009009009009, middle:0.2, tail0.0
3shot of client 31:head:0.17616580310880828, middle:0.0, tail0.09090909090909091
3shot of client 32:head:0.1619047619047619, middle:0.08, tail0.0
3shot of client 33:head:0.12299465240641712, middle:0.022727272727272728, tail0.0
3shot of client 34:head:0.03067484662576687, middle:0.0, tail0.1
3shot of client 35:head:0.13043478260869565, middle:0.1, tail0.0
3shot of client 36:head:0.25287356321839083, middle:0.0, tail0.0
3shot of client 37:head:0.18686868686868688, middle:0.0, tail0.0
3shot of client 38:head:0.375, middle:0.0, tail0.0
3shot of client 39:head:0.16666666666666666, middle:0.0, tail0.0
round 7, local average test acc  0.1549 

round 7, local macro average F1 score  0.0433 

round 7, local weighted average F1 score  0.1154 

round 7, global test acc  0.0514 

round 7, average 3shot acc: [head: 0.1875, middle: 0.0545, tail: 0.0270] 

round 7, global 3shot acc: [head: 0.1868, middle: 0.0188, tail: 0.0000] 

l_head tensor([0.5876, 0.5771, 1.6905, 1.1536, 0.7088, 0.9657, 1.7144, 1.5475, 1.4391,
        0.5835, 0.8931, 0.5653, 0.5699, 0.9248, 1.1158, 1.2141, 0.8998, 0.5682,
        0.5815, 0.6488, 0.9532, 0.8214, 0.5794, 0.8104, 0.5811, 1.3226, 0.9231,
        1.5151, 0.7053, 0.5968, 1.0024, 1.0028, 0.8543, 1.1402, 0.6927, 0.5542,
        0.5941, 0.5851, 0.5793, 0.8374, 0.7556, 0.5806, 0.5843, 0.7721, 0.8034,
        0.5717, 0.6829, 0.5918, 0.7967, 0.6961, 0.5734, 0.7242, 0.5848, 0.8024,
        0.6763, 0.5723, 0.6209, 0.6599, 0.7589, 0.5648, 0.5771, 0.5934, 0.8846,
        0.5862, 0.5832, 0.5841, 0.5870, 0.8095, 0.5922, 0.7852, 0.5852, 0.7159,
        0.5648, 0.5675, 0.5811, 0.5862, 0.5949, 0.5909, 0.6778, 0.5746, 0.5786,
        0.5751, 0.5631, 0.5906, 0.5821, 0.5840, 0.5660, 0.7872, 0.5869, 0.5896,
        0.5835, 0.5847, 0.5882, 0.5681, 0.5847, 0.5840, 0.6763, 0.5772, 0.6814,
        0.7974], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.1815, 1.2062, 1.5413, 1.0974, 1.2287, 0.9994, 1.2262, 1.3473, 1.1992,
        1.2547, 1.2516, 1.3449, 1.1304, 1.0809, 1.1089, 1.0682, 0.8194, 0.9875,
        0.9902, 0.8468, 1.1318, 0.9108, 1.0113, 1.0443, 0.9704, 0.8301, 0.7344,
        0.7479, 0.8712, 0.9116, 0.9255, 0.7595, 0.8471, 0.7744, 0.7283, 0.7094,
        0.6734, 0.7668, 0.6801, 0.6945, 0.6489, 0.7100, 0.6820, 0.6378, 0.6233,
        0.6613, 0.6434, 0.6850, 0.6108, 0.8084, 0.6551, 0.6238, 0.6856, 0.7527,
        0.6182, 0.6405, 0.5938, 0.6028, 0.6247, 0.6636, 0.6810, 0.6188, 0.6449,
        0.5760, 0.5909, 0.5949, 0.6000, 0.6155, 0.6024, 0.6035, 0.6256, 0.6275,
        0.5835, 0.6088, 0.5795, 0.5911, 0.6153, 0.5864, 0.5833, 0.5907, 0.5840,
        0.5620, 0.5989, 0.6035, 0.5901, 0.5851, 0.5950, 0.5879, 0.5674, 0.5913,
        0.5735, 0.5618, 0.5770, 0.5843, 0.5825, 0.6039, 0.5823, 0.5721, 0.5902,
        0.5941], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([6.8745], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.2392638036809816, middle:0.22857142857142856, tail0.0
3shot of client 1:head:0.287292817679558, middle:0.19047619047619047, tail0.0
3shot of client 2:head:0.1417910447761194, middle:0.0, tail0.0
3shot of client 3:head:0.31645569620253167, middle:0.016129032258064516, tail0.0
3shot of client 4:head:0.1340782122905028, middle:0.12195121951219512, tail0.0
3shot of client 5:head:0.11320754716981132, middle:0.0, tail0.0
3shot of client 6:head:0.2097560975609756, middle:0.05555555555555555, tail0.0
3shot of client 7:head:0.22929936305732485, middle:0.1, tail0.0
3shot of client 8:head:0.2962962962962963, middle:0.027777777777777776, tail0.0
3shot of client 9:head:0.13548387096774195, middle:0.11428571428571428, tail0.1
3shot of client 10:head:0.17757009345794392, middle:0.11538461538461539, tail0.0  2%|         | 9/500 [15:51<17:58:30, 131.79s/it]
3shot of client 11:head:0.256, middle:0.0, tail0.0
3shot of client 12:head:0.22872340425531915, middle:0.02, tail0.0
3shot of client 13:head:0.3162393162393162, middle:0.0, tail0.0
3shot of client 14:head:0.16751269035532995, middle:0.07142857142857142, tail0.0
3shot of client 15:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 16:head:0.3006134969325153, middle:0.0, tail0.0
3shot of client 17:head:0.10191082802547771, middle:0.0, tail0.0
3shot of client 18:head:0.37969924812030076, middle:0.0847457627118644, tail0.0
3shot of client 19:head:0.2682926829268293, middle:0.017543859649122806, tail0.0
3shot of client 20:head:0.1092896174863388, middle:0.1702127659574468, tail0.08333333333333333
3shot of client 21:head:0.1574468085106383, middle:0.05084745762711865, tail0.0
3shot of client 22:head:0.2911392405063291, middle:0.1111111111111111, tail0.0
3shot of client 23:head:0.043478260869565216, middle:0.0, tail0.08333333333333333
3shot of client 24:head:0.2740740740740741, middle:0.02702702702702703, tail0.0
3shot of client 25:head:0.2265625, middle:0.06451612903225806, tail0.0
3shot of client 26:head:0.13675213675213677, middle:0.07142857142857142, tail0.0
3shot of client 27:head:0.0962962962962963, middle:0.09375, tail0.0
3shot of client 28:head:0.22330097087378642, middle:0.02, tail0.0
3shot of client 29:head:0.30288461538461536, middle:0.14285714285714285, tail0.0
3shot of client 30:head:0.13513513513513514, middle:0.13333333333333333, tail0.0
3shot of client 31:head:0.16580310880829016, middle:0.0, tail0.09090909090909091
3shot of client 32:head:0.24761904761904763, middle:0.08, tail0.0
3shot of client 33:head:0.13368983957219252, middle:0.0, tail0.0
3shot of client 34:head:0.08588957055214724, middle:0.0, tail0.0
3shot of client 35:head:0.13043478260869565, middle:0.1, tail0.0
3shot of client 36:head:0.034482758620689655, middle:0.0, tail0.09090909090909091
3shot of client 37:head:0.015151515151515152, middle:0.0, tail0.18181818181818182
3shot of client 38:head:0.3541666666666667, middle:0.07894736842105263, tail0.0
3shot of client 39:head:0.16161616161616163, middle:0.0, tail0.0
round 8, local average test acc  0.1600 

round 8, local macro average F1 score  0.0488 

round 8, local weighted average F1 score  0.1232 

round 8, global test acc  0.0634 

round 8, average 3shot acc: [head: 0.1942, middle: 0.0577, tail: 0.0158] 

round 8, global 3shot acc: [head: 0.2232, middle: 0.0304, tail: 0.0000] 

l_head tensor([0.5876, 0.5771, 1.6905, 1.1536, 0.7088, 0.9657, 1.7144, 1.5475, 1.4391,
        0.5835, 0.8931, 0.5653, 0.5699, 0.9248, 1.1158, 1.2141, 0.8998, 0.5682,
        0.5815, 0.6488, 0.9532, 0.8214, 0.5794, 0.8104, 0.5811, 1.3226, 0.9231,
        1.5151, 0.7053, 0.5968, 1.0024, 1.0028, 0.8543, 1.1402, 0.6927, 0.5542,
        0.5941, 0.5851, 0.5793, 0.8374, 0.7556, 0.5806, 0.5843, 0.7721, 0.8034,
        0.5717, 0.6829, 0.5918, 0.7967, 0.6961, 0.5734, 0.7242, 0.5848, 0.8024,
        0.6763, 0.5723, 0.6209, 0.6599, 0.7589, 0.5648, 0.5771, 0.5934, 0.8846,
        0.5862, 0.5832, 0.5841, 0.5870, 0.8095, 0.5922, 0.7852, 0.5852, 0.7159,
        0.5648, 0.5675, 0.5811, 0.5862, 0.5949, 0.5909, 0.6778, 0.5746, 0.5786,
        0.5751, 0.5631, 0.5906, 0.5821, 0.5840, 0.5660, 0.7872, 0.5869, 0.5896,
        0.5835, 0.5847, 0.5882, 0.5681, 0.5847, 0.5840, 0.6763, 0.5772, 0.6814,
        0.7974], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.2569, 1.3364, 1.6481, 1.1699, 1.3168, 1.0436, 1.2741, 1.4225, 1.2479,
        1.2653, 1.3142, 1.4244, 1.1935, 1.1947, 1.2178, 1.1145, 0.8688, 1.1028,
        1.0710, 0.8597, 1.1952, 1.0084, 1.0672, 1.0981, 1.0547, 0.8410, 0.7461,
        0.7729, 0.8977, 0.9607, 1.0280, 0.8094, 0.8719, 0.7863, 0.7753, 0.7256,
        0.7078, 0.8279, 0.6969, 0.6968, 0.6537, 0.7259, 0.7057, 0.6430, 0.6430,
        0.6725, 0.6442, 0.7095, 0.6136, 0.8334, 0.6619, 0.6338, 0.7259, 0.7868,
        0.6268, 0.6458, 0.6032, 0.6099, 0.6244, 0.6698, 0.7020, 0.6324, 0.6699,
        0.5746, 0.5938, 0.5996, 0.6022, 0.6222, 0.6066, 0.6118, 0.6318, 0.6355,
        0.5864, 0.6156, 0.5841, 0.5915, 0.6213, 0.5890, 0.5852, 0.5940, 0.5869,
        0.5625, 0.6034, 0.6103, 0.5918, 0.5872, 0.6034, 0.5886, 0.5670, 0.5916,
        0.5754, 0.5625, 0.5774, 0.5850, 0.5840, 0.6241, 0.5841, 0.5729, 0.5904,
        0.6036], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([7.2545], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.2331288343558282, middle:0.22857142857142856, tail0.0
3shot of client 1:head:0.3812154696132597, middle:0.19047619047619047, tail0.0
3shot of client 2:head:0.13432835820895522, middle:0.0, tail0.0
3shot of client 3:head:0.3670886075949367, middle:0.0, tail0.0
3shot of client 4:head:0.18994413407821228, middle:0.0975609756097561, tail0.1
3shot of client 5:head:0.10377358490566038, middle:0.0, tail0.0
3shot of client 6:head:0.1951219512195122, middle:0.07407407407407407, tail0.0
3shot of client 7:head:0.3248407643312102, middle:0.025, tail0.1111111111111111
3shot of client 8:head:0.28888888888888886, middle:0.0, tail0.0
3shot of client 9:head:0.06451612903225806, middle:0.08571428571428572, tail0.0
3shot of client 10:head:0.21495327102803738, middle:0.038461538461538464, tail0.0
3shot of client 11:head:0.208, middle:0.0, tail0.0
3shot of client 12:head:0.2553191489361702, middle:0.08, tail0.0
3shot of client 13:head:0.27350427350427353, middle:0.0625, tail0.0
3shot of client 14:head:0.16243654822335024, middle:0.023809523809523808, tail0.0
3shot of client 15:head:0.17647058823529413, middle:0.0, tail0.0
3shot of client 16:head:0.2883435582822086, middle:0.02702702702702703, tail0.0
3shot of client 17:head:0.08917197452229299, middle:0.0, tail0.0
3shot of client 18:head:0.2631578947368421, middle:0.11864406779661017, tail0.0
3shot of client 19:head:0.3048780487804878, middle:0.05263157894736842, tail0.0
3shot of client 20:head:0.08196721311475409, middle:0.0, tail0.0
3shot of client 21:head:0.20851063829787234, middle:0.06779661016949153, tail0.0
3shot of client 22:head:0.24050632911392406, middle:0.05555555555555555, tail0.0
3shot of client 23:head:0.22826086956521738, middle:0.0425531914893617, tail0.0
3shot of client 24:head:0.34074074074074073, middle:0.10810810810810811, tail0.0
3shot of client 25:head:0.28125, middle:0.06451612903225806, tail0.0
3shot of client 26:head:0.23931623931623933, middle:0.14285714285714285, tail0.2857142857142857
3shot of client 27:head:0.08148148148148149, middle:0.125, tail0.2857142857142857
3shot of client 28:head:0.2087378640776699, middle:0.0, tail0.0
3shot of client 29:head:0.34134615384615385, middle:0.1836734693877551, tail0.0
3shot of client 30:head:0.12612612612612611, middle:0.13333333333333333, tail0.0
3shot of client 31:head:0.16580310880829016, middle:0.02040816326530612, tail0.09090909090909091
3shot of client 32:head:0.06666666666666667, middle:0.0, tail0.0
3shot of client 33:head:0.13368983957219252, middle:0.0, tail0.0
3shot of client 34:head:0.12269938650306748, middle:0.02702702702702703, tail0.0
3shot of client 35:head:0.1391304347826087, middle:0.1, tail0.0
3shot of client 36:head:0.25862068965517243, middle:0.06521739130434782, tail0.0
3shot of client 37:head:0.025252525252525252, middle:0.0, tail0.18181818181818182
3shot of client 38:head:0.3333333333333333, middle:0.02631578947368421, tail0.0
3shot of client 39:head:0.17676767676767677, middle:0.0, tail0.0
round 9, local average test acc  0.1707 

round 9, local macro average F1 score  0.0447 

round 9, local weighted average F1 score  0.1201 

round 9, global test acc  0.0644 

round 9, average 3shot acc: [head: 0.2080, middle: 0.0567, tail: 0.0264] 

round 9, global 3shot acc: [head: 0.2320, middle: 0.0256, tail: 0.0000] 

l_head tensor([0.5876, 0.5771, 1.6905, 1.1536, 0.7088, 0.9657, 1.7144, 1.5475, 1.4391,
        0.5835, 0.8931, 0.5653, 0.5699, 0.9248, 1.1158, 1.2141, 0.8998, 0.5682,
        0.5815, 0.6488, 0.9532, 0.8214, 0.5794, 0.8104, 0.5811, 1.3226, 0.9231,
        1.5151, 0.7053, 0.5968, 1.0024, 1.0028, 0.8543, 1.1402, 0.6927, 0.5542,
        0.5941, 0.5851, 0.5793, 0.8374, 0.7556, 0.5806, 0.5843, 0.7721, 0.8034,
        0.5717, 0.6829, 0.5918, 0.7967, 0.6961, 0.5734, 0.7242, 0.5848, 0.8024,
        0.6763, 0.5723, 0.6209, 0.6599, 0.7589, 0.5648, 0.5771, 0.5934, 0.8846,
        0.5862, 0.5832, 0.5841, 0.5870, 0.8095, 0.5922, 0.7852, 0.5852, 0.7159,
        0.5648, 0.5675, 0.5811, 0.5862, 0.5949, 0.5909, 0.6778, 0.5746, 0.5786,
        0.5751, 0.5631, 0.5906, 0.5821, 0.5840, 0.5660, 0.7872, 0.5869, 0.5896,
        0.5835, 0.5847, 0.5882, 0.5681, 0.5847, 0.5840, 0.6763, 0.5772, 0.6814,
        0.7974], device='cuda:4', grad_fn=<NormBackward1>)  2%|         | 10/500 [18:22<18:44:49, 137.73s/it]  2%|         | 11/500 [20:50<19:08:36, 140.93s/it]
g_aux tensor([1.3445, 1.4437, 1.7415, 1.2533, 1.3910, 1.0659, 1.3376, 1.5003, 1.2785,
        1.3158, 1.3704, 1.4546, 1.2621, 1.2467, 1.3058, 1.1545, 0.8989, 1.1416,
        1.0975, 0.8838, 1.2582, 1.0512, 1.0986, 1.1562, 1.0935, 0.8615, 0.7706,
        0.7797, 0.9331, 1.0194, 1.0774, 0.8456, 0.8946, 0.8162, 0.8041, 0.7376,
        0.7321, 0.8644, 0.7341, 0.7173, 0.6598, 0.7388, 0.7306, 0.6534, 0.6516,
        0.7028, 0.6614, 0.7644, 0.6150, 0.8742, 0.6819, 0.6393, 0.7804, 0.8355,
        0.6424, 0.6527, 0.6046, 0.6165, 0.6264, 0.6987, 0.7379, 0.6336, 0.6810,
        0.5806, 0.5990, 0.6024, 0.6072, 0.6393, 0.6209, 0.6181, 0.6408, 0.6592,
        0.5880, 0.6301, 0.5834, 0.5918, 0.6246, 0.5917, 0.5895, 0.5979, 0.5881,
        0.5634, 0.6107, 0.6186, 0.5960, 0.5885, 0.6108, 0.5895, 0.5666, 0.5927,
        0.5747, 0.5631, 0.5894, 0.5857, 0.5887, 0.6244, 0.5848, 0.5737, 0.5898,
        0.6034], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([7.5618], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.3128834355828221, middle:0.2, tail0.0
3shot of client 1:head:0.5138121546961326, middle:0.19047619047619047, tail0.0
3shot of client 2:head:0.14925373134328357, middle:0.0, tail0.0
3shot of client 3:head:0.38396624472573837, middle:0.0, tail0.0
3shot of client 4:head:0.20670391061452514, middle:0.14634146341463414, tail0.0
3shot of client 5:head:0.03773584905660377, middle:0.0, tail0.16666666666666666
3shot of client 6:head:0.24878048780487805, middle:0.05555555555555555, tail0.0
3shot of client 7:head:0.27388535031847133, middle:0.075, tail0.1111111111111111
3shot of client 8:head:0.28888888888888886, middle:0.08333333333333333, tail0.0
3shot of client 9:head:0.23225806451612904, middle:0.08571428571428572, tail0.2
3shot of client 10:head:0.24299065420560748, middle:0.11538461538461539, tail0.0
3shot of client 11:head:0.28, middle:0.03125, tail0.0
3shot of client 12:head:0.23404255319148937, middle:0.1, tail0.0
3shot of client 13:head:0.3504273504273504, middle:0.0, tail0.0
3shot of client 14:head:0.15736040609137056, middle:0.07142857142857142, tail0.0
3shot of client 15:head:0.18487394957983194, middle:0.0, tail0.0
3shot of client 16:head:0.294478527607362, middle:0.02702702702702703, tail0.0
3shot of client 17:head:0.050955414012738856, middle:0.0, tail0.0
3shot of client 18:head:0.2781954887218045, middle:0.06779661016949153, tail0.0
3shot of client 19:head:0.3130081300813008, middle:0.03508771929824561, tail0.0
3shot of client 20:head:0.08196721311475409, middle:0.0, tail0.0
3shot of client 21:head:0.2425531914893617, middle:0.11864406779661017, tail0.0
3shot of client 22:head:0.2974683544303797, middle:0.1388888888888889, tail0.0
3shot of client 23:head:0.20108695652173914, middle:0.0425531914893617, tail0.0
3shot of client 24:head:0.1111111111111111, middle:0.08108108108108109, tail0.0
3shot of client 25:head:0.3359375, middle:0.06451612903225806, tail0.0
3shot of client 26:head:0.1623931623931624, middle:0.07142857142857142, tail0.0
3shot of client 27:head:0.07407407407407407, middle:0.09375, tail0.2857142857142857
3shot of client 28:head:0.2815533980582524, middle:0.06, tail0.0
3shot of client 29:head:0.3125, middle:0.12244897959183673, tail0.0
3shot of client 30:head:0.13513513513513514, middle:0.1, tail0.0
3shot of client 31:head:0.23316062176165803, middle:0.061224489795918366, tail0.0
3shot of client 32:head:0.14285714285714285, middle:0.08, tail0.3333333333333333
3shot of client 33:head:0.11764705882352941, middle:0.0, tail0.0
3shot of client 34:head:0.1165644171779141, middle:0.0, tail0.0
3shot of client 35:head:0.20869565217391303, middle:0.16666666666666666, tail0.0
3shot of client 36:head:0.28735632183908044, middle:0.06521739130434782, tail0.0
3shot of client 37:head:0.025252525252525252, middle:0.0, tail0.18181818181818182
3shot of client 38:head:0.2777777777777778, middle:0.07894736842105263, tail0.0
3shot of client 39:head:0.18181818181818182, middle:0.0, tail0.0
round 10, local average test acc  0.1832 

round 10, local macro average F1 score  0.0617 

round 10, local weighted average F1 score  0.1545 

round 10, global test acc  0.0688 

round 10, average 3shot acc: [head: 0.2215, middle: 0.0657, tail: 0.0320] 

round 10, global 3shot acc: [head: 0.2596, middle: 0.0156, tail: 0.0000] 

l_head tensor([0.5876, 0.5771, 1.6905, 1.1536, 0.7088, 0.9657, 1.7144, 1.5475, 1.4391,
        0.5835, 0.8931, 0.5653, 0.5699, 0.9248, 1.1158, 1.2141, 0.8998, 0.5682,
        0.5815, 0.6488, 0.9532, 0.8214, 0.5794, 0.8104, 0.5811, 1.3226, 0.9231,
        1.5151, 0.7053, 0.5968, 1.0024, 1.0028, 0.8543, 1.1402, 0.6927, 0.5542,
        0.5941, 0.5851, 0.5793, 0.8374, 0.7556, 0.5806, 0.5843, 0.7721, 0.8034,
        0.5717, 0.6829, 0.5918, 0.7967, 0.6961, 0.5734, 0.7242, 0.5848, 0.8024,
        0.6763, 0.5723, 0.6209, 0.6599, 0.7589, 0.5648, 0.5771, 0.5934, 0.8846,
        0.5862, 0.5832, 0.5841, 0.5870, 0.8095, 0.5922, 0.7852, 0.5852, 0.7159,
        0.5648, 0.5675, 0.5811, 0.5862, 0.5949, 0.5909, 0.6778, 0.5746, 0.5786,
        0.5751, 0.5631, 0.5906, 0.5821, 0.5840, 0.5660, 0.7872, 0.5869, 0.5896,
        0.5835, 0.5847, 0.5882, 0.5681, 0.5847, 0.5840, 0.6763, 0.5772, 0.6814,
        0.7974], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.4152, 1.4560, 1.7825, 1.2690, 1.4453, 1.0665, 1.3912, 1.5888, 1.3219,
        1.3775, 1.4652, 1.4593, 1.3480, 1.2769, 1.3612, 1.2031, 0.9524, 1.1803,
        1.1297, 0.8925, 1.2888, 1.0985, 1.0634, 1.2436, 1.1143, 0.8728, 0.7836,
        0.7929, 0.9924, 1.0366, 1.0872, 0.8610, 0.9264, 0.8320, 0.8167, 0.7610,
        0.7610, 0.8649, 0.7369, 0.7587, 0.6843, 0.7430, 0.7413, 0.6741, 0.6814,
        0.7265, 0.6906, 0.7767, 0.6227, 0.9290, 0.6854, 0.6556, 0.8107, 0.8893,
        0.6575, 0.6653, 0.6149, 0.6260, 0.6371, 0.7226, 0.7582, 0.6457, 0.6986,
        0.5944, 0.6083, 0.6026, 0.6048, 0.6393, 0.6282, 0.6239, 0.6564, 0.6576,
        0.5887, 0.6587, 0.5850, 0.5938, 0.6324, 0.5899, 0.5922, 0.6000, 0.5916,
        0.5653, 0.6112, 0.6290, 0.6078, 0.5941, 0.6132, 0.5899, 0.5645, 0.5933,
        0.5730, 0.5621, 0.6009, 0.5823, 0.5883, 0.6247, 0.5853, 0.5743, 0.5919,
        0.6030], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([7.8763], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.2883435582822086, middle:0.22857142857142856, tail0.0
3shot of client 1:head:0.5303867403314917, middle:0.21428571428571427, tail0.0
3shot of client 2:head:0.15671641791044777, middle:0.0, tail0.0
3shot of client 3:head:0.3881856540084388, middle:0.0, tail0.0
3shot of client 4:head:0.2346368715083799, middle:0.0975609756097561, tail0.0
3shot of client 5:head:0.02830188679245283, middle:0.0, tail0.16666666666666666
3shot of client 6:head:0.23902439024390243, middle:0.07407407407407407, tail0.09090909090909091
3shot of client 7:head:0.3057324840764331, middle:0.075, tail0.2222222222222222
3shot of client 8:head:0.2962962962962963, middle:0.05555555555555555, tail0.0
3shot of client 9:head:0.2709677419354839, middle:0.08571428571428572, tail0.2
3shot of client 10:head:0.2336448598130841, middle:0.11538461538461539, tail0.0
3shot of client 11:head:0.312, middle:0.09375, tail0.0
3shot of client 12:head:0.26063829787234044, middle:0.12, tail0.0
3shot of client 13:head:0.2905982905982906, middle:0.03125, tail0.0
3shot of client 14:head:0.19289340101522842, middle:0.047619047619047616, tail0.0
3shot of client 15:head:0.21008403361344538, middle:0.0, tail0.0
3shot of client 16:head:0.38650306748466257, middle:0.08108108108108109, tail0.0
3shot of client 17:head:0.37579617834394907, middle:0.07317073170731707, tail0.0
3shot of client 18:head:0.3458646616541353, middle:0.0847457627118644, tail0.0
3shot of client 19:head:0.32113821138211385, middle:0.05263157894736842, tail0.0
3shot of client 20:head:0.08196721311475409, middle:0.0, tail0.0
3shot of client 21:head:0.31063829787234043, middle:0.15254237288135594, tail0.0
3shot of client 22:head:0.2911392405063291, middle:0.1111111111111111, tail0.0
3shot of client 23:head:0.010869565217391304, middle:0.10638297872340426, tail0.0
3shot of client 24:head:0.2222222222222222, middle:0.13513513513513514, tail0.0  2%|         | 12/500 [23:18<19:23:58, 143.11s/it]
3shot of client 25:head:0.40625, middle:0.0, tail0.0
3shot of client 26:head:0.18803418803418803, middle:0.07142857142857142, tail0.0
3shot of client 27:head:0.08148148148148149, middle:0.25, tail0.2857142857142857
3shot of client 28:head:0.27184466019417475, middle:0.12, tail0.0
3shot of client 29:head:0.40865384615384615, middle:0.0, tail0.09090909090909091
3shot of client 30:head:0.14414414414414414, middle:0.13333333333333333, tail0.0
3shot of client 31:head:0.2538860103626943, middle:0.0, tail0.09090909090909091
3shot of client 32:head:0.18095238095238095, middle:0.0, tail0.16666666666666666
3shot of client 33:head:0.11229946524064172, middle:0.0, tail0.0
3shot of client 34:head:0.11042944785276074, middle:0.0, tail0.0
3shot of client 35:head:0.2608695652173913, middle:0.16666666666666666, tail0.0
3shot of client 36:head:0.3275862068965517, middle:0.021739130434782608, tail0.0
3shot of client 37:head:0.03535353535353535, middle:0.0, tail0.18181818181818182
3shot of client 38:head:0.3194444444444444, middle:0.07894736842105263, tail0.0
3shot of client 39:head:0.30303030303030304, middle:0.07407407407407407, tail0.0
round 11, local average test acc  0.2066 

round 11, local macro average F1 score  0.0687 

round 11, local weighted average F1 score  0.1710 

round 11, global test acc  0.0703 

round 11, average 3shot acc: [head: 0.2497, middle: 0.0738, tail: 0.0374] 

round 11, global 3shot acc: [head: 0.2800, middle: 0.0012, tail: 0.0000] 

l_head tensor([0.5876, 0.5771, 1.6905, 1.1536, 0.7088, 0.9657, 1.7144, 1.5475, 1.4391,
        0.5835, 0.8931, 0.5653, 0.5699, 0.9248, 1.1158, 1.2141, 0.8998, 0.5682,
        0.5815, 0.6488, 0.9532, 0.8214, 0.5794, 0.8104, 0.5811, 1.3226, 0.9231,
        1.5151, 0.7053, 0.5968, 1.0024, 1.0028, 0.8543, 1.1402, 0.6927, 0.5542,
        0.5941, 0.5851, 0.5793, 0.8374, 0.7556, 0.5806, 0.5843, 0.7721, 0.8034,
        0.5717, 0.6829, 0.5918, 0.7967, 0.6961, 0.5734, 0.7242, 0.5848, 0.8024,
        0.6763, 0.5723, 0.6209, 0.6599, 0.7589, 0.5648, 0.5771, 0.5934, 0.8846,
        0.5862, 0.5832, 0.5841, 0.5870, 0.8095, 0.5922, 0.7852, 0.5852, 0.7159,
        0.5648, 0.5675, 0.5811, 0.5862, 0.5949, 0.5909, 0.6778, 0.5746, 0.5786,
        0.5751, 0.5631, 0.5906, 0.5821, 0.5840, 0.5660, 0.7872, 0.5869, 0.5896,
        0.5835, 0.5847, 0.5882, 0.5681, 0.5847, 0.5840, 0.6763, 0.5772, 0.6814,
        0.7974], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.4977, 1.4826, 1.7828, 1.2772, 1.5306, 1.1123, 1.3944, 1.6196, 1.3654,
        1.4900, 1.5187, 1.5056, 1.4316, 1.3573, 1.3868, 1.2606, 0.9802, 1.2910,
        1.1975, 0.9365, 1.3457, 1.1144, 1.0810, 1.3425, 1.1508, 0.9051, 0.7991,
        0.8174, 1.0223, 1.0785, 1.0896, 0.8692, 0.9405, 0.8673, 0.8273, 0.7866,
        0.7721, 0.8966, 0.7617, 0.7962, 0.6964, 0.7560, 0.7539, 0.6993, 0.6950,
        0.7455, 0.7156, 0.7914, 0.6344, 0.9334, 0.6962, 0.6712, 0.8440, 0.9245,
        0.6721, 0.6737, 0.6239, 0.6378, 0.6577, 0.7375, 0.7762, 0.6647, 0.7102,
        0.6051, 0.6242, 0.6099, 0.6107, 0.6440, 0.6318, 0.6314, 0.6952, 0.6905,
        0.5938, 0.6766, 0.5921, 0.5979, 0.6397, 0.5930, 0.6030, 0.6096, 0.5950,
        0.5680, 0.6170, 0.6370, 0.6200, 0.5972, 0.6181, 0.5888, 0.5651, 0.5933,
        0.5743, 0.5616, 0.6044, 0.5831, 0.5887, 0.6250, 0.5864, 0.5698, 0.5921,
        0.6035], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([8.1588], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.31901840490797545, middle:0.22857142857142856, tail0.0
3shot of client 1:head:0.5303867403314917, middle:0.21428571428571427, tail0.0
3shot of client 2:head:0.11194029850746269, middle:0.08571428571428572, tail0.0
3shot of client 3:head:0.3628691983122363, middle:0.016129032258064516, tail0.0
3shot of client 4:head:0.24581005586592178, middle:0.14634146341463414, tail0.1
3shot of client 5:head:0.03773584905660377, middle:0.0, tail0.16666666666666666
3shot of client 6:head:0.3121951219512195, middle:0.07407407407407407, tail0.18181818181818182
3shot of client 7:head:0.3248407643312102, middle:0.05, tail0.1111111111111111
3shot of client 8:head:0.16296296296296298, middle:0.08333333333333333, tail0.125
3shot of client 9:head:0.23225806451612904, middle:0.11428571428571428, tail0.0
3shot of client 10:head:0.2523364485981308, middle:0.15384615384615385, tail0.0
3shot of client 11:head:0.344, middle:0.09375, tail0.0
3shot of client 12:head:0.3670212765957447, middle:0.08, tail0.0
3shot of client 13:head:0.38461538461538464, middle:0.03125, tail0.0
3shot of client 14:head:0.15228426395939088, middle:0.11904761904761904, tail0.0
3shot of client 15:head:0.15966386554621848, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.36809815950920244, middle:0.08108108108108109, tail0.0
3shot of client 17:head:0.40764331210191085, middle:0.07317073170731707, tail0.0
3shot of client 18:head:0.37218045112781956, middle:0.0847457627118644, tail0.0
3shot of client 19:head:0.3861788617886179, middle:0.05263157894736842, tail0.07142857142857142
3shot of client 20:head:0.08196721311475409, middle:0.0, tail0.0
3shot of client 21:head:0.3191489361702128, middle:0.06779661016949153, tail0.0
3shot of client 22:head:0.2911392405063291, middle:0.1111111111111111, tail0.0
3shot of client 23:head:0.04891304347826087, middle:0.0425531914893617, tail0.0
3shot of client 24:head:0.24444444444444444, middle:0.08108108108108109, tail0.0
3shot of client 25:head:0.3984375, middle:0.0967741935483871, tail0.0
3shot of client 26:head:0.1794871794871795, middle:0.10714285714285714, tail0.0
3shot of client 27:head:0.1037037037037037, middle:0.25, tail0.2857142857142857
3shot of client 28:head:0.25728155339805825, middle:0.12, tail0.0
3shot of client 29:head:0.38461538461538464, middle:0.061224489795918366, tail0.09090909090909091
3shot of client 30:head:0.14414414414414414, middle:0.13333333333333333, tail0.0
3shot of client 31:head:0.27979274611398963, middle:0.061224489795918366, tail0.09090909090909091
3shot of client 32:head:0.18095238095238095, middle:0.08, tail0.3333333333333333
3shot of client 33:head:0.1443850267379679, middle:0.022727272727272728, tail0.0
3shot of client 34:head:0.06748466257668712, middle:0.0, tail0.0
3shot of client 35:head:0.25217391304347825, middle:0.13333333333333333, tail0.0
3shot of client 36:head:0.3333333333333333, middle:0.021739130434782608, tail0.0
3shot of client 37:head:0.21212121212121213, middle:0.1111111111111111, tail0.18181818181818182
3shot of client 38:head:0.3263888888888889, middle:0.07894736842105263, tail0.0
3shot of client 39:head:0.30808080808080807, middle:0.018518518518518517, tail0.0
round 12, local average test acc  0.2167 

round 12, local macro average F1 score  0.0790 

round 12, local weighted average F1 score  0.1849 

round 12, global test acc  0.0802 

round 12, average 3shot acc: [head: 0.2598, middle: 0.0861, tail: 0.0435] 

round 12, global 3shot acc: [head: 0.3016, middle: 0.0192, tail: 0.0000] 

l_head tensor([0.5876, 0.5771, 1.6905, 1.1536, 0.7088, 0.9657, 1.7144, 1.5475, 1.4391,
        0.5835, 0.8931, 0.5653, 0.5699, 0.9248, 1.1158, 1.2141, 0.8998, 0.5682,
        0.5815, 0.6488, 0.9532, 0.8214, 0.5794, 0.8104, 0.5811, 1.3226, 0.9231,
        1.5151, 0.7053, 0.5968, 1.0024, 1.0028, 0.8543, 1.1402, 0.6927, 0.5542,
        0.5941, 0.5851, 0.5793, 0.8374, 0.7556, 0.5806, 0.5843, 0.7721, 0.8034,
        0.5717, 0.6829, 0.5918, 0.7967, 0.6961, 0.5734, 0.7242, 0.5848, 0.8024,
        0.6763, 0.5723, 0.6209, 0.6599, 0.7589, 0.5648, 0.5771, 0.5934, 0.8846,
        0.5862, 0.5832, 0.5841, 0.5870, 0.8095, 0.5922, 0.7852, 0.5852, 0.7159,
        0.5648, 0.5675, 0.5811, 0.5862, 0.5949, 0.5909, 0.6778, 0.5746, 0.5786,
        0.5751, 0.5631, 0.5906, 0.5821, 0.5840, 0.5660, 0.7872, 0.5869, 0.5896,
        0.5835, 0.5847, 0.5882, 0.5681, 0.5847, 0.5840, 0.6763, 0.5772, 0.6814,
        0.7974], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.5446, 1.5334, 1.8377, 1.3706, 1.5863, 1.2212, 1.4256, 1.6421, 1.3904,
        1.4975, 1.5118, 1.5415, 1.4509, 1.4020, 1.4322, 1.2722, 1.0247, 1.3704,
        1.2585, 0.9531, 1.4239, 1.1440, 1.1153, 1.4045, 1.1764, 0.9189, 0.8124,
        0.8551, 1.0331, 1.1133, 1.1298, 0.9038, 0.9618, 0.8783, 0.8465, 0.8484,
        0.8034, 0.9168, 0.7754, 0.8075, 0.7020, 0.7842, 0.7751, 0.7078, 0.7164,
        0.7578, 0.7265, 0.8330, 0.6535, 0.9626, 0.7066, 0.6762, 0.8583, 0.9378,
        0.6806, 0.6718, 0.6337, 0.6495, 0.6981, 0.7442, 0.8130, 0.6732, 0.7197,
        0.6172, 0.6419, 0.6061, 0.6162, 0.6486, 0.6498, 0.6445, 0.6710, 0.7117,
        0.5977, 0.6810, 0.5999, 0.6047, 0.6569, 0.5931, 0.6074, 0.6136, 0.5952,
        0.5692, 0.6290, 0.6338, 0.6224, 0.5971, 0.6212, 0.5951, 0.5654, 0.5986,
        0.5834, 0.5621, 0.6013, 0.5884, 0.5895, 0.6370, 0.5926, 0.5705, 0.5975,
        0.6097], device='cuda:4', grad_fn=<NormBackward1>)  3%|         | 13/500 [25:49<19:40:51, 145.48s/it]  3%|         | 14/500 [28:19<19:47:51, 146.65s/it]
The value of constant scaler:  tensor([8.4830], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.3312883435582822, middle:0.17142857142857143, tail0.0
3shot of client 1:head:0.569060773480663, middle:0.07142857142857142, tail0.0
3shot of client 2:head:0.11940298507462686, middle:0.08571428571428572, tail0.0
3shot of client 3:head:0.4092827004219409, middle:0.016129032258064516, tail0.0
3shot of client 4:head:0.25139664804469275, middle:0.14634146341463414, tail0.1
3shot of client 5:head:0.03773584905660377, middle:0.0, tail0.16666666666666666
3shot of client 6:head:0.36097560975609755, middle:0.07407407407407407, tail0.18181818181818182
3shot of client 7:head:0.31210191082802546, middle:0.1, tail0.2222222222222222
3shot of client 8:head:0.14814814814814814, middle:0.08333333333333333, tail0.125
3shot of client 9:head:0.23870967741935484, middle:0.17142857142857143, tail0.0
3shot of client 10:head:0.2523364485981308, middle:0.11538461538461539, tail0.0
3shot of client 11:head:0.072, middle:0.0, tail0.25
3shot of client 12:head:0.30319148936170215, middle:0.18, tail0.0
3shot of client 13:head:0.38461538461538464, middle:0.0625, tail0.0
3shot of client 14:head:0.16243654822335024, middle:0.19047619047619047, tail0.08333333333333333
3shot of client 15:head:0.31932773109243695, middle:0.0967741935483871, tail0.0
3shot of client 16:head:0.4723926380368098, middle:0.05405405405405406, tail0.0
3shot of client 17:head:0.21019108280254778, middle:0.07317073170731707, tail0.1
3shot of client 18:head:0.35714285714285715, middle:0.13559322033898305, tail0.058823529411764705
3shot of client 19:head:0.42276422764227645, middle:0.12280701754385964, tail0.07142857142857142
3shot of client 20:head:0.08196721311475409, middle:0.0, tail0.0
3shot of client 21:head:0.3148936170212766, middle:0.15254237288135594, tail0.0
3shot of client 22:head:0.2974683544303797, middle:0.1111111111111111, tail0.0
3shot of client 23:head:0.059782608695652176, middle:0.0851063829787234, tail0.0
3shot of client 24:head:0.2814814814814815, middle:0.10810810810810811, tail0.2857142857142857
3shot of client 25:head:0.4453125, middle:0.03225806451612903, tail0.0
3shot of client 26:head:0.2222222222222222, middle:0.25, tail0.0
3shot of client 27:head:0.15555555555555556, middle:0.28125, tail0.2857142857142857
3shot of client 28:head:0.2961165048543689, middle:0.1, tail0.0
3shot of client 29:head:0.47596153846153844, middle:0.04081632653061224, tail0.09090909090909091
3shot of client 30:head:0.17117117117117117, middle:0.26666666666666666, tail0.0
3shot of client 31:head:0.27461139896373055, middle:0.0, tail0.09090909090909091
3shot of client 32:head:0.17142857142857143, middle:0.04, tail0.3333333333333333
3shot of client 33:head:0.13903743315508021, middle:0.0, tail0.0
3shot of client 34:head:0.09202453987730061, middle:0.0, tail0.0
3shot of client 35:head:0.2782608695652174, middle:0.2, tail0.0
3shot of client 36:head:0.3850574712643678, middle:0.0, tail0.0
3shot of client 37:head:0.2828282828282828, middle:0.1111111111111111, tail0.18181818181818182
3shot of client 38:head:0.4652777777777778, middle:0.13157894736842105, tail0.0
3shot of client 39:head:0.23232323232323232, middle:0.05555555555555555, tail0.0
round 13, local average test acc  0.2291 

round 13, local macro average F1 score  0.0864 

round 13, local weighted average F1 score  0.1761 

round 13, global test acc  0.0904 

round 13, average 3shot acc: [head: 0.2714, middle: 0.0979, tail: 0.0657] 

round 13, global 3shot acc: [head: 0.3344, middle: 0.0272, tail: 0.0000] 

l_head tensor([0.5876, 0.5771, 1.6905, 1.1536, 0.7088, 0.9657, 1.7144, 1.5475, 1.4391,
        0.5835, 0.8931, 0.5653, 0.5699, 0.9248, 1.1158, 1.2141, 0.8998, 0.5682,
        0.5815, 0.6488, 0.9532, 0.8214, 0.5794, 0.8104, 0.5811, 1.3226, 0.9231,
        1.5151, 0.7053, 0.5968, 1.0024, 1.0028, 0.8543, 1.1402, 0.6927, 0.5542,
        0.5941, 0.5851, 0.5793, 0.8374, 0.7556, 0.5806, 0.5843, 0.7721, 0.8034,
        0.5717, 0.6829, 0.5918, 0.7967, 0.6961, 0.5734, 0.7242, 0.5848, 0.8024,
        0.6763, 0.5723, 0.6209, 0.6599, 0.7589, 0.5648, 0.5771, 0.5934, 0.8846,
        0.5862, 0.5832, 0.5841, 0.5870, 0.8095, 0.5922, 0.7852, 0.5852, 0.7159,
        0.5648, 0.5675, 0.5811, 0.5862, 0.5949, 0.5909, 0.6778, 0.5746, 0.5786,
        0.5751, 0.5631, 0.5906, 0.5821, 0.5840, 0.5660, 0.7872, 0.5869, 0.5896,
        0.5835, 0.5847, 0.5882, 0.5681, 0.5847, 0.5840, 0.6763, 0.5772, 0.6814,
        0.7974], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.6327, 1.6086, 1.8793, 1.4066, 1.6405, 1.2728, 1.4642, 1.6686, 1.3962,
        1.5797, 1.4928, 1.5751, 1.4812, 1.4763, 1.5032, 1.2840, 1.0567, 1.4105,
        1.2833, 0.9849, 1.4461, 1.2327, 1.1329, 1.4440, 1.2400, 0.9611, 0.8258,
        0.8984, 1.0258, 1.1325, 1.1854, 0.9144, 0.9800, 0.8866, 0.8809, 0.8389,
        0.8126, 0.9750, 0.7992, 0.8087, 0.7167, 0.8276, 0.7811, 0.7148, 0.7593,
        0.7586, 0.7249, 0.8707, 0.6649, 0.9787, 0.7035, 0.6914, 0.8738, 0.9531,
        0.7143, 0.6749, 0.6450, 0.6515, 0.7083, 0.7758, 0.8783, 0.6819, 0.7250,
        0.6229, 0.6494, 0.6127, 0.6207, 0.6612, 0.6546, 0.6575, 0.6886, 0.7427,
        0.6002, 0.6818, 0.6103, 0.6038, 0.6814, 0.5965, 0.6110, 0.6178, 0.6008,
        0.5709, 0.6354, 0.6319, 0.6255, 0.6015, 0.6222, 0.5966, 0.5659, 0.6056,
        0.6001, 0.5632, 0.6015, 0.5923, 0.5945, 0.6544, 0.5991, 0.5681, 0.6016,
        0.6171], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([8.7868], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.3128834355828221, middle:0.2, tail0.0
3shot of client 1:head:0.5027624309392266, middle:0.19047619047619047, tail0.0
3shot of client 2:head:0.09701492537313433, middle:0.05714285714285714, tail0.0
3shot of client 3:head:0.3755274261603376, middle:0.0, tail0.0
3shot of client 4:head:0.48044692737430167, middle:0.0, tail0.0
3shot of client 5:head:0.02830188679245283, middle:0.0, tail0.16666666666666666
3shot of client 6:head:0.16097560975609757, middle:0.2037037037037037, tail0.0
3shot of client 7:head:0.3375796178343949, middle:0.1, tail0.2222222222222222
3shot of client 8:head:0.43703703703703706, middle:0.1111111111111111, tail0.0
3shot of client 9:head:0.23225806451612904, middle:0.17142857142857143, tail0.0
3shot of client 10:head:0.22429906542056074, middle:0.19230769230769232, tail0.0
3shot of client 11:head:0.056, middle:0.0, tail0.25
3shot of client 12:head:0.3191489361702128, middle:0.18, tail0.0
3shot of client 13:head:0.36752136752136755, middle:0.15625, tail0.0
3shot of client 14:head:0.18274111675126903, middle:0.16666666666666666, tail0.08333333333333333
3shot of client 15:head:0.24369747899159663, middle:0.12903225806451613, tail0.0
3shot of client 16:head:0.4662576687116564, middle:0.08108108108108109, tail0.0
3shot of client 17:head:0.17834394904458598, middle:0.1951219512195122, tail0.1
3shot of client 18:head:0.2819548872180451, middle:0.06779661016949153, tail0.058823529411764705
3shot of client 19:head:0.4186991869918699, middle:0.14035087719298245, tail0.07142857142857142
3shot of client 20:head:0.30601092896174864, middle:0.02127659574468085, tail0.08333333333333333
3shot of client 21:head:0.35319148936170214, middle:0.15254237288135594, tail0.0
3shot of client 22:head:0.27848101265822783, middle:0.1388888888888889, tail0.0
3shot of client 23:head:0.10869565217391304, middle:0.10638297872340426, tail0.0
3shot of client 24:head:0.17777777777777778, middle:0.10810810810810811, tail0.14285714285714285
3shot of client 25:head:0.5234375, middle:0.06451612903225806, tail0.0
3shot of client 26:head:0.24786324786324787, middle:0.17857142857142858, tail0.0
3shot of client 27:head:0.0962962962962963, middle:0.28125, tail0.2857142857142857
3shot of client 28:head:0.23786407766990292, middle:0.04, tail0.0
3shot of client 29:head:0.47596153846153844, middle:0.08163265306122448, tail0.09090909090909091
3shot of client 30:head:0.15315315315315314, middle:0.26666666666666666, tail0.0
3shot of client 31:head:0.3316062176165803, middle:0.0, tail0.09090909090909091
3shot of client 32:head:0.19047619047619047, middle:0.04, tail0.3333333333333333
3shot of client 33:head:0.40106951871657753, middle:0.09090909090909091, tail0.0  3%|         | 15/500 [30:46<19:46:16, 146.76s/it]
3shot of client 34:head:0.15950920245398773, middle:0.0, tail0.0
3shot of client 35:head:0.22608695652173913, middle:0.13333333333333333, tail0.14285714285714285
3shot of client 36:head:0.40804597701149425, middle:0.0, tail0.0
3shot of client 37:head:0.25757575757575757, middle:0.17777777777777778, tail0.18181818181818182
3shot of client 38:head:0.4791666666666667, middle:0.10526315789473684, tail0.0
3shot of client 39:head:0.26262626262626265, middle:0.18518518518518517, tail0.0
round 14, local average test acc  0.2417 

round 14, local macro average F1 score  0.0833 

round 14, local weighted average F1 score  0.1893 

round 14, global test acc  0.0878 

round 14, average 3shot acc: [head: 0.2845, middle: 0.1129, tail: 0.0576] 

round 14, global 3shot acc: [head: 0.3212, middle: 0.0292, tail: 0.0004] 

l_head tensor([0.5876, 0.5771, 1.6905, 1.1536, 0.7088, 0.9657, 1.7144, 1.5475, 1.4391,
        0.5835, 0.8931, 0.5653, 0.5699, 0.9248, 1.1158, 1.2141, 0.8998, 0.5682,
        0.5815, 0.6488, 0.9532, 0.8214, 0.5794, 0.8104, 0.5811, 1.3226, 0.9231,
        1.5151, 0.7053, 0.5968, 1.0024, 1.0028, 0.8543, 1.1402, 0.6927, 0.5542,
        0.5941, 0.5851, 0.5793, 0.8374, 0.7556, 0.5806, 0.5843, 0.7721, 0.8034,
        0.5717, 0.6829, 0.5918, 0.7967, 0.6961, 0.5734, 0.7242, 0.5848, 0.8024,
        0.6763, 0.5723, 0.6209, 0.6599, 0.7589, 0.5648, 0.5771, 0.5934, 0.8846,
        0.5862, 0.5832, 0.5841, 0.5870, 0.8095, 0.5922, 0.7852, 0.5852, 0.7159,
        0.5648, 0.5675, 0.5811, 0.5862, 0.5949, 0.5909, 0.6778, 0.5746, 0.5786,
        0.5751, 0.5631, 0.5906, 0.5821, 0.5840, 0.5660, 0.7872, 0.5869, 0.5896,
        0.5835, 0.5847, 0.5882, 0.5681, 0.5847, 0.5840, 0.6763, 0.5772, 0.6814,
        0.7974], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.7520, 1.6889, 1.9108, 1.4438, 1.7036, 1.3362, 1.4894, 1.7222, 1.4067,
        1.5791, 1.5030, 1.5946, 1.5220, 1.5771, 1.5786, 1.2729, 1.1048, 1.3800,
        1.2826, 1.0115, 1.5128, 1.2885, 1.1309, 1.4755, 1.2597, 0.9664, 0.8303,
        0.8959, 1.0357, 1.1674, 1.2338, 0.9375, 0.9899, 0.8909, 0.8957, 0.8719,
        0.8593, 1.0311, 0.7955, 0.8497, 0.7328, 0.8908, 0.8025, 0.7275, 0.7605,
        0.7625, 0.7478, 0.8930, 0.6908, 1.0579, 0.7185, 0.6871, 0.8970, 0.9467,
        0.7186, 0.6796, 0.6502, 0.6556, 0.7285, 0.7939, 0.9561, 0.7031, 0.7140,
        0.6427, 0.6664, 0.6161, 0.6214, 0.6804, 0.6714, 0.6641, 0.7123, 0.7547,
        0.6022, 0.6851, 0.6115, 0.6116, 0.6797, 0.5964, 0.6163, 0.6233, 0.6021,
        0.5737, 0.6452, 0.6438, 0.6266, 0.6046, 0.6277, 0.6009, 0.5667, 0.6063,
        0.5993, 0.5668, 0.6020, 0.6033, 0.6069, 0.6545, 0.6005, 0.5697, 0.6017,
        0.6140], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([9.0380], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.31901840490797545, middle:0.17142857142857143, tail0.0
3shot of client 1:head:0.5082872928176796, middle:0.19047619047619047, tail0.0
3shot of client 2:head:0.1417910447761194, middle:0.02857142857142857, tail0.0
3shot of client 3:head:0.4092827004219409, middle:0.016129032258064516, tail0.0
3shot of client 4:head:0.3575418994413408, middle:0.21951219512195122, tail0.0
3shot of client 5:head:0.03773584905660377, middle:0.038461538461538464, tail0.16666666666666666
3shot of client 6:head:0.2146341463414634, middle:0.18518518518518517, tail0.09090909090909091
3shot of client 7:head:0.3184713375796178, middle:0.1, tail0.2222222222222222
3shot of client 8:head:0.3851851851851852, middle:0.05555555555555555, tail0.25
3shot of client 9:head:0.25806451612903225, middle:0.11428571428571428, tail0.0
3shot of client 10:head:0.4672897196261682, middle:0.07692307692307693, tail0.0
3shot of client 11:head:0.056, middle:0.0, tail0.25
3shot of client 12:head:0.3882978723404255, middle:0.08, tail0.08333333333333333
3shot of client 13:head:0.452991452991453, middle:0.15625, tail0.0
3shot of client 14:head:0.17258883248730963, middle:0.16666666666666666, tail0.16666666666666666
3shot of client 15:head:0.2857142857142857, middle:0.16129032258064516, tail0.0
3shot of client 16:head:0.5276073619631901, middle:0.02702702702702703, tail0.0
3shot of client 17:head:0.20382165605095542, middle:0.12195121951219512, tail0.1
3shot of client 18:head:0.30451127819548873, middle:0.15254237288135594, tail0.058823529411764705
3shot of client 19:head:0.37398373983739835, middle:0.07017543859649122, tail0.07142857142857142
3shot of client 20:head:0.2185792349726776, middle:0.1702127659574468, tail0.16666666666666666
3shot of client 21:head:0.3148936170212766, middle:0.0847457627118644, tail0.0
3shot of client 22:head:0.2911392405063291, middle:0.1388888888888889, tail0.0
3shot of client 23:head:0.11413043478260869, middle:0.06382978723404255, tail0.0
3shot of client 24:head:0.18518518518518517, middle:0.05405405405405406, tail0.0
3shot of client 25:head:0.453125, middle:0.16129032258064516, tail0.0
3shot of client 26:head:0.18803418803418803, middle:0.21428571428571427, tail0.0
3shot of client 27:head:0.1111111111111111, middle:0.21875, tail0.2857142857142857
3shot of client 28:head:0.23786407766990292, middle:0.04, tail0.0
3shot of client 29:head:0.5, middle:0.10204081632653061, tail0.09090909090909091
3shot of client 30:head:0.18018018018018017, middle:0.3, tail0.0
3shot of client 31:head:0.29015544041450775, middle:0.02040816326530612, tail0.09090909090909091
3shot of client 32:head:0.23809523809523808, middle:0.04, tail0.16666666666666666
3shot of client 33:head:0.4117647058823529, middle:0.045454545454545456, tail0.0
3shot of client 34:head:0.13496932515337423, middle:0.0, tail0.0
3shot of client 35:head:0.34782608695652173, middle:0.26666666666666666, tail0.0
3shot of client 36:head:0.05172413793103448, middle:0.17391304347826086, tail0.0
3shot of client 37:head:0.2474747474747475, middle:0.1111111111111111, tail0.18181818181818182
3shot of client 38:head:0.4722222222222222, middle:0.10526315789473684, tail0.0
3shot of client 39:head:0.3484848484848485, middle:0.07407407407407407, tail0.0
round 15, local average test acc  0.2446 

round 15, local macro average F1 score  0.0972 

round 15, local weighted average F1 score  0.2006 

round 15, global test acc  0.0927 

round 15, average 3shot acc: [head: 0.2880, middle: 0.1129, tail: 0.0611] 

round 15, global 3shot acc: [head: 0.3344, middle: 0.0328, tail: 0.0018] 

l_head tensor([0.5876, 0.5771, 1.6905, 1.1536, 0.7088, 0.9657, 1.7144, 1.5475, 1.4391,
        0.5835, 0.8931, 0.5653, 0.5699, 0.9248, 1.1158, 1.2141, 0.8998, 0.5682,
        0.5815, 0.6488, 0.9532, 0.8214, 0.5794, 0.8104, 0.5811, 1.3226, 0.9231,
        1.5151, 0.7053, 0.5968, 1.0024, 1.0028, 0.8543, 1.1402, 0.6927, 0.5542,
        0.5941, 0.5851, 0.5793, 0.8374, 0.7556, 0.5806, 0.5843, 0.7721, 0.8034,
        0.5717, 0.6829, 0.5918, 0.7967, 0.6961, 0.5734, 0.7242, 0.5848, 0.8024,
        0.6763, 0.5723, 0.6209, 0.6599, 0.7589, 0.5648, 0.5771, 0.5934, 0.8846,
        0.5862, 0.5832, 0.5841, 0.5870, 0.8095, 0.5922, 0.7852, 0.5852, 0.7159,
        0.5648, 0.5675, 0.5811, 0.5862, 0.5949, 0.5909, 0.6778, 0.5746, 0.5786,
        0.5751, 0.5631, 0.5906, 0.5821, 0.5840, 0.5660, 0.7872, 0.5869, 0.5896,
        0.5835, 0.5847, 0.5882, 0.5681, 0.5847, 0.5840, 0.6763, 0.5772, 0.6814,
        0.7974], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.8594, 1.7362, 1.9603, 1.5058, 1.7180, 1.3701, 1.4936, 1.7273, 1.4240,
        1.5972, 1.4864, 1.6537, 1.5188, 1.5937, 1.5813, 1.2980, 1.1444, 1.3793,
        1.3291, 1.0375, 1.5554, 1.2999, 1.1554, 1.5056, 1.3493, 1.0046, 0.8424,
        0.9386, 1.0387, 1.1707, 1.2840, 0.9720, 0.9895, 0.8984, 0.9168, 0.8602,
        0.8885, 1.0491, 0.8041, 0.8661, 0.7567, 0.9329, 0.8215, 0.7292, 0.7854,
        0.7851, 0.7646, 0.9046, 0.7117, 1.0824, 0.7212, 0.6952, 0.9133, 0.9602,
        0.7259, 0.6906, 0.6664, 0.6620, 0.7733, 0.8095, 0.9856, 0.7140, 0.7320,
        0.6534, 0.6837, 0.6227, 0.6237, 0.7363, 0.6974, 0.6656, 0.7058, 0.7635,
        0.6039, 0.6990, 0.6283, 0.6161, 0.6949, 0.6019, 0.6238, 0.6350, 0.6025,
        0.5760, 0.6474, 0.6456, 0.6284, 0.6048, 0.6367, 0.6107, 0.5702, 0.6129,
        0.6126, 0.5699, 0.6004, 0.6107, 0.6152, 0.6698, 0.6089, 0.5708, 0.6068,
        0.6223], device='cuda:4', grad_fn=<NormBackward1>)  3%|         | 16/500 [32:58<19:09:16, 142.47s/it]  3%|         | 17/500 [35:22<19:11:16, 143.02s/it]
The value of constant scaler:  tensor([9.2769], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.3374233128834356, middle:0.17142857142857143, tail0.0
3shot of client 1:head:0.5193370165745856, middle:0.19047619047619047, tail0.0
3shot of client 2:head:0.13432835820895522, middle:0.05714285714285714, tail0.0
3shot of client 3:head:0.4345991561181435, middle:0.03225806451612903, tail0.0
3shot of client 4:head:0.2905027932960894, middle:0.21951219512195122, tail0.1
3shot of client 5:head:0.11320754716981132, middle:0.038461538461538464, tail0.16666666666666666
3shot of client 6:head:0.2146341463414634, middle:0.16666666666666666, tail0.09090909090909091
3shot of client 7:head:0.28662420382165604, middle:0.05, tail0.3333333333333333
3shot of client 8:head:0.35555555555555557, middle:0.1388888888888889, tail0.25
3shot of client 9:head:0.24516129032258063, middle:0.11428571428571428, tail0.0
3shot of client 10:head:0.4672897196261682, middle:0.07692307692307693, tail0.3333333333333333
3shot of client 11:head:0.08, middle:0.0, tail0.25
3shot of client 12:head:0.425531914893617, middle:0.1, tail0.08333333333333333
3shot of client 13:head:0.4188034188034188, middle:0.1875, tail0.0
3shot of client 14:head:0.1218274111675127, middle:0.14285714285714285, tail0.08333333333333333
3shot of client 15:head:0.18487394957983194, middle:0.0967741935483871, tail0.14285714285714285
3shot of client 16:head:0.4723926380368098, middle:0.08108108108108109, tail0.0
3shot of client 17:head:0.4140127388535032, middle:0.07317073170731707, tail0.0
3shot of client 18:head:0.2631578947368421, middle:0.15254237288135594, tail0.058823529411764705
3shot of client 19:head:0.35365853658536583, middle:0.07017543859649122, tail0.14285714285714285
3shot of client 20:head:0.13114754098360656, middle:0.10638297872340426, tail0.0
3shot of client 21:head:0.28936170212765955, middle:0.15254237288135594, tail0.0
3shot of client 22:head:0.2721518987341772, middle:0.1111111111111111, tail0.0
3shot of client 23:head:0.08152173913043478, middle:0.0851063829787234, tail0.0
3shot of client 24:head:0.14814814814814814, middle:0.02702702702702703, tail0.14285714285714285
3shot of client 25:head:0.4609375, middle:0.22580645161290322, tail0.0
3shot of client 26:head:0.23931623931623933, middle:0.21428571428571427, tail0.0
3shot of client 27:head:0.14814814814814814, middle:0.40625, tail0.0
3shot of client 28:head:0.23300970873786409, middle:0.02, tail0.0
3shot of client 29:head:0.4375, middle:0.10204081632653061, tail0.09090909090909091
3shot of client 30:head:0.32432432432432434, middle:0.26666666666666666, tail0.0
3shot of client 31:head:0.31088082901554404, middle:0.08163265306122448, tail0.0
3shot of client 32:head:0.18095238095238095, middle:0.08, tail0.5
3shot of client 33:head:0.43315508021390375, middle:0.11363636363636363, tail0.0
3shot of client 34:head:0.12269938650306748, middle:0.02702702702702703, tail0.0
3shot of client 35:head:0.3217391304347826, middle:0.36666666666666664, tail0.0
3shot of client 36:head:0.14942528735632185, middle:0.021739130434782608, tail0.0
3shot of client 37:head:0.2474747474747475, middle:0.08888888888888889, tail0.09090909090909091
3shot of client 38:head:0.4722222222222222, middle:0.10526315789473684, tail0.0
3shot of client 39:head:0.3787878787878788, middle:0.09259259259259259, tail0.0
round 16, local average test acc  0.2463 

round 16, local macro average F1 score  0.1098 

round 16, local weighted average F1 score  0.2096 

round 16, global test acc  0.0947 

round 16, average 3shot acc: [head: 0.2879, middle: 0.1214, tail: 0.0715] 

round 16, global 3shot acc: [head: 0.3408, middle: 0.0344, tail: 0.0018] 

l_head tensor([0.5876, 0.5771, 1.6905, 1.1536, 0.7088, 0.9657, 1.7144, 1.5475, 1.4391,
        0.5835, 0.8931, 0.5653, 0.5699, 0.9248, 1.1158, 1.2141, 0.8998, 0.5682,
        0.5815, 0.6488, 0.9532, 0.8214, 0.5794, 0.8104, 0.5811, 1.3226, 0.9231,
        1.5151, 0.7053, 0.5968, 1.0024, 1.0028, 0.8543, 1.1402, 0.6927, 0.5542,
        0.5941, 0.5851, 0.5793, 0.8374, 0.7556, 0.5806, 0.5843, 0.7721, 0.8034,
        0.5717, 0.6829, 0.5918, 0.7967, 0.6961, 0.5734, 0.7242, 0.5848, 0.8024,
        0.6763, 0.5723, 0.6209, 0.6599, 0.7589, 0.5648, 0.5771, 0.5934, 0.8846,
        0.5862, 0.5832, 0.5841, 0.5870, 0.8095, 0.5922, 0.7852, 0.5852, 0.7159,
        0.5648, 0.5675, 0.5811, 0.5862, 0.5949, 0.5909, 0.6778, 0.5746, 0.5786,
        0.5751, 0.5631, 0.5906, 0.5821, 0.5840, 0.5660, 0.7872, 0.5869, 0.5896,
        0.5835, 0.5847, 0.5882, 0.5681, 0.5847, 0.5840, 0.6763, 0.5772, 0.6814,
        0.7974], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.9223, 1.7760, 1.9483, 1.6110, 1.7585, 1.3923, 1.5510, 1.7506, 1.4913,
        1.6499, 1.5142, 1.6418, 1.5280, 1.5904, 1.5930, 1.3303, 1.2020, 1.4509,
        1.3615, 1.0396, 1.5557, 1.3215, 1.1678, 1.5638, 1.3963, 1.0530, 0.8425,
        0.9474, 1.0467, 1.1781, 1.3151, 0.9837, 0.9903, 0.9110, 0.9173, 0.8802,
        0.9772, 1.0434, 0.8144, 0.8664, 0.7934, 0.9511, 0.8302, 0.7503, 0.7966,
        0.7982, 0.7990, 0.9297, 0.7224, 1.1030, 0.7305, 0.7090, 0.9299, 0.9866,
        0.7500, 0.7003, 0.6989, 0.6732, 0.7666, 0.8395, 1.0137, 0.7506, 0.7598,
        0.6731, 0.6821, 0.6331, 0.6247, 0.7525, 0.7028, 0.6784, 0.7154, 0.7821,
        0.6163, 0.7041, 0.6422, 0.6140, 0.6997, 0.6166, 0.6268, 0.6505, 0.6044,
        0.5760, 0.6628, 0.6541, 0.6334, 0.6072, 0.6529, 0.6109, 0.5738, 0.6169,
        0.6144, 0.5728, 0.6096, 0.6113, 0.6146, 0.6784, 0.6104, 0.5768, 0.6146,
        0.6225], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([9.5147], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.294478527607362, middle:0.17142857142857143, tail0.0
3shot of client 1:head:0.5082872928176796, middle:0.19047619047619047, tail0.18181818181818182
3shot of client 2:head:0.17164179104477612, middle:0.05714285714285714, tail0.0
3shot of client 3:head:0.4219409282700422, middle:0.03225806451612903, tail0.0
3shot of client 4:head:0.2905027932960894, middle:0.21951219512195122, tail0.0
3shot of client 5:head:0.32075471698113206, middle:0.038461538461538464, tail0.0
3shot of client 6:head:0.22439024390243903, middle:0.25925925925925924, tail0.09090909090909091
3shot of client 7:head:0.3630573248407643, middle:0.025, tail0.2222222222222222
3shot of client 8:head:0.4148148148148148, middle:0.1388888888888889, tail0.125
3shot of client 9:head:0.3225806451612903, middle:0.08571428571428572, tail0.1
3shot of client 10:head:0.5420560747663551, middle:0.11538461538461539, tail0.0
3shot of client 11:head:0.104, middle:0.0, tail0.25
3shot of client 12:head:0.42021276595744683, middle:0.08, tail0.08333333333333333
3shot of client 13:head:0.37606837606837606, middle:0.21875, tail0.14285714285714285
3shot of client 14:head:0.19796954314720813, middle:0.11904761904761904, tail0.08333333333333333
3shot of client 15:head:0.2605042016806723, middle:0.1935483870967742, tail0.14285714285714285
3shot of client 16:head:0.44785276073619634, middle:0.13513513513513514, tail0.0
3shot of client 17:head:0.3885350318471338, middle:0.07317073170731707, tail0.0
3shot of client 18:head:0.31954887218045114, middle:0.1694915254237288, tail0.0
3shot of client 19:head:0.3699186991869919, middle:0.07017543859649122, tail0.14285714285714285
3shot of client 20:head:0.14754098360655737, middle:0.10638297872340426, tail0.08333333333333333
3shot of client 21:head:0.3021276595744681, middle:0.11864406779661017, tail0.0
3shot of client 22:head:0.3291139240506329, middle:0.1111111111111111, tail0.0
3shot of client 23:head:0.10869565217391304, middle:0.06382978723404255, tail0.0
3shot of client 24:head:0.17037037037037037, middle:0.02702702702702703, tail0.14285714285714285
3shot of client 25:head:0.453125, middle:0.25806451612903225, tail0.0
3shot of client 26:head:0.3247863247863248, middle:0.2857142857142857, tail0.14285714285714285
3shot of client 27:head:0.23703703703703705, middle:0.40625, tail0.0
3shot of client 28:head:0.23786407766990292, middle:0.02, tail0.0
3shot of client 29:head:0.47115384615384615, middle:0.10204081632653061, tail0.09090909090909091
3shot of client 30:head:0.27927927927927926, middle:0.4, tail0.0  4%|         | 18/500 [37:49<19:16:24, 143.95s/it]
3shot of client 31:head:0.3316062176165803, middle:0.14285714285714285, tail0.0
3shot of client 32:head:0.2, middle:0.08, tail0.3333333333333333
3shot of client 33:head:0.4385026737967914, middle:0.11363636363636363, tail0.0
3shot of client 34:head:0.44785276073619634, middle:0.0, tail0.0
3shot of client 35:head:0.3565217391304348, middle:0.3333333333333333, tail0.0
3shot of client 36:head:0.1724137931034483, middle:0.043478260869565216, tail0.0
3shot of client 37:head:0.3434343434343434, middle:0.13333333333333333, tail0.0
3shot of client 38:head:0.4583333333333333, middle:0.07894736842105263, tail0.0
3shot of client 39:head:0.25252525252525254, middle:0.1111111111111111, tail0.0
round 17, local average test acc  0.2734 

round 17, local macro average F1 score  0.1220 

round 17, local weighted average F1 score  0.2391 

round 17, global test acc  0.1022 

round 17, average 3shot acc: [head: 0.3205, middle: 0.1332, tail: 0.0590] 

round 17, global 3shot acc: [head: 0.3524, middle: 0.0420, tail: 0.0072] 

l_head tensor([0.5876, 0.5771, 1.6905, 1.1536, 0.7088, 0.9657, 1.7144, 1.5475, 1.4391,
        0.5835, 0.8931, 0.5653, 0.5699, 0.9248, 1.1158, 1.2141, 0.8998, 0.5682,
        0.5815, 0.6488, 0.9532, 0.8214, 0.5794, 0.8104, 0.5811, 1.3226, 0.9231,
        1.5151, 0.7053, 0.5968, 1.0024, 1.0028, 0.8543, 1.1402, 0.6927, 0.5542,
        0.5941, 0.5851, 0.5793, 0.8374, 0.7556, 0.5806, 0.5843, 0.7721, 0.8034,
        0.5717, 0.6829, 0.5918, 0.7967, 0.6961, 0.5734, 0.7242, 0.5848, 0.8024,
        0.6763, 0.5723, 0.6209, 0.6599, 0.7589, 0.5648, 0.5771, 0.5934, 0.8846,
        0.5862, 0.5832, 0.5841, 0.5870, 0.8095, 0.5922, 0.7852, 0.5852, 0.7159,
        0.5648, 0.5675, 0.5811, 0.5862, 0.5949, 0.5909, 0.6778, 0.5746, 0.5786,
        0.5751, 0.5631, 0.5906, 0.5821, 0.5840, 0.5660, 0.7872, 0.5869, 0.5896,
        0.5835, 0.5847, 0.5882, 0.5681, 0.5847, 0.5840, 0.6763, 0.5772, 0.6814,
        0.7974], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.9277, 1.8443, 1.9649, 1.6347, 1.7969, 1.4295, 1.5821, 1.7895, 1.5372,
        1.6456, 1.5329, 1.6949, 1.5540, 1.6803, 1.5933, 1.3768, 1.2027, 1.5141,
        1.3563, 1.0871, 1.5993, 1.3676, 1.1733, 1.5931, 1.4345, 1.0771, 0.8441,
        0.9763, 1.0697, 1.1940, 1.3295, 1.0027, 0.9786, 0.9354, 0.9161, 0.9053,
        0.9768, 1.0458, 0.8267, 0.9045, 0.8351, 0.9709, 0.8473, 0.7702, 0.8588,
        0.8192, 0.7993, 0.9529, 0.7434, 1.1148, 0.7390, 0.7156, 0.9682, 0.9907,
        0.7712, 0.7050, 0.7163, 0.6848, 0.8042, 0.8419, 1.0732, 0.7829, 0.7964,
        0.7006, 0.6893, 0.6549, 0.6329, 0.7632, 0.7060, 0.6925, 0.7394, 0.7817,
        0.6205, 0.7190, 0.6554, 0.6138, 0.7141, 0.6200, 0.6317, 0.6609, 0.6092,
        0.5795, 0.6721, 0.6573, 0.6387, 0.6210, 0.6539, 0.6111, 0.5802, 0.6159,
        0.6235, 0.5739, 0.6274, 0.6113, 0.6252, 0.6870, 0.6105, 0.5766, 0.6233,
        0.6216], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([9.7458], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.38650306748466257, middle:0.11428571428571428, tail0.0
3shot of client 1:head:0.5193370165745856, middle:0.19047619047619047, tail0.18181818181818182
3shot of client 2:head:0.16417910447761194, middle:0.05714285714285714, tail0.0
3shot of client 3:head:0.26582278481012656, middle:0.03225806451612903, tail0.0
3shot of client 4:head:0.26256983240223464, middle:0.2926829268292683, tail0.0
3shot of client 5:head:0.33962264150943394, middle:0.038461538461538464, tail0.0
3shot of client 6:head:0.2780487804878049, middle:0.18518518518518517, tail0.0
3shot of client 7:head:0.35668789808917195, middle:0.125, tail0.1111111111111111
3shot of client 8:head:0.35555555555555557, middle:0.08333333333333333, tail0.0
3shot of client 9:head:0.22580645161290322, middle:0.11428571428571428, tail0.1
3shot of client 10:head:0.45794392523364486, middle:0.19230769230769232, tail0.0
3shot of client 11:head:0.528, middle:0.125, tail0.375
3shot of client 12:head:0.40425531914893614, middle:0.14, tail0.25
3shot of client 13:head:0.41025641025641024, middle:0.1875, tail0.14285714285714285
3shot of client 14:head:0.4010152284263959, middle:0.14285714285714285, tail0.0
3shot of client 15:head:0.23529411764705882, middle:0.12903225806451613, tail0.14285714285714285
3shot of client 16:head:0.4662576687116564, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.40764331210191085, middle:0.07317073170731707, tail0.0
3shot of client 18:head:0.2744360902255639, middle:0.1694915254237288, tail0.058823529411764705
3shot of client 19:head:0.3617886178861789, middle:0.07017543859649122, tail0.14285714285714285
3shot of client 20:head:0.13114754098360656, middle:0.1276595744680851, tail0.08333333333333333
3shot of client 21:head:0.33191489361702126, middle:0.2033898305084746, tail0.07692307692307693
3shot of client 22:head:0.2974683544303797, middle:0.08333333333333333, tail0.0
3shot of client 23:head:0.21739130434782608, middle:0.1276595744680851, tail0.0
3shot of client 24:head:0.14814814814814814, middle:0.02702702702702703, tail0.14285714285714285
3shot of client 25:head:0.4765625, middle:0.16129032258064516, tail0.0
3shot of client 26:head:0.3162393162393162, middle:0.25, tail0.0
3shot of client 27:head:0.22962962962962963, middle:0.40625, tail0.0
3shot of client 28:head:0.22815533980582525, middle:0.02, tail0.0
3shot of client 29:head:0.49038461538461536, middle:0.12244897959183673, tail0.09090909090909091
3shot of client 30:head:0.27927927927927926, middle:0.23333333333333334, tail0.0
3shot of client 31:head:0.37305699481865284, middle:0.14285714285714285, tail0.0
3shot of client 32:head:0.21904761904761905, middle:0.08, tail0.3333333333333333
3shot of client 33:head:0.4385026737967914, middle:0.13636363636363635, tail0.0
3shot of client 34:head:0.31901840490797545, middle:0.08108108108108109, tail0.2
3shot of client 35:head:0.4, middle:0.3, tail0.0
3shot of client 36:head:0.1781609195402299, middle:0.043478260869565216, tail0.0
3shot of client 37:head:0.3484848484848485, middle:0.08888888888888889, tail0.0
3shot of client 38:head:0.4861111111111111, middle:0.18421052631578946, tail0.0
3shot of client 39:head:0.2777777777777778, middle:0.12962962962962962, tail0.0
round 18, local average test acc  0.2833 

round 18, local macro average F1 score  0.1254 

round 18, local weighted average F1 score  0.2566 

round 18, global test acc  0.1082 

round 18, average 3shot acc: [head: 0.3322, middle: 0.1380, tail: 0.0608] 

round 18, global 3shot acc: [head: 0.3528, middle: 0.0628, tail: 0.0086] 

l_head tensor([0.5877, 0.5772, 1.9221, 1.3668, 0.7807, 1.4059, 1.8216, 1.8986, 1.6271,
        0.5837, 1.0072, 0.5654, 0.5701, 1.1739, 1.4041, 1.4153, 1.0634, 0.5683,
        0.5816, 0.6844, 1.1479, 1.0206, 0.5795, 1.0940, 0.5812, 1.6225, 1.0929,
        1.7974, 0.7990, 0.5969, 1.1730, 1.2134, 0.9476, 1.3580, 0.7406, 0.5543,
        0.5942, 0.5852, 0.5794, 0.9491, 0.8708, 0.5807, 0.5844, 0.8787, 0.9889,
        0.5718, 0.7434, 0.5919, 0.9423, 0.8643, 0.5735, 0.8058, 0.5849, 0.9407,
        0.7161, 0.5724, 0.7181, 0.7521, 0.8676, 0.5650, 0.5772, 0.5935, 0.9660,
        0.5863, 0.5833, 0.5842, 0.5872, 1.0460, 0.5923, 0.9396, 0.5853, 0.8805,
        0.5649, 0.5676, 0.5812, 0.5864, 0.5950, 0.5911, 0.7792, 0.5747, 0.5787,
        0.5752, 0.5632, 0.5907, 0.5822, 0.5841, 0.5661, 0.8970, 0.5871, 0.5897,
        0.5837, 0.5848, 0.5883, 0.5682, 0.5848, 0.5841, 0.7126, 0.5773, 0.7400,
        0.9297], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.9754, 1.8512, 1.9777, 1.6822, 1.7358, 1.4728, 1.6245, 1.8923, 1.5821,
        1.6746, 1.5379, 1.6642, 1.5923, 1.7382, 1.6046, 1.4072, 1.2169, 1.5302,
        1.3803, 1.0533, 1.6022, 1.3952, 1.1732, 1.6480, 1.4736, 1.0821, 0.8424,
        0.9830, 1.1142, 1.2325, 1.3443, 1.0385, 0.9673, 0.9729, 0.9367, 0.9284,
        0.9930, 1.0627, 0.8389, 0.9021, 0.8697, 0.9970, 0.8575, 0.7936, 0.8741,
        0.8417, 0.8154, 0.9868, 0.7603, 1.1533, 0.7556, 0.7214, 1.0199, 1.0198,
        0.7813, 0.7186, 0.7265, 0.7057, 0.8032, 0.8700, 1.1018, 0.7970, 0.8204,
        0.7064, 0.6930, 0.6703, 0.6411, 0.7794, 0.7250, 0.7117, 0.7549, 0.7923,
        0.6324, 0.7394, 0.6558, 0.6191, 0.7288, 0.6220, 0.6457, 0.6572, 0.6134,
        0.5903, 0.6946, 0.6679, 0.6451, 0.6237, 0.6570, 0.6077, 0.5853, 0.6184,
        0.6248, 0.5779, 0.6350, 0.6113, 0.6250, 0.7030, 0.6115, 0.5776, 0.6261,
        0.6284], device='cuda:4', grad_fn=<NormBackward1>)  4%|         | 19/500 [40:11<19:11:02, 143.58s/it]  4%|         | 20/500 [42:41<19:24:25, 145.55s/it]
The value of constant scaler:  tensor([10.0251], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.39263803680981596, middle:0.17142857142857143, tail0.0
3shot of client 1:head:0.5524861878453039, middle:0.19047619047619047, tail0.18181818181818182
3shot of client 2:head:0.20149253731343283, middle:0.08571428571428572, tail0.0
3shot of client 3:head:0.29957805907172996, middle:0.12903225806451613, tail0.0
3shot of client 4:head:0.3016759776536313, middle:0.2682926829268293, tail0.0
3shot of client 5:head:0.3867924528301887, middle:0.11538461538461539, tail0.3333333333333333
3shot of client 6:head:0.2682926829268293, middle:0.2962962962962963, tail0.09090909090909091
3shot of client 7:head:0.36942675159235666, middle:0.125, tail0.2222222222222222
3shot of client 8:head:0.4148148148148148, middle:0.1388888888888889, tail0.125
3shot of client 9:head:0.2838709677419355, middle:0.02857142857142857, tail0.1
3shot of client 10:head:0.45794392523364486, middle:0.11538461538461539, tail0.0
3shot of client 11:head:0.536, middle:0.0625, tail0.375
3shot of client 12:head:0.4787234042553192, middle:0.06, tail0.08333333333333333
3shot of client 13:head:0.358974358974359, middle:0.25, tail0.2857142857142857
3shot of client 14:head:0.47715736040609136, middle:0.16666666666666666, tail0.0
3shot of client 15:head:0.21008403361344538, middle:0.0967741935483871, tail0.14285714285714285
3shot of client 16:head:0.5950920245398773, middle:0.08108108108108109, tail0.0
3shot of client 17:head:0.445859872611465, middle:0.07317073170731707, tail0.0
3shot of client 18:head:0.462406015037594, middle:0.0847457627118644, tail0.058823529411764705
3shot of client 19:head:0.4268292682926829, middle:0.14035087719298245, tail0.07142857142857142
3shot of client 20:head:0.18579234972677597, middle:0.1276595744680851, tail0.08333333333333333
3shot of client 21:head:0.3404255319148936, middle:0.2033898305084746, tail0.07692307692307693
3shot of client 22:head:0.4430379746835443, middle:0.027777777777777776, tail0.1
3shot of client 23:head:0.22282608695652173, middle:0.1702127659574468, tail0.0
3shot of client 24:head:0.14814814814814814, middle:0.0, tail0.14285714285714285
3shot of client 25:head:0.5, middle:0.16129032258064516, tail0.0
3shot of client 26:head:0.4188034188034188, middle:0.32142857142857145, tail0.0
3shot of client 27:head:0.22962962962962963, middle:0.46875, tail0.0
3shot of client 28:head:0.441747572815534, middle:0.12, tail0.0
3shot of client 29:head:0.5192307692307693, middle:0.12244897959183673, tail0.09090909090909091
3shot of client 30:head:0.2882882882882883, middle:0.26666666666666666, tail0.0
3shot of client 31:head:0.26424870466321243, middle:0.24489795918367346, tail0.0
3shot of client 32:head:0.21904761904761905, middle:0.08, tail0.3333333333333333
3shot of client 33:head:0.43315508021390375, middle:0.11363636363636363, tail0.0
3shot of client 34:head:0.4785276073619632, middle:0.10810810810810811, tail0.2
3shot of client 35:head:0.33043478260869563, middle:0.26666666666666666, tail0.14285714285714285
3shot of client 36:head:0.14942528735632185, middle:0.043478260869565216, tail0.0
3shot of client 37:head:0.3686868686868687, middle:0.17777777777777778, tail0.0
3shot of client 38:head:0.4652777777777778, middle:0.18421052631578946, tail0.0
3shot of client 39:head:0.3181818181818182, middle:0.1111111111111111, tail0.08333333333333333
round 19, local average test acc  0.3136 

round 19, local macro average F1 score  0.1315 

round 19, local weighted average F1 score  0.2658 

round 19, global test acc  0.1200 

round 19, average 3shot acc: [head: 0.3671, middle: 0.1500, tail: 0.0831] 

round 19, global 3shot acc: [head: 0.3916, middle: 0.0596, tail: 0.0144] 

l_head tensor([0.5877, 0.5772, 1.9221, 1.3668, 0.7807, 1.4059, 1.8216, 1.8986, 1.6271,
        0.5837, 1.0072, 0.5654, 0.5701, 1.1739, 1.4041, 1.4153, 1.0634, 0.5683,
        0.5816, 0.6844, 1.1479, 1.0206, 0.5795, 1.0940, 0.5812, 1.6225, 1.0929,
        1.7974, 0.7990, 0.5969, 1.1730, 1.2134, 0.9476, 1.3580, 0.7406, 0.5543,
        0.5942, 0.5852, 0.5794, 0.9491, 0.8708, 0.5807, 0.5844, 0.8787, 0.9889,
        0.5718, 0.7434, 0.5919, 0.9423, 0.8643, 0.5735, 0.8058, 0.5849, 0.9407,
        0.7161, 0.5724, 0.7181, 0.7521, 0.8676, 0.5650, 0.5772, 0.5935, 0.9660,
        0.5863, 0.5833, 0.5842, 0.5872, 1.0460, 0.5923, 0.9396, 0.5853, 0.8805,
        0.5649, 0.5676, 0.5812, 0.5864, 0.5950, 0.5911, 0.7792, 0.5747, 0.5787,
        0.5752, 0.5632, 0.5907, 0.5822, 0.5841, 0.5661, 0.8970, 0.5871, 0.5897,
        0.5837, 0.5848, 0.5883, 0.5682, 0.5848, 0.5841, 0.7126, 0.5773, 0.7400,
        0.9297], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.1050, 1.8950, 2.0361, 1.6603, 1.7607, 1.5381, 1.6241, 1.9097, 1.6111,
        1.6558, 1.5681, 1.6808, 1.6366, 1.8145, 1.6580, 1.4385, 1.2747, 1.5550,
        1.3952, 1.0866, 1.6413, 1.4641, 1.1900, 1.6697, 1.5056, 1.1108, 0.8587,
        0.9843, 1.1252, 1.2890, 1.4022, 1.0555, 1.0096, 1.0165, 0.9394, 1.0128,
        0.9877, 1.1012, 0.8510, 0.9285, 0.8970, 1.0632, 0.8696, 0.8250, 0.8841,
        0.8478, 0.8290, 1.0196, 0.8218, 1.1782, 0.7592, 0.7253, 1.0393, 1.0260,
        0.8055, 0.7213, 0.7430, 0.7136, 0.8642, 0.8671, 1.1498, 0.8305, 0.8143,
        0.7401, 0.7024, 0.6800, 0.6526, 0.7931, 0.7327, 0.7160, 0.7629, 0.8027,
        0.6337, 0.7496, 0.6655, 0.6208, 0.7530, 0.6258, 0.6485, 0.6631, 0.6174,
        0.5924, 0.7148, 0.6760, 0.6488, 0.6297, 0.6563, 0.6078, 0.5907, 0.6231,
        0.6486, 0.5799, 0.6387, 0.6191, 0.6355, 0.7346, 0.6204, 0.5776, 0.6273,
        0.6376], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([10.2274], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.43558282208588955, middle:0.11428571428571428, tail0.0
3shot of client 1:head:0.5580110497237569, middle:0.19047619047619047, tail0.18181818181818182
3shot of client 2:head:0.1417910447761194, middle:0.08571428571428572, tail0.0
3shot of client 3:head:0.2869198312236287, middle:0.06451612903225806, tail0.0
3shot of client 4:head:0.4134078212290503, middle:0.2682926829268293, tail0.1
3shot of client 5:head:0.41509433962264153, middle:0.11538461538461539, tail0.3333333333333333
3shot of client 6:head:0.2975609756097561, middle:0.14814814814814814, tail0.09090909090909091
3shot of client 7:head:0.3248407643312102, middle:0.15, tail0.1111111111111111
3shot of client 8:head:0.2962962962962963, middle:0.2777777777777778, tail0.25
3shot of client 9:head:0.2903225806451613, middle:0.05714285714285714, tail0.1
3shot of client 10:head:0.45794392523364486, middle:0.07692307692307693, tail0.0
3shot of client 11:head:0.552, middle:0.15625, tail0.375
3shot of client 12:head:0.44148936170212766, middle:0.06, tail0.16666666666666666
3shot of client 13:head:0.42735042735042733, middle:0.21875, tail0.14285714285714285
3shot of client 14:head:0.29441624365482233, middle:0.09523809523809523, tail0.0
3shot of client 15:head:0.24369747899159663, middle:0.12903225806451613, tail0.14285714285714285
3shot of client 16:head:0.5950920245398773, middle:0.21621621621621623, tail0.1
3shot of client 17:head:0.43312101910828027, middle:0.1951219512195122, tail0.4
3shot of client 18:head:0.47368421052631576, middle:0.1016949152542373, tail0.058823529411764705
3shot of client 19:head:0.4268292682926829, middle:0.19298245614035087, tail0.14285714285714285
3shot of client 20:head:0.16393442622950818, middle:0.10638297872340426, tail0.08333333333333333
3shot of client 21:head:0.37446808510638296, middle:0.22033898305084745, tail0.0
3shot of client 22:head:0.4430379746835443, middle:0.1388888888888889, tail0.0
3shot of client 23:head:0.23369565217391305, middle:0.1276595744680851, tail0.0
3shot of client 24:head:0.14814814814814814, middle:0.05405405405405406, tail0.14285714285714285
3shot of client 25:head:0.4765625, middle:0.12903225806451613, tail0.0
3shot of client 26:head:0.47863247863247865, middle:0.35714285714285715, tail0.2857142857142857
3shot of client 27:head:0.31851851851851853, middle:0.34375, tail0.14285714285714285
3shot of client 28:head:0.4563106796116505, middle:0.1, tail0.0
3shot of client 29:head:0.4951923076923077, middle:0.10204081632653061, tail0.09090909090909091  4%|         | 21/500 [45:08<19:23:38, 145.76s/it]
3shot of client 30:head:0.21621621621621623, middle:0.5333333333333333, tail0.16666666666666666
3shot of client 31:head:0.34196891191709844, middle:0.2857142857142857, tail0.0
3shot of client 32:head:0.24761904761904763, middle:0.08, tail0.3333333333333333
3shot of client 33:head:0.42780748663101603, middle:0.09090909090909091, tail0.0
3shot of client 34:head:0.49693251533742333, middle:0.13513513513513514, tail0.4
3shot of client 35:head:0.3391304347826087, middle:0.3, tail0.0
3shot of client 36:head:0.25287356321839083, middle:0.043478260869565216, tail0.0
3shot of client 37:head:0.35858585858585856, middle:0.08888888888888889, tail0.0
3shot of client 38:head:0.4027777777777778, middle:0.10526315789473684, tail0.2222222222222222
3shot of client 39:head:0.398989898989899, middle:0.12962962962962962, tail0.08333333333333333
round 20, local average test acc  0.3207 

round 20, local macro average F1 score  0.1424 

round 20, local weighted average F1 score  0.2707 

round 20, global test acc  0.1208 

round 20, average 3shot acc: [head: 0.3719, middle: 0.1596, tail: 0.1162] 

round 20, global 3shot acc: [head: 0.3880, middle: 0.0844, tail: 0.0054] 

l_head tensor([0.5877, 0.5772, 1.9221, 1.3668, 0.7807, 1.4059, 1.8216, 1.8986, 1.6271,
        0.5837, 1.0072, 0.5654, 0.5701, 1.1739, 1.4041, 1.4153, 1.0634, 0.5683,
        0.5816, 0.6844, 1.1479, 1.0206, 0.5795, 1.0940, 0.5812, 1.6225, 1.0929,
        1.7974, 0.7990, 0.5969, 1.1730, 1.2134, 0.9476, 1.3580, 0.7406, 0.5543,
        0.5942, 0.5852, 0.5794, 0.9491, 0.8708, 0.5807, 0.5844, 0.8787, 0.9889,
        0.5718, 0.7434, 0.5919, 0.9423, 0.8643, 0.5735, 0.8058, 0.5849, 0.9407,
        0.7161, 0.5724, 0.7181, 0.7521, 0.8676, 0.5650, 0.5772, 0.5935, 0.9660,
        0.5863, 0.5833, 0.5842, 0.5872, 1.0460, 0.5923, 0.9396, 0.5853, 0.8805,
        0.5649, 0.5676, 0.5812, 0.5864, 0.5950, 0.5911, 0.7792, 0.5747, 0.5787,
        0.5752, 0.5632, 0.5907, 0.5822, 0.5841, 0.5661, 0.8970, 0.5871, 0.5897,
        0.5837, 0.5848, 0.5883, 0.5682, 0.5848, 0.5841, 0.7126, 0.5773, 0.7400,
        0.9297], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.1066, 1.9064, 2.0652, 1.6910, 1.7896, 1.5629, 1.6369, 1.9198, 1.6460,
        1.7278, 1.5938, 1.6669, 1.6632, 1.8349, 1.6885, 1.4575, 1.2589, 1.5973,
        1.4377, 1.1060, 1.6462, 1.4517, 1.1950, 1.7244, 1.5562, 1.1679, 0.8936,
        1.0028, 1.1902, 1.3027, 1.4345, 1.0824, 1.0151, 1.0389, 0.9691, 1.0668,
        1.0044, 1.1321, 0.8561, 0.9414, 0.9138, 1.0942, 0.8857, 0.8477, 0.9203,
        0.8655, 0.8514, 1.0638, 0.8278, 1.1775, 0.7686, 0.7354, 1.0621, 1.1013,
        0.8249, 0.7300, 0.7731, 0.7193, 0.8954, 0.8881, 1.1532, 0.8312, 0.8388,
        0.7370, 0.6970, 0.6943, 0.6724, 0.8113, 0.7574, 0.7129, 0.7778, 0.8307,
        0.6409, 0.7615, 0.6712, 0.6294, 0.7760, 0.6348, 0.6612, 0.6666, 0.6241,
        0.6043, 0.7334, 0.6983, 0.6771, 0.6393, 0.6689, 0.6118, 0.5916, 0.6262,
        0.6456, 0.5813, 0.6493, 0.6185, 0.6394, 0.7451, 0.6202, 0.5845, 0.6328,
        0.6381], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([10.5198], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.44785276073619634, middle:0.11428571428571428, tail0.0
3shot of client 1:head:0.5248618784530387, middle:0.19047619047619047, tail0.18181818181818182
3shot of client 2:head:0.208955223880597, middle:0.02857142857142857, tail0.0
3shot of client 3:head:0.29957805907172996, middle:0.14516129032258066, tail0.06666666666666667
3shot of client 4:head:0.4134078212290503, middle:0.2926829268292683, tail0.1
3shot of client 5:head:0.3018867924528302, middle:0.07692307692307693, tail0.0
3shot of client 6:head:0.45365853658536587, middle:0.07407407407407407, tail0.18181818181818182
3shot of client 7:head:0.4140127388535032, middle:0.125, tail0.0
3shot of client 8:head:0.26666666666666666, middle:0.2777777777777778, tail0.25
3shot of client 9:head:0.27741935483870966, middle:0.0, tail0.2
3shot of client 10:head:0.514018691588785, middle:0.11538461538461539, tail0.0
3shot of client 11:head:0.568, middle:0.15625, tail0.5
3shot of client 12:head:0.4734042553191489, middle:0.04, tail0.16666666666666666
3shot of client 13:head:0.37606837606837606, middle:0.25, tail0.2857142857142857
3shot of client 14:head:0.4365482233502538, middle:0.09523809523809523, tail0.0
3shot of client 15:head:0.24369747899159663, middle:0.22580645161290322, tail0.14285714285714285
3shot of client 16:head:0.5521472392638037, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.40764331210191085, middle:0.21951219512195122, tail0.2
3shot of client 18:head:0.36466165413533835, middle:0.1694915254237288, tail0.17647058823529413
3shot of client 19:head:0.45934959349593496, middle:0.10526315789473684, tail0.07142857142857142
3shot of client 20:head:0.16939890710382513, middle:0.1276595744680851, tail0.08333333333333333
3shot of client 21:head:0.37446808510638296, middle:0.2033898305084746, tail0.0
3shot of client 22:head:0.3987341772151899, middle:0.25, tail0.0
3shot of client 23:head:0.1793478260869565, middle:0.14893617021276595, tail0.0
3shot of client 24:head:0.16296296296296298, middle:0.05405405405405406, tail0.14285714285714285
3shot of client 25:head:0.4609375, middle:0.25806451612903225, tail0.0
3shot of client 26:head:0.2905982905982906, middle:0.5357142857142857, tail0.0
3shot of client 27:head:0.35555555555555557, middle:0.3125, tail0.14285714285714285
3shot of client 28:head:0.46116504854368934, middle:0.12, tail0.0
3shot of client 29:head:0.4951923076923077, middle:0.12244897959183673, tail0.09090909090909091
3shot of client 30:head:0.2072072072072072, middle:0.5, tail0.0
3shot of client 31:head:0.2849740932642487, middle:0.22448979591836735, tail0.0
3shot of client 32:head:0.22857142857142856, middle:0.12, tail0.16666666666666666
3shot of client 33:head:0.45454545454545453, middle:0.06818181818181818, tail0.0
3shot of client 34:head:0.49693251533742333, middle:0.10810810810810811, tail0.2
3shot of client 35:head:0.34782608695652173, middle:0.23333333333333334, tail0.14285714285714285
3shot of client 36:head:0.28735632183908044, middle:0.06521739130434782, tail0.0
3shot of client 37:head:0.3787878787878788, middle:0.15555555555555556, tail0.0
3shot of client 38:head:0.4861111111111111, middle:0.10526315789473684, tail0.0
3shot of client 39:head:0.35858585858585856, middle:0.12962962962962962, tail0.08333333333333333
round 21, local average test acc  0.3209 

round 21, local macro average F1 score  0.1591 

round 21, local weighted average F1 score  0.2984 

round 21, global test acc  0.1298 

round 21, average 3shot acc: [head: 0.3721, middle: 0.1663, tail: 0.0894] 

round 21, global 3shot acc: [head: 0.3868, middle: 0.0860, tail: 0.0232] 

l_head tensor([0.5877, 0.5772, 1.9221, 1.3668, 0.7807, 1.4059, 1.8216, 1.8986, 1.6271,
        0.5837, 1.0072, 0.5654, 0.5701, 1.1739, 1.4041, 1.4153, 1.0634, 0.5683,
        0.5816, 0.6844, 1.1479, 1.0206, 0.5795, 1.0940, 0.5812, 1.6225, 1.0929,
        1.7974, 0.7990, 0.5969, 1.1730, 1.2134, 0.9476, 1.3580, 0.7406, 0.5543,
        0.5942, 0.5852, 0.5794, 0.9491, 0.8708, 0.5807, 0.5844, 0.8787, 0.9889,
        0.5718, 0.7434, 0.5919, 0.9423, 0.8643, 0.5735, 0.8058, 0.5849, 0.9407,
        0.7161, 0.5724, 0.7181, 0.7521, 0.8676, 0.5650, 0.5772, 0.5935, 0.9660,
        0.5863, 0.5833, 0.5842, 0.5872, 1.0460, 0.5923, 0.9396, 0.5853, 0.8805,
        0.5649, 0.5676, 0.5812, 0.5864, 0.5950, 0.5911, 0.7792, 0.5747, 0.5787,
        0.5752, 0.5632, 0.5907, 0.5822, 0.5841, 0.5661, 0.8970, 0.5871, 0.5897,
        0.5837, 0.5848, 0.5883, 0.5682, 0.5848, 0.5841, 0.7126, 0.5773, 0.7400,
        0.9297], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.1921, 1.9997, 2.0977, 1.7789, 1.7802, 1.5948, 1.7015, 1.9633, 1.7019,
        1.7150, 1.6646, 1.6855, 1.7093, 1.8774, 1.7014, 1.5388, 1.2583, 1.6070,
        1.4636, 1.0960, 1.6800, 1.5446, 1.2149, 1.7207, 1.6176, 1.1926, 0.9370,
        0.9947, 1.1876, 1.3232, 1.4925, 1.1038, 1.0745, 1.0649, 1.0095, 1.1298,
        1.0038, 1.1645, 0.8921, 0.9533, 0.9155, 1.1602, 0.9077, 0.8397, 0.9306,
        0.8920, 0.8443, 1.0879, 0.8402, 1.2320, 0.7929, 0.7490, 1.1317, 1.0798,
        0.8501, 0.7474, 0.7701, 0.7258, 0.9198, 0.9086, 1.2062, 0.8469, 0.8639,
        0.7579, 0.7135, 0.7057, 0.6825, 0.8335, 0.7752, 0.7250, 0.7660, 0.8493,
        0.6504, 0.7595, 0.6808, 0.6400, 0.7894, 0.6397, 0.6685, 0.6696, 0.6287,
        0.6134, 0.7695, 0.7086, 0.6860, 0.6440, 0.6748, 0.6118, 0.5967, 0.6328,
        0.6621, 0.5855, 0.6630, 0.6186, 0.6420, 0.7622, 0.6266, 0.5842, 0.6490,
        0.6484], device='cuda:4', grad_fn=<NormBackward1>)  4%|         | 22/500 [47:37<19:28:37, 146.69s/it]  5%|         | 23/500 [49:59<19:15:54, 145.40s/it]
The value of constant scaler:  tensor([10.7350], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.49693251533742333, middle:0.2, tail0.0
3shot of client 1:head:0.5414364640883977, middle:0.19047619047619047, tail0.18181818181818182
3shot of client 2:head:0.208955223880597, middle:0.08571428571428572, tail0.0
3shot of client 3:head:0.28270042194092826, middle:0.12903225806451613, tail0.06666666666666667
3shot of client 4:head:0.3743016759776536, middle:0.2926829268292683, tail0.1
3shot of client 5:head:0.1509433962264151, middle:0.15384615384615385, tail0.0
3shot of client 6:head:0.4, middle:0.18518518518518517, tail0.09090909090909091
3shot of client 7:head:0.3630573248407643, middle:0.15, tail0.1111111111111111
3shot of client 8:head:0.32592592592592595, middle:0.25, tail0.375
3shot of client 9:head:0.3032258064516129, middle:0.02857142857142857, tail0.1
3shot of client 10:head:0.4953271028037383, middle:0.038461538461538464, tail0.0
3shot of client 11:head:0.544, middle:0.09375, tail0.375
3shot of client 12:head:0.4734042553191489, middle:0.04, tail0.16666666666666666
3shot of client 13:head:0.36752136752136755, middle:0.25, tail0.2857142857142857
3shot of client 14:head:0.4619289340101523, middle:0.11904761904761904, tail0.0
3shot of client 15:head:0.35294117647058826, middle:0.0967741935483871, tail0.0
3shot of client 16:head:0.49079754601226994, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.4713375796178344, middle:0.1951219512195122, tail0.1
3shot of client 18:head:0.36466165413533835, middle:0.22033898305084745, tail0.11764705882352941
3shot of client 19:head:0.4349593495934959, middle:0.08771929824561403, tail0.0
3shot of client 20:head:0.16939890710382513, middle:0.14893617021276595, tail0.08333333333333333
3shot of client 21:head:0.3574468085106383, middle:0.1694915254237288, tail0.0
3shot of client 22:head:0.4240506329113924, middle:0.3333333333333333, tail0.2
3shot of client 23:head:0.22826086956521738, middle:0.0851063829787234, tail0.0
3shot of client 24:head:0.14814814814814814, middle:0.02702702702702703, tail0.14285714285714285
3shot of client 25:head:0.4921875, middle:0.25806451612903225, tail0.0
3shot of client 26:head:0.3076923076923077, middle:0.5, tail0.14285714285714285
3shot of client 27:head:0.32592592592592595, middle:0.53125, tail0.14285714285714285
3shot of client 28:head:0.4563106796116505, middle:0.12, tail0.0
3shot of client 29:head:0.5048076923076923, middle:0.14285714285714285, tail0.18181818181818182
3shot of client 30:head:0.24324324324324326, middle:0.5333333333333333, tail0.0
3shot of client 31:head:0.32124352331606215, middle:0.16326530612244897, tail0.0
3shot of client 32:head:0.22857142857142856, middle:0.12, tail0.16666666666666666
3shot of client 33:head:0.3582887700534759, middle:0.2727272727272727, tail0.0
3shot of client 34:head:0.49693251533742333, middle:0.13513513513513514, tail0.1
3shot of client 35:head:0.41739130434782606, middle:0.3, tail0.0
3shot of client 36:head:0.26436781609195403, middle:0.043478260869565216, tail0.0
3shot of client 37:head:0.35858585858585856, middle:0.13333333333333333, tail0.0
3shot of client 38:head:0.4861111111111111, middle:0.13157894736842105, tail0.0
3shot of client 39:head:0.40404040404040403, middle:0.12962962962962962, tail0.0
round 22, local average test acc  0.3230 

round 22, local macro average F1 score  0.1616 

round 22, local weighted average F1 score  0.2840 

round 22, global test acc  0.1287 

round 22, average 3shot acc: [head: 0.3724, middle: 0.1798, tail: 0.0808] 

round 22, global 3shot acc: [head: 0.3856, middle: 0.0948, tail: 0.0172] 

l_head tensor([0.5877, 0.5772, 2.3002, 1.5721, 0.8468, 1.5456, 2.0953, 2.2142, 2.0062,
        0.5837, 1.2738, 0.5654, 0.5701, 1.3762, 1.6293, 1.6231, 1.1944, 0.5683,
        0.5816, 0.7453, 1.1129, 1.2209, 0.5795, 1.2050, 0.5813, 1.7970, 1.2010,
        2.1850, 0.8845, 0.5970, 1.3907, 1.4893, 1.0282, 1.5814, 0.8240, 0.5544,
        0.5943, 0.5853, 0.5795, 1.0936, 1.0903, 0.5808, 0.5845, 1.0173, 1.1553,
        0.5718, 0.8904, 0.5920, 1.0387, 0.9894, 0.5735, 0.9118, 0.5850, 1.0636,
        0.7845, 0.5725, 0.8614, 0.8300, 0.9539, 0.5650, 0.5773, 0.5936, 1.0864,
        0.5864, 0.5833, 0.5842, 0.5872, 1.2427, 0.5924, 1.0679, 0.5854, 1.0432,
        0.5650, 0.5677, 0.5812, 0.5864, 0.5951, 0.5911, 0.9680, 0.5747, 0.5788,
        0.5753, 0.5632, 0.5908, 0.5823, 0.5841, 0.5662, 1.0002, 0.5871, 0.5897,
        0.5837, 0.5848, 0.5884, 0.5683, 0.5848, 0.5841, 0.7824, 0.5773, 0.8419,
        1.1128], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.2106, 2.0218, 2.1263, 1.8097, 1.7893, 1.6539, 1.7633, 2.0186, 1.7782,
        1.7842, 1.7034, 1.6802, 1.7741, 1.9285, 1.6917, 1.5386, 1.2559, 1.6318,
        1.4716, 1.1142, 1.7028, 1.5542, 1.2480, 1.8092, 1.6213, 1.2147, 0.9846,
        1.0297, 1.1955, 1.3940, 1.5549, 1.1213, 1.0751, 1.1235, 1.0174, 1.1406,
        1.0383, 1.1450, 0.9083, 1.0066, 0.9440, 1.1803, 0.9101, 0.8912, 0.9348,
        0.9127, 0.8598, 1.1620, 0.8865, 1.2391, 0.8037, 0.7610, 1.1354, 1.1255,
        0.8498, 0.7469, 0.8214, 0.7330, 0.9421, 0.9273, 1.2541, 0.8791, 0.8812,
        0.7542, 0.7102, 0.7075, 0.6955, 0.8336, 0.7926, 0.7259, 0.8053, 0.8659,
        0.6595, 0.7720, 0.6885, 0.6430, 0.7830, 0.6557, 0.7091, 0.6751, 0.6339,
        0.6129, 0.7720, 0.7435, 0.7122, 0.6618, 0.6763, 0.6143, 0.5947, 0.6342,
        0.6672, 0.5894, 0.6799, 0.6200, 0.6414, 0.7618, 0.6285, 0.5881, 0.6583,
        0.6497], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([10.9717], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.38650306748466257, middle:0.37142857142857144, tail0.0
3shot of client 1:head:0.6077348066298343, middle:0.3333333333333333, tail0.0
3shot of client 2:head:0.20149253731343283, middle:0.02857142857142857, tail0.0
3shot of client 3:head:0.24050632911392406, middle:0.2903225806451613, tail0.13333333333333333
3shot of client 4:head:0.2905027932960894, middle:0.36585365853658536, tail0.3
3shot of client 5:head:0.1509433962264151, middle:0.15384615384615385, tail0.0
3shot of client 6:head:0.40487804878048783, middle:0.12962962962962962, tail0.09090909090909091
3shot of client 7:head:0.33121019108280253, middle:0.2, tail0.1111111111111111
3shot of client 8:head:0.3037037037037037, middle:0.3333333333333333, tail0.375
3shot of client 9:head:0.3419354838709677, middle:0.05714285714285714, tail0.1
3shot of client 10:head:0.4766355140186916, middle:0.07692307692307693, tail0.0
3shot of client 11:head:0.384, middle:0.34375, tail0.375
3shot of client 12:head:0.5106382978723404, middle:0.06, tail0.25
3shot of client 13:head:0.41025641025641024, middle:0.3125, tail0.14285714285714285
3shot of client 14:head:0.41624365482233505, middle:0.11904761904761904, tail0.08333333333333333
3shot of client 15:head:0.33613445378151263, middle:0.16129032258064516, tail0.0
3shot of client 16:head:0.5153374233128835, middle:0.16216216216216217, tail0.0
3shot of client 17:head:0.42038216560509556, middle:0.1951219512195122, tail0.3
3shot of client 18:head:0.3609022556390977, middle:0.22033898305084745, tail0.11764705882352941
3shot of client 19:head:0.483739837398374, middle:0.10526315789473684, tail0.07142857142857142
3shot of client 20:head:0.366120218579235, middle:0.06382978723404255, tail0.16666666666666666
3shot of client 21:head:0.4, middle:0.3050847457627119, tail0.07692307692307693
3shot of client 22:head:0.4050632911392405, middle:0.25, tail0.2
3shot of client 23:head:0.28804347826086957, middle:0.0851063829787234, tail0.0
3shot of client 24:head:0.18518518518518517, middle:0.05405405405405406, tail0.14285714285714285
3shot of client 25:head:0.4921875, middle:0.25806451612903225, tail0.0
3shot of client 26:head:0.3162393162393162, middle:0.4642857142857143, tail0.2857142857142857
3shot of client 27:head:0.3111111111111111, middle:0.34375, tail0.14285714285714285
3shot of client 28:head:0.4320388349514563, middle:0.1, tail0.0
3shot of client 29:head:0.5048076923076923, middle:0.16326530612244897, tail0.09090909090909091
3shot of client 30:head:0.24324324324324326, middle:0.5333333333333333, tail0.16666666666666666
3shot of client 31:head:0.3160621761658031, middle:0.22448979591836735, tail0.0  5%|         | 24/500 [52:25<19:14:24, 145.51s/it]
3shot of client 32:head:0.34285714285714286, middle:0.08, tail0.3333333333333333
3shot of client 33:head:0.3850267379679144, middle:0.3181818181818182, tail0.0
3shot of client 34:head:0.5153374233128835, middle:0.21621621621621623, tail0.3
3shot of client 35:head:0.41739130434782606, middle:0.26666666666666666, tail0.2857142857142857
3shot of client 36:head:0.15517241379310345, middle:0.021739130434782608, tail0.09090909090909091
3shot of client 37:head:0.3282828282828283, middle:0.15555555555555556, tail0.0
3shot of client 38:head:0.5138888888888888, middle:0.13157894736842105, tail0.0
3shot of client 39:head:0.4090909090909091, middle:0.14814814814814814, tail0.08333333333333333
round 23, local average test acc  0.3296 

round 23, local macro average F1 score  0.1697 

round 23, local weighted average F1 score  0.2862 

round 23, global test acc  0.1351 

round 23, average 3shot acc: [head: 0.3725, middle: 0.2051, tail: 0.1204] 

round 23, global 3shot acc: [head: 0.3956, middle: 0.0896, tail: 0.0276] 

l_head tensor([0.5878, 0.5772, 2.5021, 1.8369, 0.9664, 1.9238, 2.3525, 2.4681, 2.2437,
        0.5837, 1.5297, 0.5655, 0.5701, 1.6639, 1.7451, 1.8863, 1.4401, 0.5683,
        0.5817, 0.8876, 1.3311, 1.3738, 0.5796, 1.2840, 0.5813, 1.9964, 1.3629,
        2.4768, 1.0124, 0.5970, 1.5391, 1.6973, 1.1316, 1.8779, 0.9265, 0.5544,
        0.5943, 0.5853, 0.5795, 1.2703, 1.2318, 0.5808, 0.5845, 1.1668, 1.3503,
        0.5719, 0.9818, 0.5920, 1.2224, 1.1727, 0.5736, 1.0634, 0.5850, 1.1612,
        0.8972, 0.5725, 1.0380, 0.9724, 1.1007, 0.5651, 0.5773, 0.5936, 1.2583,
        0.5864, 0.5833, 0.5843, 0.5872, 1.2923, 0.5924, 1.1860, 0.5854, 1.1641,
        0.5650, 0.5677, 0.5812, 0.5864, 0.5951, 0.5911, 1.0199, 0.5748, 0.5788,
        0.5753, 0.5633, 0.5908, 0.5823, 0.5841, 0.5662, 1.1602, 0.5871, 0.5897,
        0.5837, 0.5849, 0.5884, 0.5683, 0.5849, 0.5841, 0.8637, 0.5773, 0.9607,
        1.2735], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.2521, 2.0492, 2.1382, 1.8295, 1.8145, 1.6667, 1.8224, 2.0816, 1.8579,
        1.8674, 1.7219, 1.6972, 1.7778, 1.9323, 1.6953, 1.5357, 1.3392, 1.6546,
        1.5142, 1.1236, 1.7463, 1.5621, 1.2885, 1.8064, 1.6632, 1.3052, 0.9866,
        1.0768, 1.2541, 1.4012, 1.5552, 1.1785, 1.0891, 1.1481, 1.0507, 1.1369,
        1.0778, 1.1569, 0.9026, 1.0018, 0.9805, 1.2052, 0.9254, 0.8989, 0.9731,
        0.9431, 0.9005, 1.1852, 0.9105, 1.3370, 0.8196, 0.7689, 1.2252, 1.1493,
        0.8909, 0.7663, 0.8567, 0.7454, 0.9397, 0.9740, 1.2677, 0.8749, 0.9105,
        0.7527, 0.7184, 0.7157, 0.6977, 0.8713, 0.8067, 0.7448, 0.8210, 0.8755,
        0.6671, 0.7874, 0.6913, 0.6425, 0.8115, 0.6787, 0.7271, 0.6857, 0.6377,
        0.6170, 0.7931, 0.7605, 0.7304, 0.6634, 0.7054, 0.6221, 0.5964, 0.6441,
        0.6672, 0.5911, 0.6783, 0.6201, 0.6472, 0.7615, 0.6315, 0.5950, 0.6576,
        0.6592], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([11.2323], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.44171779141104295, middle:0.2571428571428571, tail0.0
3shot of client 1:head:0.585635359116022, middle:0.2619047619047619, tail0.0
3shot of client 2:head:0.26119402985074625, middle:0.05714285714285714, tail0.0
3shot of client 3:head:0.43037974683544306, middle:0.0967741935483871, tail0.0
3shot of client 4:head:0.3128491620111732, middle:0.24390243902439024, tail0.3
3shot of client 5:head:0.18867924528301888, middle:0.07692307692307693, tail0.0
3shot of client 6:head:0.3951219512195122, middle:0.2037037037037037, tail0.18181818181818182
3shot of client 7:head:0.4012738853503185, middle:0.2, tail0.0
3shot of client 8:head:0.2962962962962963, middle:0.2777777777777778, tail0.375
3shot of client 9:head:0.32903225806451614, middle:0.17142857142857143, tail0.1
3shot of client 10:head:0.4672897196261682, middle:0.23076923076923078, tail0.16666666666666666
3shot of client 11:head:0.488, middle:0.25, tail0.25
3shot of client 12:head:0.4734042553191489, middle:0.08, tail0.16666666666666666
3shot of client 13:head:0.46153846153846156, middle:0.34375, tail0.14285714285714285
3shot of client 14:head:0.3350253807106599, middle:0.023809523809523808, tail0.0
3shot of client 15:head:0.37815126050420167, middle:0.12903225806451613, tail0.0
3shot of client 16:head:0.5644171779141104, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.4713375796178344, middle:0.17073170731707318, tail0.2
3shot of client 18:head:0.38345864661654133, middle:0.23728813559322035, tail0.11764705882352941
3shot of client 19:head:0.45528455284552843, middle:0.21052631578947367, tail0.07142857142857142
3shot of client 20:head:0.3114754098360656, middle:0.06382978723404255, tail0.08333333333333333
3shot of client 21:head:0.3617021276595745, middle:0.288135593220339, tail0.0
3shot of client 22:head:0.43670886075949367, middle:0.25, tail0.2
3shot of client 23:head:0.2608695652173913, middle:0.0851063829787234, tail0.0
3shot of client 24:head:0.17037037037037037, middle:0.02702702702702703, tail0.14285714285714285
3shot of client 25:head:0.5546875, middle:0.16129032258064516, tail0.0
3shot of client 26:head:0.37606837606837606, middle:0.5357142857142857, tail0.14285714285714285
3shot of client 27:head:0.3111111111111111, middle:0.375, tail0.14285714285714285
3shot of client 28:head:0.36893203883495146, middle:0.14, tail0.0
3shot of client 29:head:0.4230769230769231, middle:0.3673469387755102, tail0.18181818181818182
3shot of client 30:head:0.21621621621621623, middle:0.4666666666666667, tail0.16666666666666666
3shot of client 31:head:0.35751295336787564, middle:0.22448979591836735, tail0.0
3shot of client 32:head:0.37142857142857144, middle:0.16, tail0.3333333333333333
3shot of client 33:head:0.3689839572192513, middle:0.3181818181818182, tail0.0
3shot of client 34:head:0.5398773006134969, middle:0.16216216216216217, tail0.3
3shot of client 35:head:0.34782608695652173, middle:0.3333333333333333, tail0.14285714285714285
3shot of client 36:head:0.1781609195402299, middle:0.021739130434782608, tail0.09090909090909091
3shot of client 37:head:0.4090909090909091, middle:0.17777777777777778, tail0.0
3shot of client 38:head:0.5208333333333334, middle:0.15789473684210525, tail0.0
3shot of client 39:head:0.41919191919191917, middle:0.12962962962962962, tail0.0
round 24, local average test acc  0.3379 

round 24, local macro average F1 score  0.1733 

round 24, local weighted average F1 score  0.3095 

round 24, global test acc  0.1355 

round 24, average 3shot acc: [head: 0.3856, middle: 0.2019, tail: 0.1000] 

round 24, global 3shot acc: [head: 0.4080, middle: 0.0892, tail: 0.0224] 

l_head tensor([0.5878, 0.5772, 2.5021, 1.8369, 0.9664, 1.9238, 2.3525, 2.4681, 2.2437,
        0.5837, 1.5297, 0.5655, 0.5701, 1.6639, 1.7451, 1.8863, 1.4401, 0.5683,
        0.5817, 0.8876, 1.3311, 1.3738, 0.5796, 1.2840, 0.5813, 1.9964, 1.3629,
        2.4768, 1.0124, 0.5970, 1.5391, 1.6973, 1.1316, 1.8779, 0.9265, 0.5544,
        0.5943, 0.5853, 0.5795, 1.2703, 1.2318, 0.5808, 0.5845, 1.1668, 1.3503,
        0.5719, 0.9818, 0.5920, 1.2224, 1.1727, 0.5736, 1.0634, 0.5850, 1.1612,
        0.8972, 0.5725, 1.0380, 0.9724, 1.1007, 0.5651, 0.5773, 0.5936, 1.2583,
        0.5864, 0.5833, 0.5843, 0.5872, 1.2923, 0.5924, 1.1860, 0.5854, 1.1641,
        0.5650, 0.5677, 0.5812, 0.5864, 0.5951, 0.5911, 1.0199, 0.5748, 0.5788,
        0.5753, 0.5633, 0.5908, 0.5823, 0.5841, 0.5662, 1.1602, 0.5871, 0.5897,
        0.5837, 0.5849, 0.5884, 0.5683, 0.5849, 0.5841, 0.8637, 0.5773, 0.9607,
        1.2735], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.3579, 2.1266, 2.1722, 1.9048, 1.8153, 1.7449, 1.8161, 2.1834, 1.9263,
        1.9164, 1.7932, 1.7475, 1.8100, 1.9781, 1.7340, 1.5824, 1.3743, 1.7003,
        1.5466, 1.1424, 1.8373, 1.6055, 1.3176, 1.8323, 1.6973, 1.3282, 0.9930,
        1.0679, 1.3233, 1.4286, 1.5866, 1.2090, 1.1484, 1.1741, 1.0744, 1.1657,
        1.0875, 1.2115, 0.9227, 1.0429, 0.9935, 1.2262, 0.9534, 0.9217, 0.9737,
        0.9668, 0.9227, 1.2074, 0.9415, 1.3666, 0.8360, 0.7820, 1.2700, 1.1428,
        0.8947, 0.7685, 0.8762, 0.7658, 0.9670, 0.9982, 1.2696, 0.8854, 0.8944,
        0.7633, 0.7231, 0.7200, 0.7046, 0.9323, 0.8353, 0.7555, 0.8195, 0.8765,
        0.6747, 0.7972, 0.7048, 0.6556, 0.8276, 0.6913, 0.7581, 0.6948, 0.6389,
        0.6242, 0.8062, 0.7852, 0.7404, 0.6668, 0.7081, 0.6273, 0.6027, 0.6503,
        0.6782, 0.5923, 0.6787, 0.6246, 0.6490, 0.7825, 0.6393, 0.6003, 0.6560,
        0.6711], device='cuda:4', grad_fn=<NormBackward1>)  5%|         | 25/500 [54:58<19:30:05, 147.80s/it]  5%|         | 26/500 [57:20<19:14:04, 146.09s/it]
The value of constant scaler:  tensor([11.4408], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.4233128834355828, middle:0.37142857142857144, tail0.0
3shot of client 1:head:0.6298342541436464, middle:0.23809523809523808, tail0.0
3shot of client 2:head:0.2835820895522388, middle:0.17142857142857143, tail0.125
3shot of client 3:head:0.4388185654008439, middle:0.14516129032258066, tail0.0
3shot of client 4:head:0.39664804469273746, middle:0.24390243902439024, tail0.2
3shot of client 5:head:0.18867924528301888, middle:0.3076923076923077, tail0.0
3shot of client 6:head:0.43414634146341463, middle:0.16666666666666666, tail0.2727272727272727
3shot of client 7:head:0.3630573248407643, middle:0.2, tail0.1111111111111111
3shot of client 8:head:0.4666666666666667, middle:0.16666666666666666, tail0.375
3shot of client 9:head:0.38064516129032255, middle:0.05714285714285714, tail0.2
3shot of client 10:head:0.4485981308411215, middle:0.07692307692307693, tail0.0
3shot of client 11:head:0.48, middle:0.40625, tail0.375
3shot of client 12:head:0.5, middle:0.12, tail0.16666666666666666
3shot of client 13:head:0.42735042735042733, middle:0.28125, tail0.14285714285714285
3shot of client 14:head:0.40609137055837563, middle:0.023809523809523808, tail0.0
3shot of client 15:head:0.3949579831932773, middle:0.2903225806451613, tail0.0
3shot of client 16:head:0.5828220858895705, middle:0.13513513513513514, tail0.1
3shot of client 17:head:0.5796178343949044, middle:0.17073170731707318, tail0.2
3shot of client 18:head:0.40225563909774437, middle:0.2711864406779661, tail0.11764705882352941
3shot of client 19:head:0.4186991869918699, middle:0.2807017543859649, tail0.14285714285714285
3shot of client 20:head:0.29508196721311475, middle:0.0851063829787234, tail0.08333333333333333
3shot of client 21:head:0.33617021276595743, middle:0.3389830508474576, tail0.07692307692307693
3shot of client 22:head:0.5189873417721519, middle:0.2777777777777778, tail0.2
3shot of client 23:head:0.21739130434782608, middle:0.0851063829787234, tail0.08333333333333333
3shot of client 24:head:0.17037037037037037, middle:0.02702702702702703, tail0.14285714285714285
3shot of client 25:head:0.546875, middle:0.16129032258064516, tail0.125
3shot of client 26:head:0.42735042735042733, middle:0.4642857142857143, tail0.0
3shot of client 27:head:0.24444444444444444, middle:0.4375, tail0.14285714285714285
3shot of client 28:head:0.47572815533980584, middle:0.12, tail0.0
3shot of client 29:head:0.46634615384615385, middle:0.30612244897959184, tail0.36363636363636365
3shot of client 30:head:0.26126126126126126, middle:0.4666666666666667, tail0.0
3shot of client 31:head:0.35233160621761656, middle:0.20408163265306123, tail0.0
3shot of client 32:head:0.3523809523809524, middle:0.16, tail0.5
3shot of client 33:head:0.39037433155080214, middle:0.3409090909090909, tail0.08333333333333333
3shot of client 34:head:0.3987730061349693, middle:0.16216216216216217, tail0.2
3shot of client 35:head:0.3739130434782609, middle:0.2, tail0.14285714285714285
3shot of client 36:head:0.3850574712643678, middle:0.08695652173913043, tail0.0
3shot of client 37:head:0.3434343434343434, middle:0.15555555555555556, tail0.0
3shot of client 38:head:0.4861111111111111, middle:0.10526315789473684, tail0.0
3shot of client 39:head:0.45454545454545453, middle:0.18518518518518517, tail0.08333333333333333
round 25, local average test acc  0.3544 

round 25, local macro average F1 score  0.1951 

round 25, local weighted average F1 score  0.3451 

round 25, global test acc  0.1390 

round 25, average 3shot acc: [head: 0.4036, middle: 0.2124, tail: 0.1189] 

round 25, global 3shot acc: [head: 0.4156, middle: 0.0940, tail: 0.0232] 

l_head tensor([0.5878, 0.5772, 2.5021, 1.8369, 0.9664, 1.9238, 2.3525, 2.4681, 2.2437,
        0.5837, 1.5297, 0.5655, 0.5701, 1.6639, 1.7451, 1.8863, 1.4401, 0.5683,
        0.5817, 0.8876, 1.3311, 1.3738, 0.5796, 1.2840, 0.5813, 1.9964, 1.3629,
        2.4768, 1.0124, 0.5970, 1.5391, 1.6973, 1.1316, 1.8779, 0.9265, 0.5544,
        0.5943, 0.5853, 0.5795, 1.2703, 1.2318, 0.5808, 0.5845, 1.1668, 1.3503,
        0.5719, 0.9818, 0.5920, 1.2224, 1.1727, 0.5736, 1.0634, 0.5850, 1.1612,
        0.8972, 0.5725, 1.0380, 0.9724, 1.1007, 0.5651, 0.5773, 0.5936, 1.2583,
        0.5864, 0.5833, 0.5843, 0.5872, 1.2923, 0.5924, 1.1860, 0.5854, 1.1641,
        0.5650, 0.5677, 0.5812, 0.5864, 0.5951, 0.5911, 1.0199, 0.5748, 0.5788,
        0.5753, 0.5633, 0.5908, 0.5823, 0.5841, 0.5662, 1.1602, 0.5871, 0.5897,
        0.5837, 0.5849, 0.5884, 0.5683, 0.5849, 0.5841, 0.8637, 0.5773, 0.9607,
        1.2735], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.3816, 2.1689, 2.1525, 1.9182, 1.8699, 1.8105, 1.8612, 2.1501, 2.0277,
        1.9413, 1.8091, 1.7443, 1.8076, 1.9862, 1.7209, 1.5712, 1.4330, 1.8479,
        1.6056, 1.1995, 1.7982, 1.6657, 1.3417, 1.8678, 1.7325, 1.3727, 1.0431,
        1.0876, 1.3505, 1.4580, 1.6182, 1.2139, 1.1577, 1.1927, 1.1159, 1.2055,
        1.1358, 1.2164, 0.9696, 1.0658, 1.0423, 1.2792, 0.9451, 0.9416, 1.0080,
        0.9857, 0.9525, 1.2377, 0.9946, 1.3687, 0.8701, 0.7877, 1.2746, 1.1808,
        0.9425, 0.7877, 0.9089, 0.7877, 0.9911, 1.0281, 1.2851, 0.8977, 0.9525,
        0.7634, 0.7265, 0.7288, 0.7201, 0.9375, 0.8549, 0.7609, 0.8201, 0.9486,
        0.6800, 0.8116, 0.7200, 0.6791, 0.8560, 0.6944, 0.7598, 0.7083, 0.6565,
        0.6332, 0.8296, 0.7989, 0.7435, 0.6706, 0.7161, 0.6313, 0.5993, 0.6559,
        0.6823, 0.5946, 0.6709, 0.6243, 0.6499, 0.7923, 0.6441, 0.6115, 0.6661,
        0.6709], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([11.6744], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.44785276073619634, middle:0.42857142857142855, tail0.0
3shot of client 1:head:0.6243093922651933, middle:0.23809523809523808, tail0.09090909090909091
3shot of client 2:head:0.23880597014925373, middle:0.02857142857142857, tail0.0
3shot of client 3:head:0.4430379746835443, middle:0.12903225806451613, tail0.0
3shot of client 4:head:0.4134078212290503, middle:0.2682926829268293, tail0.3
3shot of client 5:head:0.1320754716981132, middle:0.3076923076923077, tail0.0
3shot of client 6:head:0.4292682926829268, middle:0.14814814814814814, tail0.2727272727272727
3shot of client 7:head:0.4012738853503185, middle:0.2, tail0.1111111111111111
3shot of client 8:head:0.5037037037037037, middle:0.25, tail0.25
3shot of client 9:head:0.32903225806451614, middle:0.17142857142857143, tail0.1
3shot of client 10:head:0.5233644859813084, middle:0.19230769230769232, tail0.16666666666666666
3shot of client 11:head:0.464, middle:0.34375, tail0.375
3shot of client 12:head:0.5425531914893617, middle:0.12, tail0.16666666666666666
3shot of client 13:head:0.4188034188034188, middle:0.40625, tail0.0
3shot of client 14:head:0.3553299492385787, middle:0.09523809523809523, tail0.16666666666666666
3shot of client 15:head:0.4369747899159664, middle:0.16129032258064516, tail0.0
3shot of client 16:head:0.5398773006134969, middle:0.16216216216216217, tail0.1
3shot of client 17:head:0.4840764331210191, middle:0.36585365853658536, tail0.2
3shot of client 18:head:0.36466165413533835, middle:0.2033898305084746, tail0.058823529411764705
3shot of client 19:head:0.44715447154471544, middle:0.2631578947368421, tail0.14285714285714285
3shot of client 20:head:0.22404371584699453, middle:0.10638297872340426, tail0.08333333333333333
3shot of client 21:head:0.37872340425531914, middle:0.3559322033898305, tail0.0
3shot of client 22:head:0.44936708860759494, middle:0.2222222222222222, tail0.2
3shot of client 23:head:0.24456521739130435, middle:0.10638297872340426, tail0.16666666666666666
3shot of client 24:head:0.4888888888888889, middle:0.08108108108108109, tail0.0
3shot of client 25:head:0.53125, middle:0.16129032258064516, tail0.125
3shot of client 26:head:0.4358974358974359, middle:0.5357142857142857, tail0.2857142857142857
3shot of client 27:head:0.3111111111111111, middle:0.46875, tail0.0
3shot of client 28:head:0.4320388349514563, middle:0.16, tail0.0
3shot of client 29:head:0.5961538461538461, middle:0.2653061224489796, tail0.2727272727272727
3shot of client 30:head:0.24324324324324326, middle:0.5666666666666667, tail0.16666666666666666  5%|         | 27/500 [59:47<19:14:35, 146.46s/it]
3shot of client 31:head:0.3471502590673575, middle:0.20408163265306123, tail0.0
3shot of client 32:head:0.2, middle:0.2, tail0.16666666666666666
3shot of client 33:head:0.31016042780748665, middle:0.2727272727272727, tail0.08333333333333333
3shot of client 34:head:0.39263803680981596, middle:0.16216216216216217, tail0.2
3shot of client 35:head:0.391304347826087, middle:0.26666666666666666, tail0.0
3shot of client 36:head:0.5057471264367817, middle:0.06521739130434782, tail0.18181818181818182
3shot of client 37:head:0.3333333333333333, middle:0.17777777777777778, tail0.0
3shot of client 38:head:0.5138888888888888, middle:0.18421052631578946, tail0.0
3shot of client 39:head:0.4595959595959596, middle:0.18518518518518517, tail0.08333333333333333
round 26, local average test acc  0.3611 

round 26, local macro average F1 score  0.1955 

round 26, local weighted average F1 score  0.3443 

round 26, global test acc  0.1470 

round 26, average 3shot acc: [head: 0.4082, middle: 0.2308, tail: 0.1129] 

round 26, global 3shot acc: [head: 0.4360, middle: 0.0800, tail: 0.0360] 

l_head tensor([0.5878, 0.5772, 2.5021, 1.8369, 0.9664, 1.9238, 2.3525, 2.4681, 2.2437,
        0.5837, 1.5297, 0.5655, 0.5701, 1.6639, 1.7451, 1.8863, 1.4401, 0.5683,
        0.5817, 0.8876, 1.3311, 1.3738, 0.5796, 1.2840, 0.5813, 1.9964, 1.3629,
        2.4768, 1.0124, 0.5970, 1.5391, 1.6973, 1.1316, 1.8779, 0.9265, 0.5544,
        0.5943, 0.5853, 0.5795, 1.2703, 1.2318, 0.5808, 0.5845, 1.1668, 1.3503,
        0.5719, 0.9818, 0.5920, 1.2224, 1.1727, 0.5736, 1.0634, 0.5850, 1.1612,
        0.8972, 0.5725, 1.0380, 0.9724, 1.1007, 0.5651, 0.5773, 0.5936, 1.2583,
        0.5864, 0.5833, 0.5843, 0.5872, 1.2923, 0.5924, 1.1860, 0.5854, 1.1641,
        0.5650, 0.5677, 0.5812, 0.5864, 0.5951, 0.5911, 1.0199, 0.5748, 0.5788,
        0.5753, 0.5633, 0.5908, 0.5823, 0.5841, 0.5662, 1.1602, 0.5871, 0.5897,
        0.5837, 0.5849, 0.5884, 0.5683, 0.5849, 0.5841, 0.8637, 0.5773, 0.9607,
        1.2735], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.4798, 2.1937, 2.1636, 1.9592, 1.9386, 1.9175, 1.8690, 2.1634, 2.1184,
        2.0135, 1.9111, 1.7825, 1.8116, 2.0484, 1.7693, 1.5683, 1.4937, 1.8135,
        1.6489, 1.3014, 1.8434, 1.7230, 1.4028, 1.8992, 1.8479, 1.3988, 1.0954,
        1.1006, 1.3720, 1.4971, 1.6426, 1.2426, 1.1846, 1.2147, 1.1531, 1.2330,
        1.1771, 1.2711, 0.9717, 1.0864, 1.0608, 1.3834, 0.9595, 0.9647, 1.0074,
        1.0048, 0.9940, 1.2712, 1.0570, 1.3894, 0.8790, 0.8050, 1.3071, 1.1829,
        1.0070, 0.7938, 0.9458, 0.7901, 1.0044, 1.0511, 1.3228, 0.9110, 0.9885,
        0.7639, 0.7358, 0.7267, 0.7279, 0.9563, 0.8797, 0.7725, 0.8236, 1.0266,
        0.6773, 0.8186, 0.7280, 0.6968, 0.8807, 0.7072, 0.7704, 0.7252, 0.6573,
        0.6435, 0.8485, 0.8054, 0.7444, 0.6737, 0.7295, 0.6374, 0.6050, 0.6607,
        0.6841, 0.5959, 0.6693, 0.6330, 0.6542, 0.7918, 0.6436, 0.6170, 0.6706,
        0.6677], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([11.9131], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.4601226993865031, middle:0.34285714285714286, tail0.0
3shot of client 1:head:0.6187845303867403, middle:0.2857142857142857, tail0.0
3shot of client 2:head:0.2462686567164179, middle:0.11428571428571428, tail0.0
3shot of client 3:head:0.459915611814346, middle:0.11290322580645161, tail0.0
3shot of client 4:head:0.4134078212290503, middle:0.36585365853658536, tail0.2
3shot of client 5:head:0.16037735849056603, middle:0.2692307692307692, tail0.0
3shot of client 6:head:0.43414634146341463, middle:0.2222222222222222, tail0.18181818181818182
3shot of client 7:head:0.3630573248407643, middle:0.175, tail0.0
3shot of client 8:head:0.45925925925925926, middle:0.16666666666666666, tail0.25
3shot of client 9:head:0.36129032258064514, middle:0.11428571428571428, tail0.2
3shot of client 10:head:0.48598130841121495, middle:0.3076923076923077, tail0.16666666666666666
3shot of client 11:head:0.496, middle:0.3125, tail0.25
3shot of client 12:head:0.574468085106383, middle:0.2, tail0.25
3shot of client 13:head:0.3162393162393162, middle:0.40625, tail0.0
3shot of client 14:head:0.4263959390862944, middle:0.09523809523809523, tail0.0
3shot of client 15:head:0.4369747899159664, middle:0.25806451612903225, tail0.0
3shot of client 16:head:0.588957055214724, middle:0.10810810810810811, tail0.1
3shot of client 17:head:0.5732484076433121, middle:0.1951219512195122, tail0.1
3shot of client 18:head:0.39473684210526316, middle:0.1864406779661017, tail0.058823529411764705
3shot of client 19:head:0.45121951219512196, middle:0.22807017543859648, tail0.07142857142857142
3shot of client 20:head:0.24043715846994534, middle:0.10638297872340426, tail0.08333333333333333
3shot of client 21:head:0.4, middle:0.3220338983050847, tail0.0
3shot of client 22:head:0.4873417721518987, middle:0.2222222222222222, tail0.2
3shot of client 23:head:0.2554347826086957, middle:0.10638297872340426, tail0.08333333333333333
3shot of client 24:head:0.4888888888888889, middle:0.08108108108108109, tail0.0
3shot of client 25:head:0.53125, middle:0.1935483870967742, tail0.125
3shot of client 26:head:0.5384615384615384, middle:0.4642857142857143, tail0.0
3shot of client 27:head:0.26666666666666666, middle:0.375, tail0.0
3shot of client 28:head:0.4368932038834951, middle:0.14, tail0.0
3shot of client 29:head:0.5576923076923077, middle:0.30612244897959184, tail0.18181818181818182
3shot of client 30:head:0.23423423423423423, middle:0.5333333333333333, tail0.16666666666666666
3shot of client 31:head:0.37823834196891193, middle:0.1836734693877551, tail0.0
3shot of client 32:head:0.21904761904761905, middle:0.24, tail0.16666666666666666
3shot of client 33:head:0.44919786096256686, middle:0.22727272727272727, tail0.0
3shot of client 34:head:0.4110429447852761, middle:0.02702702702702703, tail0.1
3shot of client 35:head:0.3826086956521739, middle:0.3333333333333333, tail0.14285714285714285
3shot of client 36:head:0.4540229885057471, middle:0.10869565217391304, tail0.0
3shot of client 37:head:0.30303030303030304, middle:0.17777777777777778, tail0.09090909090909091
3shot of client 38:head:0.5277777777777778, middle:0.10526315789473684, tail0.0
3shot of client 39:head:0.41919191919191917, middle:0.18518518518518517, tail0.08333333333333333
round 27, local average test acc  0.3655 

round 27, local macro average F1 score  0.1881 

round 27, local weighted average F1 score  0.3290 

round 27, global test acc  0.1442 

round 27, average 3shot acc: [head: 0.4176, middle: 0.2226, tail: 0.0813] 

round 27, global 3shot acc: [head: 0.4280, middle: 0.0808, tail: 0.0340] 

l_head tensor([0.5878, 0.5772, 2.5021, 1.8369, 0.9664, 1.9238, 2.3525, 2.4681, 2.2437,
        0.5837, 1.5297, 0.5655, 0.5701, 1.6639, 1.7451, 1.8863, 1.4401, 0.5683,
        0.5817, 0.8876, 1.3311, 1.3738, 0.5796, 1.2840, 0.5813, 1.9964, 1.3629,
        2.4768, 1.0124, 0.5970, 1.5391, 1.6973, 1.1316, 1.8779, 0.9265, 0.5544,
        0.5943, 0.5853, 0.5795, 1.2703, 1.2318, 0.5808, 0.5845, 1.1668, 1.3503,
        0.5719, 0.9818, 0.5920, 1.2224, 1.1727, 0.5736, 1.0634, 0.5850, 1.1612,
        0.8972, 0.5725, 1.0380, 0.9724, 1.1007, 0.5651, 0.5773, 0.5936, 1.2583,
        0.5864, 0.5833, 0.5843, 0.5872, 1.2923, 0.5924, 1.1860, 0.5854, 1.1641,
        0.5650, 0.5677, 0.5812, 0.5864, 0.5951, 0.5911, 1.0199, 0.5748, 0.5788,
        0.5753, 0.5633, 0.5908, 0.5823, 0.5841, 0.5662, 1.1602, 0.5871, 0.5897,
        0.5837, 0.5849, 0.5884, 0.5683, 0.5849, 0.5841, 0.8637, 0.5773, 0.9607,
        1.2735], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.5504, 2.2579, 2.2240, 1.9599, 1.9698, 2.0438, 1.8861, 2.1991, 2.1648,
        2.0811, 1.9061, 1.8103, 1.8496, 2.0885, 1.7812, 1.6164, 1.6026, 1.8457,
        1.6518, 1.2975, 1.8857, 1.7652, 1.4602, 1.9612, 1.8384, 1.4429, 1.1510,
        1.1480, 1.3987, 1.5359, 1.6574, 1.2627, 1.2482, 1.2473, 1.1818, 1.2797,
        1.1745, 1.2760, 1.0003, 1.0990, 1.0737, 1.4039, 0.9883, 0.9846, 1.0349,
        1.0286, 1.0616, 1.3109, 1.1364, 1.4039, 0.9069, 0.8360, 1.3343, 1.2094,
        1.0365, 0.8002, 0.9652, 0.8131, 1.0510, 1.0582, 1.3543, 0.9402, 0.9791,
        0.7952, 0.7372, 0.7265, 0.7440, 0.9788, 0.9298, 0.7865, 0.8241, 1.0550,
        0.6827, 0.8437, 0.7399, 0.7145, 0.9177, 0.7158, 0.7731, 0.7511, 0.6666,
        0.6446, 0.8551, 0.8025, 0.7455, 0.6749, 0.7352, 0.6440, 0.6139, 0.6744,
        0.7036, 0.6036, 0.6763, 0.6502, 0.6536, 0.8246, 0.6601, 0.6218, 0.6725,
        0.6775], device='cuda:4', grad_fn=<NormBackward1>)  6%|         | 28/500 [1:02:18<19:21:13, 147.61s/it]  6%|         | 29/500 [1:04:50<19:31:02, 149.18s/it]
The value of constant scaler:  tensor([12.1550], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.44785276073619634, middle:0.37142857142857144, tail0.0
3shot of client 1:head:0.6519337016574586, middle:0.2619047619047619, tail0.0
3shot of client 2:head:0.291044776119403, middle:0.11428571428571428, tail0.0
3shot of client 3:head:0.47257383966244726, middle:0.14516129032258066, tail0.0
3shot of client 4:head:0.4245810055865922, middle:0.3170731707317073, tail0.1
3shot of client 5:head:0.16981132075471697, middle:0.2692307692307692, tail0.16666666666666666
3shot of client 6:head:0.47317073170731705, middle:0.2037037037037037, tail0.2727272727272727
3shot of client 7:head:0.3821656050955414, middle:0.175, tail0.1111111111111111
3shot of client 8:head:0.5037037037037037, middle:0.1111111111111111, tail0.25
3shot of client 9:head:0.41935483870967744, middle:0.05714285714285714, tail0.1
3shot of client 10:head:0.5794392523364486, middle:0.3076923076923077, tail0.16666666666666666
3shot of client 11:head:0.52, middle:0.40625, tail0.25
3shot of client 12:head:0.6063829787234043, middle:0.16, tail0.25
3shot of client 13:head:0.3333333333333333, middle:0.34375, tail0.0
3shot of client 14:head:0.5329949238578681, middle:0.21428571428571427, tail0.08333333333333333
3shot of client 15:head:0.44537815126050423, middle:0.2903225806451613, tail0.0
3shot of client 16:head:0.6503067484662577, middle:0.13513513513513514, tail0.1
3shot of client 17:head:0.4968152866242038, middle:0.1951219512195122, tail0.2
3shot of client 18:head:0.4699248120300752, middle:0.423728813559322, tail0.0
3shot of client 19:head:0.5121951219512195, middle:0.2982456140350877, tail0.07142857142857142
3shot of client 20:head:0.4426229508196721, middle:0.0851063829787234, tail0.08333333333333333
3shot of client 21:head:0.4127659574468085, middle:0.3559322033898305, tail0.0
3shot of client 22:head:0.4430379746835443, middle:0.25, tail0.3
3shot of client 23:head:0.29347826086956524, middle:0.14893617021276595, tail0.08333333333333333
3shot of client 24:head:0.3111111111111111, middle:0.08108108108108109, tail0.0
3shot of client 25:head:0.5546875, middle:0.25806451612903225, tail0.0
3shot of client 26:head:0.49572649572649574, middle:0.4642857142857143, tail0.14285714285714285
3shot of client 27:head:0.34074074074074073, middle:0.46875, tail0.14285714285714285
3shot of client 28:head:0.46601941747572817, middle:0.16, tail0.0
3shot of client 29:head:0.5865384615384616, middle:0.3469387755102041, tail0.18181818181818182
3shot of client 30:head:0.24324324324324326, middle:0.5333333333333333, tail0.16666666666666666
3shot of client 31:head:0.39896373056994816, middle:0.1836734693877551, tail0.0
3shot of client 32:head:0.3238095238095238, middle:0.28, tail0.16666666666666666
3shot of client 33:head:0.46524064171123, middle:0.29545454545454547, tail0.0
3shot of client 34:head:0.44171779141104295, middle:0.10810810810810811, tail0.1
3shot of client 35:head:0.45217391304347826, middle:0.23333333333333334, tail0.0
3shot of client 36:head:0.47126436781609193, middle:0.1956521739130435, tail0.0
3shot of client 37:head:0.30808080808080807, middle:0.24444444444444444, tail0.09090909090909091
3shot of client 38:head:0.5625, middle:0.13157894736842105, tail0.0
3shot of client 39:head:0.30808080808080807, middle:0.2037037037037037, tail0.16666666666666666
round 28, local average test acc  0.3894 

round 28, local macro average F1 score  0.2198 

round 28, local weighted average F1 score  0.3788 

round 28, global test acc  0.1554 

round 28, average 3shot acc: [head: 0.4426, middle: 0.2457, tail: 0.0937] 

round 28, global 3shot acc: [head: 0.4500, middle: 0.1100, tail: 0.0308] 

l_head tensor([0.5878, 0.5772, 2.5021, 1.8369, 0.9664, 1.9238, 2.3525, 2.4681, 2.2437,
        0.5837, 1.5297, 0.5655, 0.5701, 1.6639, 1.7451, 1.8863, 1.4401, 0.5683,
        0.5817, 0.8876, 1.3311, 1.3738, 0.5796, 1.2840, 0.5813, 1.9964, 1.3629,
        2.4768, 1.0124, 0.5970, 1.5391, 1.6973, 1.1316, 1.8779, 0.9265, 0.5544,
        0.5943, 0.5853, 0.5795, 1.2703, 1.2318, 0.5808, 0.5845, 1.1668, 1.3503,
        0.5719, 0.9818, 0.5920, 1.2224, 1.1727, 0.5736, 1.0634, 0.5850, 1.1612,
        0.8972, 0.5725, 1.0380, 0.9724, 1.1007, 0.5651, 0.5773, 0.5936, 1.2583,
        0.5864, 0.5833, 0.5843, 0.5872, 1.2923, 0.5924, 1.1860, 0.5854, 1.1641,
        0.5650, 0.5677, 0.5812, 0.5864, 0.5951, 0.5911, 1.0199, 0.5748, 0.5788,
        0.5753, 0.5633, 0.5908, 0.5823, 0.5841, 0.5662, 1.1602, 0.5871, 0.5897,
        0.5837, 0.5849, 0.5884, 0.5683, 0.5849, 0.5841, 0.8637, 0.5773, 0.9607,
        1.2735], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.6464, 2.3123, 2.2656, 2.0200, 1.9975, 2.1203, 1.9089, 2.2679, 2.1951,
        2.1045, 1.9756, 1.8550, 1.9124, 2.1496, 1.8242, 1.6398, 1.6779, 1.8274,
        1.6741, 1.3910, 1.9803, 1.8032, 1.4963, 1.9570, 1.8946, 1.4807, 1.1896,
        1.1735, 1.4379, 1.5803, 1.7364, 1.3203, 1.3071, 1.2904, 1.2226, 1.3433,
        1.2069, 1.3352, 1.0012, 1.1613, 1.1253, 1.4741, 1.0131, 1.0030, 1.0689,
        1.0787, 1.0776, 1.3420, 1.1980, 1.4260, 0.9141, 0.8611, 1.3457, 1.2169,
        1.0681, 0.8063, 0.9999, 0.8265, 1.0822, 1.0813, 1.3785, 0.9484, 1.0177,
        0.8121, 0.7522, 0.7337, 0.7543, 1.0145, 0.9403, 0.7953, 0.8541, 1.0962,
        0.6826, 0.8482, 0.7544, 0.7272, 0.9358, 0.7219, 0.7868, 0.7713, 0.6725,
        0.6551, 0.8749, 0.8100, 0.7448, 0.6887, 0.7572, 0.6438, 0.6268, 0.6855,
        0.7307, 0.6156, 0.6739, 0.6592, 0.6694, 0.8505, 0.6661, 0.6324, 0.6784,
        0.6901], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([12.3569], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.4662576687116564, middle:0.4, tail0.0
3shot of client 1:head:0.6464088397790055, middle:0.40476190476190477, tail0.0
3shot of client 2:head:0.31343283582089554, middle:0.17142857142857143, tail0.0
3shot of client 3:head:0.47257383966244726, middle:0.1774193548387097, tail0.0
3shot of client 4:head:0.39664804469273746, middle:0.3170731707317073, tail0.2
3shot of client 5:head:0.27358490566037735, middle:0.15384615384615385, tail0.0
3shot of client 6:head:0.5073170731707317, middle:0.14814814814814814, tail0.2727272727272727
3shot of client 7:head:0.42038216560509556, middle:0.2, tail0.1111111111111111
3shot of client 8:head:0.4962962962962963, middle:0.2777777777777778, tail0.25
3shot of client 9:head:0.47096774193548385, middle:0.11428571428571428, tail0.1
3shot of client 10:head:0.5887850467289719, middle:0.15384615384615385, tail0.16666666666666666
3shot of client 11:head:0.488, middle:0.3125, tail0.25
3shot of client 12:head:0.5, middle:0.3, tail0.08333333333333333
3shot of client 13:head:0.3333333333333333, middle:0.34375, tail0.14285714285714285
3shot of client 14:head:0.4720812182741117, middle:0.21428571428571427, tail0.0
3shot of client 15:head:0.3697478991596639, middle:0.3548387096774194, tail0.0
3shot of client 16:head:0.6380368098159509, middle:0.16216216216216217, tail0.1
3shot of client 17:head:0.5159235668789809, middle:0.21951219512195122, tail0.1
3shot of client 18:head:0.4774436090225564, middle:0.4067796610169492, tail0.058823529411764705
3shot of client 19:head:0.43089430894308944, middle:0.2807017543859649, tail0.07142857142857142
3shot of client 20:head:0.4371584699453552, middle:0.06382978723404255, tail0.08333333333333333
3shot of client 21:head:0.4085106382978723, middle:0.3559322033898305, tail0.0
3shot of client 22:head:0.5189873417721519, middle:0.2222222222222222, tail0.0
3shot of client 23:head:0.29347826086956524, middle:0.10638297872340426, tail0.08333333333333333
3shot of client 24:head:0.3333333333333333, middle:0.05405405405405406, tail0.0
3shot of client 25:head:0.5078125, middle:0.2903225806451613, tail0.125
3shot of client 26:head:0.5128205128205128, middle:0.4642857142857143, tail0.14285714285714285
3shot of client 27:head:0.362962962962963, middle:0.6875, tail0.0
3shot of client 28:head:0.5242718446601942, middle:0.14, tail0.0
3shot of client 29:head:0.5528846153846154, middle:0.3469387755102041, tail0.2727272727272727
3shot of client 30:head:0.24324324324324326, middle:0.5666666666666667, tail0.16666666666666666  6%|         | 30/500 [1:07:16<19:21:12, 148.24s/it]
3shot of client 31:head:0.40932642487046633, middle:0.22448979591836735, tail0.0
3shot of client 32:head:0.23809523809523808, middle:0.28, tail0.3333333333333333
3shot of client 33:head:0.42245989304812837, middle:0.20454545454545456, tail0.0
3shot of client 34:head:0.4723926380368098, middle:0.10810810810810811, tail0.2
3shot of client 35:head:0.4260869565217391, middle:0.3, tail0.14285714285714285
3shot of client 36:head:0.5, middle:0.15217391304347827, tail0.09090909090909091
3shot of client 37:head:0.30808080808080807, middle:0.17777777777777778, tail0.09090909090909091
3shot of client 38:head:0.5694444444444444, middle:0.15789473684210525, tail0.0
3shot of client 39:head:0.4292929292929293, middle:0.24074074074074073, tail0.08333333333333333
round 29, local average test acc  0.3923 

round 29, local macro average F1 score  0.2228 

round 29, local weighted average F1 score  0.3919 

round 29, global test acc  0.1617 

round 29, average 3shot acc: [head: 0.4437, middle: 0.2564, tail: 0.0931] 

round 29, global 3shot acc: [head: 0.4520, middle: 0.1248, tail: 0.0350] 

l_head tensor([0.5878, 0.5772, 2.5021, 1.8369, 0.9664, 1.9238, 2.3525, 2.4681, 2.2437,
        0.5837, 1.5297, 0.5655, 0.5701, 1.6639, 1.7451, 1.8863, 1.4401, 0.5683,
        0.5817, 0.8876, 1.3311, 1.3738, 0.5796, 1.2840, 0.5813, 1.9964, 1.3629,
        2.4768, 1.0124, 0.5970, 1.5391, 1.6973, 1.1316, 1.8779, 0.9265, 0.5544,
        0.5943, 0.5853, 0.5795, 1.2703, 1.2318, 0.5808, 0.5845, 1.1668, 1.3503,
        0.5719, 0.9818, 0.5920, 1.2224, 1.1727, 0.5736, 1.0634, 0.5850, 1.1612,
        0.8972, 0.5725, 1.0380, 0.9724, 1.1007, 0.5651, 0.5773, 0.5936, 1.2583,
        0.5864, 0.5833, 0.5843, 0.5872, 1.2923, 0.5924, 1.1860, 0.5854, 1.1641,
        0.5650, 0.5677, 0.5812, 0.5864, 0.5951, 0.5911, 1.0199, 0.5748, 0.5788,
        0.5753, 0.5633, 0.5908, 0.5823, 0.5841, 0.5662, 1.1602, 0.5871, 0.5897,
        0.5837, 0.5849, 0.5884, 0.5683, 0.5849, 0.5841, 0.8637, 0.5773, 0.9607,
        1.2735], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.6816, 2.3388, 2.2858, 2.0654, 2.0527, 2.1634, 1.9909, 2.2557, 2.2201,
        2.1312, 1.9924, 1.8961, 1.9326, 2.1411, 1.8433, 1.7028, 1.6711, 1.8967,
        1.7057, 1.4507, 2.0486, 1.8484, 1.5568, 2.0483, 1.9524, 1.4699, 1.2408,
        1.1923, 1.4836, 1.6050, 1.7624, 1.3480, 1.3906, 1.3224, 1.2333, 1.3943,
        1.2278, 1.3293, 1.0403, 1.2185, 1.1642, 1.5525, 1.0593, 1.0439, 1.0887,
        1.0863, 1.1079, 1.3868, 1.2565, 1.4319, 0.9128, 0.8969, 1.3693, 1.2268,
        1.0732, 0.8247, 1.0175, 0.8716, 1.1356, 1.0897, 1.4554, 0.9704, 1.0146,
        0.8484, 0.7738, 0.7475, 0.7790, 1.0246, 0.9723, 0.8160, 0.8780, 1.0859,
        0.6840, 0.8575, 0.7709, 0.7377, 0.9481, 0.7351, 0.7988, 0.7891, 0.6796,
        0.6545, 0.8875, 0.8149, 0.7563, 0.6910, 0.7552, 0.6591, 0.6293, 0.7031,
        0.7555, 0.6287, 0.6758, 0.6757, 0.6793, 0.8773, 0.6813, 0.6358, 0.6891,
        0.7073], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([12.5589], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.5214723926380368, middle:0.42857142857142855, tail0.0
3shot of client 1:head:0.6408839779005525, middle:0.38095238095238093, tail0.0
3shot of client 2:head:0.3208955223880597, middle:0.17142857142857143, tail0.0
3shot of client 3:head:0.5232067510548524, middle:0.1935483870967742, tail0.0
3shot of client 4:head:0.5195530726256983, middle:0.2682926829268293, tail0.1
3shot of client 5:head:0.39622641509433965, middle:0.23076923076923078, tail0.0
3shot of client 6:head:0.48292682926829267, middle:0.12962962962962962, tail0.18181818181818182
3shot of client 7:head:0.40764331210191085, middle:0.175, tail0.1111111111111111
3shot of client 8:head:0.4962962962962963, middle:0.19444444444444445, tail0.25
3shot of client 9:head:0.45161290322580644, middle:0.11428571428571428, tail0.0
3shot of client 10:head:0.6355140186915887, middle:0.23076923076923078, tail0.16666666666666666
3shot of client 11:head:0.536, middle:0.21875, tail0.5
3shot of client 12:head:0.5478723404255319, middle:0.32, tail0.25
3shot of client 13:head:0.4017094017094017, middle:0.375, tail0.0
3shot of client 14:head:0.4873096446700508, middle:0.21428571428571427, tail0.0
3shot of client 15:head:0.37815126050420167, middle:0.3870967741935484, tail0.0
3shot of client 16:head:0.6748466257668712, middle:0.13513513513513514, tail0.0
3shot of client 17:head:0.5414012738853503, middle:0.17073170731707318, tail0.1
3shot of client 18:head:0.44360902255639095, middle:0.4067796610169492, tail0.11764705882352941
3shot of client 19:head:0.483739837398374, middle:0.3508771929824561, tail0.14285714285714285
3shot of client 20:head:0.45901639344262296, middle:0.10638297872340426, tail0.25
3shot of client 21:head:0.4085106382978723, middle:0.3220338983050847, tail0.0
3shot of client 22:head:0.5, middle:0.16666666666666666, tail0.1
3shot of client 23:head:0.32065217391304346, middle:0.10638297872340426, tail0.08333333333333333
3shot of client 24:head:0.35555555555555557, middle:0.02702702702702703, tail0.14285714285714285
3shot of client 25:head:0.484375, middle:0.3225806451612903, tail0.125
3shot of client 26:head:0.5128205128205128, middle:0.5357142857142857, tail0.14285714285714285
3shot of client 27:head:0.37777777777777777, middle:0.4375, tail0.0
3shot of client 28:head:0.4077669902912621, middle:0.14, tail0.0
3shot of client 29:head:0.5625, middle:0.3673469387755102, tail0.2727272727272727
3shot of client 30:head:0.3063063063063063, middle:0.5333333333333333, tail0.0
3shot of client 31:head:0.46632124352331605, middle:0.22448979591836735, tail0.0
3shot of client 32:head:0.21904761904761905, middle:0.24, tail0.3333333333333333
3shot of client 33:head:0.40106951871657753, middle:0.3409090909090909, tail0.0
3shot of client 34:head:0.5460122699386503, middle:0.2972972972972973, tail0.4
3shot of client 35:head:0.46956521739130436, middle:0.3333333333333333, tail0.14285714285714285
3shot of client 36:head:0.47126436781609193, middle:0.15217391304347827, tail0.18181818181818182
3shot of client 37:head:0.3383838383838384, middle:0.1111111111111111, tail0.09090909090909091
3shot of client 38:head:0.5763888888888888, middle:0.2631578947368421, tail0.0
3shot of client 39:head:0.48484848484848486, middle:0.2777777777777778, tail0.08333333333333333
round 30, local average test acc  0.4091 

round 30, local macro average F1 score  0.2241 

round 30, local weighted average F1 score  0.3939 

round 30, global test acc  0.1638 

round 30, average 3shot acc: [head: 0.4640, middle: 0.2600, tail: 0.1067] 

round 30, global 3shot acc: [head: 0.4476, middle: 0.1264, tail: 0.0406] 

l_head tensor([0.5878, 0.5772, 2.5021, 1.8369, 0.9664, 1.9238, 2.3525, 2.4681, 2.2437,
        0.5837, 1.5297, 0.5655, 0.5701, 1.6639, 1.7451, 1.8863, 1.4401, 0.5683,
        0.5817, 0.8876, 1.3311, 1.3738, 0.5796, 1.2840, 0.5813, 1.9964, 1.3629,
        2.4768, 1.0124, 0.5970, 1.5391, 1.6973, 1.1316, 1.8779, 0.9265, 0.5544,
        0.5943, 0.5853, 0.5795, 1.2703, 1.2318, 0.5808, 0.5845, 1.1668, 1.3503,
        0.5719, 0.9818, 0.5920, 1.2224, 1.1727, 0.5736, 1.0634, 0.5850, 1.1612,
        0.8972, 0.5725, 1.0380, 0.9724, 1.1007, 0.5651, 0.5773, 0.5936, 1.2583,
        0.5864, 0.5833, 0.5843, 0.5872, 1.2923, 0.5924, 1.1860, 0.5854, 1.1641,
        0.5650, 0.5677, 0.5812, 0.5864, 0.5951, 0.5911, 1.0199, 0.5748, 0.5788,
        0.5753, 0.5633, 0.5908, 0.5823, 0.5841, 0.5662, 1.1602, 0.5871, 0.5897,
        0.5837, 0.5849, 0.5884, 0.5683, 0.5849, 0.5841, 0.8637, 0.5773, 0.9607,
        1.2735], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.7006, 2.3817, 2.2670, 2.1007, 2.1317, 2.1959, 2.0975, 2.3295, 2.2970,
        2.1511, 2.0096, 1.9632, 1.9786, 2.1602, 1.8756, 1.7414, 1.7325, 1.9889,
        1.7425, 1.4957, 2.1159, 1.9025, 1.6037, 2.0537, 1.9625, 1.4990, 1.2498,
        1.2113, 1.5042, 1.5969, 1.7795, 1.4282, 1.4405, 1.3580, 1.2616, 1.4240,
        1.3065, 1.3746, 1.0669, 1.2803, 1.2591, 1.5578, 1.1000, 1.0757, 1.0973,
        1.1413, 1.1825, 1.3835, 1.2898, 1.4846, 0.9346, 0.9094, 1.4531, 1.2132,
        1.0733, 0.8407, 1.0625, 0.9203, 1.1526, 1.0934, 1.4835, 1.0174, 1.0679,
        0.8838, 0.8066, 0.7840, 0.7785, 1.0606, 1.0005, 0.8761, 0.8894, 1.0882,
        0.7131, 0.8714, 0.7647, 0.7438, 0.9601, 0.7611, 0.7954, 0.7906, 0.6840,
        0.6521, 0.9331, 0.8142, 0.7680, 0.6960, 0.7823, 0.6590, 0.6403, 0.7005,
        0.7541, 0.6365, 0.6763, 0.6876, 0.6892, 0.8991, 0.6810, 0.6408, 0.6916,
        0.7064], device='cuda:4', grad_fn=<NormBackward1>)  6%|         | 31/500 [1:09:42<19:13:32, 147.58s/it]  6%|         | 32/500 [1:12:36<20:11:45, 155.35s/it]
The value of constant scaler:  tensor([12.7865], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.44785276073619634, middle:0.37142857142857144, tail0.0
3shot of client 1:head:0.585635359116022, middle:0.30952380952380953, tail0.09090909090909091
3shot of client 2:head:0.3358208955223881, middle:0.22857142857142856, tail0.0
3shot of client 3:head:0.459915611814346, middle:0.1774193548387097, tail0.06666666666666667
3shot of client 4:head:0.5195530726256983, middle:0.2682926829268293, tail0.1
3shot of client 5:head:0.41509433962264153, middle:0.3076923076923077, tail0.0
3shot of client 6:head:0.4634146341463415, middle:0.16666666666666666, tail0.36363636363636365
3shot of client 7:head:0.39490445859872614, middle:0.175, tail0.1111111111111111
3shot of client 8:head:0.4740740740740741, middle:0.3888888888888889, tail0.25
3shot of client 9:head:0.4967741935483871, middle:0.08571428571428572, tail0.2
3shot of client 10:head:0.5981308411214953, middle:0.23076923076923078, tail0.16666666666666666
3shot of client 11:head:0.552, middle:0.25, tail0.5
3shot of client 12:head:0.574468085106383, middle:0.28, tail0.08333333333333333
3shot of client 13:head:0.4017094017094017, middle:0.375, tail0.14285714285714285
3shot of client 14:head:0.5126903553299492, middle:0.23809523809523808, tail0.0
3shot of client 15:head:0.40336134453781514, middle:0.3225806451612903, tail0.0
3shot of client 16:head:0.7300613496932515, middle:0.1891891891891892, tail0.0
3shot of client 17:head:0.5796178343949044, middle:0.21951219512195122, tail0.1
3shot of client 18:head:0.43609022556390975, middle:0.2542372881355932, tail0.23529411764705882
3shot of client 19:head:0.43089430894308944, middle:0.2982456140350877, tail0.14285714285714285
3shot of client 20:head:0.3770491803278688, middle:0.0851063829787234, tail0.08333333333333333
3shot of client 21:head:0.39148936170212767, middle:0.4067796610169492, tail0.07692307692307693
3shot of client 22:head:0.5253164556962026, middle:0.25, tail0.1
3shot of client 23:head:0.29891304347826086, middle:0.14893617021276595, tail0.16666666666666666
3shot of client 24:head:0.26666666666666666, middle:0.08108108108108109, tail0.14285714285714285
3shot of client 25:head:0.578125, middle:0.3225806451612903, tail0.125
3shot of client 26:head:0.49572649572649574, middle:0.5357142857142857, tail0.14285714285714285
3shot of client 27:head:0.43703703703703706, middle:0.46875, tail0.0
3shot of client 28:head:0.4563106796116505, middle:0.2, tail0.0
3shot of client 29:head:0.5865384615384616, middle:0.3469387755102041, tail0.18181818181818182
3shot of client 30:head:0.2972972972972973, middle:0.5666666666666667, tail0.0
3shot of client 31:head:0.43523316062176165, middle:0.24489795918367346, tail0.0
3shot of client 32:head:0.24761904761904763, middle:0.24, tail0.16666666666666666
3shot of client 33:head:0.45454545454545453, middle:0.2727272727272727, tail0.08333333333333333
3shot of client 34:head:0.44785276073619634, middle:0.24324324324324326, tail0.2
3shot of client 35:head:0.45217391304347826, middle:0.3, tail0.0
3shot of client 36:head:0.5689655172413793, middle:0.30434782608695654, tail0.0
3shot of client 37:head:0.5202020202020202, middle:0.37777777777777777, tail0.2727272727272727
3shot of client 38:head:0.6180555555555556, middle:0.23684210526315788, tail0.0
3shot of client 39:head:0.4090909090909091, middle:0.18518518518518517, tail0.0
round 31, local average test acc  0.4142 

round 31, local macro average F1 score  0.2393 

round 31, local weighted average F1 score  0.3856 

round 31, global test acc  0.1646 

round 31, average 3shot acc: [head: 0.4669, middle: 0.2739, tail: 0.1074] 

round 31, global 3shot acc: [head: 0.4636, middle: 0.1188, tail: 0.0380] 

l_head tensor([0.5878, 0.5772, 2.5021, 1.8369, 0.9664, 1.9238, 2.3525, 2.4681, 2.2437,
        0.5837, 1.5297, 0.5655, 0.5701, 1.6639, 1.7451, 1.8863, 1.4401, 0.5683,
        0.5817, 0.8876, 1.3311, 1.3738, 0.5796, 1.2840, 0.5813, 1.9964, 1.3629,
        2.4768, 1.0124, 0.5970, 1.5391, 1.6973, 1.1316, 1.8779, 0.9265, 0.5544,
        0.5943, 0.5853, 0.5795, 1.2703, 1.2318, 0.5808, 0.5845, 1.1668, 1.3503,
        0.5719, 0.9818, 0.5920, 1.2224, 1.1727, 0.5736, 1.0634, 0.5850, 1.1612,
        0.8972, 0.5725, 1.0380, 0.9724, 1.1007, 0.5651, 0.5773, 0.5936, 1.2583,
        0.5864, 0.5833, 0.5843, 0.5872, 1.2923, 0.5924, 1.1860, 0.5854, 1.1641,
        0.5650, 0.5677, 0.5812, 0.5864, 0.5951, 0.5911, 1.0199, 0.5748, 0.5788,
        0.5753, 0.5633, 0.5908, 0.5823, 0.5841, 0.5662, 1.1602, 0.5871, 0.5897,
        0.5837, 0.5849, 0.5884, 0.5683, 0.5849, 0.5841, 0.8637, 0.5773, 0.9607,
        1.2735], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.7546, 2.4321, 2.3372, 2.1502, 2.2458, 2.2488, 2.1477, 2.3386, 2.3578,
        2.2715, 2.0592, 2.0199, 2.0061, 2.2603, 1.9667, 1.7431, 1.8124, 2.0417,
        1.7857, 1.5653, 2.1754, 1.9532, 1.6722, 2.0501, 2.0230, 1.5658, 1.2731,
        1.2567, 1.5538, 1.6832, 1.8586, 1.4719, 1.4426, 1.3948, 1.3362, 1.4386,
        1.3719, 1.4240, 1.0842, 1.2985, 1.3080, 1.6145, 1.0970, 1.1029, 1.1074,
        1.1694, 1.2142, 1.4258, 1.3586, 1.4958, 0.9760, 0.9695, 1.4713, 1.2438,
        1.1010, 0.8598, 1.1122, 0.9521, 1.1674, 1.1472, 1.4967, 1.0368, 1.1113,
        0.8997, 0.8213, 0.7822, 0.7889, 1.0643, 1.0191, 0.9098, 0.9289, 1.1215,
        0.7196, 0.8925, 0.7688, 0.7422, 0.9760, 0.7784, 0.8015, 0.8073, 0.6936,
        0.6633, 0.9576, 0.8106, 0.7760, 0.7100, 0.7975, 0.6590, 0.6537, 0.7177,
        0.7532, 0.6351, 0.6772, 0.6984, 0.7039, 0.9109, 0.6862, 0.6522, 0.6907,
        0.7058], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([12.9620], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.50920245398773, middle:0.34285714285714286, tail0.0
3shot of client 1:head:0.5911602209944752, middle:0.35714285714285715, tail0.36363636363636365
3shot of client 2:head:0.23880597014925373, middle:0.22857142857142856, tail0.0
3shot of client 3:head:0.4810126582278481, middle:0.22580645161290322, tail0.06666666666666667
3shot of client 4:head:0.5139664804469274, middle:0.3170731707317073, tail0.1
3shot of client 5:head:0.42452830188679247, middle:0.23076923076923078, tail0.0
3shot of client 6:head:0.44878048780487806, middle:0.24074074074074073, tail0.18181818181818182
3shot of client 7:head:0.39490445859872614, middle:0.225, tail0.1111111111111111
3shot of client 8:head:0.5037037037037037, middle:0.3333333333333333, tail0.25
3shot of client 9:head:0.44516129032258067, middle:0.14285714285714285, tail0.1
3shot of client 10:head:0.6728971962616822, middle:0.23076923076923078, tail0.16666666666666666
3shot of client 11:head:0.528, middle:0.25, tail0.625
3shot of client 12:head:0.5478723404255319, middle:0.3, tail0.25
3shot of client 13:head:0.41025641025641024, middle:0.4375, tail0.0
3shot of client 14:head:0.5076142131979695, middle:0.21428571428571427, tail0.08333333333333333
3shot of client 15:head:0.42857142857142855, middle:0.25806451612903225, tail0.2857142857142857
3shot of client 16:head:0.6993865030674846, middle:0.21621621621621623, tail0.0
3shot of client 17:head:0.4968152866242038, middle:0.2926829268292683, tail0.3
3shot of client 18:head:0.42105263157894735, middle:0.2542372881355932, tail0.23529411764705882
3shot of client 19:head:0.4105691056910569, middle:0.40350877192982454, tail0.07142857142857142
3shot of client 20:head:0.4098360655737705, middle:0.0851063829787234, tail0.16666666666666666
3shot of client 21:head:0.46808510638297873, middle:0.4067796610169492, tail0.0
3shot of client 22:head:0.5506329113924051, middle:0.19444444444444445, tail0.0
3shot of client 23:head:0.3423913043478261, middle:0.14893617021276595, tail0.08333333333333333
3shot of client 24:head:0.2518518518518518, middle:0.08108108108108109, tail0.14285714285714285
3shot of client 25:head:0.5859375, middle:0.2903225806451613, tail0.125
3shot of client 26:head:0.48717948717948717, middle:0.5, tail0.2857142857142857
3shot of client 27:head:0.37777777777777777, middle:0.5625, tail0.14285714285714285
3shot of client 28:head:0.44660194174757284, middle:0.12, tail0.0
3shot of client 29:head:0.5576923076923077, middle:0.3673469387755102, tail0.18181818181818182  7%|         | 33/500 [1:27:25<48:41:23, 375.34s/it]
3shot of client 30:head:0.35135135135135137, middle:0.3, tail0.16666666666666666
3shot of client 31:head:0.5077720207253886, middle:0.20408163265306123, tail0.0
3shot of client 32:head:0.2571428571428571, middle:0.24, tail0.3333333333333333
3shot of client 33:head:0.45989304812834225, middle:0.4772727272727273, tail0.0
3shot of client 34:head:0.4785276073619632, middle:0.24324324324324326, tail0.2
3shot of client 35:head:0.5043478260869565, middle:0.3, tail0.14285714285714285
3shot of client 36:head:0.5574712643678161, middle:0.2608695652173913, tail0.0
3shot of client 37:head:0.5303030303030303, middle:0.4, tail0.2727272727272727
3shot of client 38:head:0.6319444444444444, middle:0.15789473684210525, tail0.0
3shot of client 39:head:0.4595959595959596, middle:0.18518518518518517, tail0.0
round 32, local average test acc  0.4198 

round 32, local macro average F1 score  0.2512 

round 32, local weighted average F1 score  0.4032 

round 32, global test acc  0.1775 

round 32, average 3shot acc: [head: 0.4723, middle: 0.2757, tail: 0.1359] 

round 32, global 3shot acc: [head: 0.4664, middle: 0.1472, tail: 0.0482] 

l_head tensor([0.5878, 0.5772, 2.6889, 1.9025, 1.1473, 2.1017, 2.4490, 2.6429, 2.6917,
        0.5838, 1.6933, 0.5655, 0.5701, 1.8030, 2.0154, 2.1255, 1.7382, 0.5683,
        0.5817, 0.9661, 1.5170, 1.5468, 0.5796, 1.4556, 0.5813, 2.2499, 1.5281,
        2.6713, 1.1478, 0.5970, 1.6967, 1.9123, 1.3172, 2.0789, 1.0272, 0.5544,
        0.5943, 0.5853, 0.5795, 1.4574, 1.4091, 0.5808, 0.5845, 1.3562, 1.4703,
        0.5719, 1.1361, 0.5920, 1.3882, 1.4036, 0.5736, 1.1171, 0.5850, 1.3069,
        1.0482, 0.5725, 1.1973, 1.0945, 1.2286, 0.5651, 0.5773, 0.5936, 1.3507,
        0.5864, 0.5833, 0.5843, 0.5872, 1.5348, 0.5924, 1.3450, 0.5854, 1.3212,
        0.5650, 0.5677, 0.5813, 0.5864, 0.5951, 0.5912, 1.1670, 0.5748, 0.5788,
        0.5753, 0.5633, 0.5908, 0.5823, 0.5842, 0.5662, 1.3373, 0.5871, 0.5897,
        0.5838, 0.5849, 0.5884, 0.5683, 0.5849, 0.5842, 1.0063, 0.5773, 1.1409,
        1.4010], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.8041, 2.4456, 2.4360, 2.1995, 2.2087, 2.2910, 2.1138, 2.3739, 2.4951,
        2.3325, 2.1193, 2.0140, 2.0562, 2.2828, 1.9657, 1.7862, 1.8609, 2.0600,
        1.8155, 1.6291, 2.1997, 2.0028, 1.7155, 2.1036, 2.0794, 1.6182, 1.3028,
        1.3055, 1.6386, 1.7432, 1.8777, 1.4670, 1.4496, 1.4666, 1.3709, 1.4596,
        1.4379, 1.4409, 1.1018, 1.3487, 1.3483, 1.6378, 1.1316, 1.1264, 1.1332,
        1.2248, 1.2554, 1.4782, 1.3962, 1.5442, 0.9949, 0.9761, 1.4984, 1.3338,
        1.1449, 0.9018, 1.1742, 0.9696, 1.1834, 1.1782, 1.5220, 1.0599, 1.1250,
        0.9133, 0.8264, 0.7881, 0.7921, 1.0815, 1.0454, 0.9131, 0.9665, 1.1712,
        0.7277, 0.9058, 0.7784, 0.7685, 0.9747, 0.8084, 0.8545, 0.8179, 0.7040,
        0.6696, 0.9674, 0.8341, 0.7916, 0.7242, 0.8178, 0.6714, 0.6658, 0.7206,
        0.7526, 0.6343, 0.6790, 0.7170, 0.7026, 0.9176, 0.6974, 0.6688, 0.6953,
        0.7126], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([13.1531], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.4785276073619632, middle:0.3142857142857143, tail0.0
3shot of client 1:head:0.574585635359116, middle:0.35714285714285715, tail0.09090909090909091
3shot of client 2:head:0.291044776119403, middle:0.22857142857142856, tail0.0
3shot of client 3:head:0.48945147679324896, middle:0.1935483870967742, tail0.06666666666666667
3shot of client 4:head:0.44692737430167595, middle:0.3902439024390244, tail0.3
3shot of client 5:head:0.41509433962264153, middle:0.19230769230769232, tail0.0
3shot of client 6:head:0.43414634146341463, middle:0.2222222222222222, tail0.18181818181818182
3shot of client 7:head:0.40764331210191085, middle:0.2, tail0.2222222222222222
3shot of client 8:head:0.5407407407407407, middle:0.2222222222222222, tail0.25
3shot of client 9:head:0.49032258064516127, middle:0.2, tail0.1
3shot of client 10:head:0.616822429906542, middle:0.3076923076923077, tail0.16666666666666666
3shot of client 11:head:0.6, middle:0.15625, tail0.375
3shot of client 12:head:0.526595744680851, middle:0.3, tail0.3333333333333333
3shot of client 13:head:0.38461538461538464, middle:0.375, tail0.0
3shot of client 14:head:0.5228426395939086, middle:0.23809523809523808, tail0.08333333333333333
3shot of client 15:head:0.5294117647058824, middle:0.22580645161290322, tail0.14285714285714285
3shot of client 16:head:0.6319018404907976, middle:0.2702702702702703, tail0.1
3shot of client 17:head:0.5286624203821656, middle:0.3170731707317073, tail0.3
3shot of client 18:head:0.44360902255639095, middle:0.3389830508474576, tail0.29411764705882354
3shot of client 19:head:0.42276422764227645, middle:0.3684210526315789, tail0.14285714285714285
3shot of client 20:head:0.39344262295081966, middle:0.0851063829787234, tail0.08333333333333333
3shot of client 21:head:0.4425531914893617, middle:0.4067796610169492, tail0.0
3shot of client 22:head:0.5189873417721519, middle:0.2222222222222222, tail0.0
3shot of client 23:head:0.358695652173913, middle:0.1702127659574468, tail0.0
3shot of client 24:head:0.2740740740740741, middle:0.08108108108108109, tail0.14285714285714285
3shot of client 25:head:0.5546875, middle:0.3225806451612903, tail0.0
3shot of client 26:head:0.49572649572649574, middle:0.6071428571428571, tail0.14285714285714285
3shot of client 27:head:0.4, middle:0.46875, tail0.0
3shot of client 28:head:0.5145631067961165, middle:0.14, tail0.0
3shot of client 29:head:0.5625, middle:0.3877551020408163, tail0.18181818181818182
3shot of client 30:head:0.34234234234234234, middle:0.3, tail0.0
3shot of client 31:head:0.48186528497409326, middle:0.24489795918367346, tail0.18181818181818182
3shot of client 32:head:0.26666666666666666, middle:0.24, tail0.16666666666666666
3shot of client 33:head:0.44919786096256686, middle:0.3409090909090909, tail0.08333333333333333
3shot of client 34:head:0.5521472392638037, middle:0.32432432432432434, tail0.3
3shot of client 35:head:0.4956521739130435, middle:0.3, tail0.2857142857142857
3shot of client 36:head:0.5574712643678161, middle:0.2391304347826087, tail0.0
3shot of client 37:head:0.48484848484848486, middle:0.4222222222222222, tail0.2727272727272727
3shot of client 38:head:0.6597222222222222, middle:0.18421052631578946, tail0.2222222222222222
3shot of client 39:head:0.42424242424242425, middle:0.2222222222222222, tail0.16666666666666666
round 33, local average test acc  0.4221 

round 33, local macro average F1 score  0.2370 

round 33, local weighted average F1 score  0.3978 

round 33, global test acc  0.1779 

round 33, average 3shot acc: [head: 0.4751, middle: 0.2782, tail: 0.1345] 

round 33, global 3shot acc: [head: 0.4852, middle: 0.1432, tail: 0.0416] 

l_head tensor([0.5878, 0.5772, 2.6889, 1.9025, 1.1473, 2.1017, 2.4490, 2.6429, 2.6917,
        0.5838, 1.6933, 0.5655, 0.5701, 1.8030, 2.0154, 2.1255, 1.7382, 0.5683,
        0.5817, 0.9661, 1.5170, 1.5468, 0.5796, 1.4556, 0.5813, 2.2499, 1.5281,
        2.6713, 1.1478, 0.5970, 1.6967, 1.9123, 1.3172, 2.0789, 1.0272, 0.5544,
        0.5943, 0.5853, 0.5795, 1.4574, 1.4091, 0.5808, 0.5845, 1.3562, 1.4703,
        0.5719, 1.1361, 0.5920, 1.3882, 1.4036, 0.5736, 1.1171, 0.5850, 1.3069,
        1.0482, 0.5725, 1.1973, 1.0945, 1.2286, 0.5651, 0.5773, 0.5936, 1.3507,
        0.5864, 0.5833, 0.5843, 0.5872, 1.5348, 0.5924, 1.3450, 0.5854, 1.3212,
        0.5650, 0.5677, 0.5813, 0.5864, 0.5951, 0.5912, 1.1670, 0.5748, 0.5788,
        0.5753, 0.5633, 0.5908, 0.5823, 0.5842, 0.5662, 1.3373, 0.5871, 0.5897,
        0.5838, 0.5849, 0.5884, 0.5683, 0.5849, 0.5842, 1.0063, 0.5773, 1.1409,
        1.4010], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.8253, 2.5157, 2.4257, 2.2223, 2.2579, 2.4024, 2.1524, 2.4221, 2.5713,
        2.3687, 2.1193, 2.0315, 2.1129, 2.3094, 1.9712, 1.7993, 1.9307, 2.1221,
        1.8354, 1.7260, 2.3052, 2.0431, 1.8096, 2.0986, 2.1355, 1.6543, 1.3477,
        1.3348, 1.7022, 1.7940, 1.8897, 1.4959, 1.4535, 1.5270, 1.3829, 1.4835,
        1.4658, 1.4759, 1.1215, 1.4272, 1.4141, 1.6967, 1.1768, 1.1818, 1.1646,
        1.2293, 1.3011, 1.5125, 1.4318, 1.5687, 0.9966, 0.9972, 1.5065, 1.3390,
        1.1546, 0.9182, 1.2274, 0.9987, 1.2210, 1.1883, 1.5897, 1.0954, 1.1512,
        0.9514, 0.8422, 0.8231, 0.7924, 1.1409, 1.0612, 0.9214, 0.9913, 1.1689,
        0.7412, 0.9164, 0.7958, 0.7835, 1.0079, 0.8238, 0.8659, 0.8360, 0.7081,
        0.6833, 0.9825, 0.8329, 0.7931, 0.7511, 0.8235, 0.6710, 0.6937, 0.7299,
        0.7618, 0.6434, 0.6862, 0.7242, 0.7244, 0.9235, 0.7057, 0.6798, 0.6944,
        0.7119], device='cuda:4', grad_fn=<NormBackward1>)  7%|         | 34/500 [1:42:17<68:40:25, 530.53s/it]  7%|         | 35/500 [1:57:05<82:21:26, 637.60s/it]
The value of constant scaler:  tensor([13.3494], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.5276073619631901, middle:0.37142857142857144, tail0.0
3shot of client 1:head:0.5911602209944752, middle:0.30952380952380953, tail0.18181818181818182
3shot of client 2:head:0.2537313432835821, middle:0.22857142857142856, tail0.0
3shot of client 3:head:0.5569620253164557, middle:0.25806451612903225, tail0.13333333333333333
3shot of client 4:head:0.49162011173184356, middle:0.2682926829268293, tail0.2
3shot of client 5:head:0.42452830188679247, middle:0.15384615384615385, tail0.0
3shot of client 6:head:0.4926829268292683, middle:0.2037037037037037, tail0.18181818181818182
3shot of client 7:head:0.47770700636942676, middle:0.2, tail0.1111111111111111
3shot of client 8:head:0.5333333333333333, middle:0.2222222222222222, tail0.25
3shot of client 9:head:0.4645161290322581, middle:0.22857142857142856, tail0.1
3shot of client 10:head:0.5887850467289719, middle:0.38461538461538464, tail0.16666666666666666
3shot of client 11:head:0.64, middle:0.15625, tail0.375
3shot of client 12:head:0.5372340425531915, middle:0.36, tail0.3333333333333333
3shot of client 13:head:0.39316239316239315, middle:0.46875, tail0.0
3shot of client 14:head:0.49746192893401014, middle:0.2857142857142857, tail0.08333333333333333
3shot of client 15:head:0.5210084033613446, middle:0.1935483870967742, tail0.0
3shot of client 16:head:0.6073619631901841, middle:0.32432432432432434, tail0.1
3shot of client 17:head:0.47770700636942676, middle:0.3170731707317073, tail0.3
3shot of client 18:head:0.44360902255639095, middle:0.3898305084745763, tail0.11764705882352941
3shot of client 19:head:0.483739837398374, middle:0.19298245614035087, tail0.07142857142857142
3shot of client 20:head:0.4207650273224044, middle:0.14893617021276595, tail0.08333333333333333
3shot of client 21:head:0.48936170212765956, middle:0.3728813559322034, tail0.0
3shot of client 22:head:0.6075949367088608, middle:0.19444444444444445, tail0.1
3shot of client 23:head:0.3695652173913043, middle:0.2127659574468085, tail0.0
3shot of client 24:head:0.43703703703703706, middle:0.1891891891891892, tail0.14285714285714285
3shot of client 25:head:0.5625, middle:0.25806451612903225, tail0.125
3shot of client 26:head:0.5128205128205128, middle:0.5357142857142857, tail0.14285714285714285
3shot of client 27:head:0.3925925925925926, middle:0.46875, tail0.0
3shot of client 28:head:0.5048543689320388, middle:0.18, tail0.0
3shot of client 29:head:0.5721153846153846, middle:0.3877551020408163, tail0.09090909090909091
3shot of client 30:head:0.27927927927927926, middle:0.4666666666666667, tail0.16666666666666666
3shot of client 31:head:0.49222797927461137, middle:0.2653061224489796, tail0.09090909090909091
3shot of client 32:head:0.2857142857142857, middle:0.24, tail0.3333333333333333
3shot of client 33:head:0.4385026737967914, middle:0.3409090909090909, tail0.08333333333333333
3shot of client 34:head:0.6073619631901841, middle:0.2972972972972973, tail0.3
3shot of client 35:head:0.4608695652173913, middle:0.36666666666666664, tail0.14285714285714285
3shot of client 36:head:0.3620689655172414, middle:0.08695652173913043, tail0.18181818181818182
3shot of client 37:head:0.4797979797979798, middle:0.37777777777777777, tail0.36363636363636365
3shot of client 38:head:0.6736111111111112, middle:0.18421052631578946, tail0.1111111111111111
3shot of client 39:head:0.4444444444444444, middle:0.24074074074074073, tail0.25
round 34, local average test acc  0.4309 

round 34, local macro average F1 score  0.2444 

round 34, local weighted average F1 score  0.4166 

round 34, global test acc  0.1825 

round 34, average 3shot acc: [head: 0.4849, middle: 0.2833, tail: 0.1354] 

round 34, global 3shot acc: [head: 0.4876, middle: 0.1624, tail: 0.0400] 

l_head tensor([0.5878, 0.5772, 2.6889, 1.9025, 1.1473, 2.1017, 2.4490, 2.6429, 2.6917,
        0.5838, 1.6933, 0.5655, 0.5701, 1.8030, 2.0154, 2.1255, 1.7382, 0.5683,
        0.5817, 0.9661, 1.5170, 1.5468, 0.5796, 1.4556, 0.5813, 2.2499, 1.5281,
        2.6713, 1.1478, 0.5970, 1.6967, 1.9123, 1.3172, 2.0789, 1.0272, 0.5544,
        0.5943, 0.5853, 0.5795, 1.4574, 1.4091, 0.5808, 0.5845, 1.3562, 1.4703,
        0.5719, 1.1361, 0.5920, 1.3882, 1.4036, 0.5736, 1.1171, 0.5850, 1.3069,
        1.0482, 0.5725, 1.1973, 1.0945, 1.2286, 0.5651, 0.5773, 0.5936, 1.3507,
        0.5864, 0.5833, 0.5843, 0.5872, 1.5348, 0.5924, 1.3450, 0.5854, 1.3212,
        0.5650, 0.5677, 0.5813, 0.5864, 0.5951, 0.5912, 1.1670, 0.5748, 0.5788,
        0.5753, 0.5633, 0.5908, 0.5823, 0.5842, 0.5662, 1.3373, 0.5871, 0.5897,
        0.5838, 0.5849, 0.5884, 0.5683, 0.5849, 0.5842, 1.0063, 0.5773, 1.1409,
        1.4010], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([2.8644, 2.5489, 2.5087, 2.2728, 2.3140, 2.3947, 2.1821, 2.4937, 2.6052,
        2.3978, 2.2437, 2.0921, 2.1847, 2.3159, 2.0867, 1.8920, 1.9756, 2.1533,
        1.9149, 1.7044, 2.3320, 2.0883, 1.8352, 2.1788, 2.1758, 1.6749, 1.3699,
        1.3490, 1.7848, 1.8238, 1.9359, 1.5721, 1.5491, 1.5498, 1.4415, 1.5486,
        1.5031, 1.5326, 1.1491, 1.4494, 1.4452, 1.7343, 1.2326, 1.2127, 1.2074,
        1.2671, 1.3439, 1.6115, 1.4699, 1.5838, 1.0351, 1.0181, 1.5528, 1.3888,
        1.1696, 0.9490, 1.2334, 1.0072, 1.2559, 1.1968, 1.6261, 1.1502, 1.1488,
        0.9796, 0.8622, 0.8551, 0.8100, 1.1864, 1.0569, 0.9465, 1.0192, 1.1827,
        0.7567, 0.9294, 0.8097, 0.7975, 1.0251, 0.8465, 0.8872, 0.8476, 0.7021,
        0.6824, 1.0174, 0.8661, 0.8192, 0.7516, 0.8429, 0.6794, 0.6879, 0.7514,
        0.7761, 0.6584, 0.6979, 0.7306, 0.7299, 0.9554, 0.7152, 0.6781, 0.7021,
        0.7270], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([13.5081], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.50920245398773, middle:0.4, tail0.0
3shot of client 1:head:0.5966850828729282, middle:0.3333333333333333, tail0.18181818181818182
3shot of client 2:head:0.2462686567164179, middle:0.22857142857142856, tail0.0
3shot of client 3:head:0.48523206751054854, middle:0.24193548387096775, tail0.13333333333333333
3shot of client 4:head:0.4692737430167598, middle:0.2926829268292683, tail0.3
3shot of client 5:head:0.24528301886792453, middle:0.19230769230769232, tail0.0
3shot of client 6:head:0.5024390243902439, middle:0.14814814814814814, tail0.36363636363636365
3shot of client 7:head:0.47770700636942676, middle:0.25, tail0.1111111111111111
3shot of client 8:head:0.5777777777777777, middle:0.25, tail0.25
3shot of client 9:head:0.41935483870967744, middle:0.2857142857142857, tail0.3
3shot of client 10:head:0.6448598130841121, middle:0.3076923076923077, tail0.16666666666666666
3shot of client 11:head:0.608, middle:0.25, tail0.375
3shot of client 12:head:0.5585106382978723, middle:0.36, tail0.4166666666666667
3shot of client 13:head:0.3333333333333333, middle:0.40625, tail0.0
3shot of client 14:head:0.4619289340101523, middle:0.3333333333333333, tail0.25
3shot of client 15:head:0.4789915966386555, middle:0.2903225806451613, tail0.0
3shot of client 16:head:0.6993865030674846, middle:0.32432432432432434, tail0.1
3shot of client 17:head:0.4585987261146497, middle:0.3170731707317073, tail0.2
3shot of client 18:head:0.45112781954887216, middle:0.3898305084745763, tail0.058823529411764705
3shot of client 19:head:0.491869918699187, middle:0.21052631578947367, tail0.07142857142857142
3shot of client 20:head:0.43169398907103823, middle:0.10638297872340426, tail0.08333333333333333
3shot of client 21:head:0.4808510638297872, middle:0.4576271186440678, tail0.0
3shot of client 22:head:0.5443037974683544, middle:0.3055555555555556, tail0.3
3shot of client 23:head:0.3641304347826087, middle:0.1702127659574468, tail0.08333333333333333
3shot of client 24:head:0.48148148148148145, middle:0.24324324324324326, tail0.2857142857142857
3shot of client 25:head:0.53125, middle:0.3225806451612903, tail0.125
3shot of client 26:head:0.5299145299145299, middle:0.5714285714285714, tail0.2857142857142857
3shot of client 27:head:0.4148148148148148, middle:0.625, tail0.2857142857142857
3shot of client 28:head:0.5388349514563107, middle:0.26, tail0.0
3shot of client 29:head:0.5913461538461539, middle:0.40816326530612246, tail0.2727272727272727  7%|         | 36/500 [2:12:08<92:27:13, 717.31s/it]
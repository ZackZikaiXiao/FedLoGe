nohup: ignoring input
./temp/fl_acc_cifar100_resnet34_cons_frac0.3_iidFalse_iter500_ep5_lr0.03_N40_100_seed3407_p1_dirichlet0.5_IF0.01_LossCE.txt
Files already downloaded and verified
[500, 477, 455, 434, 415, 396, 378, 361, 344, 328, 314, 299, 286, 273, 260, 248, 237, 226, 216, 206, 197, 188, 179, 171, 163, 156, 149, 142, 135, 129, 123, 118, 112, 107, 102, 98, 93, 89, 85, 81, 77, 74, 70, 67, 64, 61, 58, 56, 53, 51, 48, 46, 44, 42, 40, 38, 36, 35, 33, 32, 30, 29, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 15, 14, 13, 13, 12, 12, 11, 11, 10, 10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5]
10847
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[264, 285, 233, 378, 283, 185, 318, 263, 231, 256, 187, 218, 317, 207, 306, 213, 270, 263, 406, 383, 297, 368, 255, 297, 233, 224, 202, 230, 330, 325, 196, 315, 186, 299, 265, 199, 289, 305, 244, 322]
training set distribution:
[[ 0  0 27 14  2  9 15 24 24  0  4  0  0  5  9 11  4  0  0  1  3  4  0  3
   0 14  4 27  2  0  6  7  3  9  1  0  0  0  0  2  2  0  0  2  2  0  1  0
   2  1  0  1  0  1  1  0  1  1  1  0  0  0  1  0  0  0  0  2  0  3  0  1
   0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0
   1  0  1  2]
 [70  0 40  1 21  0  6  0 19 29  0  2 12  0 21  1  0  2  3  2  1  1  5  1
   0  2  2  1  1  0  0  2  1  1  0  0  2  2  0  1  0  0  0  0  0  5  0  0
   0  9  0  5  1  0  0  0  0  0  0  7  0  0  0  1  0  0  1  0  0  1  0  0
   0  0  0  0  0  0  0  0  1  0  0  2  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [11  2 10  9  4  7  1  0 20  0  4  6  3  0  3  3  3 14  6  3 11  5  1  3
   0 12 15  0  0  1  4  1  0  2  0  2  5  1  0  2  0  9  0  2  2  8  0  0
   0  5  0  0  3  0  0  2  0  0  4  1  0  0  0  0  4  1  3  1  0  0  0  1
   0  2  0  4  0  2  1  0  0  0  1  0  0  0  1  0  0  0  0  0  1  0  0  0
   0  0  1  0]
 [ 0  7 12 54  6  1 76 52  2 13  2 12 10  0  4  2  0  0  7  0 10 10  2  0
   3  4  3  0  0  1  0  7  5  5  2  0  2  2 22  2  0  1  4  0  0  0  0  0
   0  4  4  0  6  2  1  3  0  0  0  2  1  0  0  0  1  2  0  1  1  1  0  1
   0  0  0  0  0  1  0  0  0  0  1  0  0  0  1  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [12 27 41  0 13  1  1  6  5  0  0 27  5 12 14 10  0  3  0  0 20  0  4  0
   1  1  0  0  9  1 11 10  0  0  0  1  1 14  0  1  0  0  3  2  2  4  0  4
   0  0  1  0  0  1  0  3  1  0  1  0  1  0  0  0  0  2  0  3  0  0  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  1  0
   0  0  0  0]
 [ 0  1  0 14  3  1 37  2 10  2  0  5  0  0 10  5  0  2  0 17  3  0  0  7
   4  3  0  1  2  5  0  0  1  0  0  0  2  2  7  0  8  5  2  0  1  2  0  0
   1  0  3  0  1  3  0  0  2  0  1  0  0  0  1  0  1  0  2  0  0  0  0  0
   1  0  0  0  0  1  0  0  2  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0
   0  0  1  0]
 [11 28  9 11  0  6 16 51 12  0 45  3  8  0 17  6  1  0  0  0  1 17  0  1
   2  6  0  9  4  0  3  0  1  0 10  5  0  0  0  9  0  0  3  1  7  0  0  1
   0  4  3  0  3  0  0  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  1  0 46  1 13 10  5  5  5 14  9  2 16  4 27  0  2  0  0  0  0  1  5
   8  0  4  1  3  2  3  3 12  0  6  5  2  0  0  4  4  1  1  0  0  5  7  1
   0  0  3  2  3  0  1  2  0  1  0  0  0  0  0  2  0  0  0  0  0  3  1  0
   0  0  1  0  0  0  0  0  0  0  0  1  2  0  0  0  0  0  0  0  2  0  0  0
   0  0  1  0]
 [ 0  0  0  0  0 43  2  1  3  2 12  2 12  5 21  0  0  4  3 19  8  1  3  7
   2  0  4  3  1  0  1  1  0  1  0 14  5  0  0 15  1  7  4  2  0  0  1  0
   0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  2  5  0  2  0  0  2
   0  0  0  2  1  0  0  0  1  1  0  1  1  0  0  1  0  0  0  1  0  0  0  0
   0  0  0  0]
 [ 1  0  3  8 24 21  1 11 15  0  1  5  3  0  5  0 45  1  5  4  7  1  0  1
   2  3 13  0  4  0  0  0  2  1  8  0  2  4  2  1  1  0  0  6 11  1  1  3
   4  0  1  1  0  1 10  0  2  1  0  0  0  0  2  0  0  0  0  0  2  0  0  0
   0  0  1  0  1  0  0  0  0  0  0  0  0  2  0  0  0  0  1  0  0  0  0  0
   0  0  0  0]
 [14 21  7  0  1  4  3  5  0  6  2  0  1  2  0 14  0  6  6  7  2 17  5  7
   7  0  7  0 10  2  0  0  0  0  0  1  0  0  1  0  2  3  0  4  2  0  0  1
   1  0  1  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  2  1  1  1  1
   0  0  2  2  0  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0
   0  0  0  0]
 [ 0 44  0  6  6  0  4  2  1  2  8  3 21  0  3  1 24  1  0  1  8  7  1  0
   7  1  0  9  0  0  1  6  1  3  1  0  0  1  0  0  6  5  1  0  5  0  0  0
   2  2  0  0  0  0  0  0  1  4  0  1  1  0  1  1  0  0  0  0  1  4  0  0
   4  0  1  0  1  0  0  0  0  1  0  0  0  0  1  0  0  0  0  1  0  0  0  0
   1  0  0  0]
 [24  3  9  4 10 10 37  6  3 49  7  1  0  0  3  2 10  5  1  1 15  3  0 21
   0  3  0 16  6  2  3  0  0  0  3  4  0  0  1  6  2  0  0  1  3  0  4  1
   4  0  1  1  3  1  2  2  0  1  1  0  3  0  3  0  0  1  0  1  2  1  0  1
   1  1  0  0  0  0  1  0  0  0  0  0  0  0  0  4  0  0  1  0  0  1  0  0
   0  0  1  0]
 [ 4  5  3  0  0  1  0  2 13  0  0 21  0  0  4  0 13  0 19  1  3  3  4  1
  23  9  5  9  7  0  5  1  2  0  5  0  0  4  5  2  3  0  2  1  2  0  0  0
   0  1  0  0  3  2  2  0  2  0  1  0  0  5  0  2  0  1  0  0  0  0  0  0
   0  1  0  0  0  0  0  1  1  1  1  0  0  0  0  0  1  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0 50 13  1  0 31  1  6 19  0  0  0  2 12 22  1  0  0 32  0 12  0 10  0
   0  0 13  0  5  1  0 15  4  5  3  8  2  3  4  0  0  1  8  0  0  1  0  0
   1  0  2  0  0  0  0  0  2  2  2  0  0  0  0  0  0  2  1  1  0  0  0  0
   0  0  0  2  1  0  0  0  1  1  1  0  0  0  0  0  1  1  0  0  0  0  0  0
   0  0  0  0]
 [ 0  3  7  4 11 29  3  0 13 23  0  0  2  1  2  8  3  1  3  6  5  3  3  1
   0  2  0  0  4  4  9  3  0  4  4  0  0  0  0  2  0  9  1  2  0  0  1  8
   4  1  0  3  1  0  2  0  3  1  0  1  0  1  1  1  0  2  0  0  0  0  1  0
   1  0  0  0  0  0  1  0  0  0  0  0  0  2  0  0  0  1  0  0  0  0  0  0
   1  1  0  0]
 [12 42  0  0  0 10  0  2  4 25  4  0 28 28  5  3  0  2  1  7  2  3  6  8
   0  2  2 15  2  1  0  0  1  1  0  2  0  6  2  2  7  0  0  7  2  1  0  0
   3  0  1  1  0  0  2  0  0  0  1  1  1  2  0  0  1  1  0  0  0  0  3  0
   0  1  1  0  1  0  0  1  0  0  0  0  0  1  0  0  0  0  1  2  0  0  0  0
   0  0  0  0]
 [ 3  8  2  0 59  0  9  2 14 32  1  0  1  1  0  0  6  1  6  3  0  5  1  0
   4 25  1  8  4  1  1  0  4  2 14  0  1  4  0  0  0  0  3  5  0  0  1  0
   1  0  2  0  0  2  6  0  4  0  0  1  0  0  3  0  0  0  2  0  0  0  1  2
   0  0  0  0  0  0  0  0  1  0  0  0  0  0  2  0  0  0  0  0  0  2  0  0
   0  2  0  0]
 [19 75 32  4  0  2  6 13  1  4 21 22 11 21 43  0  6  0  4  6  2 18  0  2
   4  4  0  0  1  7 17  0  6  1 10  1  0 14  3  0  0  6  3  0  1  0  0  2
   1  0  3  0  1  0  1  0  0  0  0  0  1  0  1  0  0  0  0  0  0  0  1  1
   0  0  0  0  0  0  0  0  1  0  2  0  0  0  0  0  0  0  0  0  0  0  1  0
   0  0  0  0]
 [26  3 37 60  0 19  0  5  0  2  0 19  2  3  2 38  3  1 15  2  0 24  9 10
   0  2  0  0  7  4  2 10 23  4  0  2  0  1  0  1  1  4 10  0  1  1  3  0
   0  0  1  3  1  0  0  2  3  0  0  0  0  0  0  0  0  0  1  3  0  0  2  0
   0  0  1  0  2  0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  0  0  0  3
   1  0  0  1]
 [22  4  7 39 20 21  1 11 15  3  0  0  2  1  0  6 49  2  0  7  2  3 17  2
   5  2  0  2  2  3  1  0  0  1  0  0  6  0  0  5  3  0  1  0  0  2  9  0
   0  2  0  0  1  0  0  0  2  0  0  0  0  3  0  1  0  0  0  3  1  0  2  0
   0  0  0  0  0  1  0  3  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  0 28  0  5  0  1 37  0 22 35 18 25  7  0 12  0 17  8  1  1  0  3 13
   0  5  1  2 28 26  0  0  2  8  1  0  2  0  1  3  0  0  1  4  0  4  0  8
   0  0  0  0  1 11  0  0  1  4  0  6  0  1  0  0  0  0  0  0  0  0  1  0
   0  1  0  0  0  3  4  0  0  0  0  1  2  1  1  1  0  0  0  0  0  0  0  0
   0  0  0  0]
 [21 14  2  1 16  1 24 23  3  9  5  2  3  0  0  5 17  0  1  2  0  1  2  0
   2  1 10  0  1  0  3  7  5  8  0 23  0  0  0  1  1  6  3  2  0  0  0 11
   0  2  0  2  0  0  0  1  1  0  6  1  1  0  0  0  0  1  2  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [12  5 35 10 12 11  4  7 14  7  9  0 12 13  9  6  0 21  4  2  3  0  0  6
   0 10  0  0  0 11  3  0  5  0  2  2  0  6  7  0  0  0  6  1  4  4  1  5
   1  0  2  0  0  2  0  1  0  0  3  0  1  0  0  4  0  0  0  0  2  0  0  4
   1  0  3  1  1  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   1  0  0  0]
 [10  0  4  8 40  5  3  0  2  5 16  0  3  1  0  0 12  1  8  4  7  7  1  1
   7  4  2  0  0  0 15 14  0  0  5  0  3  4  2  0  5  1  1  0  3  1  1  0
   1  0  0  3  0  0  1  0  3  2  0  1  0  1  4  0  5  0  0  0  0  1  0  1
   2  0  0  0  0  0  0  1  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [30  0  5  4  5  1  4  1  1  9  6 12 10 24  0 14  1  5  2  1  1  4  4 15
   4  4  3  0  0  3  4  3  3  0  0  0  0  4  1  1  0  0  0  6  0  0  1  1
   1  0  2  0  2  1  0  0  0  1  0  5  0  1  0  0  0  0  0  4  2  1  0  0
   0  0  1  0  1  0  0  0  0  0  0  0  0  0  0  0  1  1  0  1  1  0  0  0
   0  1  0  0]
 [13 31 23  0  1  4  1  0  0  1  7  2  5  0  1 10  1  0  1  0  5  5  0  5
   3  0 26  0  0  2  3  0  0  6  0  6  0  0  3  2  0  0  0  3  6  3  1  4
   0  1  0  1  0  2  1  0  0  0  2  0  0  0  0  0  0  0  1  0  3  0  1  0
   0  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0  1  0  1  0  1  0  0  0
   0  0  0  1]
 [ 4  0  2 13  1  7 18  8  9 14  8  0  0  0  7  0  0  5 13 19  0 11 15  5
   1 14  2  0  1  2 12  0  0  1  0  4  1  0  1  5  0  0  2  0  0  0  1  0
   0  3  1  1  0  0  0  0  1  2  0  0  0  0  1  2  1  1  1  0  0  1  0  0
   1  0  1  0  0  1  0  0  0  0  2  1  1  0  0  0  0  1  0  0  0  0  0  0
   0  1  0  0]
 [32 10  0  1 13 15  3 16  3  0  8  2 50 10  9  0 13 11  0  2 17  5  1 12
   4  0  0  1  2  2  0  2 14  0  0  4  0  6  1  6  6  0  0  3  0  0  9  0
   6  2  2  2  1  0  0  1  0  1  3  0  0  3  1  4  2  2  0  0  0  1  0  0
   0  0  0  1  0  0  0  3  0  0  0  0  0  0  0  0  0  0  0  1  0  1  0  0
   0  0  0  0]
 [47  7  1  7  0 43 10  0  9 20 27 11  2 18  0  1  0  1  1 33  5  1  0  2
  20  6  0  0  3  1  0  1  0 11  5  0  5  0  1  0  1  1  0  0  0  0  0  0
   0  2  3  1  4  0  3  1  1  1  0  0  0  0  1  1  0  0  1  0  1  0  1  3
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 1  8  4  3  0  5  0 12  0  1  6 11  1  5 14  4  9  3  9  0  0  0  9  1
   1  0  0  5  0  1  3  1  0  0  1  0 26  1  0  2 10  0  3  2  0 11  3  3
   1  0  0  1  2  1  0  1  0  0  0  2  0  0  0  0  0  1  0  0  0  0  1  0
   2  0  0  1  0  0  0  0  0  0  1  0  0  1  0  0  0  0  0  0  0  0  0  2
   0  0  0  0]
 [26  0  5  2 14  0  7 20 48  1 50  7  2  0  6 22  2  4  6  0  4 11  6  1
   1  0  1  1  2  0  0  1  9  1  1  7  0  3  0  0  0  3  0  2  2  0  0  0
   1  4  0  0  1  0  0  3  0  4  0  0  6  1  0  2  0  4  2  0  0  0  1  0
   1  0  0  0  1  1  0  0  0  0  1  0  0  1  0  0  1  0  2  0  0  0  0  0
   0  0  0  0]
 [ 1  0 24  4  2  0  7  0  1 16  0  1 11  0  1 13  0  4  2  7  2  0  9  2
   2  0  8  0  0  1  1  1  0  0  0  0  0  1  0  0  4  5  3  1  0  7  4  0
   1  2  0  8  2  0  2  3  0  1  1  0  0  4  0  0  1  0  0  1  0  0  0  0
   0  4  0  1  1  0  0  0  1  5  0  0  2  0  0  0  0  0  0  0  0  0  1  0
   0  0  0  0]
 [27  0  4 32 33 18 25  1  5  0  0  2  2  1  2  9  0  1  4  5  8  4 25 16
   5  0 10  0  3 12  1  3  1  6  1  1  0  0  1  0  1  2  1  0  0  0  3  0
   3  0  0  1  0  0  0  3  2  0  0  0  6  3  0  0  0  0  0  0  0  0  1  0
   0  0  0  1  0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0
   0  0  0  1]
 [29  1  1  1  4 38  7 23  7  5  2 14  3  9  3  1  7 15  1  0  0  4  0  0
   4  8  6  5  0 10  0  1  1  8  3  0  5  0  0  0  2  0  0  4  1  0  0  1
   2  0  4  0  3  0  0  0  0  8  0  0  0  0  4  0  0  1  0  0  0  0  0  0
   0  2  0  0  1  0  0  1  1  0  1  0  0  0  0  0  1  0  0  0  1  0  0  1
   0  0  0  0]
 [ 4  6 29  1  0  7  9  4  0  0  0 13  9  2  0  1  5  6  0 15  7  0  1  0
   6  0  0  7  1  6  4  0  2  0  0  3  2  3  1  1  0  0  0  2  1  0  2  0
  12  4  4  4  1  2  0  3  2  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  2  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  1  1  0
   0  0  0  0]
 [ 4 45  5 29 16  1  1  2 17 10  7  8  3  0 10  1  1 14 21  0  1  0 15 10
   4  0  4  2  2  0  0  5  0  0  8  0  2  0  8  0  0  1  0  0  4  0  2  2
   0  0  2  4  0  2  0  2  0  0  1  1  0  1  0  1  0  0  1  0  0  0  0  0
   0  0  2  0  1  2  0  1  0  0  0  0  1  0  0  0  0  2  0  0  0  0  0  0
   0  0  0  0]
 [ 5  7 16 23 40  0 17  0  4  2  0 18  1 11  1 11  0 41  0  0  3  9 15  0
   0  6  0 16  0 11  2  6  0  5  1  0 14  1  0  0  1  1  0  0  0  0  1  0
   0  0  2  0  0  0  0  0  0  0  0  0  1  2  0  0  2  0  0  0  3  2  0  0
   2  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 5 16  3  7  0  6  5  1  4  1  0  3  0 56  0  0  2 14  0  7  1  0  0  1
  15  0  3  0 17  1  4  6  4  4  7  2  2  2 10  1  1  0  1  1  2  1  0  0
   0  0  0  0  0  8  5  4  2  0  0  2  0  0  3  0  0  0  0  0  0  0  0  0
   0  0  0  0  1  0  0  0  1  1  0  0  0  1  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  3  5 13 32  5  3  0 19  8  3 38 19  9  5  0  0 16 24 21 17  1  1  1
  12  3  0  2  1  5  1  1  0  9  0  1  1  0  1  4  5  3  3  1  0  0  1  0
   0  2  0  1  0  0  0  0  0  0  3  0  6  0  0  3  6  0  0  0  0  0  1  0
   0  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  1  0
   0  0  0  0]]
Total size of training set
10847
local test distribution:
[[ 0  0 24 12  1  8 13 22 22  0  3  0  0  4  8 10  3  0  0  0  2  3  0  2
   0 12  3 24  1  0  5  6  2  8  0  0  0  0  0  1  1  0  0  1  1  0  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  2  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0
   0  0  0  1]
 [64  0 36  0 19  0  5  0 17 26  0  1 11  0 19  0  0  1  2  1  0  0  4  0
   0  1  1  0  0  0  0  1  0  0  0  0  1  1  0  0  0  0  0  0  0  4  0  0
   0  8  0  4  0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [10  1  9  8  3  6  0  0 18  0  3  5  2  0  2  2  2 12  5  2 10  4  0  2
   0 11 13  0  0  0  3  0  0  1  0  1  4  0  0  1  0  8  0  1  1  7  0  0
   0  4  0  0  2  0  0  1  0  0  3  0  0  0  0  0  3  0  2  0  0  0  0  0
   0  1  0  3  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  6 11 49  5  0 70 47  1 11  1 11  9  0  3  1  0  0  6  0  9  9  1  0
   2  3  2  0  0  0  0  6  4  4  1  0  1  1 20  1  0  0  3  0  0  0  0  0
   0  3  3  0  5  1  0  2  0  0  0  1  0  0  0  0  0  1  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [11 24 37  0 11  0  0  5  4  0  0 24  4 11 12  9  0  2  0  0 18  0  3  0
   0  0  0  0  8  0 10  9  0  0  0  0  0 12  0  0  0  0  2  1  1  3  0  3
   0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0  1  0  2  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  0  0 12  2  0 34  1  9  1  0  4  0  0  9  4  0  1  0 15  2  0  0  6
   3  2  0  0  1  4  0  0  0  0  0  0  1  1  6  0  7  4  1  0  0  1  0  0
   0  0  2  0  0  2  0  0  1  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0
   0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [10 25  8 10  0  5 14 47 11  0 41  2  7  0 15  5  0  0  0  0  0 15  0  0
   1  5  0  8  3  0  2  0  0  0  9  4  0  0  0  8  0  0  2  0  6  0  0  0
   0  3  2  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  0  0 42  0 11  9  4  4  4 12  8  1 14  3 24  0  1  0  0  0  0  0  4
   7  0  3  0  2  1  2  2 11  0  5  4  1  0  0  3  3  0  0  0  0  4  6  0
   0  0  2  1  2  0  0  1  0  0  0  0  0  0  0  1  0  0  0  0  0  2  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  1  0  0  0
   0  0  0  0]
 [ 0  0  0  0  0 39  1  0  2  1 11  1 11  4 19  0  0  3  2 17  7  0  2  6
   1  0  3  2  0  0  0  0  0  0  0 12  4  0  0 13  0  6  3  1  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  4  0  1  0  0  1
   0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  0  2  7 22 19  0 10 13  0  0  4  2  0  4  0 41  0  4  3  6  0  0  0
   1  2 11  0  3  0  0  0  1  0  7  0  1  3  1  0  0  0  0  5 10  0  0  2
   3  0  0  0  0  0  9  0  1  0  0  0  0  0  1  0  0  0  0  0  1  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [12 19  6  0  0  3  2  4  0  5  1  0  0  1  0 12  0  5  5  6  1 15  4  6
   6  0  6  0  9  1  0  0  0  0  0  0  0  0  0  0  1  2  0  3  1  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0
   0  0  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0 40  0  5  5  0  3  1  0  1  7  2 19  0  2  0 22  0  0  0  7  6  0  0
   6  0  0  8  0  0  0  5  0  2  0  0  0  0  0  0  5  4  0  0  4  0  0  0
   1  1  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0  0  0  3  0  0
   3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [22  2  8  3  9  9 34  5  2 45  6  0  0  0  2  1  9  4  0  0 13  2  0 19
   0  2  0 14  5  1  2  0  0  0  2  3  0  0  0  5  1  0  0  0  2  0  3  0
   3  0  0  0  2  0  1  1  0  0  0  0  2  0  2  0  0  0  0  0  1  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 3  4  2  0  0  0  0  1 11  0  0 19  0  0  3  0 11  0 17  0  2  2  3  0
  21  8  4  8  6  0  4  0  1  0  4  0  0  3  4  1  2  0  1  0  1  0  0  0
   0  0  0  0  2  1  1  0  1  0  0  0  0  4  0  1  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0 46 11  0  0 28  0  5 17  0  0  0  1 11 20  0  0  0 29  0 11  0  9  0
   0  0 11  0  4  0  0 13  3  4  2  7  1  2  3  0  0  0  7  0  0  0  0  0
   0  0  1  0  0  0  0  0  1  1  1  0  0  0  0  0  0  1  0  0  0  0  0  0
   0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  2  6  3 10 26  2  0 11 21  0  0  1  0  1  7  2  0  2  5  4  2  2  0
   0  1  0  0  3  3  8  2  0  3  3  0  0  0  0  1  0  8  0  1  0  0  0  7
   3  0  0  2  0  0  1  0  2  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [11 38  0  0  0  9  0  1  3 23  3  0 25 25  4  2  0  1  0  6  1  2  5  7
   0  1  1 13  1  0  0  0  0  0  0  1  0  5  1  1  6  0  0  6  1  0  0  0
   2  0  0  0  0  0  1  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  2  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0
   0  0  0  0]
 [ 2  7  1  0 54  0  8  1 12 29  0  0  0  0  0  0  5  0  5  2  0  4  0  0
   3 23  0  7  3  0  0  0  3  1 12  0  0  3  0  0  0  0  2  4  0  0  0  0
   0  0  1  0  0  1  5  0  3  0  0  0  0  0  2  0  0  0  1  0  0  0  0  1
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  1  0  0
   0  1  0  0]
 [17 69 29  3  0  1  5 11  0  3 19 20 10 19 39  0  5  0  3  5  1 16  0  1
   3  3  0  0  0  6 15  0  5  0  9  0  0 12  2  0  0  5  2  0  0  0  0  1
   0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [23  2 34 55  0 17  0  4  0  1  0 17  1  2  1 35  2  0 13  1  0 22  8  9
   0  1  0  0  6  3  1  9 21  3  0  1  0  0  0  0  0  3  9  0  0  0  2  0
   0  0  0  2  0  0  0  1  2  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0
   0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2
   0  0  0  0]
 [20  3  6 35 18 19  0 10 13  2  0  0  1  0  0  5 45  1  0  6  1  2 15  1
   4  1  0  1  1  2  0  0  0  0  0  0  5  0  0  4  2  0  0  0  0  1  8  0
   0  1  0  0  0  0  0  0  1  0  0  0  0  2  0  0  0  0  0  2  0  0  1  0
   0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  0 25  0  4  0  0 34  0 20 32 16 23  6  0 11  0 15  7  0  0  0  2 11
   0  4  0  1 25 23  0  0  1  7  0  0  1  0  0  2  0  0  0  3  0  3  0  7
   0  0  0  0  0 10  0  0  0  3  0  5  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  2  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [19 12  1  0 14  0 22 21  2  8  4  1  2  0  0  4 15  0  0  1  0  0  1  0
   1  0  9  0  0  0  2  6  4  7  0 21  0  0  0  0  0  5  2  1  0  0  0 10
   0  1  0  1  0  0  0  0  0  0  5  0  0  0  0  0  0  0  1  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [11  4 32  9 11 10  3  6 12  6  8  0 11 11  8  5  0 19  3  1  2  0  0  5
   0  9  0  0  0 10  2  0  4  0  1  1  0  5  6  0  0  0  5  0  3  3  0  4
   0  0  1  0  0  1  0  0  0  0  2  0  0  0  0  3  0  0  0  0  1  0  0  3
   0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 9  0  3  7 36  4  2  0  1  4 14  0  2  0  0  0 11  0  7  3  6  6  0  0
   6  3  1  0  0  0 13 12  0  0  4  0  2  3  1  0  4  0  0  0  2  0  0  0
   0  0  0  2  0  0  0  0  2  1  0  0  0  0  3  0  4  0  0  0  0  0  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [27  0  4  3  4  0  3  0  0  8  5 11  9 22  0 12  0  4  1  0  0  3  3 13
   3  3  2  0  0  2  3  2  2  0  0  0  0  3  0  0  0  0  0  5  0  0  0  0
   0  0  1  0  1  0  0  0  0  0  0  4  0  0  0  0  0  0  0  3  1  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [11 28 21  0  0  3  0  0  0  0  6  1  4  0  0  9  0  0  0  0  4  4  0  4
   2  0 23  0  0  1  2  0  0  5  0  5  0  0  2  1  0  0  0  2  5  2  0  3
   0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0  2  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 3  0  1 11  0  6 16  7  8 12  7  0  0  0  6  0  0  4 11 17  0 10 13  4
   0 12  1  0  0  1 11  0  0  0  0  3  0  0  0  4  0  0  1  0  0  0  0  0
   0  2  0  0  0  0  0  0  0  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [29  9  0  0 11 13  2 14  2  0  7  1 46  9  8  0 11 10  0  1 15  4  0 11
   3  0  0  0  1  1  0  1 12  0  0  3  0  5  0  5  5  0  0  2  0  0  8  0
   5  1  1  1  0  0  0  0  0  0  2  0  0  2  0  3  1  1  0  0  0  0  0  0
   0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [43  6  0  6  0 39  9  0  8 18 24 10  1 16  0  0  0  0  0 30  4  0  0  1
  18  5  0  0  2  0  0  0  0 10  4  0  4  0  0  0  0  0  0  0  0  0  0  0
   0  1  2  0  3  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  7  3  2  0  4  0 11  0  0  5 10  0  4 12  3  8  2  8  0  0  0  8  0
   0  0  0  4  0  0  2  0  0  0  0  0 23  0  0  1  9  0  2  1  0 10  2  2
   0  0  0  0  1  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1
   0  0  0  0]
 [23  0  4  1 12  0  6 18 44  0 46  6  1  0  5 20  1  3  5  0  3 10  5  0
   0  0  0  0  1  0  0  0  8  0  0  6  0  2  0  0  0  2  0  1  1  0  0  0
   0  3  0  0  0  0  0  2  0  3  0  0  5  0  0  1  0  3  1  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0
   0  0  0  0]
 [ 0  0 22  3  1  0  6  0  0 14  0  0 10  0  0 11  0  3  1  6  1  0  8  1
   1  0  7  0  0  0  0  0  0  0  0  0  0  0  0  0  3  4  2  0  0  6  3  0
   0  1  0  7  1  0  1  2  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0  0
   0  3  0  0  0  0  0  0  0  4  0  0  1  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [24  0  3 29 30 16 23  0  4  0  0  1  1  0  1  8  0  0  3  4  7  3 23 14
   4  0  9  0  2 11  0  2  0  5  0  0  0  0  0  0  0  1  0  0  0  0  2  0
   2  0  0  0  0  0  0  2  1  0  0  0  5  2  0  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [26  0  0  0  3 35  6 21  6  4  1 12  2  8  2  0  6 13  0  0  0  3  0  0
   3  7  5  4  0  9  0  0  0  7  2  0  4  0  0  0  1  0  0  3  0  0  0  0
   1  0  3  0  2  0  0  0  0  7  0  0  0  0  3  0  0  0  0  0  0  0  0  0
   0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 3  5 26  0  0  6  8  3  0  0  0 11  8  1  0  0  4  5  0 13  6  0  0  0
   5  0  0  6  0  5  3  0  1  0  0  2  1  2  0  0  0  0  0  1  0  0  1  0
  11  3  3  3  0  1  0  2  1  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 3 41  4 26 14  0  0  1 15  9  6  7  2  0  9  0  0 12 19  0  0  0 13  9
   3  0  3  1  1  0  0  4  0  0  7  0  1  0  7  0  0  0  0  0  3  0  1  1
   0  0  1  3  0  1  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  1  0  0  1  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0
   0  0  0  0]
 [ 4  6 14 21 36  0 15  0  3  1  0 16  0 10  0 10  0 37  0  0  2  8 13  0
   0  5  0 14  0 10  1  5  0  4  0  0 12  0  0  0  0  0  0  0  0  0  0  0
   0  0  1  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  2  1  0  0
   1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 4 14  2  6  0  5  4  0  3  0  0  2  0 51  0  0  1 12  0  6  0  0  0  0
  13  0  2  0 15  0  3  5  3  3  6  1  1  1  9  0  0  0  0  0  1  0  0  0
   0  0  0  0  0  7  4  3  1  0  0  1  0  0  2  0  0  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]
 [ 0  2  4 11 29  4  2  0 17  7  2 35 17  8  4  0  0 14 22 19 15  0  0  0
  11  2  0  1  0  4  0  0  0  8  0  0  0  0  0  3  4  2  2  0  0  0  0  0
   0  1  0  0  0  0  0  0  0  0  2  0  5  0  0  2  5  0  0  0  0  0  0  0
   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
   0  0  0  0]]/home/jianhui/anaconda3/envs/FedLLM/lib/python3.7/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/jianhui/anaconda3/envs/FedLLM/lib/python3.7/site-packages/torchvision/image.so: undefined symbol: _ZN2at4_ops19empty_memory_format4callEN3c108ArrayRefIlEENS2_8optionalINS2_10ScalarTypeEEENS5_INS2_6LayoutEEENS5_INS2_6DeviceEEENS5_IbEENS5_INS2_12MemoryFormatEEE
  warn(f"Failed to load image Python extension: {e}")
/data/jianhui/FedLoGe/util/etf_methods.py:134: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  sparse_etf = torch.tensor(sparse_etf, requires_grad=True)

Total size of testing set
8636
[444 422 399 379 364 345 327 315 295 284 274 258 244 237 221 210 204 184
 180 170 160 155 145 136 131 126 120 116 103  98  94  90  86  82  78  75
  68  64  62  55  54  54  46  42  43  44  36  40  32  33  26  26  23  26
  25  20  17  19  17  18  17  15  13  12  14   9  10  11   9   8   4   7
   6   6   4   6   1   4   4   4   1   4   2   2   3   2   2   4   1   1
   1   1   1   1   0   3   0   1   0   1]
40
Step 0, Loss 26.707042694091797
Step 100, Loss 16.122817993164062
Step 200, Loss 9.328774452209473
Step 300, Loss 5.0143256187438965
Step 400, Loss 2.319241523742676
Step 500, Loss 0.6721667051315308
Step 600, Loss -0.3084346055984497
Step 700, Loss -0.8770543336868286
Step 800, Loss -1.1979626417160034
Step 900, Loss -1.3741819858551025
Step 1000, Loss -1.468639612197876
Step 1100, Loss -1.5183303356170654
Step 1200, Loss -1.5444430112838745
Step 1300, Loss -1.5582386255264282
Step 1400, Loss -1.5658588409423828
Step 1500, Loss -1.5702534914016724
Step 1600, Loss -1.573004961013794
Step 1700, Loss -1.5746220350265503
Step 1800, Loss -1.5755937099456787
Step 1900, Loss -1.5763685703277588
Step 2000, Loss -1.5766655206680298
Step 2100, Loss -1.5769119262695312
Step 2200, Loss -1.5770058631896973
Step 2300, Loss -1.577066421508789
Step 2400, Loss -1.577109932899475
Step 2500, Loss -1.5771899223327637
Step 2600, Loss -1.5770494937896729
Step 2700, Loss -1.5769699811935425
Step 2800, Loss -1.5770304203033447
Step 2900, Loss -1.576891541481018
Step 3000, Loss -1.5768898725509644
Step 3100, Loss -1.5767631530761719
Step 3200, Loss -1.5768394470214844
Step 3300, Loss -1.576735019683838
Step 3400, Loss -1.5767710208892822
Step 3500, Loss -1.5766890048980713
Step 3600, Loss -1.5766385793685913
Step 3700, Loss -1.5765390396118164
Step 3800, Loss -1.5765506029129028
Step 3900, Loss -1.5765495300292969
Step 4000, Loss -1.5764702558517456
Step 4100, Loss -1.5763863325119019
Step 4200, Loss -1.5763828754425049
Step 4300, Loss -1.5763123035430908
Step 4400, Loss -1.5762789249420166
Step 4500, Loss -1.5762110948562622
Step 4600, Loss -1.5761919021606445
Step 4700, Loss -1.5762277841567993
Step 4800, Loss -1.5762481689453125
Step 4900, Loss -1.576088786125183
Step 5000, Loss -1.5761018991470337
Step 5100, Loss -1.5761808156967163
Step 5200, Loss -1.5761219263076782
Step 5300, Loss -1.5761094093322754
Step 5400, Loss -1.5760401487350464
Step 5500, Loss -1.5759962797164917
Step 5600, Loss -1.576080322265625
Step 5700, Loss -1.5761257410049438
Step 5800, Loss -1.576088309288025
Step 5900, Loss -1.5759828090667725
Step 6000, Loss -1.5760302543640137
Step 6100, Loss -1.576082468032837
Step 6200, Loss -1.5759607553482056
Step 6300, Loss -1.5759472846984863
Step 6400, Loss -1.575944423675537
Step 6500, Loss -1.575966715812683
Step 6600, Loss -1.5759642124176025
Step 6700, Loss -1.575973629951477
Step 6800, Loss -1.575981855392456
Step 6900, Loss -1.5759774446487427
Step 7000, Loss -1.575956106185913
Step 7100, Loss -1.5757426023483276
Step 7200, Loss -1.575937032699585
Step 7300, Loss -1.5759222507476807
Step 7400, Loss -1.5759332180023193
Step 7500, Loss -1.575863003730774
Step 7600, Loss -1.5758898258209229
Step 7700, Loss -1.575886607170105
Step 7800, Loss -1.5758919715881348
Step 7900, Loss -1.5759611129760742
Step 8000, Loss -1.5758798122406006
Step 8100, Loss -1.5759239196777344
Step 8200, Loss -1.5757964849472046
Step 8300, Loss -1.576015830039978
Step 8400, Loss -1.575979232788086
Step 8500, Loss -1.5759261846542358
Step 8600, Loss -1.575936198234558
Step 8700, Loss -1.5758062601089478
Step 8800, Loss -1.5758730173110962
Step 8900, Loss -1.5759665966033936
Step 9000, Loss -1.5758702754974365
Step 9100, Loss -1.5758799314498901
Step 9200, Loss -1.575838327407837
Step 9300, Loss -1.575832486152649
Step 9400, Loss -1.5758777856826782
Step 9500, Loss -1.575838327407837
Step 9600, Loss -1.5760245323181152
Step 9700, Loss -1.575888752937317
Step 9800, Loss -1.5758763551712036
Step 9900, Loss -1.575890064239502
Angle Mean: 90.57780456542969, Angle Variance: 0.042339928448200226
Norm Mean: 0.10025106370449066, Norm Variance: 2.5868063247003192e-09
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [01:17<10:46:26, 77.73s/it]The value of constant scaler:  tensor([2.3407], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.0736196319018405, middle:0.0, tail0.0
3shot of client 1:head:0.143646408839779, middle:0.0, tail0.0
3shot of client 2:head:0.05970149253731343, middle:0.0, tail0.0
3shot of client 3:head:0.0, middle:0.0, tail0.06666666666666667
3shot of client 4:head:0.0670391061452514, middle:0.0, tail0.0
3shot of client 5:head:0.11320754716981132, middle:0.0, tail0.0
3shot of client 6:head:0.04878048780487805, middle:0.0, tail0.0
3shot of client 7:head:0.267515923566879, middle:0.0, tail0.0
3shot of client 8:head:0.28888888888888886, middle:0.0, tail0.0
3shot of client 9:head:0.04516129032258064, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.07692307692307693, tail0.0
3shot of client 11:head:0.04, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.06, tail0.0
3shot of client 13:head:0.0, middle:0.09375, tail0.0
3shot of client 14:head:0.233502538071066, middle:0.0, tail0.0
3shot of client 15:head:0.058823529411764705, middle:0.0, tail0.0
3shot of client 16:head:0.0, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.34394904458598724, middle:0.0, tail0.0
3shot of client 18:head:0.14661654135338345, middle:0.0, tail0.0
3shot of client 19:head:0.22357723577235772, middle:0.0, tail0.0
3shot of client 20:head:0.1912568306010929, middle:0.0, tail0.0
3shot of client 21:head:0.04680851063829787, middle:0.0, tail0.0
3shot of client 22:head:0.0, middle:0.1111111111111111, tail0.0
3shot of client 23:head:0.04891304347826087, middle:0.0, tail0.0
3shot of client 24:head:0.05185185185185185, middle:0.0, tail0.0
3shot of client 25:head:0.0, middle:0.0967741935483871, tail0.0
3shot of client 26:head:0.03418803418803419, middle:0.0, tail0.0
3shot of client 27:head:0.08148148148148149, middle:0.0, tail0.0
3shot of client 28:head:0.05339805825242718, middle:0.0, tail0.0
3shot of client 29:head:0.0, middle:0.12244897959183673, tail0.0
3shot of client 30:head:0.0, middle:0.06666666666666667, tail0.0
3shot of client 31:head:0.22797927461139897, middle:0.0, tail0.0
3shot of client 32:head:0.10476190476190476, middle:0.0, tail0.0
3shot of client 33:head:0.15508021390374332, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.08108108108108109, tail0.0
3shot of client 35:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 36:head:0.14942528735632185, middle:0.0, tail0.0
3shot of client 37:head:0.10101010101010101, middle:0.0, tail0.0
3shot of client 38:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 39:head:0.14646464646464646, middle:0.0, tail0.0
round 0, local average test acc  0.0734 

round 0, local macro average F1 score  0.0052 

round 0, local weighted average F1 score  0.0225 

round 0, global test acc  0.0100 

round 0, average 3shot acc: [head: 0.0908, middle: 0.0204, tail: 0.0017] 

round 0, global 3shot acc: [head: 0.0400, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.5873, 0.5766, 1.0912, 0.7906, 0.6658, 0.7752, 0.9557, 0.8664, 0.7917,
        0.5830, 0.7320, 0.5647, 0.5694, 0.6618, 0.8172, 0.8186, 0.7526, 0.5678,
        0.5810, 0.6135, 0.6791, 0.6740, 0.5789, 0.6358, 0.5806, 0.8586, 0.7231,
        0.9325, 0.6214, 0.5963, 0.6741, 0.7602, 0.7027, 0.7181, 0.6067, 0.5538,
        0.5936, 0.5846, 0.5788, 0.6642, 0.6497, 0.5801, 0.5838, 0.7223, 0.6456,
        0.5712, 0.5811, 0.5914, 0.5999, 0.6061, 0.5729, 0.6274, 0.5844, 0.6690,
        0.6310, 0.5717, 0.5618, 0.6384, 0.5937, 0.5643, 0.5767, 0.5928, 0.7705,
        0.5857, 0.5827, 0.5836, 0.5866, 0.6677, 0.5917, 0.6496, 0.5847, 0.5661,
        0.5643, 0.5669, 0.5806, 0.5858, 0.5944, 0.5905, 0.6024, 0.5741, 0.5781,
        0.5745, 0.5625, 0.5901, 0.5816, 0.5835, 0.5655, 0.6735, 0.5865, 0.5891,
        0.5831, 0.5842, 0.5879, 0.5676, 0.5842, 0.5835, 0.6345, 0.5767, 0.6056,
        0.6429], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.6447, 0.6107, 0.6526, 0.6152, 0.6003, 0.5942, 0.5975, 0.5939, 0.6198,
        0.6122, 0.5973, 0.6340, 0.5707, 0.5922, 0.6016, 0.6279, 0.6104, 0.5707,
        0.5951, 0.5923, 0.6040, 0.6029, 0.6044, 0.5909, 0.5705, 0.5896, 0.5772,
        0.5706, 0.5900, 0.5861, 0.5934, 0.5794, 0.6130, 0.5756, 0.5781, 0.5993,
        0.5929, 0.6008, 0.5782, 0.5865, 0.5767, 0.5707, 0.5802, 0.5819, 0.5840,
        0.5907, 0.5830, 0.5722, 0.5644, 0.5876, 0.5917, 0.5821, 0.5707, 0.5865,
        0.5838, 0.5998, 0.5686, 0.5663, 0.5777, 0.6000, 0.5692, 0.5801, 0.5815,
        0.5725, 0.5793, 0.5873, 0.5733, 0.5799, 0.5861, 0.5787, 0.5924, 0.5884,
        0.5639, 0.5812, 0.5761, 0.5878, 0.5901, 0.5756, 0.5650, 0.5900, 0.5779,
        0.5593, 0.5803, 0.5758, 0.5883, 0.5863, 0.5759, 0.5850, 0.5664, 0.5903,
        0.5732, 0.5599, 0.5615, 0.5837, 0.5768, 0.5853, 0.5748, 0.5687, 0.5853,
        0.5758], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([3.1981], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.0736196319018405, middle:0.0, tail0.0
3shot of client 1:head:0.143646408839779, middle:0.0, tail0.0
3shot of client 2:head:0.08955223880597014, middle:0.0, tail0.0
3shot of client 3:head:0.0, middle:0.16129032258064516, tail0.0
3shot of client 4:head:0.0, middle:0.1951219512195122, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.16666666666666666
3shot of client 6:head:0.07317073170731707, middle:0.0, tail0.0
3shot of client 7:head:0.0, middle:0.0, tail0.1111111111111111
3shot of client 8:head:0.14074074074074075, middle:0.0, tail0.0
3shot of client 9:head:0.0, middle:0.11428571428571428, tail0.0
3shot of client 10:head:0.11214953271028037, middle:0.0, tail0.0
3shot of client 11:head:0.0, middle:0.0, tail0.25
3shot of client 12:head:0.0, middle:0.04, tail0.0
3shot of client 13:head:0.1452991452991453, middle:0.0, tail0.0
3shot of client 14:head:0.233502538071066, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.0, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.18471337579617833, middle:0.0, tail0.0
3shot of client 18:head:0.07518796992481203, middle:0.0, tail0.0
3shot of client 19:head:0.14227642276422764, middle:0.0, tail0.0
3shot of client 20:head:0.0, middle:0.0425531914893617, tail0.0
3shot of client 21:head:0.06808510638297872, middle:0.0, tail0.0
3shot of client 22:head:0.0, middle:0.0, tail0.1
3shot of client 23:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 24:head:0.044444444444444446, middle:0.0, tail0.0
3shot of client 25:head:0.0703125, middle:0.0, tail0.0
3shot of client 26:head:0.03418803418803419, middle:0.0, tail0.0
3shot of client 27:head:0.1259259259259259, middle:0.0, tail0.0
3shot of client 28:head:0.22330097087378642, middle:0.0, tail0.0
3shot of client 29:head:0.04807692307692308, middle:0.0, tail0.0
3shot of client 30:head:0.10810810810810811, middle:0.0, tail0.0
3shot of client 31:head:0.22797927461139897, middle:0.0, tail0.0
3shot of client 32:head:0.20952380952380953, middle:0.0, tail0.0
3shot of client 33:head:0.15508021390374332, middle:0.0, tail0.0
3shot of client 34:head:0.0, middle:0.0, tail0.2
3shot of client 35:head:0.0, middle:0.0, tail0.14285714285714285
3shot of client 36:head:0.05172413793103448, middle:0.0, tail0.0
3shot of client 37:head:0.0, middle:0.17777777777777778, tail0.0
3shot of client 38:head:0.041666666666666664, middle:0.0, tail0.0
3shot of client 39:head:0.17676767676767677, middle:0.0, tail0.0
round 1, local average test acc  0.0635 

round 1, local macro average F1 score  0.0035 

round 1, local weighted average F1 score  0.0065 

round 1, global test acc  0.0102 

round 1, average 3shot acc: [head: 0.0761, middle: 0.0226, tail: 0.0243] 

round 1, global 3shot acc: [head: 0.0408, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.5873, 0.5766, 1.0912, 0.7906, 0.6658, 0.7752, 0.9557, 0.8664, 0.7917,
        0.5830, 0.7320, 0.5647, 0.5694, 0.6618, 0.8172, 0.8186, 0.7526, 0.5678,
        0.5810, 0.6135, 0.6791, 0.6740, 0.5789, 0.6358, 0.5806, 0.8586, 0.7231,
        0.9325, 0.6214, 0.5963, 0.6741, 0.7602, 0.7027, 0.7181, 0.6067, 0.5538,
        0.5936, 0.5846, 0.5788, 0.6642, 0.6497, 0.5801, 0.5838, 0.7223, 0.6456,
        0.5712, 0.5811, 0.5914, 0.5999, 0.6061, 0.5729, 0.6274, 0.5844, 0.6690,
        0.6310, 0.5717, 0.5618, 0.6384, 0.5937, 0.5643, 0.5767, 0.5928, 0.7705,
        0.5857, 0.5827, 0.5836, 0.5866, 0.6677, 0.5917, 0.6496, 0.5847, 0.5661,
        0.5643, 0.5669, 0.5806, 0.5858, 0.5944, 0.5905, 0.6024, 0.5741, 0.5781,
        0.5745, 0.5625, 0.5901, 0.5816, 0.5835, 0.5655, 0.6735, 0.5865, 0.5891,
        0.5831, 0.5842, 0.5879, 0.5676, 0.5842, 0.5835, 0.6345, 0.5767, 0.6056,
        0.6429], device='cuda:4', grad_fn=<NormBackward1>)  0%|          | 2/500 [02:28<10:09:38, 73.45s/it]  1%|          | 3/500 [03:42<10:10:25, 73.69s/it]
g_aux tensor([0.7436, 0.6681, 0.7879, 0.6329, 0.6351, 0.6294, 0.6443, 0.6506, 0.6658,
        0.6661, 0.6471, 0.7474, 0.6157, 0.6557, 0.6786, 0.6585, 0.6255, 0.5994,
        0.6279, 0.6176, 0.6518, 0.6679, 0.6509, 0.6173, 0.6162, 0.6335, 0.5847,
        0.5826, 0.6163, 0.6196, 0.6217, 0.5840, 0.6558, 0.5866, 0.5939, 0.6047,
        0.5976, 0.6149, 0.5795, 0.5861, 0.5816, 0.6019, 0.5829, 0.5772, 0.5827,
        0.5935, 0.5878, 0.5778, 0.5644, 0.5963, 0.5935, 0.5829, 0.5752, 0.5902,
        0.5907, 0.6023, 0.5729, 0.5661, 0.5778, 0.6036, 0.5664, 0.5781, 0.5834,
        0.5714, 0.5778, 0.5858, 0.5736, 0.5803, 0.5873, 0.5779, 0.5922, 0.5902,
        0.5663, 0.5809, 0.5731, 0.5870, 0.5950, 0.5758, 0.5654, 0.5875, 0.5794,
        0.5587, 0.5801, 0.5779, 0.5870, 0.5886, 0.5805, 0.5878, 0.5685, 0.5893,
        0.5738, 0.5600, 0.5633, 0.5834, 0.5773, 0.5854, 0.5762, 0.5679, 0.5847,
        0.5795], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([4.0054], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.10429447852760736, middle:0.0, tail0.0
3shot of client 1:head:0.027624309392265192, middle:0.09523809523809523, tail0.0
3shot of client 2:head:0.08955223880597014, middle:0.0, tail0.0
3shot of client 3:head:0.19831223628691982, middle:0.0, tail0.0
3shot of client 4:head:0.1340782122905028, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.0, tail0.16666666666666666
3shot of client 6:head:0.09268292682926829, middle:0.0, tail0.0
3shot of client 7:head:0.267515923566879, middle:0.0, tail0.0
3shot of client 8:head:0.06666666666666667, middle:0.027777777777777776, tail0.0
3shot of client 9:head:0.0064516129032258064, middle:0.11428571428571428, tail0.0
3shot of client 10:head:0.11214953271028037, middle:0.0, tail0.0
3shot of client 11:head:0.04, middle:0.0, tail0.0
3shot of client 12:head:0.010638297872340425, middle:0.04, tail0.0
3shot of client 13:head:0.23076923076923078, middle:0.0, tail0.0
3shot of client 14:head:0.233502538071066, middle:0.0, tail0.0
3shot of client 15:head:0.008403361344537815, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.0, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.15286624203821655, middle:0.0, tail0.0
3shot of client 18:head:0.10902255639097744, middle:0.0, tail0.0
3shot of client 19:head:0.14227642276422764, middle:0.0, tail0.0
3shot of client 20:head:0.20765027322404372, middle:0.0, tail0.0
3shot of client 21:head:0.06382978723404255, middle:0.0, tail0.0
3shot of client 22:head:0.03164556962025317, middle:0.05555555555555555, tail0.0
3shot of client 23:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 24:head:0.26666666666666666, middle:0.0, tail0.0
3shot of client 25:head:0.171875, middle:0.0, tail0.0
3shot of client 26:head:0.09401709401709402, middle:0.0, tail0.0
3shot of client 27:head:0.1259259259259259, middle:0.0, tail0.0
3shot of client 28:head:0.06796116504854369, middle:0.0, tail0.0
3shot of client 29:head:0.1201923076923077, middle:0.0, tail0.0
3shot of client 30:head:0.04504504504504504, middle:0.0, tail0.0
3shot of client 31:head:0.21761658031088082, middle:0.0, tail0.0
3shot of client 32:head:0.0761904761904762, middle:0.0, tail0.16666666666666666
3shot of client 33:head:0.16042780748663102, middle:0.0, tail0.0
3shot of client 34:head:0.049079754601226995, middle:0.0, tail0.0
3shot of client 35:head:0.21739130434782608, middle:0.0, tail0.0
3shot of client 36:head:0.005747126436781609, middle:0.021739130434782608, tail0.0
3shot of client 37:head:0.0, middle:0.17777777777777778, tail0.0
3shot of client 38:head:0.3680555555555556, middle:0.0, tail0.0
3shot of client 39:head:0.0, middle:0.037037037037037035, tail0.0
round 2, local average test acc  0.0870 

round 2, local macro average F1 score  0.0065 

round 2, local weighted average F1 score  0.0200 

round 2, global test acc  0.0134 

round 2, average 3shot acc: [head: 0.1090, middle: 0.0186, tail: 0.0083] 

round 2, global 3shot acc: [head: 0.0536, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.5873, 0.5766, 1.0912, 0.7906, 0.6658, 0.7752, 0.9557, 0.8664, 0.7917,
        0.5830, 0.7320, 0.5647, 0.5694, 0.6618, 0.8172, 0.8186, 0.7526, 0.5678,
        0.5810, 0.6135, 0.6791, 0.6740, 0.5789, 0.6358, 0.5806, 0.8586, 0.7231,
        0.9325, 0.6214, 0.5963, 0.6741, 0.7602, 0.7027, 0.7181, 0.6067, 0.5538,
        0.5936, 0.5846, 0.5788, 0.6642, 0.6497, 0.5801, 0.5838, 0.7223, 0.6456,
        0.5712, 0.5811, 0.5914, 0.5999, 0.6061, 0.5729, 0.6274, 0.5844, 0.6690,
        0.6310, 0.5717, 0.5618, 0.6384, 0.5937, 0.5643, 0.5767, 0.5928, 0.7705,
        0.5857, 0.5827, 0.5836, 0.5866, 0.6677, 0.5917, 0.6496, 0.5847, 0.5661,
        0.5643, 0.5669, 0.5806, 0.5858, 0.5944, 0.5905, 0.6024, 0.5741, 0.5781,
        0.5745, 0.5625, 0.5901, 0.5816, 0.5835, 0.5655, 0.6735, 0.5865, 0.5891,
        0.5831, 0.5842, 0.5879, 0.5676, 0.5842, 0.5835, 0.6345, 0.5767, 0.6056,
        0.6429], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.8331, 0.7059, 0.9783, 0.7135, 0.7639, 0.7004, 0.7680, 0.7949, 0.7351,
        0.7815, 0.7411, 0.8374, 0.7221, 0.7537, 0.7321, 0.7136, 0.6457, 0.6764,
        0.6413, 0.6414, 0.7269, 0.6803, 0.7082, 0.6807, 0.6686, 0.6607, 0.6069,
        0.5907, 0.6707, 0.6935, 0.6475, 0.6078, 0.7053, 0.6066, 0.6139, 0.6071,
        0.5997, 0.6319, 0.5986, 0.5951, 0.5876, 0.6143, 0.5929, 0.5867, 0.5854,
        0.6078, 0.5921, 0.5842, 0.5789, 0.6137, 0.5965, 0.5898, 0.5842, 0.6193,
        0.5985, 0.6179, 0.5742, 0.5664, 0.5825, 0.6058, 0.5669, 0.5852, 0.5880,
        0.5705, 0.5784, 0.5861, 0.5739, 0.5825, 0.5905, 0.5761, 0.5931, 0.5884,
        0.5673, 0.5824, 0.5743, 0.5882, 0.5939, 0.5765, 0.5664, 0.5878, 0.5804,
        0.5589, 0.5819, 0.5780, 0.5879, 0.5857, 0.5791, 0.5863, 0.5702, 0.5909,
        0.5755, 0.5620, 0.5622, 0.5841, 0.5793, 0.5870, 0.5768, 0.5696, 0.5862,
        0.5790], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([4.5413], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.10429447852760736, middle:0.0, tail0.0
3shot of client 1:head:0.09944751381215469, middle:0.2619047619047619, tail0.0
3shot of client 2:head:0.08955223880597014, middle:0.0, tail0.0
3shot of client 3:head:0.05907172995780591, middle:0.04838709677419355, tail0.0
3shot of client 4:head:0.0670391061452514, middle:0.0, tail0.2
3shot of client 5:head:0.32075471698113206, middle:0.0, tail0.0
3shot of client 6:head:0.08292682926829269, middle:0.0, tail0.0
3shot of client 7:head:0.29936305732484075, middle:0.0, tail0.0
3shot of client 8:head:0.28888888888888886, middle:0.0, tail0.0
3shot of client 9:head:0.06451612903225806, middle:0.05714285714285714, tail0.0
3shot of client 10:head:0.11214953271028037, middle:0.0, tail0.0
3shot of client 11:head:0.088, middle:0.0, tail0.0
3shot of client 12:head:0.0851063829787234, middle:0.06, tail0.0
3shot of client 13:head:0.27350427350427353, middle:0.0, tail0.0
3shot of client 14:head:0.06091370558375635, middle:0.0, tail0.08333333333333333
3shot of client 15:head:0.08403361344537816, middle:0.0, tail0.0
3shot of client 16:head:0.09202453987730061, middle:0.05405405405405406, tail0.0
3shot of client 17:head:0.05732484076433121, middle:0.0, tail0.0
3shot of client 18:head:0.10526315789473684, middle:0.03389830508474576, tail0.0
3shot of client 19:head:0.24796747967479674, middle:0.0, tail0.0
3shot of client 20:head:0.18579234972677597, middle:0.0, tail0.16666666666666666
3shot of client 21:head:0.14042553191489363, middle:0.01694915254237288, tail0.0
3shot of client 22:head:0.056962025316455694, middle:0.027777777777777776, tail0.0
3shot of client 23:head:0.043478260869565216, middle:0.0, tail0.0
3shot of client 24:head:0.26666666666666666, middle:0.0, tail0.0
3shot of client 25:head:0.0546875, middle:0.0967741935483871, tail0.0
3shot of client 26:head:0.18803418803418803, middle:0.0, tail0.0
3shot of client 27:head:0.11851851851851852, middle:0.0625, tail0.0
3shot of client 28:head:0.16019417475728157, middle:0.04, tail0.0
3shot of client 29:head:0.057692307692307696, middle:0.10204081632653061, tail0.0
3shot of client 30:head:0.036036036036036036, middle:0.06666666666666667, tail0.16666666666666666  1%|          | 4/500 [04:51<9:56:06, 72.11s/it]   1%|          | 5/500 [06:05<10:00:18, 72.77s/it]
3shot of client 31:head:0.17098445595854922, middle:0.0, tail0.0
3shot of client 32:head:0.17142857142857143, middle:0.0, tail0.0
3shot of client 33:head:0.1657754010695187, middle:0.0, tail0.0
3shot of client 34:head:0.04294478527607362, middle:0.02702702702702703, tail0.0
3shot of client 35:head:0.19130434782608696, middle:0.0, tail0.0
3shot of client 36:head:0.0, middle:0.06521739130434782, tail0.0
3shot of client 37:head:0.06565656565656566, middle:0.13333333333333333, tail0.0
3shot of client 38:head:0.3819444444444444, middle:0.02631578947368421, tail0.0
3shot of client 39:head:0.07575757575757576, middle:0.05555555555555555, tail0.0
round 3, local average test acc  0.1068 

round 3, local macro average F1 score  0.0135 

round 3, local weighted average F1 score  0.0445 

round 3, global test acc  0.0236 

round 3, average 3shot acc: [head: 0.1314, middle: 0.0309, tail: 0.0154] 

round 3, global 3shot acc: [head: 0.0944, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.5873, 0.5766, 1.0912, 0.7906, 0.6658, 0.7752, 0.9557, 0.8664, 0.7917,
        0.5830, 0.7320, 0.5647, 0.5694, 0.6618, 0.8172, 0.8186, 0.7526, 0.5678,
        0.5810, 0.6135, 0.6791, 0.6740, 0.5789, 0.6358, 0.5806, 0.8586, 0.7231,
        0.9325, 0.6214, 0.5963, 0.6741, 0.7602, 0.7027, 0.7181, 0.6067, 0.5538,
        0.5936, 0.5846, 0.5788, 0.6642, 0.6497, 0.5801, 0.5838, 0.7223, 0.6456,
        0.5712, 0.5811, 0.5914, 0.5999, 0.6061, 0.5729, 0.6274, 0.5844, 0.6690,
        0.6310, 0.5717, 0.5618, 0.6384, 0.5937, 0.5643, 0.5767, 0.5928, 0.7705,
        0.5857, 0.5827, 0.5836, 0.5866, 0.6677, 0.5917, 0.6496, 0.5847, 0.5661,
        0.5643, 0.5669, 0.5806, 0.5858, 0.5944, 0.5905, 0.6024, 0.5741, 0.5781,
        0.5745, 0.5625, 0.5901, 0.5816, 0.5835, 0.5655, 0.6735, 0.5865, 0.5891,
        0.5831, 0.5842, 0.5879, 0.5676, 0.5842, 0.5835, 0.6345, 0.5767, 0.6056,
        0.6429], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.8509, 0.8200, 1.0809, 0.7642, 0.8722, 0.7685, 0.9095, 0.9401, 0.8344,
        0.8688, 0.8465, 0.9187, 0.7996, 0.8125, 0.8367, 0.7657, 0.6818, 0.6989,
        0.7035, 0.6758, 0.8538, 0.7167, 0.7738, 0.7254, 0.7277, 0.6894, 0.6349,
        0.6031, 0.6972, 0.6886, 0.6788, 0.6484, 0.7347, 0.6188, 0.6298, 0.6365,
        0.6117, 0.6670, 0.6127, 0.6046, 0.5993, 0.6431, 0.6166, 0.6013, 0.5868,
        0.6193, 0.5942, 0.5915, 0.5782, 0.6356, 0.6187, 0.5892, 0.5974, 0.6368,
        0.6010, 0.6259, 0.5808, 0.5718, 0.5893, 0.6125, 0.5839, 0.5920, 0.5933,
        0.5717, 0.5782, 0.5859, 0.5903, 0.5913, 0.5906, 0.5751, 0.5929, 0.5936,
        0.5701, 0.5852, 0.5755, 0.5871, 0.5951, 0.5793, 0.5676, 0.5889, 0.5798,
        0.5613, 0.5874, 0.5798, 0.5933, 0.5878, 0.5821, 0.5851, 0.5652, 0.5915,
        0.5759, 0.5600, 0.5653, 0.5873, 0.5803, 0.5869, 0.5781, 0.5697, 0.5859,
        0.5801], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([5.0417], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.0736196319018405, middle:0.05714285714285714, tail0.0
3shot of client 1:head:0.10497237569060773, middle:0.2619047619047619, tail0.0
3shot of client 2:head:0.09701492537313433, middle:0.0, tail0.0
3shot of client 3:head:0.0759493670886076, middle:0.03225806451612903, tail0.0
3shot of client 4:head:0.22346368715083798, middle:0.0, tail0.0
3shot of client 5:head:0.32075471698113206, middle:0.0, tail0.0
3shot of client 6:head:0.22926829268292684, middle:0.0, tail0.0
3shot of client 7:head:0.25477707006369427, middle:0.0, tail0.0
3shot of client 8:head:0.2814814814814815, middle:0.027777777777777776, tail0.0
3shot of client 9:head:0.13548387096774195, middle:0.08571428571428572, tail0.0
3shot of client 10:head:0.14018691588785046, middle:0.0, tail0.0
3shot of client 11:head:0.096, middle:0.0, tail0.0
3shot of client 12:head:0.14361702127659576, middle:0.08, tail0.0
3shot of client 13:head:0.2905982905982906, middle:0.0, tail0.0
3shot of client 14:head:0.06091370558375635, middle:0.0, tail0.08333333333333333
3shot of client 15:head:0.025210084033613446, middle:0.12903225806451613, tail0.0
3shot of client 16:head:0.17177914110429449, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.08917197452229299, middle:0.0, tail0.0
3shot of client 18:head:0.16165413533834586, middle:0.06779661016949153, tail0.0
3shot of client 19:head:0.16666666666666666, middle:0.0, tail0.0
3shot of client 20:head:0.0273224043715847, middle:0.10638297872340426, tail0.08333333333333333
3shot of client 21:head:0.09787234042553192, middle:0.0847457627118644, tail0.0
3shot of client 22:head:0.2088607594936709, middle:0.08333333333333333, tail0.0
3shot of client 23:head:0.06521739130434782, middle:0.0, tail0.0
3shot of client 24:head:0.05925925925925926, middle:0.0, tail0.0
3shot of client 25:head:0.109375, middle:0.12903225806451613, tail0.0
3shot of client 26:head:0.17094017094017094, middle:0.07142857142857142, tail0.0
3shot of client 27:head:0.1037037037037037, middle:0.125, tail0.0
3shot of client 28:head:0.23786407766990292, middle:0.02, tail0.0
3shot of client 29:head:0.1201923076923077, middle:0.061224489795918366, tail0.0
3shot of client 30:head:0.0990990990990991, middle:0.03333333333333333, tail0.16666666666666666
3shot of client 31:head:0.17616580310880828, middle:0.0, tail0.0
3shot of client 32:head:0.14285714285714285, middle:0.08, tail0.0
3shot of client 33:head:0.13903743315508021, middle:0.045454545454545456, tail0.0
3shot of client 34:head:0.13496932515337423, middle:0.0, tail0.0
3shot of client 35:head:0.14782608695652175, middle:0.03333333333333333, tail0.0
3shot of client 36:head:0.25287356321839083, middle:0.0, tail0.0
3shot of client 37:head:0.06060606060606061, middle:0.0, tail0.0
3shot of client 38:head:0.4236111111111111, middle:0.0, tail0.0
3shot of client 39:head:0.16161616161616163, middle:0.018518518518518517, tail0.0
round 4, local average test acc  0.1247 

round 4, local macro average F1 score  0.0238 

round 4, local weighted average F1 score  0.0673 

round 4, global test acc  0.0394 

round 4, average 3shot acc: [head: 0.1520, middle: 0.0435, tail: 0.0083] 

round 4, global 3shot acc: [head: 0.1436, middle: 0.0140, tail: 0.0000] 

l_head tensor([0.5873, 0.5766, 1.0912, 0.7906, 0.6658, 0.7752, 0.9557, 0.8664, 0.7917,
        0.5830, 0.7320, 0.5647, 0.5694, 0.6618, 0.8172, 0.8186, 0.7526, 0.5678,
        0.5810, 0.6135, 0.6791, 0.6740, 0.5789, 0.6358, 0.5806, 0.8586, 0.7231,
        0.9325, 0.6214, 0.5963, 0.6741, 0.7602, 0.7027, 0.7181, 0.6067, 0.5538,
        0.5936, 0.5846, 0.5788, 0.6642, 0.6497, 0.5801, 0.5838, 0.7223, 0.6456,
        0.5712, 0.5811, 0.5914, 0.5999, 0.6061, 0.5729, 0.6274, 0.5844, 0.6690,
        0.6310, 0.5717, 0.5618, 0.6384, 0.5937, 0.5643, 0.5767, 0.5928, 0.7705,
        0.5857, 0.5827, 0.5836, 0.5866, 0.6677, 0.5917, 0.6496, 0.5847, 0.5661,
        0.5643, 0.5669, 0.5806, 0.5858, 0.5944, 0.5905, 0.6024, 0.5741, 0.5781,
        0.5745, 0.5625, 0.5901, 0.5816, 0.5835, 0.5655, 0.6735, 0.5865, 0.5891,
        0.5831, 0.5842, 0.5879, 0.5676, 0.5842, 0.5835, 0.6345, 0.5767, 0.6056,
        0.6429], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.9372, 0.9698, 1.1939, 0.8267, 0.9900, 0.8176, 0.9472, 1.0871, 0.9294,
        0.9668, 0.9741, 1.0740, 0.9017, 0.8968, 0.9081, 0.8326, 0.7164, 0.8294,
        0.7708, 0.7264, 0.9190, 0.7530, 0.8382, 0.7765, 0.8189, 0.7312, 0.6564,
        0.6284, 0.7552, 0.7625, 0.7541, 0.6884, 0.7474, 0.6485, 0.6590, 0.6604,
        0.6416, 0.6895, 0.6204, 0.6266, 0.6104, 0.6633, 0.6199, 0.6190, 0.5985,
        0.6308, 0.6005, 0.6242, 0.5865, 0.6618, 0.6291, 0.5921, 0.6105, 0.6799,
        0.6039, 0.6205, 0.5817, 0.5749, 0.5920, 0.6238, 0.6011, 0.5969, 0.6008,
        0.5750, 0.5827, 0.5874, 0.5934, 0.6073, 0.5940, 0.5799, 0.5983, 0.5961,
        0.5736, 0.5892, 0.5739, 0.5865, 0.5975, 0.5813, 0.5717, 0.5876, 0.5807,
        0.5620, 0.5887, 0.5820, 0.5925, 0.5866, 0.5866, 0.5841, 0.5657, 0.5890,
        0.5768, 0.5595, 0.5638, 0.5864, 0.5805, 0.5884, 0.5791, 0.5703, 0.5869,
        0.5811], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([5.5911], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.10429447852760736, middle:0.2, tail0.0  1%|          | 6/500 [08:27<13:13:06, 96.33s/it]
3shot of client 1:head:0.3701657458563536, middle:0.047619047619047616, tail0.0
3shot of client 2:head:0.11194029850746269, middle:0.0, tail0.0
3shot of client 3:head:0.08016877637130802, middle:0.03225806451612903, tail0.0
3shot of client 4:head:0.18994413407821228, middle:0.0, tail0.0
3shot of client 5:head:0.11320754716981132, middle:0.0, tail0.0
3shot of client 6:head:0.22439024390243903, middle:0.018518518518518517, tail0.0
3shot of client 7:head:0.267515923566879, middle:0.025, tail0.0
3shot of client 8:head:0.28888888888888886, middle:0.0, tail0.0
3shot of client 9:head:0.12903225806451613, middle:0.14285714285714285, tail0.0
3shot of client 10:head:0.19626168224299065, middle:0.038461538461538464, tail0.0
3shot of client 11:head:0.088, middle:0.0, tail0.0
3shot of client 12:head:0.17553191489361702, middle:0.0, tail0.0
3shot of client 13:head:0.2905982905982906, middle:0.0, tail0.0
3shot of client 14:head:0.07614213197969544, middle:0.0, tail0.0
3shot of client 15:head:0.10084033613445378, middle:0.0, tail0.0
3shot of client 16:head:0.1656441717791411, middle:0.02702702702702703, tail0.0
3shot of client 17:head:0.07643312101910828, middle:0.0, tail0.0
3shot of client 18:head:0.06766917293233082, middle:0.13559322033898305, tail0.0
3shot of client 19:head:0.14634146341463414, middle:0.0, tail0.0
3shot of client 20:head:0.06557377049180328, middle:0.14893617021276595, tail0.08333333333333333
3shot of client 21:head:0.1829787234042553, middle:0.03389830508474576, tail0.07692307692307693
3shot of client 22:head:0.24050632911392406, middle:0.08333333333333333, tail0.0
3shot of client 23:head:0.07608695652173914, middle:0.0, tail0.0
3shot of client 24:head:0.014814814814814815, middle:0.08108108108108109, tail0.2857142857142857
3shot of client 25:head:0.2265625, middle:0.03225806451612903, tail0.0
3shot of client 26:head:0.1452991452991453, middle:0.0, tail0.0
3shot of client 27:head:0.11851851851851852, middle:0.0625, tail0.0
3shot of client 28:head:0.23786407766990292, middle:0.0, tail0.0
3shot of client 29:head:0.24519230769230768, middle:0.12244897959183673, tail0.0
3shot of client 30:head:0.06306306306306306, middle:0.0, tail0.16666666666666666
3shot of client 31:head:0.15025906735751296, middle:0.0, tail0.09090909090909091
3shot of client 32:head:0.18095238095238095, middle:0.0, tail0.0
3shot of client 33:head:0.1711229946524064, middle:0.045454545454545456, tail0.0
3shot of client 34:head:0.049079754601226995, middle:0.0, tail0.1
3shot of client 35:head:0.1391304347826087, middle:0.1, tail0.0
3shot of client 36:head:0.2471264367816092, middle:0.0, tail0.0
3shot of client 37:head:0.08080808080808081, middle:0.0, tail0.0
3shot of client 38:head:0.3958333333333333, middle:0.02631578947368421, tail0.0
3shot of client 39:head:0.16666666666666666, middle:0.0, tail0.0
round 5, local average test acc  0.1308 

round 5, local macro average F1 score  0.0312 

round 5, local weighted average F1 score  0.0879 

round 5, global test acc  0.0446 

round 5, average 3shot acc: [head: 0.1615, middle: 0.0351, tail: 0.0201] 

round 5, global 3shot acc: [head: 0.1784, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.5873, 0.5766, 1.0912, 0.7906, 0.6658, 0.7752, 0.9557, 0.8664, 0.7917,
        0.5830, 0.7320, 0.5647, 0.5694, 0.6618, 0.8172, 0.8186, 0.7526, 0.5678,
        0.5810, 0.6135, 0.6791, 0.6740, 0.5789, 0.6358, 0.5806, 0.8586, 0.7231,
        0.9325, 0.6214, 0.5963, 0.6741, 0.7602, 0.7027, 0.7181, 0.6067, 0.5538,
        0.5936, 0.5846, 0.5788, 0.6642, 0.6497, 0.5801, 0.5838, 0.7223, 0.6456,
        0.5712, 0.5811, 0.5914, 0.5999, 0.6061, 0.5729, 0.6274, 0.5844, 0.6690,
        0.6310, 0.5717, 0.5618, 0.6384, 0.5937, 0.5643, 0.5767, 0.5928, 0.7705,
        0.5857, 0.5827, 0.5836, 0.5866, 0.6677, 0.5917, 0.6496, 0.5847, 0.5661,
        0.5643, 0.5669, 0.5806, 0.5858, 0.5944, 0.5905, 0.6024, 0.5741, 0.5781,
        0.5745, 0.5625, 0.5901, 0.5816, 0.5835, 0.5655, 0.6735, 0.5865, 0.5891,
        0.5831, 0.5842, 0.5879, 0.5676, 0.5842, 0.5835, 0.6345, 0.5767, 0.6056,
        0.6429], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.0596, 0.9991, 1.3439, 0.8571, 1.1099, 0.8850, 1.0361, 1.1876, 1.0262,
        1.0956, 1.1284, 1.1677, 0.9779, 0.9644, 0.9385, 0.9117, 0.7523, 0.9107,
        0.8061, 0.7931, 0.9954, 0.8004, 0.8855, 0.8827, 0.8847, 0.7650, 0.6769,
        0.6759, 0.8050, 0.8330, 0.7849, 0.7056, 0.7607, 0.7012, 0.6771, 0.6693,
        0.6525, 0.6988, 0.6329, 0.6403, 0.6212, 0.6650, 0.6209, 0.6328, 0.6033,
        0.6407, 0.6094, 0.6449, 0.6027, 0.6999, 0.6406, 0.5973, 0.6386, 0.7222,
        0.6034, 0.6273, 0.5844, 0.5883, 0.5974, 0.6416, 0.6238, 0.6104, 0.6148,
        0.5745, 0.5873, 0.5899, 0.5947, 0.6072, 0.5934, 0.5841, 0.6093, 0.6028,
        0.5737, 0.6033, 0.5727, 0.5869, 0.6013, 0.5809, 0.5750, 0.5867, 0.5803,
        0.5636, 0.5937, 0.5905, 0.5912, 0.5852, 0.5881, 0.5844, 0.5664, 0.5895,
        0.5733, 0.5595, 0.5642, 0.5844, 0.5813, 0.5896, 0.5799, 0.5709, 0.5862,
        0.5833], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([6.0160], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.2085889570552147, middle:0.08571428571428572, tail0.0
3shot of client 1:head:0.26519337016574585, middle:0.023809523809523808, tail0.0
3shot of client 2:head:0.1044776119402985, middle:0.0, tail0.0
3shot of client 3:head:0.0970464135021097, middle:0.03225806451612903, tail0.0
3shot of client 4:head:0.18435754189944134, middle:0.0, tail0.0
3shot of client 5:head:0.10377358490566038, middle:0.0, tail0.0
3shot of client 6:head:0.21951219512195122, middle:0.037037037037037035, tail0.0
3shot of client 7:head:0.06369426751592357, middle:0.025, tail0.0
3shot of client 8:head:0.2962962962962963, middle:0.0, tail0.0
3shot of client 9:head:0.06451612903225806, middle:0.14285714285714285, tail0.0
3shot of client 10:head:0.11214953271028037, middle:0.07692307692307693, tail0.0
3shot of client 11:head:0.08, middle:0.0625, tail0.0
3shot of client 12:head:0.19148936170212766, middle:0.0, tail0.0
3shot of client 13:head:0.06837606837606838, middle:0.0, tail0.0
3shot of client 14:head:0.15228426395939088, middle:0.07142857142857142, tail0.0
3shot of client 15:head:0.13445378151260504, middle:0.03225806451612903, tail0.0
3shot of client 16:head:0.12883435582822086, middle:0.10810810810810811, tail0.0
3shot of client 17:head:0.044585987261146494, middle:0.0, tail0.0
3shot of client 18:head:0.14661654135338345, middle:0.1694915254237288, tail0.0
3shot of client 19:head:0.12195121951219512, middle:0.17543859649122806, tail0.0
3shot of client 20:head:0.01092896174863388, middle:0.0425531914893617, tail0.25
3shot of client 21:head:0.06382978723404255, middle:0.0847457627118644, tail0.0
3shot of client 22:head:0.21518987341772153, middle:0.027777777777777776, tail0.0
3shot of client 23:head:0.06521739130434782, middle:0.0, tail0.0
3shot of client 24:head:0.0, middle:0.08108108108108109, tail0.2857142857142857
3shot of client 25:head:0.234375, middle:0.06451612903225806, tail0.0
3shot of client 26:head:0.15384615384615385, middle:0.03571428571428571, tail0.0
3shot of client 27:head:0.1111111111111111, middle:0.0625, tail0.0
3shot of client 28:head:0.24757281553398058, middle:0.0, tail0.0
3shot of client 29:head:0.1971153846153846, middle:0.16326530612244897, tail0.0
3shot of client 30:head:0.0990990990990991, middle:0.13333333333333333, tail0.16666666666666666
3shot of client 31:head:0.12953367875647667, middle:0.02040816326530612, tail0.09090909090909091
3shot of client 32:head:0.19047619047619047, middle:0.04, tail0.0
3shot of client 33:head:0.13903743315508021, middle:0.045454545454545456, tail0.0
3shot of client 34:head:0.012269938650306749, middle:0.0, tail0.1
3shot of client 35:head:0.13043478260869565, middle:0.0, tail0.0
3shot of client 36:head:0.2471264367816092, middle:0.0, tail0.0
3shot of client 37:head:0.13131313131313133, middle:0.0, tail0.0
3shot of client 38:head:0.3819444444444444, middle:0.0, tail0.0
3shot of client 39:head:0.14646464646464646, middle:0.0, tail0.0
round 6, local average test acc  0.1185 

round 6, local macro average F1 score  0.0324 

round 6, local weighted average F1 score  0.0785 
  1%|         | 7/500 [10:55<15:29:27, 113.12s/it]  2%|         | 8/500 [13:22<16:54:45, 123.75s/it]
round 6, global test acc  0.0515 

round 6, average 3shot acc: [head: 0.1424, middle: 0.0461, tail: 0.0223] 

round 6, global 3shot acc: [head: 0.1796, middle: 0.0264, tail: 0.0000] 

l_head tensor([0.5875, 0.5768, 1.3700, 0.9302, 0.6792, 0.8404, 1.3389, 1.2787, 1.1032,
        0.5833, 0.7896, 0.5650, 0.5697, 0.7975, 0.9731, 0.9684, 0.8680, 0.5680,
        0.5812, 0.6320, 0.8475, 0.7769, 0.5791, 0.8101, 0.5809, 1.0813, 0.8121,
        1.2590, 0.6949, 0.5966, 0.8239, 0.8973, 0.7738, 0.9021, 0.6288, 0.5540,
        0.5939, 0.5849, 0.5791, 0.7239, 0.6819, 0.5803, 0.5840, 0.7382, 0.7047,
        0.5714, 0.6132, 0.5916, 0.6374, 0.6566, 0.5731, 0.6672, 0.5846, 0.7341,
        0.6438, 0.5720, 0.5706, 0.6696, 0.6650, 0.5646, 0.5769, 0.5931, 0.7891,
        0.5860, 0.5830, 0.5838, 0.5868, 0.7306, 0.5920, 0.6899, 0.5850, 0.6036,
        0.5646, 0.5672, 0.5809, 0.5860, 0.5947, 0.5907, 0.6342, 0.5744, 0.5784,
        0.5748, 0.5628, 0.5904, 0.5819, 0.5837, 0.5657, 0.7264, 0.5867, 0.5893,
        0.5833, 0.5845, 0.5881, 0.5679, 0.5844, 0.5838, 0.6446, 0.5770, 0.6582,
        0.7413], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.0943, 1.1143, 1.4304, 0.9721, 1.1660, 0.9754, 1.0977, 1.2808, 1.1114,
        1.1430, 1.2201, 1.2797, 1.0232, 1.0516, 1.0549, 0.9946, 0.7911, 0.9612,
        0.9402, 0.8447, 1.0640, 0.8572, 0.9668, 0.9896, 0.9444, 0.7801, 0.7135,
        0.6964, 0.8575, 0.8932, 0.8595, 0.7307, 0.8036, 0.7461, 0.7138, 0.6903,
        0.6594, 0.7323, 0.6492, 0.6602, 0.6292, 0.6908, 0.6596, 0.6373, 0.6101,
        0.6484, 0.6266, 0.6633, 0.5978, 0.7314, 0.6461, 0.6075, 0.6462, 0.7515,
        0.6073, 0.6311, 0.5887, 0.5999, 0.6073, 0.6498, 0.6609, 0.6106, 0.6234,
        0.5759, 0.5910, 0.5914, 0.5986, 0.6130, 0.5955, 0.5887, 0.6289, 0.6062,
        0.5767, 0.6074, 0.5756, 0.5882, 0.6103, 0.5832, 0.5805, 0.5887, 0.5818,
        0.5628, 0.5966, 0.5990, 0.5902, 0.5849, 0.5914, 0.5843, 0.5664, 0.5907,
        0.5716, 0.5596, 0.5715, 0.5838, 0.5816, 0.5941, 0.5798, 0.5715, 0.5854,
        0.5879], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([6.4425], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.25766871165644173, middle:0.2, tail0.0
3shot of client 1:head:0.3867403314917127, middle:0.07142857142857142, tail0.0
3shot of client 2:head:0.1417910447761194, middle:0.0, tail0.0
3shot of client 3:head:0.3080168776371308, middle:0.0, tail0.0
3shot of client 4:head:0.18435754189944134, middle:0.024390243902439025, tail0.0
3shot of client 5:head:0.11320754716981132, middle:0.0, tail0.0
3shot of client 6:head:0.2, middle:0.09259259259259259, tail0.0
3shot of client 7:head:0.20382165605095542, middle:0.125, tail0.1111111111111111
3shot of client 8:head:0.2740740740740741, middle:0.027777777777777776, tail0.0
3shot of client 9:head:0.06451612903225806, middle:0.08571428571428572, tail0.1
3shot of client 10:head:0.19626168224299065, middle:0.07692307692307693, tail0.0
3shot of client 11:head:0.232, middle:0.03125, tail0.0
3shot of client 12:head:0.18085106382978725, middle:0.1, tail0.0
3shot of client 13:head:0.23931623931623933, middle:0.03125, tail0.0
3shot of client 14:head:0.14720812182741116, middle:0.047619047619047616, tail0.0
3shot of client 15:head:0.15966386554621848, middle:0.0, tail0.0
3shot of client 16:head:0.3067484662576687, middle:0.0, tail0.0
3shot of client 17:head:0.06369426751592357, middle:0.0, tail0.0
3shot of client 18:head:0.17293233082706766, middle:0.2542372881355932, tail0.0
3shot of client 19:head:0.23170731707317074, middle:0.05263157894736842, tail0.0
3shot of client 20:head:0.23497267759562843, middle:0.0425531914893617, tail0.16666666666666666
3shot of client 21:head:0.14893617021276595, middle:0.05084745762711865, tail0.0
3shot of client 22:head:0.25316455696202533, middle:0.08333333333333333, tail0.0
3shot of client 23:head:0.03260869565217391, middle:0.0, tail0.08333333333333333
3shot of client 24:head:0.007407407407407408, middle:0.10810810810810811, tail0.2857142857142857
3shot of client 25:head:0.34375, middle:0.06451612903225806, tail0.0
3shot of client 26:head:0.11965811965811966, middle:0.07142857142857142, tail0.0
3shot of client 27:head:0.08888888888888889, middle:0.09375, tail0.14285714285714285
3shot of client 28:head:0.22330097087378642, middle:0.0, tail0.0
3shot of client 29:head:0.28846153846153844, middle:0.04081632653061224, tail0.0
3shot of client 30:head:0.09009009009009009, middle:0.2, tail0.0
3shot of client 31:head:0.17616580310880828, middle:0.0, tail0.09090909090909091
3shot of client 32:head:0.1619047619047619, middle:0.08, tail0.0
3shot of client 33:head:0.12299465240641712, middle:0.022727272727272728, tail0.0
3shot of client 34:head:0.03067484662576687, middle:0.0, tail0.1
3shot of client 35:head:0.13043478260869565, middle:0.1, tail0.0
3shot of client 36:head:0.25287356321839083, middle:0.0, tail0.0
3shot of client 37:head:0.18686868686868688, middle:0.0, tail0.0
3shot of client 38:head:0.375, middle:0.0, tail0.0
3shot of client 39:head:0.16666666666666666, middle:0.0, tail0.0
round 7, local average test acc  0.1549 

round 7, local macro average F1 score  0.0433 

round 7, local weighted average F1 score  0.1154 

round 7, global test acc  0.0514 

round 7, average 3shot acc: [head: 0.1875, middle: 0.0545, tail: 0.0270] 

round 7, global 3shot acc: [head: 0.1868, middle: 0.0188, tail: 0.0000] 

l_head tensor([0.5876, 0.5771, 1.6905, 1.1536, 0.7088, 0.9657, 1.7144, 1.5475, 1.4391,
        0.5835, 0.8931, 0.5653, 0.5699, 0.9248, 1.1158, 1.2141, 0.8998, 0.5682,
        0.5815, 0.6488, 0.9532, 0.8214, 0.5794, 0.8104, 0.5811, 1.3226, 0.9231,
        1.5151, 0.7053, 0.5968, 1.0024, 1.0028, 0.8543, 1.1402, 0.6927, 0.5542,
        0.5941, 0.5851, 0.5793, 0.8374, 0.7556, 0.5806, 0.5843, 0.7721, 0.8034,
        0.5717, 0.6829, 0.5918, 0.7967, 0.6961, 0.5734, 0.7242, 0.5848, 0.8024,
        0.6763, 0.5723, 0.6209, 0.6599, 0.7589, 0.5648, 0.5771, 0.5934, 0.8846,
        0.5862, 0.5832, 0.5841, 0.5870, 0.8095, 0.5922, 0.7852, 0.5852, 0.7159,
        0.5648, 0.5675, 0.5811, 0.5862, 0.5949, 0.5909, 0.6778, 0.5746, 0.5786,
        0.5751, 0.5631, 0.5906, 0.5821, 0.5840, 0.5660, 0.7872, 0.5869, 0.5896,
        0.5835, 0.5847, 0.5882, 0.5681, 0.5847, 0.5840, 0.6763, 0.5772, 0.6814,
        0.7974], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.1815, 1.2062, 1.5413, 1.0974, 1.2287, 0.9994, 1.2262, 1.3473, 1.1992,
        1.2547, 1.2516, 1.3449, 1.1304, 1.0809, 1.1089, 1.0682, 0.8194, 0.9875,
        0.9902, 0.8468, 1.1318, 0.9108, 1.0113, 1.0443, 0.9704, 0.8301, 0.7344,
        0.7479, 0.8712, 0.9116, 0.9255, 0.7595, 0.8471, 0.7744, 0.7283, 0.7094,
        0.6734, 0.7668, 0.6801, 0.6945, 0.6489, 0.7100, 0.6820, 0.6378, 0.6233,
        0.6613, 0.6434, 0.6850, 0.6108, 0.8084, 0.6551, 0.6238, 0.6856, 0.7527,
        0.6182, 0.6405, 0.5938, 0.6028, 0.6247, 0.6636, 0.6810, 0.6188, 0.6449,
        0.5760, 0.5909, 0.5949, 0.6000, 0.6155, 0.6024, 0.6035, 0.6256, 0.6275,
        0.5835, 0.6088, 0.5795, 0.5911, 0.6153, 0.5864, 0.5833, 0.5907, 0.5840,
        0.5620, 0.5989, 0.6035, 0.5901, 0.5851, 0.5950, 0.5879, 0.5674, 0.5913,
        0.5735, 0.5618, 0.5770, 0.5843, 0.5825, 0.6039, 0.5823, 0.5721, 0.5902,
        0.5941], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([6.8745], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.2392638036809816, middle:0.22857142857142856, tail0.0
3shot of client 1:head:0.287292817679558, middle:0.19047619047619047, tail0.0
3shot of client 2:head:0.1417910447761194, middle:0.0, tail0.0
3shot of client 3:head:0.31645569620253167, middle:0.016129032258064516, tail0.0
3shot of client 4:head:0.1340782122905028, middle:0.12195121951219512, tail0.0
3shot of client 5:head:0.11320754716981132, middle:0.0, tail0.0
3shot of client 6:head:0.2097560975609756, middle:0.05555555555555555, tail0.0
3shot of client 7:head:0.22929936305732485, middle:0.1, tail0.0
3shot of client 8:head:0.2962962962962963, middle:0.027777777777777776, tail0.0
3shot of client 9:head:0.13548387096774195, middle:0.11428571428571428, tail0.1
3shot of client 10:head:0.17757009345794392, middle:0.11538461538461539, tail0.0  2%|         | 9/500 [15:51<17:58:30, 131.79s/it]
3shot of client 11:head:0.256, middle:0.0, tail0.0
3shot of client 12:head:0.22872340425531915, middle:0.02, tail0.0
3shot of client 13:head:0.3162393162393162, middle:0.0, tail0.0
3shot of client 14:head:0.16751269035532995, middle:0.07142857142857142, tail0.0
3shot of client 15:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 16:head:0.3006134969325153, middle:0.0, tail0.0
3shot of client 17:head:0.10191082802547771, middle:0.0, tail0.0
3shot of client 18:head:0.37969924812030076, middle:0.0847457627118644, tail0.0
3shot of client 19:head:0.2682926829268293, middle:0.017543859649122806, tail0.0
3shot of client 20:head:0.1092896174863388, middle:0.1702127659574468, tail0.08333333333333333
3shot of client 21:head:0.1574468085106383, middle:0.05084745762711865, tail0.0
3shot of client 22:head:0.2911392405063291, middle:0.1111111111111111, tail0.0
3shot of client 23:head:0.043478260869565216, middle:0.0, tail0.08333333333333333
3shot of client 24:head:0.2740740740740741, middle:0.02702702702702703, tail0.0
3shot of client 25:head:0.2265625, middle:0.06451612903225806, tail0.0
3shot of client 26:head:0.13675213675213677, middle:0.07142857142857142, tail0.0
3shot of client 27:head:0.0962962962962963, middle:0.09375, tail0.0
3shot of client 28:head:0.22330097087378642, middle:0.02, tail0.0
3shot of client 29:head:0.30288461538461536, middle:0.14285714285714285, tail0.0
3shot of client 30:head:0.13513513513513514, middle:0.13333333333333333, tail0.0
3shot of client 31:head:0.16580310880829016, middle:0.0, tail0.09090909090909091
3shot of client 32:head:0.24761904761904763, middle:0.08, tail0.0
3shot of client 33:head:0.13368983957219252, middle:0.0, tail0.0
3shot of client 34:head:0.08588957055214724, middle:0.0, tail0.0
3shot of client 35:head:0.13043478260869565, middle:0.1, tail0.0
3shot of client 36:head:0.034482758620689655, middle:0.0, tail0.09090909090909091
3shot of client 37:head:0.015151515151515152, middle:0.0, tail0.18181818181818182
3shot of client 38:head:0.3541666666666667, middle:0.07894736842105263, tail0.0
3shot of client 39:head:0.16161616161616163, middle:0.0, tail0.0
round 8, local average test acc  0.1600 

round 8, local macro average F1 score  0.0488 

round 8, local weighted average F1 score  0.1232 

round 8, global test acc  0.0634 

round 8, average 3shot acc: [head: 0.1942, middle: 0.0577, tail: 0.0158] 

round 8, global 3shot acc: [head: 0.2232, middle: 0.0304, tail: 0.0000] 

l_head tensor([0.5876, 0.5771, 1.6905, 1.1536, 0.7088, 0.9657, 1.7144, 1.5475, 1.4391,
        0.5835, 0.8931, 0.5653, 0.5699, 0.9248, 1.1158, 1.2141, 0.8998, 0.5682,
        0.5815, 0.6488, 0.9532, 0.8214, 0.5794, 0.8104, 0.5811, 1.3226, 0.9231,
        1.5151, 0.7053, 0.5968, 1.0024, 1.0028, 0.8543, 1.1402, 0.6927, 0.5542,
        0.5941, 0.5851, 0.5793, 0.8374, 0.7556, 0.5806, 0.5843, 0.7721, 0.8034,
        0.5717, 0.6829, 0.5918, 0.7967, 0.6961, 0.5734, 0.7242, 0.5848, 0.8024,
        0.6763, 0.5723, 0.6209, 0.6599, 0.7589, 0.5648, 0.5771, 0.5934, 0.8846,
        0.5862, 0.5832, 0.5841, 0.5870, 0.8095, 0.5922, 0.7852, 0.5852, 0.7159,
        0.5648, 0.5675, 0.5811, 0.5862, 0.5949, 0.5909, 0.6778, 0.5746, 0.5786,
        0.5751, 0.5631, 0.5906, 0.5821, 0.5840, 0.5660, 0.7872, 0.5869, 0.5896,
        0.5835, 0.5847, 0.5882, 0.5681, 0.5847, 0.5840, 0.6763, 0.5772, 0.6814,
        0.7974], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.2569, 1.3364, 1.6481, 1.1699, 1.3168, 1.0436, 1.2741, 1.4225, 1.2479,
        1.2653, 1.3142, 1.4244, 1.1935, 1.1947, 1.2178, 1.1145, 0.8688, 1.1028,
        1.0710, 0.8597, 1.1952, 1.0084, 1.0672, 1.0981, 1.0547, 0.8410, 0.7461,
        0.7729, 0.8977, 0.9607, 1.0280, 0.8094, 0.8719, 0.7863, 0.7753, 0.7256,
        0.7078, 0.8279, 0.6969, 0.6968, 0.6537, 0.7259, 0.7057, 0.6430, 0.6430,
        0.6725, 0.6442, 0.7095, 0.6136, 0.8334, 0.6619, 0.6338, 0.7259, 0.7868,
        0.6268, 0.6458, 0.6032, 0.6099, 0.6244, 0.6698, 0.7020, 0.6324, 0.6699,
        0.5746, 0.5938, 0.5996, 0.6022, 0.6222, 0.6066, 0.6118, 0.6318, 0.6355,
        0.5864, 0.6156, 0.5841, 0.5915, 0.6213, 0.5890, 0.5852, 0.5940, 0.5869,
        0.5625, 0.6034, 0.6103, 0.5918, 0.5872, 0.6034, 0.5886, 0.5670, 0.5916,
        0.5754, 0.5625, 0.5774, 0.5850, 0.5840, 0.6241, 0.5841, 0.5729, 0.5904,
        0.6036], device='cuda:4', grad_fn=<NormBackward1>)
The value of constant scaler:  tensor([7.2545], device='cuda:4', requires_grad=True)
3shot of client 0:head:0.2331288343558282, middle:0.22857142857142856, tail0.0
3shot of client 1:head:0.3812154696132597, middle:0.19047619047619047, tail0.0
3shot of client 2:head:0.13432835820895522, middle:0.0, tail0.0
3shot of client 3:head:0.3670886075949367, middle:0.0, tail0.0
3shot of client 4:head:0.18994413407821228, middle:0.0975609756097561, tail0.1
3shot of client 5:head:0.10377358490566038, middle:0.0, tail0.0
3shot of client 6:head:0.1951219512195122, middle:0.07407407407407407, tail0.0
3shot of client 7:head:0.3248407643312102, middle:0.025, tail0.1111111111111111
3shot of client 8:head:0.28888888888888886, middle:0.0, tail0.0
3shot of client 9:head:0.06451612903225806, middle:0.08571428571428572, tail0.0
3shot of client 10:head:0.21495327102803738, middle:0.038461538461538464, tail0.0
3shot of client 11:head:0.208, middle:0.0, tail0.0
3shot of client 12:head:0.2553191489361702, middle:0.08, tail0.0
3shot of client 13:head:0.27350427350427353, middle:0.0625, tail0.0
3shot of client 14:head:0.16243654822335024, middle:0.023809523809523808, tail0.0
3shot of client 15:head:0.17647058823529413, middle:0.0, tail0.0
3shot of client 16:head:0.2883435582822086, middle:0.02702702702702703, tail0.0
3shot of client 17:head:0.08917197452229299, middle:0.0, tail0.0
3shot of client 18:head:0.2631578947368421, middle:0.11864406779661017, tail0.0
3shot of client 19:head:0.3048780487804878, middle:0.05263157894736842, tail0.0
3shot of client 20:head:0.08196721311475409, middle:0.0, tail0.0
3shot of client 21:head:0.20851063829787234, middle:0.06779661016949153, tail0.0
3shot of client 22:head:0.24050632911392406, middle:0.05555555555555555, tail0.0
3shot of client 23:head:0.22826086956521738, middle:0.0425531914893617, tail0.0
3shot of client 24:head:0.34074074074074073, middle:0.10810810810810811, tail0.0
3shot of client 25:head:0.28125, middle:0.06451612903225806, tail0.0
3shot of client 26:head:0.23931623931623933, middle:0.14285714285714285, tail0.2857142857142857
3shot of client 27:head:0.08148148148148149, middle:0.125, tail0.2857142857142857
3shot of client 28:head:0.2087378640776699, middle:0.0, tail0.0
3shot of client 29:head:0.34134615384615385, middle:0.1836734693877551, tail0.0
3shot of client 30:head:0.12612612612612611, middle:0.13333333333333333, tail0.0
3shot of client 31:head:0.16580310880829016, middle:0.02040816326530612, tail0.09090909090909091
3shot of client 32:head:0.06666666666666667, middle:0.0, tail0.0
3shot of client 33:head:0.13368983957219252, middle:0.0, tail0.0
3shot of client 34:head:0.12269938650306748, middle:0.02702702702702703, tail0.0
3shot of client 35:head:0.1391304347826087, middle:0.1, tail0.0
3shot of client 36:head:0.25862068965517243, middle:0.06521739130434782, tail0.0
3shot of client 37:head:0.025252525252525252, middle:0.0, tail0.18181818181818182
3shot of client 38:head:0.3333333333333333, middle:0.02631578947368421, tail0.0
3shot of client 39:head:0.17676767676767677, middle:0.0, tail0.0
round 9, local average test acc  0.1707 

round 9, local macro average F1 score  0.0447 

round 9, local weighted average F1 score  0.1201 

round 9, global test acc  0.0644 

round 9, average 3shot acc: [head: 0.2080, middle: 0.0567, tail: 0.0264] 

round 9, global 3shot acc: [head: 0.2320, middle: 0.0256, tail: 0.0000] 

l_head tensor([0.5876, 0.5771, 1.6905, 1.1536, 0.7088, 0.9657, 1.7144, 1.5475, 1.4391,
        0.5835, 0.8931, 0.5653, 0.5699, 0.9248, 1.1158, 1.2141, 0.8998, 0.5682,
        0.5815, 0.6488, 0.9532, 0.8214, 0.5794, 0.8104, 0.5811, 1.3226, 0.9231,
        1.5151, 0.7053, 0.5968, 1.0024, 1.0028, 0.8543, 1.1402, 0.6927, 0.5542,
        0.5941, 0.5851, 0.5793, 0.8374, 0.7556, 0.5806, 0.5843, 0.7721, 0.8034,
        0.5717, 0.6829, 0.5918, 0.7967, 0.6961, 0.5734, 0.7242, 0.5848, 0.8024,
        0.6763, 0.5723, 0.6209, 0.6599, 0.7589, 0.5648, 0.5771, 0.5934, 0.8846,
        0.5862, 0.5832, 0.5841, 0.5870, 0.8095, 0.5922, 0.7852, 0.5852, 0.7159,
        0.5648, 0.5675, 0.5811, 0.5862, 0.5949, 0.5909, 0.6778, 0.5746, 0.5786,
        0.5751, 0.5631, 0.5906, 0.5821, 0.5840, 0.5660, 0.7872, 0.5869, 0.5896,
        0.5835, 0.5847, 0.5882, 0.5681, 0.5847, 0.5840, 0.6763, 0.5772, 0.6814,
        0.7974], device='cuda:4', grad_fn=<NormBackward1>)  2%|         | 10/500 [18:22<18:44:49, 137.73s/it]  2%|         | 11/500 [20:50<19:08:36, 140.93s/it]
nohup: ignoring input
./temp/fl_acc_cifar100_resnet34_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N20_100_seed3407_p1_dirichlet0.5_IF0.01_LossCE.txt
Files already downloaded and verified
[500, 477, 455, 434, 415, 396, 378, 361, 344, 328, 314, 299, 286, 273, 260, 248, 237, 226, 216, 206, 197, 188, 179, 171, 163, 156, 149, 142, 135, 129, 123, 118, 112, 107, 102, 98, 93, 89, 85, 81, 77, 74, 70, 67, 64, 61, 58, 56, 53, 51, 48, 46, 44, 42, 40, 38, 36, 35, 33, 32, 30, 29, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 15, 14, 13, 13, 12, 12, 11, 11, 10, 10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5]
10847
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[573, 766, 469, 733, 726, 766, 466, 320, 676, 410, 554, 546, 535, 512, 586, 396, 460, 448, 431, 474]
training set distribution:
[[  8   5  18   0  32  55  32   1  64   2   4  41   7   3  47  19   2   3
    0   6   0   3   5  14   6   4   9  50   0  11   3   0   2   0  38  12
   11   1  19   0   1   0   0   0   1  10   0   0   3   0   0   0   0   0
    1   0   2   2   0   0   1   0   2   0   2   4   0   0   0   0   0   0
    0   0   1   0   0   1   0   0   0   0   2   0   0   0   1   0   0   0
    0   0   0   0   0   1   1   0   0   0]
 [ 99   7  26  25  22   2  54  80   2  28  22  33   7  19 105   0   1   3
    4  13   2  26   9   3   0   4   4   4  37   0  18   1   2   6   5  16
    4   0  15  13   1   0   0   0   3   2   0   0   0   0   2   2   3   9
    1   0   2   0   2   1   0   0   3   0   0   0   0   0   0   7   0   0
    0   0   0   0   0   0   0   0   0   0   0   1   0   2   1   0   0   0
    0   2   0   1   0   0   0   0   0   0]
 [ 14  60   9  13   3  40   0   8   0   6  24  11  75  13  14   6  11   2
    2   7   0   0   0   0   0  10   0   4   0   3   7  10  11   3   5   0
    8   6   1   0   1   8   1   1   5   0   5   2   4   8   0   1   3   0
    2   1   1   1   3   3   2   2   0   0   0   0   0   0   0   0   2   0
    0   1   4   0   6   1   0   0   4   0   3   0   3   0   1   0   1   2
    0   0   0   0   0   0   0   1   0   0]
 [ 23  89  56   2  47   1   7   8  48  33   0  49   1  29   5  32   2  17
   76   5  13  10   0  12   0   0   2   0   9  19  16   2   0  18   2   0
    6   0   0   2   2   1  26   5  10   2   0   1   0   0   4   1   0   1
    1   0   0   0   0   1   3   0   0   8   3   2   0   1   3   0   1   0
    0   4   0   0   0   0   0   0   0   0   0   1   0   1   0   1   3   0
    3   0   1   0   2   0   0   0   0   0]
 [  9  95  66   3  48   7  41  15  36  24  65   1   2   1   0   2   4   8
    0   6  29   0   2  53   7   2  24  19  10  14   0   3   0  25   2   5
    0  30   3   0   4   0   4   7   7   4   0   0   8   4   3   1   0   0
    2   0   0   4   0   0   0   0   1   0   4   0   0   0   0   0   1   3
    1   0   0   1   0   0   2   1   0   0   1   0   0   0   1   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 22  45  14  67   2   2  54  10  18  22  47  12  10  71  16   1  52   4
    7   1  31  36  16   8  25  30   7   0   8   0   3   0   6   6   6  27
    0   0   0   0   4   0   0   0   2   5   4   5   9   1   5   3   3   0
    1   0   6  14   1   1   0   0   1   0   1   3   0   0   0   0   0   4
    1   2   0   0   0   1   0   1   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [  5   0   1  11  50   1  31  30  22  10   1   1   8   4   2   0   2   6
   31   0  15  46   1   7   9   1  18   0   0  10   5   0   7   2  24   2
    6   2   5  18   4   3   3   0   0   0   2   4   3   8   0   3   1   1
    0   2   4   3   0   0   0   6   0   2   0   2   0   2   0   2   3   0
    0   0   0   0   0   2   1   3   0   0   0   0   0   0   1   0   3   0
    0   0   0   2   0   0   1   0   0   1]
 [  0  19   5  26  11  14   5  14   2  11   1  12  20   2   7   6   0   0
    3   0  21   0   3   0   1   1  14   0   2  12   1   9   3   0   4   6
    1   1   5   0   2  10   1   4   1   2   6   0   2   2   1   4   3   1
    0  16   3   0   0   0   1   0   1   1   0   1   0   3   2   0   1   0
    0   1   1   2   0   1   1   2   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [ 44  21  72  58  46  20   1   1  52   0  37  46  14   5  10  11  17   8
    1   1   1   1   8  16  15  40   0   0   0  12   1  10   1   0   0   3
    9   0   5   3   6   5   6   2   7   0   0   5   0   0   2   1   0   0
    7  11   3   0   1   1   2   0   0   0   3   0   4   0   0   1   5   0
    1   0   0   0   0   0   1   0   2   1   0   0   0   0   2   2   0   1
    0   1   0   0   0   0   1   0   0   2]
 [  0  16   3   2  33  70   1  22   1   5  45   9   5   6   3   7   0  14
    7   5   8   5   2   0   1   4   2   5   0   0   1  12   1   7   0   2
    1   2  15  18   0   2   0   0   7  10   3   0   1   2   2   0   5   0
    1   0   7   0   2   0   0   1   0   0   0   0   1   0   0   0   3   1
    0   3   0   3   1   0   0   0   0   0   3   0   2   2   0   2   0   1
    0   1   0   1   0   1   0   0   0   2]
 [  0   0   0  28  16   3  89  14  43   6   9   7   0  12   0   2  62   0
    8  74   2   2   0  26   2   1   8   2   6   0   1   0   2   2   1   2
    5   1   1   0   8   2   0   1   4   7   0  18   0   2   1   0   0  13
    4   0   4   1   0   3   3   0   0   3   3   0   8   0   2   1   0   0
    9   1   2   3   0   1   4   0   1   0   0   1   0   2   0   0   0   0
    0   0   1   0   1   1   0   0   2   0]
 [ 90   0  30  51   5   0   4   3   1   5   1   1   8  11  23  84   0  23
    4   6   0   2   9   0   0   3   0   7   7  17   5   2  21   5   0   3
    0   2   0   2   0   0   0  10   0   1  13   3   0   7   1   2   3   1
    5   0   0   0   6   3   1   1   3   0   5  11   0  12   0   1   0   4
    1   0   4   0   0   0   0   0   1   0   0   3   0   0   0   1   0   1
    2   0   0   0   0   1   1   1   2   0]
 [  9  41   0  22   1  13   6   1   0  53  13   6  47  19   4   2   2  13
   10  15   3   0   0   0  67   8   7   2  37   0  35   0   0  11   0   4
    4   1   2   0   0   8   3   4   2   0   0   0   3   0   5   3   2   8
    5   1   0   5   1   0   1   0   3   0   2   0   0   0   7   0   0   2
    0   0   0   1   3   0   1   0   2   0   1   0   1   0   0   0   0   0
    0   1   0   0   1   0   1   0   0   0]
 [ 14  17   3  80   2  97  18   3   0  17   3   1  13  20   0   1   3   6
    0   0   1  24  40   6   2   1   2   8   0   7   5   1   0   2   1   0
    1   0   5   1  12   4   0  19   6   4   1   5   0   8   0   6   6   0
    2   3   0   0   1   5   0   1   1   6   0   0   0   0   0   1   1   2
    0   0   0   1   3   0   0   2   0   3   0   2   1   0   0   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 30  43   0  19   2   1  17 114   1  68   2   0   6   2   4   9   7  28
    0  11   2   0   7   2  11  12   5  14   9  12   3   2  10   7   0   2
    8   2   0   6  14   4   1   0   0   0  13   1   4   0   8   5   4   0
    6   0   0   4   0   0   2   7   7   2   0   1   2   0   2   3   0   2
    1   0   0   1   0   1   0   2   1   1   0   0   2   2   2   0   0   1
    0   0   0   0   0   1   0   0   1   0]
 [  3   5  43   6  25   7   1  18   0   8   2   2   7   0   0   1   0   0
   37  11   7   0   6   1   3   0  19   0   0   8   0  35  25   0   1  10
    4   0   1  11   6   0   0   4   4   8   5   0  11   9   2   3   0   2
    0   1   1   0   2   2   8   0   4   1   0   0   0   3   1   1   1   0
    0   2   1   2   0   1   0   0   0   3   0   0   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   0   0]
 [ 19   2  21  13   2   0   8  10   1   3  15  15   4  12  17  10  27  40
    1   2   6   1  62  18   2  11  21   7   6   1   0   1   1   1   2   4
   24  15   1   0   2   0   4   1   0   0   2  10   0   0   1   3   4   5
    0   3   0   0   0   0   0   3   0   0   1   0   2   0   0   0   0   0
    0   0   1   0   1   2   3   1   0   0   0   1   1   0   0   0   0   0
    0   1   0   0   2   0   0   0   0   0]
 [  7   5   3   5  21  54   9   0  10   9  20  45  36  35   3  12  23   8
    1   7   0  24   0   4   6  20   6  10   1   0   0   2   0   0   5   0
    0  22   0   6   1   0   0   1   0   0   4   0   3   0   1   0   1   0
    0   0   0   1   0   0   0   6   0   0   1   0   0   0   0   0   0   0
    1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   1
    1   1   1   1   0   0   0   1   0   0]
 [ 87   7  18   0  21   1   0   8   3   2   0   1   6   7   0  10   3  41
    4  35   2   7   7   0   1   2   0  10   3   1  17   2  20   0   0   0
    1   3   0   0   5  20  20   1   5   2   0   2   0   0   9   3   1   1
    2   0   1   0   1  11   1   1   0   3   0   0   3   1   0   3   1   0
    0   1   1   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   1   0   0   0   0]
 [ 17   0  67   3  26   8   0   1  40  16   3   6  10   2   0  33  19   2
   20   1  54   1   2   1   5   2   1   0   0   2   2  26   0  12   6   0
    0   1   7   1   4   7   1   7   0   4   0   0   2   0   1   5   5   0
    0   0   2   0  13   1   5   1   1   0   0   0   3   0   4   0   0   0
    2   0   0   1   0   1   0   0   0   3   0   1   0   0   0   1   0   0
    0   0   1   1   0   0   0   0   0   0]]
Total size of training set
10847
local test distribution:
[[  7   4  16   0  29  50  29   0  59   1   3  37   6   2  43  17   1   2
    0   5   0   2   4  12   5   3   8  46   0  10   2   0   1   0  35  11
   10   0  17   0   0   0   0   0   0   9   0   0   2   0   0   0   0   0
    0   0   1   1   0   0   0   0   1   0   1   3   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 91   6  23  23  20   1  49  73   1  25  20  30   6  17  96   0   0   2
    3  11   1  23   8   2   0   3   3   3  34   0  16   0   1   5   4  14
    3   0  13  11   0   0   0   0   2   1   0   0   0   0   1   1   2   8
    0   0   1   0   1   0   0   0   2   0   0   0   0   0   0   6   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0
    0   1   0   0   0   0   0   0   0   0]
 [ 12  55   8  11   2  36   0   7   0   5  22  10  69  11  12   5  10   1
    1   6   0   0   0   0   0   9   0   3   0   2   6   9  10   2   4   0
    7   5   0   0   0   7   0   0   4   0   4   1   3   7   0   0   2   0
    1   0   0   0   2   2   1   1   0   0   0   0   0   0   0   0   1   0
    0   0   3   0   5   0   0   0   3   0   2   0   2   0   0   0   0   1
    0   0   0   0   0   0   0   0   0   0]
 [ 21  82  51   1  43   0   6   7  44  30   0  45   0  26   4  29   1  15
   70   4  11   9   0  11   0   0   1   0   8  17  14   1   0  16   1   0
    5   0   0   1   1   0  23   4   9   1   0   0   0   0   3   0   0   0
    0   0   0   0   0   0   2   0   0   7   2   1   0   0   2   0   0   0
    0   3   0   0   0   0   0   0   0   0   0   0   0   0   0   0   2   0
    2   0   0   0   1   0   0   0   0   0]
 [  8  87  60   2  44   6  37  13  33  22  59   0   1   0   0   1   3   7
    0   5  26   0   1  48   6   1  22  17   9  12   0   2   0  23   1   4
    0  27   2   0   3   0   3   6   6   3   0   0   7   3   2   0   0   0
    1   0   0   3   0   0   0   0   0   0   3   0   0   0   0   0   0   2
    0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 20  41  12  61   1   1  49   9  16  20  43  11   9  65  14   0  47   3
    6   0  28  33  14   7  23  27   6   0   7   0   2   0   5   5   5  24
    0   0   0   0   3   0   0   0   1   4   3   4   8   0   4   2   2   0
    0   0   5  12   0   0   0   0   0   0   0   2   0   0   0   0   0   3
    0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  4   0   0  10  46   0  28  27  20   9   0   0   7   3   1   0   1   5
   28   0  13  42   0   6   8   0  16   0   0   9   4   0   6   1  22   1
    5   1   4  16   3   2   2   0   0   0   1   3   2   7   0   2   0   0
    0   1   3   2   0   0   0   5   0   1   0   1   0   1   0   1   2   0
    0   0   0   0   0   1   0   2   0   0   0   0   0   0   0   0   2   0
    0   0   0   1   0   0   0   0   0   0]
 [  0  17   4  23  10  12   4  12   1  10   0  11  18   1   6   5   0   0
    2   0  19   0   2   0   0   0  12   0   1  11   0   8   2   0   3   5
    0   0   4   0   1   9   0   3   0   1   5   0   1   1   0   3   2   0
    0  14   2   0   0   0   0   0   0   0   0   0   0   2   1   0   0   0
    0   0   0   1   0   0   0   1   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 40  19  66  53  42  18   0   0  47   0  34  42  12   4   9  10  15   7
    0   0   0   0   7  14  13  36   0   0   0  11   0   9   0   0   0   2
    8   0   4   2   5   4   5   1   6   0   0   4   0   0   1   0   0   0
    6  10   2   0   0   0   1   0   0   0   2   0   3   0   0   0   4   0
    0   0   0   0   0   0   0   0   1   0   0   0   0   0   1   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0  14   2   1  30  64   0  20   0   4  41   8   4   5   2   6   0  12
    6   4   7   4   1   0   0   3   1   4   0   0   0  11   0   6   0   1
    0   1  13  16   0   1   0   0   6   9   2   0   0   1   1   0   4   0
    0   0   6   0   1   0   0   0   0   0   0   0   0   0   0   0   2   0
    0   2   0   2   0   0   0   0   0   0   2   0   1   1   0   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0   0   0  25  14   2  82  12  39   5   8   6   0  11   0   1  57   0
    7  68   1   1   0  23   1   0   7   1   5   0   0   0   1   1   0   1
    4   0   0   0   7   1   0   0   3   6   0  16   0   1   0   0   0  11
    3   0   3   0   0   2   2   0   0   2   2   0   7   0   1   0   0   0
    8   0   1   2   0   0   3   0   0   0   0   0   0   1   0   0   0   0
    0   0   0   0   0   0   0   0   1   0]
 [ 82   0  27  47   4   0   3   2   0   4   0   0   7  10  21  77   0  21
    3   5   0   1   8   0   0   2   0   6   6  15   4   1  19   4   0   2
    0   1   0   1   0   0   0   9   0   0  11   2   0   6   0   1   2   0
    4   0   0   0   5   2   0   0   2   0   4  10   0  11   0   0   0   3
    0   0   3   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   1   0]
 [  8  37   0  20   0  11   5   0   0  48  11   5  43  17   3   1   1  11
    9  13   2   0   0   0  61   7   6   1  34   0  32   0   0  10   0   3
    3   0   1   0   0   7   2   3   1   0   0   0   2   0   4   2   1   7
    4   0   0   4   0   0   0   0   2   0   1   0   0   0   6   0   0   1
    0   0   0   0   2   0   0   0   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 12  15   2  73   1  89  16   2   0  15   2   0  11  18   0   0   2   5
    0   0   0  22  36   5   1   0   1   7   0   6   4   0   0   1   0   0
    0   0   4   0  11   3   0  17   5   3   0   4   0   7   0   5   5   0
    1   2   0   0   0   4   0   0   0   5   0   0   0   0   0   0   0   1
    0   0   0   0   2   0   0   1   0   2   0   1   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 27  39   0  17   1   0  15 105   0  62   1   0   5   1   3   8   6  25
    0  10   1   0   6   1  10  11   4  12   8  11   2   1   9   6   0   1
    7   1   0   5  12   3   0   0   0   0  11   0   3   0   7   4   3   0
    5   0   0   3   0   0   1   6   6   1   0   0   1   0   1   2   0   1
    0   0   0   0   0   0   0   1   0   0   0   0   1   1   1   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  2   4  39   5  23   6   0  16   0   7   1   1   6   0   0   0   0   0
   34  10   6   0   5   0   2   0  17   0   0   7   0  32  23   0   0   9
    3   0   0  10   5   0   0   3   3   7   4   0  10   8   1   2   0   1
    0   0   0   0   1   1   7   0   3   0   0   0   0   2   0   0   0   0
    0   1   0   1   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 17   1  19  11   1   0   7   9   0   2  13  13   3  11  15   9  24  36
    0   1   5   0  57  16   1  10  19   6   5   0   0   0   0   0   1   3
   22  13   0   0   1   0   3   0   0   0   1   9   0   0   0   2   3   4
    0   2   0   0   0   0   0   2   0   0   0   0   1   0   0   0   0   0
    0   0   0   0   0   1   2   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   1   0   0   0   0   0]
 [  6   4   2   4  19  49   8   0   9   8  18  41  33  32   2  11  21   7
    0   6   0  22   0   3   5  18   5   9   0   0   0   1   0   0   4   0
    0  20   0   5   0   0   0   0   0   0   3   0   2   0   0   0   0   0
    0   0   0   0   0   0   0   5   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 80   6  16   0  19   0   0   7   2   1   0   0   5   6   0   9   2  37
    3  32   1   6   6   0   0   1   0   9   2   0  15   1  18   0   0   0
    0   2   0   0   4  18  18   0   4   1   0   1   0   0   8   2   0   0
    1   0   0   0   0  10   0   0   0   2   0   0   2   0   0   2   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 15   0  61   2  23   7   0   0  36  14   2   5   9   1   0  30  17   1
   18   0  49   0   1   0   4   1   0   0   0   1   1  23   0  11   5   0
    0   0   6   0   3   6   0   6   0   3   0   0   1   0   0   4   4   0
    0   0   1   0  11   0   4   0   0   0   0   0   2   0   3   0   0   0
    1   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]]
Total size of testing set
9199
[452 431 408 389 372 352 338 321 307 292 278 265 254 241 231 219 208 197
 190 180 170 165 156 148 140 132 128 124 119 112 102  99  95  91  85  81
  77  71  68  67  59  61  56  52  50  48  45  44  41  41  32  30  30  31
  26  29  24  25  21  21  18  19  16  18  15  17  16  16  14  11   9  11
   9   7   7   6   9   2   6   5   5   6   5   3   4   4   2   2   4   1
   3   1   0   1   2   0   0   0   2   2]
20
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [04:11<34:55:28, 251.96s/it]  0%|          | 2/500 [08:15<34:10:45, 247.08s/it]3shot of client 0:head:0.04497354497354497, middle:0.0, tail0.0
3shot of client 1:head:0.1893491124260355, middle:0.0, tail0.0
3shot of client 2:head:0.02348993288590604, middle:0.0, tail0.0
3shot of client 3:head:0.0, middle:0.047619047619047616, tail0.0
3shot of client 4:head:0.12295081967213115, middle:0.0, tail0.0
3shot of client 5:head:0.08414872798434442, middle:0.0, tail0.0
3shot of client 6:head:0.09523809523809523, middle:0.0, tail0.0
3shot of client 7:head:0.11979166666666667, middle:0.0, tail0.0
3shot of client 8:head:0.0774487471526196, middle:0.0, tail0.0
3shot of client 9:head:0.0, middle:0.058823529411764705, tail0.0
3shot of client 10:head:0.22905027932960895, middle:0.0, tail0.0
3shot of client 11:head:0.07122507122507123, middle:0.0, tail0.0
3shot of client 12:head:0.13793103448275862, middle:0.0, tail0.0
3shot of client 13:head:0.27469135802469136, middle:0.0, tail0.0
3shot of client 14:head:0.16711590296495957, middle:0.0, tail0.0
3shot of client 15:head:0.15476190476190477, middle:0.0, tail0.0
3shot of client 16:head:0.08108108108108109, middle:0.0, tail0.0
3shot of client 17:head:0.16723549488054607, middle:0.0, tail0.0
3shot of client 18:head:0.11764705882352941, middle:0.0, tail0.0
3shot of client 19:head:0.12121212121212122, middle:0.0, tail0.0
round 0, local average test acc  0.0879 

round 0, local macro average F1 score  0.0039 

round 0, local weighted average F1 score  0.0187 

round 0, global test acc  0.0100 

round 0, average 3shot acc: [head: 0.1140, middle: 0.0053, tail: 0.0000] 

round 0, global 3shot acc: [head: 0.0370, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.7372, 0.6253, 0.8540, 0.5749, 0.8666, 1.1521, 0.8392, 0.5990, 1.0630,
        0.6043, 0.6624, 1.0262, 0.7046, 0.5690, 0.8996, 0.7916, 0.5921, 0.6340,
        0.5872, 0.6812, 0.5976, 0.6420, 0.6790, 0.7624, 0.7797, 0.6070, 0.6888,
        1.0125, 0.5923, 0.7539, 0.5830, 0.5928, 0.6085, 0.5978, 0.8636, 0.6644,
        0.7248, 0.6129, 0.7670, 0.6069, 0.6141, 0.5861, 0.5898, 0.5974, 0.5955,
        0.6564, 0.5753, 0.5967, 0.5849, 0.6009, 0.5785, 0.5841, 0.5902, 0.5820,
        0.5835, 0.5773, 0.6190, 0.6127, 0.5853, 0.5707, 0.6082, 0.5983, 0.5967,
        0.5916, 0.6122, 0.6803, 0.5926, 0.5867, 0.5975, 0.5919, 0.5909, 0.5680,
        0.5704, 0.5715, 0.5836, 0.5913, 0.5994, 0.6130, 0.5966, 0.5805, 0.5838,
        0.5809, 0.6467, 0.5962, 0.5873, 0.5893, 0.5814, 0.5930, 0.5928, 0.5943,
        0.5890, 0.5894, 0.5930, 0.5746, 0.5903, 0.6134, 0.6040, 0.5823, 0.5907,
        0.5961], device='cuda:5', grad_fn=<NormBackward1>)
g_aux tensor([0.6122, 0.6295, 0.6283, 0.6302, 0.6097, 0.6202, 0.6181, 0.6095, 0.6305,
        0.6211, 0.5837, 0.6040, 0.6042, 0.5825, 0.5927, 0.5894, 0.6237, 0.5871,
        0.5844, 0.5855, 0.6079, 0.5933, 0.5749, 0.5962, 0.5718, 0.6000, 0.5788,
        0.5675, 0.5884, 0.5813, 0.5819, 0.5897, 0.5850, 0.5772, 0.5749, 0.5962,
        0.5908, 0.5829, 0.5791, 0.5907, 0.5853, 0.5657, 0.5766, 0.5812, 0.5819,
        0.5874, 0.5816, 0.5728, 0.5626, 0.5815, 0.5894, 0.5833, 0.5649, 0.5829,
        0.5831, 0.5995, 0.5689, 0.5600, 0.5756, 0.5955, 0.5639, 0.5843, 0.5812,
        0.5713, 0.5776, 0.5840, 0.5698, 0.5809, 0.5844, 0.5758, 0.5910, 0.5903,
        0.5693, 0.5793, 0.5770, 0.5879, 0.5904, 0.5718, 0.5643, 0.5884, 0.5787,
        0.5593, 0.5844, 0.5805, 0.5855, 0.5824, 0.5725, 0.5835, 0.5721, 0.5934,
        0.5722, 0.5628, 0.5619, 0.5880, 0.5831, 0.5839, 0.5780, 0.5695, 0.5890,
        0.5759], device='cuda:5', grad_fn=<NormBackward1>)
3shot of client 0:head:0.07671957671957672, middle:0.0, tail0.0
3shot of client 1:head:0.1893491124260355, middle:0.0, tail0.0
3shot of client 2:head:0.12080536912751678, middle:0.0, tail0.0
3shot of client 3:head:0.05405405405405406, middle:0.0, tail0.0
3shot of client 4:head:0.12295081967213115, middle:0.0, tail0.0
3shot of client 5:head:0.08414872798434442, middle:0.0, tail0.0
3shot of client 6:head:0.07482993197278912, middle:0.0, tail0.0
3shot of client 7:head:0.0625, middle:0.0, tail0.0
3shot of client 8:head:0.12072892938496584, middle:0.0, tail0.0
3shot of client 9:head:0.0, middle:0.08823529411764706, tail0.0
3shot of client 10:head:0.22905027932960895, middle:0.0, tail0.0
3shot of client 11:head:0.1339031339031339, middle:0.0, tail0.0
3shot of client 12:head:0.031609195402298854, middle:0.0, tail0.0
3shot of client 13:head:0.22530864197530864, middle:0.0, tail0.0
3shot of client 14:head:0.2695417789757412, middle:0.0, tail0.0
3shot of client 15:head:0.12698412698412698, middle:0.0, tail0.0
3shot of client 16:head:0.04391891891891892, middle:0.0, tail0.0
3shot of client 17:head:0.06484641638225255, middle:0.0, tail0.0
3shot of client 18:head:0.06985294117647059, middle:0.0, tail0.0
3shot of client 19:head:0.2053872053872054, middle:0.0, tail0.0
round 1, local average test acc  0.0886 

round 1, local macro average F1 score  0.0035 

round 1, local weighted average F1 score  0.0166 

round 1, global test acc  0.0100 

round 1, average 3shot acc: [head: 0.1153, middle: 0.0044, tail: 0.0000] 

round 1, global 3shot acc: [head: 0.0370, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.8216, 0.6641, 0.9426, 0.5780, 1.1438, 1.4091, 1.2154, 0.6200, 1.4655,
        0.6165, 0.7255, 1.2961, 0.7538, 0.6171, 1.2885, 0.8473, 0.6195, 0.6604,
        0.5900, 0.7320, 0.6007, 0.6972, 0.7528, 0.8611, 0.8161, 0.6501, 0.7720,
        1.2873, 0.5951, 0.8336, 0.6344, 0.5960, 0.6579, 0.6010, 1.0988, 0.7507,
        0.8610, 0.6351, 0.8914, 0.6098, 0.6386, 0.5893, 0.5933, 0.6002, 0.6107,
        0.7467, 0.5789, 0.5998, 0.6190, 0.6040, 0.5817, 0.5871, 0.5929, 0.5846,
        0.6092, 0.5800, 0.6241, 0.6403, 0.5886, 0.5741, 0.6312, 0.6010, 0.6567,
        0.5947, 0.6161, 0.7378, 0.5953, 0.5893, 0.5999, 0.5949, 0.5934, 0.5711,
        0.5730, 0.5744, 0.6018, 0.5945, 0.6022, 0.6215, 0.5992, 0.5834, 0.5869,
        0.5843, 0.6626, 0.5988, 0.5905, 0.5920, 0.5890, 0.5964, 0.5958, 0.5968,
        0.5916, 0.5922, 0.5956, 0.5780, 0.5931, 0.6321, 0.6511, 0.5848, 0.5938,
        0.5993], device='cuda:5', grad_fn=<NormBackward1>)
g_aux tensor([0.6452, 0.6634, 0.6726, 0.6978, 0.6522, 0.6796, 0.6528, 0.6610, 0.6804,
        0.6920, 0.6391, 0.6383, 0.6511, 0.6216, 0.6120, 0.6088, 0.6641, 0.6124,
        0.5967, 0.5899, 0.6314, 0.6197, 0.5876, 0.6084, 0.6006, 0.6140, 0.6028,
        0.5747, 0.5963, 0.5930, 0.5930, 0.6005, 0.6048, 0.5916, 0.5797, 0.6001,
        0.5906, 0.5877, 0.5774, 0.5941, 0.5867, 0.5706, 0.5762, 0.5842, 0.5809,
        0.5874, 0.5791, 0.5735, 0.5611, 0.5901, 0.5843, 0.5840, 0.5677, 0.5818,
        0.5840, 0.6007, 0.5695, 0.5606, 0.5749, 0.5967, 0.5640, 0.5876, 0.5801,
        0.5741, 0.5778, 0.5824, 0.5713, 0.5833, 0.5870, 0.5762, 0.5859, 0.5943,
        0.5668, 0.5785, 0.5773, 0.5877, 0.5904, 0.5692, 0.5666, 0.5890, 0.5766,
        0.5592, 0.5836, 0.5836, 0.5847, 0.5855, 0.5716, 0.5852, 0.5727, 0.5914,
        0.5750, 0.5623, 0.5613, 0.5900, 0.5849, 0.5857, 0.5795, 0.5684, 0.5930,
        0.5808], device='cuda:5', grad_fn=<NormBackward1>)
3shot of client 0:head:0.12433862433862433, middle:0.0, tail0.0
3shot of client 1:head:0.045364891518737675, middle:0.0, tail0.0
3shot of client 2:head:0.12080536912751678, middle:0.0, tail0.0
3shot of client 3:head:0.10602910602910603, middle:0.0, tail0.0
3shot of client 4:head:0.12090163934426229, middle:0.0, tail0.0
3shot of client 5:head:0.09197651663405088, middle:0.0, tail0.0
3shot of client 6:head:0.09523809523809523, middle:0.0, tail0.0
3shot of client 7:head:0.0625, middle:0.0, tail0.0
3shot of client 8:head:0.15034168564920272, middle:0.0, tail0.0
3shot of client 9:head:0.11952191235059761, middle:0.0, tail0.0
3shot of client 10:head:0.0, middle:0.06976744186046512, tail0.0
3shot of client 11:head:0.1339031339031339, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.10714285714285714, tail0.0
3shot of client 13:head:0.22530864197530864, middle:0.0, tail0.0
3shot of client 14:head:0.16711590296495957, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0967741935483871, tail0.0
3shot of client 16:head:0.06418918918918919, middle:0.0, tail0.0
3shot of client 17:head:0.16723549488054607, middle:0.0, tail0.0
  1%|          | 3/500 [12:20<33:59:52, 246.26s/it]  1%|          | 4/500 [16:22<33:40:49, 244.46s/it]3shot of client 18:head:0.11764705882352941, middle:0.0, tail0.0
3shot of client 19:head:0.05723905723905724, middle:0.0, tail0.0
round 2, local average test acc  0.0774 

round 2, local macro average F1 score  0.0035 

round 2, local weighted average F1 score  0.0140 

round 2, global test acc  0.0100 

round 2, average 3shot acc: [head: 0.0985, middle: 0.0137, tail: 0.0000] 

round 2, global 3shot acc: [head: 0.0370, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.8701, 0.6957, 1.0696, 0.5817, 1.2902, 1.8680, 1.4109, 0.6397, 1.7536,
        0.6258, 0.7213, 1.5329, 0.9162, 0.6680, 1.5054, 0.9235, 0.6518, 0.7068,
        0.5935, 0.8548, 0.6048, 0.7223, 0.8589, 1.0913, 0.8783, 0.6735, 0.8064,
        1.5835, 0.5991, 0.9391, 0.6896, 0.5997, 0.6394, 0.6047, 1.4326, 0.9028,
        0.9577, 0.6906, 1.0853, 0.6138, 0.6740, 0.5932, 0.5974, 0.6036, 0.6269,
        0.8436, 0.5828, 0.6036, 0.6426, 0.6078, 0.5853, 0.5914, 0.5971, 0.5882,
        0.6284, 0.5839, 0.6526, 0.6630, 0.5921, 0.5781, 0.6613, 0.6050, 0.6739,
        0.5988, 0.6494, 0.7982, 0.5993, 0.5931, 0.6038, 0.5983, 0.5972, 0.5753,
        0.5767, 0.5782, 0.6227, 0.5984, 0.6060, 0.6392, 0.6033, 0.5872, 0.5907,
        0.5883, 0.7054, 0.6024, 0.5945, 0.5955, 0.6161, 0.6003, 0.6000, 0.6009,
        0.5959, 0.5957, 0.5996, 0.5821, 0.5964, 0.6508, 0.7159, 0.5878, 0.5979,
        0.6036], device='cuda:5', grad_fn=<NormBackward1>)
g_aux tensor([0.6731, 0.7051, 0.7554, 0.7735, 0.7121, 0.7378, 0.6900, 0.7108, 0.7443,
        0.7399, 0.6817, 0.6918, 0.7130, 0.6688, 0.6528, 0.6440, 0.7086, 0.6470,
        0.6259, 0.6090, 0.6686, 0.6419, 0.6072, 0.6421, 0.6228, 0.6242, 0.6306,
        0.5856, 0.5996, 0.6055, 0.6106, 0.6218, 0.6145, 0.6125, 0.5870, 0.6040,
        0.6029, 0.5930, 0.5856, 0.6034, 0.5949, 0.5753, 0.5754, 0.5869, 0.5865,
        0.5935, 0.5803, 0.5764, 0.5632, 0.6088, 0.5856, 0.5850, 0.5757, 0.5810,
        0.5844, 0.5992, 0.5746, 0.5608, 0.5713, 0.6023, 0.5752, 0.5838, 0.5798,
        0.5727, 0.5794, 0.5804, 0.5734, 0.5865, 0.5937, 0.5767, 0.5844, 0.5960,
        0.5695, 0.5777, 0.5755, 0.5856, 0.5950, 0.5658, 0.5679, 0.5922, 0.5761,
        0.5582, 0.5818, 0.5841, 0.5865, 0.5883, 0.5738, 0.5842, 0.5731, 0.5914,
        0.5757, 0.5647, 0.5604, 0.5926, 0.5867, 0.5882, 0.5817, 0.5714, 0.5947,
        0.5837], device='cuda:5', grad_fn=<NormBackward1>)
3shot of client 0:head:0.13756613756613756, middle:0.0, tail0.0
3shot of client 1:head:0.21893491124260356, middle:0.0, tail0.0
3shot of client 2:head:0.14429530201342283, middle:0.0, tail0.0
3shot of client 3:head:0.10602910602910603, middle:0.0, tail0.0
3shot of client 4:head:0.09221311475409837, middle:0.0, tail0.0
3shot of client 5:head:0.14481409001956946, middle:0.0, tail0.0
3shot of client 6:head:0.1564625850340136, middle:0.0, tail0.0
3shot of client 7:head:0.057291666666666664, middle:0.0, tail0.0
3shot of client 8:head:0.11845102505694761, middle:0.0, tail0.0
3shot of client 9:head:0.0, middle:0.014705882352941176, tail0.0
3shot of client 10:head:0.22905027932960895, middle:0.0, tail0.0
3shot of client 11:head:0.08262108262108261, middle:0.0, tail0.0
3shot of client 12:head:0.20402298850574713, middle:0.0, tail0.0
3shot of client 13:head:0.27469135802469136, middle:0.0, tail0.0
3shot of client 14:head:0.029649595687331536, middle:0.042105263157894736, tail0.0
3shot of client 15:head:0.15873015873015872, middle:0.0, tail0.0
3shot of client 16:head:0.1891891891891892, middle:0.0, tail0.0
3shot of client 17:head:0.07849829351535836, middle:0.0, tail0.0
3shot of client 18:head:0.3272058823529412, middle:0.0, tail0.0
3shot of client 19:head:0.06060606060606061, middle:0.0, tail0.0
round 3, local average test acc  0.1076 

round 3, local macro average F1 score  0.0084 

round 3, local weighted average F1 score  0.0423 

round 3, global test acc  0.0100 

round 3, average 3shot acc: [head: 0.1405, middle: 0.0028, tail: 0.0000] 

round 3, global 3shot acc: [head: 0.0370, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.9492, 0.7540, 1.2577, 0.5837, 1.4104, 2.0098, 1.6062, 0.6561, 2.1380,
        0.6732, 0.7989, 1.7458, 0.9582, 0.7340, 1.7140, 1.0667, 0.6896, 0.7706,
        0.5952, 0.9083, 0.6065, 0.7119, 0.8628, 1.2845, 0.9862, 0.7214, 0.8558,
        1.8057, 0.6008, 0.9888, 0.7191, 0.6015, 0.6634, 0.6062, 1.6628, 0.9735,
        1.0118, 0.7226, 1.2482, 0.6153, 0.7559, 0.5952, 0.5992, 0.6053, 0.6540,
        0.8749, 0.5848, 0.6054, 0.6644, 0.6092, 0.5867, 0.5933, 0.5989, 0.5898,
        0.6375, 0.5854, 0.7140, 0.7106, 0.5936, 0.5799, 0.7022, 0.6066, 0.7028,
        0.6007, 0.6638, 0.8370, 0.6011, 0.5946, 0.6054, 0.6001, 0.5988, 0.5772,
        0.5786, 0.5798, 0.6219, 0.6000, 0.6077, 0.6427, 0.6050, 0.5890, 0.5926,
        0.5904, 0.7530, 0.6037, 0.5964, 0.5972, 0.6531, 0.6019, 0.6017, 0.6029,
        0.5976, 0.5974, 0.6011, 0.5842, 0.5980, 0.6937, 0.7320, 0.5893, 0.5999,
        0.6054], device='cuda:5', grad_fn=<NormBackward1>)
g_aux tensor([0.7283, 0.7718, 0.8099, 0.8361, 0.7844, 0.7816, 0.7512, 0.7528, 0.8099,
        0.7812, 0.7371, 0.7296, 0.7716, 0.7007, 0.6917, 0.6732, 0.7444, 0.7172,
        0.6422, 0.6362, 0.7112, 0.6618, 0.6360, 0.6992, 0.6580, 0.6469, 0.6478,
        0.6034, 0.6128, 0.6176, 0.6440, 0.6449, 0.6306, 0.6288, 0.5945, 0.6103,
        0.6199, 0.6032, 0.5917, 0.6153, 0.6026, 0.5906, 0.5820, 0.5942, 0.5948,
        0.5964, 0.5783, 0.5900, 0.5642, 0.6409, 0.5866, 0.5902, 0.5910, 0.5903,
        0.5862, 0.6026, 0.5802, 0.5633, 0.5742, 0.6114, 0.5901, 0.5838, 0.5847,
        0.5767, 0.5814, 0.5805, 0.5768, 0.5915, 0.5969, 0.5807, 0.5868, 0.6036,
        0.5692, 0.5852, 0.5750, 0.5862, 0.5996, 0.5666, 0.5674, 0.5951, 0.5753,
        0.5571, 0.5830, 0.5878, 0.5867, 0.5892, 0.5738, 0.5853, 0.5754, 0.5911,
        0.5785, 0.5654, 0.5617, 0.5931, 0.5875, 0.5912, 0.5846, 0.5734, 0.5947,
        0.5856], device='cuda:5', grad_fn=<NormBackward1>)
3shot of client 0:head:0.1746031746031746, middle:0.031914893617021274, tail0.0
3shot of client 1:head:0.2682445759368836, middle:0.0, tail0.0
3shot of client 2:head:0.13758389261744966, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.19542619542619544, middle:0.023809523809523808, tail0.0
3shot of client 4:head:0.23155737704918034, middle:0.0, tail0.0
3shot of client 5:head:0.15655577299412915, middle:0.0, tail0.0
3shot of client 6:head:0.16666666666666666, middle:0.09333333333333334, tail0.0
3shot of client 7:head:0.109375, middle:0.0, tail0.0
3shot of client 8:head:0.14578587699316628, middle:0.06837606837606838, tail0.0
3shot of client 9:head:0.07171314741035857, middle:0.0, tail0.0
3shot of client 10:head:0.1871508379888268, middle:0.0, tail0.0
3shot of client 11:head:0.25925925925925924, middle:0.0, tail0.0
3shot of client 12:head:0.20689655172413793, middle:0.047619047619047616, tail0.0
3shot of client 13:head:0.2932098765432099, middle:0.0, tail0.0
3shot of client 14:head:0.2884097035040431, middle:0.0, tail0.0
3shot of client 15:head:0.16666666666666666, middle:0.016129032258064516, tail0.0
3shot of client 16:head:0.18243243243243243, middle:0.0, tail0.0
3shot of client 17:head:0.17406143344709898, middle:0.06944444444444445, tail0.0
3shot of client 18:head:0.4485294117647059, middle:0.0, tail0.0
3shot of client 19:head:0.2053872053872054, middle:0.0375, tail0.0
round 4, local average test acc  0.1588 

round 4, local macro average F1 score  0.0218 

round 4, local weighted average F1 score  0.0827 

round 4, global test acc  0.0117 

round 4, average 3shot acc: [head: 0.2035, middle: 0.0201, tail: 0.0000] 

round 4, global 3shot acc: [head: 0.0433, middle: 0.0000, tail: 0.0000] 

l_head   1%|          | 5/500 [20:34<33:58:22, 247.08s/it]  1%|          | 6/500 [24:42<33:56:18, 247.33s/it]tensor([1.0949, 0.7549, 1.3364, 0.5861, 1.5677, 2.1812, 1.7018, 0.6751, 2.3085,
        0.6836, 0.8380, 1.8502, 1.0594, 0.7940, 1.8816, 1.2058, 0.6969, 0.8657,
        0.5974, 0.9465, 0.6086, 0.7494, 0.9168, 1.3331, 1.0560, 0.7176, 0.9265,
        2.0926, 0.6028, 1.0438, 0.7756, 0.6036, 0.7209, 0.6082, 1.7930, 1.0331,
        1.1016, 0.7586, 1.3493, 0.6176, 0.8045, 0.5974, 0.6016, 0.6070, 0.6951,
        0.9669, 0.5870, 0.6075, 0.7879, 0.6109, 0.5888, 0.5957, 0.6012, 0.5920,
        0.6691, 0.5878, 0.7702, 0.8083, 0.5955, 0.5823, 0.7016, 0.6087, 0.7477,
        0.6030, 0.6778, 0.9121, 0.6031, 0.5965, 0.6074, 0.6022, 0.6009, 0.5795,
        0.5807, 0.5817, 0.6548, 0.6020, 0.6098, 0.6529, 0.6070, 0.5912, 0.5948,
        0.5927, 0.7884, 0.6057, 0.5984, 0.5991, 0.6464, 0.6041, 0.6040, 0.6051,
        0.5997, 0.5995, 0.6034, 0.5869, 0.6003, 0.7569, 0.7795, 0.5912, 0.6024,
        0.6076], device='cuda:5', grad_fn=<NormBackward1>)
g_aux tensor([0.7808, 0.8904, 0.8883, 0.9201, 0.8504, 0.8327, 0.8142, 0.8067, 0.8806,
        0.8282, 0.7902, 0.7928, 0.8226, 0.7482, 0.7354, 0.7057, 0.8051, 0.8069,
        0.6848, 0.6759, 0.7706, 0.6866, 0.6659, 0.7748, 0.7149, 0.6760, 0.6681,
        0.6255, 0.6321, 0.6298, 0.6965, 0.6792, 0.6423, 0.6636, 0.6091, 0.6195,
        0.6375, 0.6164, 0.6070, 0.6330, 0.6131, 0.5996, 0.5905, 0.6008, 0.6100,
        0.6003, 0.5824, 0.6068, 0.5730, 0.6796, 0.5872, 0.5972, 0.6171, 0.6076,
        0.5903, 0.6074, 0.5862, 0.5677, 0.5752, 0.6276, 0.6131, 0.5854, 0.5925,
        0.5828, 0.5855, 0.5815, 0.5819, 0.5965, 0.5988, 0.5857, 0.5945, 0.6111,
        0.5708, 0.5950, 0.5772, 0.5878, 0.6081, 0.5680, 0.5673, 0.5982, 0.5728,
        0.5558, 0.5828, 0.5924, 0.5871, 0.5915, 0.5756, 0.5860, 0.5775, 0.5926,
        0.5811, 0.5644, 0.5633, 0.5940, 0.5866, 0.5994, 0.5870, 0.5735, 0.5952,
        0.5887], device='cuda:5', grad_fn=<NormBackward1>)
3shot of client 0:head:0.15608465608465608, middle:0.0, tail0.0
3shot of client 1:head:0.3057199211045365, middle:0.015625, tail0.0
3shot of client 2:head:0.32550335570469796, middle:0.0, tail0.0
3shot of client 3:head:0.21413721413721415, middle:0.007936507936507936, tail0.0
3shot of client 4:head:0.2581967213114754, middle:0.008695652173913044, tail0.0
3shot of client 5:head:0.16046966731898238, middle:0.0, tail0.0
3shot of client 6:head:0.06802721088435375, middle:0.04, tail0.0
3shot of client 7:head:0.14583333333333334, middle:0.06521739130434782, tail0.0
3shot of client 8:head:0.2938496583143508, middle:0.008547008547008548, tail0.0
3shot of client 9:head:0.14741035856573706, middle:0.0, tail0.0
3shot of client 10:head:0.3128491620111732, middle:0.0, tail0.0
3shot of client 11:head:0.3190883190883191, middle:0.0, tail0.0
3shot of client 12:head:0.3132183908045977, middle:0.011904761904761904, tail0.0
3shot of client 13:head:0.4166666666666667, middle:0.0, tail0.0
3shot of client 14:head:0.33962264150943394, middle:0.0, tail0.0
3shot of client 15:head:0.21428571428571427, middle:0.04838709677419355, tail0.0
3shot of client 16:head:0.22635135135135134, middle:0.0, tail0.0
3shot of client 17:head:0.24573378839590443, middle:0.08333333333333333, tail0.0
3shot of client 18:head:0.4522058823529412, middle:0.02857142857142857, tail0.0
3shot of client 19:head:0.29292929292929293, middle:0.075, tail0.0
round 5, local average test acc  0.2020 

round 5, local macro average F1 score  0.0330 

round 5, local weighted average F1 score  0.1254 

round 5, global test acc  0.0245 

round 5, average 3shot acc: [head: 0.2604, middle: 0.0197, tail: 0.0000] 

round 5, global 3shot acc: [head: 0.0907, middle: 0.0000, tail: 0.0000] 

l_head tensor([1.1761, 0.8701, 1.4699, 0.5871, 1.7759, 2.3449, 1.7627, 0.7029, 2.4560,
        0.6962, 0.9338, 1.9438, 1.1553, 0.7913, 2.0893, 1.3628, 0.7292, 1.0617,
        0.5984, 1.0475, 0.6097, 0.7815, 1.0782, 1.4527, 1.1070, 0.7550, 0.9904,
        2.4083, 0.6036, 1.1071, 0.8050, 0.6046, 0.7257, 0.6093, 1.9707, 1.0861,
        1.2155, 0.7762, 1.5195, 0.6186, 0.8232, 0.5984, 0.6028, 0.6079, 0.7248,
        1.0104, 0.5880, 0.6085, 0.8513, 0.6117, 0.5896, 0.5967, 0.6021, 0.5928,
        0.7089, 0.5888, 0.7898, 0.7950, 0.5964, 0.5834, 0.7612, 0.6096, 0.7795,
        0.6040, 0.6937, 0.9491, 0.6041, 0.5974, 0.6081, 0.6032, 0.6019, 0.5806,
        0.5817, 0.5826, 0.6504, 0.6030, 0.6109, 0.6581, 0.6079, 0.5922, 0.5959,
        0.5937, 0.8156, 0.6066, 0.5993, 0.6001, 0.6944, 0.6051, 0.6051, 0.6061,
        0.6007, 0.6004, 0.6043, 0.5879, 0.6012, 0.7977, 0.7946, 0.5921, 0.6034,
        0.6085], device='cuda:5', grad_fn=<NormBackward1>)
g_aux tensor([0.8330, 1.0198, 0.9617, 0.9836, 0.9364, 0.8709, 0.8829, 0.8954, 0.9456,
        0.8602, 0.8390, 0.8488, 0.9065, 0.7860, 0.7858, 0.7661, 0.8329, 0.9049,
        0.7269, 0.7210, 0.8257, 0.7277, 0.6983, 0.8518, 0.7687, 0.6957, 0.6943,
        0.6629, 0.6579, 0.6558, 0.7579, 0.6997, 0.6586, 0.6945, 0.6265, 0.6373,
        0.6602, 0.6324, 0.6209, 0.6550, 0.6262, 0.6167, 0.6030, 0.6105, 0.6152,
        0.6085, 0.5939, 0.6269, 0.5822, 0.7162, 0.5943, 0.6079, 0.6453, 0.6191,
        0.5979, 0.6125, 0.5903, 0.5741, 0.5810, 0.6465, 0.6427, 0.5898, 0.6055,
        0.5896, 0.5951, 0.5827, 0.5871, 0.6041, 0.6082, 0.5938, 0.6032, 0.6253,
        0.5748, 0.6060, 0.5783, 0.5890, 0.6151, 0.5699, 0.5681, 0.6022, 0.5728,
        0.5564, 0.5855, 0.5997, 0.5886, 0.5945, 0.5821, 0.5872, 0.5765, 0.5924,
        0.5798, 0.5652, 0.5643, 0.5942, 0.5871, 0.6030, 0.5910, 0.5727, 0.5945,
        0.5925], device='cuda:5', grad_fn=<NormBackward1>)
3shot of client 0:head:0.18253968253968253, middle:0.02127659574468085, tail0.0
3shot of client 1:head:0.34714003944773175, middle:0.1171875, tail0.030303030303030304
3shot of client 2:head:0.3221476510067114, middle:0.013157894736842105, tail0.05555555555555555
3shot of client 3:head:0.3659043659043659, middle:0.047619047619047616, tail0.0
3shot of client 4:head:0.35450819672131145, middle:0.02608695652173913, tail0.0
3shot of client 5:head:0.2876712328767123, middle:0.024, tail0.03125
3shot of client 6:head:0.06802721088435375, middle:0.06666666666666667, tail0.0
3shot of client 7:head:0.171875, middle:0.0, tail0.0
3shot of client 8:head:0.1776765375854214, middle:0.008547008547008548, tail0.0
3shot of client 9:head:0.12350597609561753, middle:0.07352941176470588, tail0.0
3shot of client 10:head:0.2206703910614525, middle:0.023255813953488372, tail0.0
3shot of client 11:head:0.3903133903133903, middle:0.0, tail0.0
3shot of client 12:head:0.29022988505747127, middle:0.07142857142857142, tail0.0
3shot of client 13:head:0.38580246913580246, middle:0.047058823529411764, tail0.0
3shot of client 14:head:0.2641509433962264, middle:0.0, tail0.0
3shot of client 15:head:0.2777777777777778, middle:0.016129032258064516, tail0.0
3shot of client 16:head:0.1891891891891892, middle:0.0, tail0.0
3shot of client 17:head:0.25597269624573377, middle:0.16666666666666666, tail0.0
3shot of client 18:head:0.47794117647058826, middle:0.014285714285714285, tail0.0
3shot of client 19:head:0.31313131313131315, middle:0.0375, tail0.0
round 6, local average test acc  0.2158 

round 6, local macro average F1 score  0.0451 

round 6, local weighted average F1 score  0.1477 

round 6, global test acc  0.0378 

round 6, average 3shot acc: [head: 0.2733, middle: 0.0387, tail: 0.0059] 

round 6, global 3shot acc: [head: 0.1393, middle: 0.0008, tail: 0.0000] 

l_head   1%|▏         | 7/500 [28:55<34:07:45, 249.22s/it]  2%|▏         | 8/500 [33:12<34:24:37, 251.78s/it]tensor([1.1767, 0.9229, 1.6055, 0.5879, 1.8822, 2.5723, 1.9490, 0.7102, 2.6449,
        0.7566, 0.9303, 2.2106, 1.2120, 0.8743, 2.1453, 1.4597, 0.7483, 1.0320,
        0.5992, 1.0568, 0.6107, 0.8679, 1.0460, 1.5100, 1.1129, 0.8057, 1.0664,
        2.5056, 0.6044, 1.1951, 0.8315, 0.6053, 0.7478, 0.6102, 2.1589, 1.2128,
        1.2886, 0.8349, 1.6494, 0.6193, 0.8526, 0.5994, 0.6038, 0.6086, 0.7511,
        1.0923, 0.5889, 0.6094, 0.8914, 0.6124, 0.5903, 0.5974, 0.6028, 0.5935,
        0.7210, 0.5895, 0.8605, 0.8294, 0.5973, 0.5844, 0.7797, 0.6104, 0.8450,
        0.6049, 0.7163, 0.9598, 0.6049, 0.5982, 0.6088, 0.6041, 0.6028, 0.5814,
        0.5826, 0.5836, 0.6692, 0.6039, 0.6115, 0.6900, 0.6087, 0.5929, 0.5968,
        0.5946, 0.8335, 0.6073, 0.6001, 0.6009, 0.7384, 0.6061, 0.6062, 0.6070,
        0.6016, 0.6013, 0.6051, 0.5888, 0.6020, 0.8387, 0.7977, 0.5928, 0.6043,
        0.6093], device='cuda:5', grad_fn=<NormBackward1>)
g_aux tensor([0.8559, 1.1150, 1.0486, 1.0399, 0.9935, 0.9219, 0.9213, 0.9766, 0.9989,
        0.8913, 0.9027, 0.8926, 0.9769, 0.8365, 0.8146, 0.8003, 0.8631, 0.9838,
        0.7784, 0.7485, 0.8736, 0.7770, 0.7242, 0.9253, 0.8043, 0.7256, 0.7105,
        0.6786, 0.6867, 0.6749, 0.8436, 0.7354, 0.6788, 0.7271, 0.6486, 0.6517,
        0.6737, 0.6389, 0.6425, 0.6862, 0.6268, 0.6416, 0.6187, 0.6290, 0.6293,
        0.6221, 0.6090, 0.6442, 0.5868, 0.7545, 0.6008, 0.6229, 0.6817, 0.6312,
        0.6077, 0.6183, 0.5976, 0.5789, 0.5943, 0.6653, 0.6792, 0.5978, 0.6192,
        0.5974, 0.6014, 0.5865, 0.5961, 0.6100, 0.6192, 0.5955, 0.6106, 0.6412,
        0.5778, 0.6195, 0.5832, 0.5950, 0.6201, 0.5703, 0.5717, 0.6074, 0.5759,
        0.5585, 0.5900, 0.6030, 0.5904, 0.6002, 0.5864, 0.5866, 0.5778, 0.5946,
        0.5812, 0.5656, 0.5663, 0.5949, 0.5864, 0.6115, 0.5953, 0.5746, 0.5940,
        0.5934], device='cuda:5', grad_fn=<NormBackward1>)
3shot of client 0:head:0.22486772486772486, middle:0.09574468085106383, tail0.125
3shot of client 1:head:0.2958579881656805, middle:0.1328125, tail0.030303030303030304
3shot of client 2:head:0.23154362416107382, middle:0.07894736842105263, tail0.05555555555555555
3shot of client 3:head:0.367983367983368, middle:0.1746031746031746, tail0.0
3shot of client 4:head:0.2725409836065574, middle:0.043478260869565216, tail0.0
3shot of client 5:head:0.23874755381604695, middle:0.048, tail0.0
3shot of client 6:head:0.13945578231292516, middle:0.09333333333333334, tail0.0
3shot of client 7:head:0.140625, middle:0.15217391304347827, tail0.0
3shot of client 8:head:0.3097949886104784, middle:0.03418803418803419, tail0.0
3shot of client 9:head:0.099601593625498, middle:0.014705882352941176, tail0.06666666666666667
3shot of client 10:head:0.30726256983240224, middle:0.011627906976744186, tail0.045454545454545456
3shot of client 11:head:0.28774928774928776, middle:0.0, tail0.0
3shot of client 12:head:0.3620689655172414, middle:0.03571428571428571, tail0.0
3shot of client 13:head:0.29012345679012347, middle:0.07058823529411765, tail0.05
3shot of client 14:head:0.42587601078167114, middle:0.0, tail0.041666666666666664
3shot of client 15:head:0.2698412698412698, middle:0.0967741935483871, tail0.0
3shot of client 16:head:0.2702702702702703, middle:0.058823529411764705, tail0.0
3shot of client 17:head:0.23208191126279865, middle:0.1111111111111111, tail0.058823529411764705
3shot of client 18:head:0.5036764705882353, middle:0.0, tail0.0
3shot of client 19:head:0.3063973063973064, middle:0.0125, tail0.0
round 7, local average test acc  0.2254 

round 7, local macro average F1 score  0.0603 

round 7, local weighted average F1 score  0.1673 

round 7, global test acc  0.0425 

round 7, average 3shot acc: [head: 0.2788, middle: 0.0633, tail: 0.0237] 

round 7, global 3shot acc: [head: 0.1470, middle: 0.0108, tail: 0.0000] 

l_head tensor([1.2553, 1.0614, 1.7151, 0.5887, 2.0484, 2.7084, 1.9949, 0.7629, 2.8734,
        0.7629, 1.0452, 2.3596, 1.3849, 0.9757, 2.3279, 1.6282, 0.8191, 1.1689,
        0.5998, 1.1273, 0.6114, 0.8697, 1.1442, 1.6783, 1.1809, 0.8990, 1.1428,
        2.7776, 0.6050, 1.2933, 0.9597, 0.6060, 0.7898, 0.6109, 2.2787, 1.2833,
        1.4153, 0.8595, 1.7673, 0.6200, 0.9405, 0.6001, 0.6046, 0.6092, 0.7925,
        1.1889, 0.5896, 0.6100, 0.9260, 0.6130, 0.5909, 0.5982, 0.6034, 0.5941,
        0.7605, 0.5902, 0.8744, 0.8759, 0.5979, 0.5851, 0.8546, 0.6111, 0.9003,
        0.6056, 0.7366, 1.0395, 0.6057, 0.5988, 0.6094, 0.6048, 0.6034, 0.5821,
        0.5833, 0.5843, 0.6900, 0.6045, 0.6121, 0.7173, 0.6092, 0.5934, 0.5976,
        0.5953, 0.8793, 0.6079, 0.6008, 0.6016, 0.8126, 0.6067, 0.6070, 0.6076,
        0.6023, 0.6019, 0.6057, 0.5895, 0.6027, 0.9089, 0.8256, 0.5933, 0.6051,
        0.6100], device='cuda:5', grad_fn=<NormBackward1>)
g_aux tensor([0.9092, 1.1750, 1.1243, 1.0952, 1.0729, 0.9767, 0.9673, 1.0463, 1.0575,
        0.9144, 0.9459, 0.9083, 1.0651, 0.8927, 0.8598, 0.8572, 0.9042, 1.0536,
        0.8164, 0.7742, 0.8971, 0.8284, 0.7586, 0.9941, 0.8490, 0.7382, 0.7360,
        0.7140, 0.7068, 0.7032, 0.9175, 0.7697, 0.6966, 0.7490, 0.6559, 0.6689,
        0.6948, 0.6649, 0.6639, 0.7156, 0.6394, 0.6662, 0.6360, 0.6502, 0.6426,
        0.6373, 0.6214, 0.6577, 0.5975, 0.8093, 0.6038, 0.6390, 0.7137, 0.6483,
        0.6236, 0.6252, 0.6033, 0.5872, 0.6123, 0.6871, 0.7218, 0.6090, 0.6392,
        0.6052, 0.6087, 0.5907, 0.6041, 0.6121, 0.6308, 0.6017, 0.6187, 0.6604,
        0.5824, 0.6371, 0.5905, 0.5962, 0.6276, 0.5705, 0.5743, 0.6149, 0.5765,
        0.5594, 0.5932, 0.6118, 0.5933, 0.6094, 0.5931, 0.5856, 0.5789, 0.5964,
        0.5837, 0.5679, 0.5700, 0.5967, 0.5883, 0.6218, 0.5992, 0.5756, 0.5946,
        0.5971], device='cuda:5', grad_fn=<NormBackward1>)
3shot of client 0:head:0.14814814814814814, middle:0.1276595744680851, tail0.041666666666666664
3shot of client 1:head:0.3609467455621302, middle:0.1015625, tail0.06060606060606061
3shot of client 2:head:0.3859060402684564, middle:0.05263157894736842, tail0.0
3shot of client 3:head:0.3367983367983368, middle:0.23809523809523808, tail0.0
3shot of client 4:head:0.36885245901639346, middle:0.0, tail0.0
3shot of client 5:head:0.2328767123287671, middle:0.032, tail0.0
3shot of client 6:head:0.12585034013605442, middle:0.10666666666666667, tail0.05263157894736842
3shot of client 7:head:0.2760416666666667, middle:0.043478260869565216, tail0.0
3shot of client 8:head:0.21867881548974943, middle:0.0, tail0.0
3shot of client 9:head:0.21115537848605578, middle:0.014705882352941176, tail0.0
3shot of client 10:head:0.23743016759776536, middle:0.011627906976744186, tail0.0
3shot of client 11:head:0.38461538461538464, middle:0.0, tail0.0
3shot of client 12:head:0.3706896551724138, middle:0.05952380952380952, tail0.0
3shot of client 13:head:0.36419753086419754, middle:0.03529411764705882, tail0.0
3shot of client 14:head:0.41778975741239893, middle:0.0, tail0.041666666666666664
3shot of client 15:head:0.2777777777777778, middle:0.03225806451612903, tail0.0
3shot of client 16:head:0.2702702702702703, middle:0.029411764705882353, tail0.0
3shot of client 17:head:0.26621160409556316, middle:0.027777777777777776, tail0.0
3shot of client 18:head:0.6102941176470589, middle:0.1, tail0.0
3shot of client 19:head:0.24579124579124578, middle:0.1375, tail0.0
round 8, local average test acc  0.2442 

round 8, local macro average F1 score  0.0653 

round 8, local weighted average F1 score  0.1898 

round 8, global test acc  0.0556 

round 8, average 3shot acc: [head: 0.3055, middle: 0.0575, tail: 0.0098] 

round 8, global 3shot acc: [head: 0.1993, middle: 0.0069, tail: 0.0000] 

l_head   2%|▏         | 9/500 [37:36<34:51:19, 255.56s/it]  2%|▏         | 10/500 [41:57<35:01:04, 257.27s/it]
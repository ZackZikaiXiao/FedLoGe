nohup: ignoring input
./temp/fl_acc_cifar100_resnet34_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N20_100_seed3407_p1_dirichlet0.5_IF0.01_LossCE.txt
Files already downloaded and verified
[500, 477, 455, 434, 415, 396, 378, 361, 344, 328, 314, 299, 286, 273, 260, 248, 237, 226, 216, 206, 197, 188, 179, 171, 163, 156, 149, 142, 135, 129, 123, 118, 112, 107, 102, 98, 93, 89, 85, 81, 77, 74, 70, 67, 64, 61, 58, 56, 53, 51, 48, 46, 44, 42, 40, 38, 36, 35, 33, 32, 30, 29, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 15, 14, 13, 13, 12, 12, 11, 11, 10, 10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5]
10847
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[573, 766, 469, 733, 726, 766, 466, 320, 676, 410, 554, 546, 535, 512, 586, 396, 460, 448, 431, 474]
training set distribution:
[[  8   5  18   0  32  55  32   1  64   2   4  41   7   3  47  19   2   3
    0   6   0   3   5  14   6   4   9  50   0  11   3   0   2   0  38  12
   11   1  19   0   1   0   0   0   1  10   0   0   3   0   0   0   0   0
    1   0   2   2   0   0   1   0   2   0   2   4   0   0   0   0   0   0
    0   0   1   0   0   1   0   0   0   0   2   0   0   0   1   0   0   0
    0   0   0   0   0   1   1   0   0   0]
 [ 99   7  26  25  22   2  54  80   2  28  22  33   7  19 105   0   1   3
    4  13   2  26   9   3   0   4   4   4  37   0  18   1   2   6   5  16
    4   0  15  13   1   0   0   0   3   2   0   0   0   0   2   2   3   9
    1   0   2   0   2   1   0   0   3   0   0   0   0   0   0   7   0   0
    0   0   0   0   0   0   0   0   0   0   0   1   0   2   1   0   0   0
    0   2   0   1   0   0   0   0   0   0]
 [ 14  60   9  13   3  40   0   8   0   6  24  11  75  13  14   6  11   2
    2   7   0   0   0   0   0  10   0   4   0   3   7  10  11   3   5   0
    8   6   1   0   1   8   1   1   5   0   5   2   4   8   0   1   3   0
    2   1   1   1   3   3   2   2   0   0   0   0   0   0   0   0   2   0
    0   1   4   0   6   1   0   0   4   0   3   0   3   0   1   0   1   2
    0   0   0   0   0   0   0   1   0   0]
 [ 23  89  56   2  47   1   7   8  48  33   0  49   1  29   5  32   2  17
   76   5  13  10   0  12   0   0   2   0   9  19  16   2   0  18   2   0
    6   0   0   2   2   1  26   5  10   2   0   1   0   0   4   1   0   1
    1   0   0   0   0   1   3   0   0   8   3   2   0   1   3   0   1   0
    0   4   0   0   0   0   0   0   0   0   0   1   0   1   0   1   3   0
    3   0   1   0   2   0   0   0   0   0]
 [  9  95  66   3  48   7  41  15  36  24  65   1   2   1   0   2   4   8
    0   6  29   0   2  53   7   2  24  19  10  14   0   3   0  25   2   5
    0  30   3   0   4   0   4   7   7   4   0   0   8   4   3   1   0   0
    2   0   0   4   0   0   0   0   1   0   4   0   0   0   0   0   1   3
    1   0   0   1   0   0   2   1   0   0   1   0   0   0   1   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 22  45  14  67   2   2  54  10  18  22  47  12  10  71  16   1  52   4
    7   1  31  36  16   8  25  30   7   0   8   0   3   0   6   6   6  27
    0   0   0   0   4   0   0   0   2   5   4   5   9   1   5   3   3   0
    1   0   6  14   1   1   0   0   1   0   1   3   0   0   0   0   0   4
    1   2   0   0   0   1   0   1   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [  5   0   1  11  50   1  31  30  22  10   1   1   8   4   2   0   2   6
   31   0  15  46   1   7   9   1  18   0   0  10   5   0   7   2  24   2
    6   2   5  18   4   3   3   0   0   0   2   4   3   8   0   3   1   1
    0   2   4   3   0   0   0   6   0   2   0   2   0   2   0   2   3   0
    0   0   0   0   0   2   1   3   0   0   0   0   0   0   1   0   3   0
    0   0   0   2   0   0   1   0   0   1]
 [  0  19   5  26  11  14   5  14   2  11   1  12  20   2   7   6   0   0
    3   0  21   0   3   0   1   1  14   0   2  12   1   9   3   0   4   6
    1   1   5   0   2  10   1   4   1   2   6   0   2   2   1   4   3   1
    0  16   3   0   0   0   1   0   1   1   0   1   0   3   2   0   1   0
    0   1   1   2   0   1   1   2   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [ 44  21  72  58  46  20   1   1  52   0  37  46  14   5  10  11  17   8
    1   1   1   1   8  16  15  40   0   0   0  12   1  10   1   0   0   3
    9   0   5   3   6   5   6   2   7   0   0   5   0   0   2   1   0   0
    7  11   3   0   1   1   2   0   0   0   3   0   4   0   0   1   5   0
    1   0   0   0   0   0   1   0   2   1   0   0   0   0   2   2   0   1
    0   1   0   0   0   0   1   0   0   2]
 [  0  16   3   2  33  70   1  22   1   5  45   9   5   6   3   7   0  14
    7   5   8   5   2   0   1   4   2   5   0   0   1  12   1   7   0   2
    1   2  15  18   0   2   0   0   7  10   3   0   1   2   2   0   5   0
    1   0   7   0   2   0   0   1   0   0   0   0   1   0   0   0   3   1
    0   3   0   3   1   0   0   0   0   0   3   0   2   2   0   2   0   1
    0   1   0   1   0   1   0   0   0   2]
 [  0   0   0  28  16   3  89  14  43   6   9   7   0  12   0   2  62   0
    8  74   2   2   0  26   2   1   8   2   6   0   1   0   2   2   1   2
    5   1   1   0   8   2   0   1   4   7   0  18   0   2   1   0   0  13
    4   0   4   1   0   3   3   0   0   3   3   0   8   0   2   1   0   0
    9   1   2   3   0   1   4   0   1   0   0   1   0   2   0   0   0   0
    0   0   1   0   1   1   0   0   2   0]
 [ 90   0  30  51   5   0   4   3   1   5   1   1   8  11  23  84   0  23
    4   6   0   2   9   0   0   3   0   7   7  17   5   2  21   5   0   3
    0   2   0   2   0   0   0  10   0   1  13   3   0   7   1   2   3   1
    5   0   0   0   6   3   1   1   3   0   5  11   0  12   0   1   0   4
    1   0   4   0   0   0   0   0   1   0   0   3   0   0   0   1   0   1
    2   0   0   0   0   1   1   1   2   0]
 [  9  41   0  22   1  13   6   1   0  53  13   6  47  19   4   2   2  13
   10  15   3   0   0   0  67   8   7   2  37   0  35   0   0  11   0   4
    4   1   2   0   0   8   3   4   2   0   0   0   3   0   5   3   2   8
    5   1   0   5   1   0   1   0   3   0   2   0   0   0   7   0   0   2
    0   0   0   1   3   0   1   0   2   0   1   0   1   0   0   0   0   0
    0   1   0   0   1   0   1   0   0   0]
 [ 14  17   3  80   2  97  18   3   0  17   3   1  13  20   0   1   3   6
    0   0   1  24  40   6   2   1   2   8   0   7   5   1   0   2   1   0
    1   0   5   1  12   4   0  19   6   4   1   5   0   8   0   6   6   0
    2   3   0   0   1   5   0   1   1   6   0   0   0   0   0   1   1   2
    0   0   0   1   3   0   0   2   0   3   0   2   1   0   0   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 30  43   0  19   2   1  17 114   1  68   2   0   6   2   4   9   7  28
    0  11   2   0   7   2  11  12   5  14   9  12   3   2  10   7   0   2
    8   2   0   6  14   4   1   0   0   0  13   1   4   0   8   5   4   0
    6   0   0   4   0   0   2   7   7   2   0   1   2   0   2   3   0   2
    1   0   0   1   0   1   0   2   1   1   0   0   2   2   2   0   0   1
    0   0   0   0   0   1   0   0   1   0]
 [  3   5  43   6  25   7   1  18   0   8   2   2   7   0   0   1   0   0
   37  11   7   0   6   1   3   0  19   0   0   8   0  35  25   0   1  10
    4   0   1  11   6   0   0   4   4   8   5   0  11   9   2   3   0   2
    0   1   1   0   2   2   8   0   4   1   0   0   0   3   1   1   1   0
    0   2   1   2   0   1   0   0   0   3   0   0   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   0   0]
 [ 19   2  21  13   2   0   8  10   1   3  15  15   4  12  17  10  27  40
    1   2   6   1  62  18   2  11  21   7   6   1   0   1   1   1   2   4
   24  15   1   0   2   0   4   1   0   0   2  10   0   0   1   3   4   5
    0   3   0   0   0   0   0   3   0   0   1   0   2   0   0   0   0   0
    0   0   1   0   1   2   3   1   0   0   0   1   1   0   0   0   0   0
    0   1   0   0   2   0   0   0   0   0]
 [  7   5   3   5  21  54   9   0  10   9  20  45  36  35   3  12  23   8
    1   7   0  24   0   4   6  20   6  10   1   0   0   2   0   0   5   0
    0  22   0   6   1   0   0   1   0   0   4   0   3   0   1   0   1   0
    0   0   0   1   0   0   0   6   0   0   1   0   0   0   0   0   0   0
    1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   1
    1   1   1   1   0   0   0   1   0   0]
 [ 87   7  18   0  21   1   0   8   3   2   0   1   6   7   0  10   3  41
    4  35   2   7   7   0   1   2   0  10   3   1  17   2  20   0   0   0
    1   3   0   0   5  20  20   1   5   2   0   2   0   0   9   3   1   1
    2   0   1   0   1  11   1   1   0   3   0   0   3   1   0   3   1   0
    0   1   1   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   1   0   0   0   0]
 [ 17   0  67   3  26   8   0   1  40  16   3   6  10   2   0  33  19   2
   20   1  54   1   2   1   5   2   1   0   0   2   2  26   0  12   6   0
    0   1   7   1   4   7   1   7   0   4   0   0   2   0   1   5   5   0
    0   0   2   0  13   1   5   1   1   0   0   0   3   0   4   0   0   0
    2   0   0   1   0   1   0   0   0   3   0   1   0   0   0   1   0   0
    0   0   1   1   0   0   0   0   0   0]]
Total size of training set
10847
local test distribution:
[[  7   4  16   0  29  50  29   0  59   1   3  37   6   2  43  17   1   2
    0   5   0   2   4  12   5   3   8  46   0  10   2   0   1   0  35  11
   10   0  17   0   0   0   0   0   0   9   0   0   2   0   0   0   0   0
    0   0   1   1   0   0   0   0   1   0   1   3   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 91   6  23  23  20   1  49  73   1  25  20  30   6  17  96   0   0   2
    3  11   1  23   8   2   0   3   3   3  34   0  16   0   1   5   4  14
    3   0  13  11   0   0   0   0   2   1   0   0   0   0   1   1   2   8
    0   0   1   0   1   0   0   0   2   0   0   0   0   0   0   6   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0
    0   1   0   0   0   0   0   0   0   0]
 [ 12  55   8  11   2  36   0   7   0   5  22  10  69  11  12   5  10   1
    1   6   0   0   0   0   0   9   0   3   0   2   6   9  10   2   4   0
    7   5   0   0   0   7   0   0   4   0   4   1   3   7   0   0   2   0
    1   0   0   0   2   2   1   1   0   0   0   0   0   0   0   0   1   0
    0   0   3   0   5   0   0   0   3   0   2   0   2   0   0   0   0   1
    0   0   0   0   0   0   0   0   0   0]
 [ 21  82  51   1  43   0   6   7  44  30   0  45   0  26   4  29   1  15
   70   4  11   9   0  11   0   0   1   0   8  17  14   1   0  16   1   0
    5   0   0   1   1   0  23   4   9   1   0   0   0   0   3   0   0   0
    0   0   0   0   0   0   2   0   0   7   2   1   0   0   2   0   0   0
    0   3   0   0   0   0   0   0   0   0   0   0   0   0   0   0   2   0
    2   0   0   0   1   0   0   0   0   0]
 [  8  87  60   2  44   6  37  13  33  22  59   0   1   0   0   1   3   7
    0   5  26   0   1  48   6   1  22  17   9  12   0   2   0  23   1   4
    0  27   2   0   3   0   3   6   6   3   0   0   7   3   2   0   0   0
    1   0   0   3   0   0   0   0   0   0   3   0   0   0   0   0   0   2
    0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 20  41  12  61   1   1  49   9  16  20  43  11   9  65  14   0  47   3
    6   0  28  33  14   7  23  27   6   0   7   0   2   0   5   5   5  24
    0   0   0   0   3   0   0   0   1   4   3   4   8   0   4   2   2   0
    0   0   5  12   0   0   0   0   0   0   0   2   0   0   0   0   0   3
    0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  4   0   0  10  46   0  28  27  20   9   0   0   7   3   1   0   1   5
   28   0  13  42   0   6   8   0  16   0   0   9   4   0   6   1  22   1
    5   1   4  16   3   2   2   0   0   0   1   3   2   7   0   2   0   0
    0   1   3   2   0   0   0   5   0   1   0   1   0   1   0   1   2   0
    0   0   0   0   0   1   0   2   0   0   0   0   0   0   0   0   2   0
    0   0   0   1   0   0   0   0   0   0]
 [  0  17   4  23  10  12   4  12   1  10   0  11  18   1   6   5   0   0
    2   0  19   0   2   0   0   0  12   0   1  11   0   8   2   0   3   5
    0   0   4   0   1   9   0   3   0   1   5   0   1   1   0   3   2   0
    0  14   2   0   0   0   0   0   0   0   0   0   0   2   1   0   0   0
    0   0   0   1   0   0   0   1   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 40  19  66  53  42  18   0   0  47   0  34  42  12   4   9  10  15   7
    0   0   0   0   7  14  13  36   0   0   0  11   0   9   0   0   0   2
    8   0   4   2   5   4   5   1   6   0   0   4   0   0   1   0   0   0
    6  10   2   0   0   0   1   0   0   0   2   0   3   0   0   0   4   0
    0   0   0   0   0   0   0   0   1   0   0   0   0   0   1   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0  14   2   1  30  64   0  20   0   4  41   8   4   5   2   6   0  12
    6   4   7   4   1   0   0   3   1   4   0   0   0  11   0   6   0   1
    0   1  13  16   0   1   0   0   6   9   2   0   0   1   1   0   4   0
    0   0   6   0   1   0   0   0   0   0   0   0   0   0   0   0   2   0
    0   2   0   2   0   0   0   0   0   0   2   0   1   1   0   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0   0   0  25  14   2  82  12  39   5   8   6   0  11   0   1  57   0
    7  68   1   1   0  23   1   0   7   1   5   0   0   0   1   1   0   1
    4   0   0   0   7   1   0   0   3   6   0  16   0   1   0   0   0  11
    3   0   3   0   0   2   2   0   0   2   2   0   7   0   1   0   0   0
    8   0   1   2   0   0   3   0   0   0   0   0   0   1   0   0   0   0
    0   0   0   0   0   0   0   0   1   0]
 [ 82   0  27  47   4   0   3   2   0   4   0   0   7  10  21  77   0  21
    3   5   0   1   8   0   0   2   0   6   6  15   4   1  19   4   0   2
    0   1   0   1   0   0   0   9   0   0  11   2   0   6   0   1   2   0
    4   0   0   0   5   2   0   0   2   0   4  10   0  11   0   0   0   3
    0   0   3   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   1   0]
 [  8  37   0  20   0  11   5   0   0  48  11   5  43  17   3   1   1  11
    9  13   2   0   0   0  61   7   6   1  34   0  32   0   0  10   0   3
    3   0   1   0   0   7   2   3   1   0   0   0   2   0   4   2   1   7
    4   0   0   4   0   0   0   0   2   0   1   0   0   0   6   0   0   1
    0   0   0   0   2   0   0   0   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 12  15   2  73   1  89  16   2   0  15   2   0  11  18   0   0   2   5
    0   0   0  22  36   5   1   0   1   7   0   6   4   0   0   1   0   0
    0   0   4   0  11   3   0  17   5   3   0   4   0   7   0   5   5   0
    1   2   0   0   0   4   0   0   0   5   0   0   0   0   0   0   0   1
    0   0   0   0   2   0   0   1   0   2   0   1   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 27  39   0  17   1   0  15 105   0  62   1   0   5   1   3   8   6  25
    0  10   1   0   6   1  10  11   4  12   8  11   2   1   9   6   0   1
    7   1   0   5  12   3   0   0   0   0  11   0   3   0   7   4   3   0
    5   0   0   3   0   0   1   6   6   1   0   0   1   0   1   2   0   1
    0   0   0   0   0   0   0   1   0   0   0   0   1   1   1   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  2   4  39   5  23   6   0  16   0   7   1   1   6   0   0   0   0   0
   34  10   6   0   5   0   2   0  17   0   0   7   0  32  23   0   0   9
    3   0   0  10   5   0   0   3   3   7   4   0  10   8   1   2   0   1
    0   0   0   0   1   1   7   0   3   0   0   0   0   2   0   0   0   0
    0   1   0   1   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 17   1  19  11   1   0   7   9   0   2  13  13   3  11  15   9  24  36
    0   1   5   0  57  16   1  10  19   6   5   0   0   0   0   0   1   3
   22  13   0   0   1   0   3   0   0   0   1   9   0   0   0   2   3   4
    0   2   0   0   0   0   0   2   0   0   0   0   1   0   0   0   0   0
    0   0   0   0   0   1   2   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   1   0   0   0   0   0]
 [  6   4   2   4  19  49   8   0   9   8  18  41  33  32   2  11  21   7
    0   6   0  22   0   3   5  18   5   9   0   0   0   1   0   0   4   0
    0  20   0   5   0   0   0   0   0   0   3   0   2   0   0   0   0   0
    0   0   0   0   0   0   0   5   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 80   6  16   0  19   0   0   7   2   1   0   0   5   6   0   9   2  37
    3  32   1   6   6   0   0   1   0   9   2   0  15   1  18   0   0   0
    0   2   0   0   4  18  18   0   4   1   0   1   0   0   8   2   0   0
    1   0   0   0   0  10   0   0   0   2   0   0   2   0   0   2   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 15   0  61   2  23   7   0   0  36  14   2   5   9   1   0  30  17   1
   18   0  49   0   1   0   4   1   0   0   0   1   1  23   0  11   5   0
    0   0   6   0   3   6   0   6   0   3   0   0   1   0   0   4   4   0
    0   0   1   0  11   0   4   0   0   0   0   0   2   0   3   0   0   0
    1   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]]
Total size of testing set
9199
[452 431 408 389 372 352 338 321 307 292 278 265 254 241 231 219 208 197
 190 180 170 165 156 148 140 132 128 124 119 112 102  99  95  91  85  81
  77  71  68  67  59  61  56  52  50  48  45  44  41  41  32  30  30  31
  26  29  24  25  21  21  18  19  16  18  15  17  16  16  14  11   9  11
   9   7   7   6   9   2   6   5   5   6   5   3   4   4   2   2   4   1
   3   1   0   1   2   0   0   0   2   2]
20
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [03:26<28:37:25, 206.50s/it]  0%|          | 2/500 [06:45<27:58:57, 202.28s/it]3shot of client 0:head:0.07671957671957672, middle:0.0, tail0.0
3shot of client 1:head:0.1893491124260355, middle:0.0, tail0.0
3shot of client 2:head:0.03691275167785235, middle:0.0, tail0.0
3shot of client 3:head:0.0, middle:0.047619047619047616, tail0.0
3shot of client 4:head:0.07581967213114754, middle:0.0, tail0.0
3shot of client 5:head:0.0, middle:0.072, tail0.0
3shot of client 6:head:0.09523809523809523, middle:0.0, tail0.0
3shot of client 7:head:0.11979166666666667, middle:0.0, tail0.0
3shot of client 8:head:0.15034168564920272, middle:0.0, tail0.0
3shot of client 9:head:0.0, middle:0.058823529411764705, tail0.0
3shot of client 10:head:0.22905027932960895, middle:0.0, tail0.0
3shot of client 11:head:0.21937321937321938, middle:0.0, tail0.0
3shot of client 12:head:0.13793103448275862, middle:0.0, tail0.0
3shot of client 13:head:0.04938271604938271, middle:0.0, tail0.0
3shot of client 14:head:0.16711590296495957, middle:0.0, tail0.0
3shot of client 15:head:0.15476190476190477, middle:0.0, tail0.0
3shot of client 16:head:0.19256756756756757, middle:0.0, tail0.0
3shot of client 17:head:0.16723549488054607, middle:0.0, tail0.0
3shot of client 18:head:0.13602941176470587, middle:0.0, tail0.0
3shot of client 19:head:0.10101010101010101, middle:0.0, tail0.0
round 0, local average test acc  0.0894 

round 0, local macro average F1 score  0.0040 

round 0, local weighted average F1 score  0.0200 

round 0, global test acc  0.0100 

round 0, average 3shot acc: [head: 0.1149, middle: 0.0089, tail: 0.0000] 

round 0, global 3shot acc: [head: 0.0370, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.7691, 0.6184, 0.7358, 0.5789, 0.8364, 1.0621, 0.8669, 0.6175, 1.1217,
        0.5906, 0.6418, 0.9789, 0.7337, 0.5994, 0.9812, 0.7824, 0.6074, 0.5983,
        0.5907, 0.6733, 0.6008, 0.6376, 0.6854, 0.8131, 0.7575, 0.6091, 0.6682,
        0.9669, 0.5965, 0.6689, 0.6063, 0.5958, 0.6223, 0.6017, 0.8235, 0.6942,
        0.6918, 0.6189, 0.7681, 0.6108, 0.6201, 0.5895, 0.5937, 0.6003, 0.5890,
        0.6874, 0.5788, 0.5999, 0.5885, 0.6033, 0.5825, 0.5875, 0.5940, 0.5855,
        0.5876, 0.5810, 0.6117, 0.6001, 0.5888, 0.5743, 0.6015, 0.6019, 0.5916,
        0.5954, 0.6296, 0.7041, 0.5960, 0.5900, 0.6011, 0.5959, 0.5942, 0.5701,
        0.5724, 0.5754, 0.5829, 0.5946, 0.6037, 0.6093, 0.6003, 0.5839, 0.5873,
        0.5845, 0.6375, 0.5989, 0.5909, 0.5924, 0.6065, 0.5962, 0.5954, 0.5985,
        0.5927, 0.5938, 0.5967, 0.5780, 0.5938, 0.6117, 0.6071, 0.5854, 0.5933,
        0.5998], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.6005, 0.6236, 0.6153, 0.6247, 0.5835, 0.5960, 0.6060, 0.6028, 0.6185,
        0.6169, 0.5809, 0.6030, 0.5804, 0.5818, 0.5862, 0.5827, 0.6031, 0.5836,
        0.5834, 0.5896, 0.6005, 0.5828, 0.5757, 0.5929, 0.5665, 0.5885, 0.5715,
        0.5618, 0.5858, 0.5789, 0.5888, 0.5921, 0.5850, 0.5708, 0.5754, 0.5959,
        0.5836, 0.5799, 0.5793, 0.5893, 0.5831, 0.5666, 0.5759, 0.5806, 0.5867,
        0.5867, 0.5859, 0.5704, 0.5638, 0.5811, 0.5896, 0.5839, 0.5666, 0.5776,
        0.5820, 0.5979, 0.5700, 0.5627, 0.5752, 0.5918, 0.5663, 0.5810, 0.5810,
        0.5751, 0.5782, 0.5878, 0.5726, 0.5799, 0.5841, 0.5752, 0.5909, 0.5938,
        0.5627, 0.5788, 0.5761, 0.5883, 0.5910, 0.5732, 0.5623, 0.5872, 0.5778,
        0.5619, 0.5844, 0.5801, 0.5872, 0.5837, 0.5759, 0.5888, 0.5741, 0.5946,
        0.5756, 0.5600, 0.5631, 0.5885, 0.5822, 0.5857, 0.5785, 0.5699, 0.5909,
        0.5780], device='cuda:4', grad_fn=<NormBackward1>)
3shot of client 0:head:0.07671957671957672, middle:0.0, tail0.0
3shot of client 1:head:0.03944773175542406, middle:0.0, tail0.0
3shot of client 2:head:0.0738255033557047, middle:0.0, tail0.0
3shot of client 3:head:0.060291060291060294, middle:0.0, tail0.0
3shot of client 4:head:0.12295081967213115, middle:0.0, tail0.0
3shot of client 5:head:0.08023483365949119, middle:0.0, tail0.0
3shot of client 6:head:0.0, middle:0.08, tail0.0
3shot of client 7:head:0.0625, middle:0.0, tail0.0
3shot of client 8:head:0.12072892938496584, middle:0.0, tail0.0
3shot of client 9:head:0.16334661354581673, middle:0.0, tail0.0
3shot of client 10:head:0.22905027932960895, middle:0.0, tail0.0
3shot of client 11:head:0.03133903133903134, middle:0.0, tail0.0
3shot of client 12:head:0.13793103448275862, middle:0.0, tail0.0
3shot of client 13:head:0.27469135802469136, middle:0.0, tail0.0
3shot of client 14:head:0.07277628032345014, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.08064516129032258, tail0.0
3shot of client 16:head:0.04391891891891892, middle:0.0, tail0.0
3shot of client 17:head:0.06484641638225255, middle:0.0, tail0.0
3shot of client 18:head:0.06985294117647059, middle:0.0, tail0.0
3shot of client 19:head:0.2053872053872054, middle:0.0, tail0.0
round 1, local average test acc  0.0749 

round 1, local macro average F1 score  0.0031 

round 1, local weighted average F1 score  0.0135 

round 1, global test acc  0.0100 

round 1, average 3shot acc: [head: 0.0965, middle: 0.0080, tail: 0.0000] 

round 1, global 3shot acc: [head: 0.0370, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.8901, 0.6631, 0.8533, 0.5834, 1.0207, 1.3927, 1.0698, 0.6333, 1.4791,
        0.6026, 0.6955, 1.2006, 0.8276, 0.6186, 1.2493, 0.9017, 0.6482, 0.6258,
        0.5952, 0.7387, 0.6054, 0.6772, 0.7997, 0.9196, 0.7677, 0.6451, 0.7092,
        1.3060, 0.6011, 0.7560, 0.6585, 0.6004, 0.6683, 0.6064, 1.0741, 0.7941,
        0.7881, 0.6509, 0.9137, 0.6150, 0.6570, 0.5942, 0.5982, 0.6052, 0.6034,
        0.7206, 0.5838, 0.6040, 0.6353, 0.6078, 0.5875, 0.5920, 0.5983, 0.5897,
        0.6081, 0.5857, 0.6108, 0.6090, 0.5932, 0.5790, 0.6556, 0.6063, 0.6397,
        0.6000, 0.6310, 0.7496, 0.6006, 0.5947, 0.6056, 0.6004, 0.5983, 0.5741,
        0.5769, 0.5803, 0.6219, 0.5987, 0.6088, 0.6126, 0.6048, 0.5888, 0.5921,
        0.5896, 0.6797, 0.6034, 0.5958, 0.5970, 0.6299, 0.6004, 0.6000, 0.6030,
        0.5972, 0.5972, 0.6005, 0.5838, 0.5985, 0.6392, 0.6368, 0.5897, 0.5980,
        0.6041], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.6261, 0.6564, 0.6481, 0.6764, 0.6096, 0.6480, 0.6311, 0.6323, 0.6612,
        0.6627, 0.6310, 0.6219, 0.6278, 0.6061, 0.6059, 0.5815, 0.6345, 0.5937,
        0.6013, 0.5877, 0.6290, 0.6000, 0.5868, 0.6056, 0.5907, 0.5958, 0.5755,
        0.5636, 0.5911, 0.5844, 0.5936, 0.5986, 0.5921, 0.5777, 0.5809, 0.5941,
        0.5876, 0.5829, 0.5794, 0.5891, 0.5853, 0.5674, 0.5797, 0.5821, 0.5849,
        0.5865, 0.5832, 0.5728, 0.5638, 0.5925, 0.5851, 0.5854, 0.5734, 0.5772,
        0.5787, 0.5963, 0.5698, 0.5589, 0.5756, 0.5901, 0.5687, 0.5783, 0.5836,
        0.5803, 0.5792, 0.5863, 0.5727, 0.5789, 0.5864, 0.5755, 0.5915, 0.5981,
        0.5664, 0.5761, 0.5760, 0.5896, 0.5910, 0.5737, 0.5624, 0.5874, 0.5736,
        0.5626, 0.5855, 0.5860, 0.5873, 0.5883, 0.5761, 0.5883, 0.5744, 0.5956,
        0.5782, 0.5616, 0.5633, 0.5899, 0.5836, 0.5916, 0.5811, 0.5703, 0.5948,
        0.5815], device='cuda:4', grad_fn=<NormBackward1>)
3shot of client 0:head:0.09788359788359788, middle:0.0, tail0.0
3shot of client 1:head:0.1893491124260355, middle:0.0, tail0.0
3shot of client 2:head:0.12080536912751678, middle:0.0, tail0.0
3shot of client 3:head:0.14553014553014554, middle:0.0, tail0.0
3shot of client 4:head:0.12090163934426229, middle:0.0, tail0.0
3shot of client 5:head:0.0958904109589041, middle:0.0, tail0.0
3shot of client 6:head:0.09523809523809523, middle:0.0, tail0.0
3shot of client 7:head:0.0625, middle:0.0, tail0.0
3shot of client 8:head:0.09567198177676538, middle:0.0, tail0.0
3shot of client 9:head:0.11952191235059761, middle:0.0, tail0.0
3shot of client 10:head:0.15921787709497207, middle:0.0, tail0.0
3shot of client 11:head:0.05982905982905983, middle:0.0, tail0.0
3shot of client 12:head:0.07758620689655173, middle:0.03571428571428571, tail0.0
3shot of client 13:head:0.22530864197530864, middle:0.0, tail0.0
3shot of client 14:head:0.16711590296495957, middle:0.0, tail0.0
3shot of client 15:head:0.0, middle:0.0967741935483871, tail0.0
3shot of client 16:head:0.06418918918918919, middle:0.0, tail0.0
3shot of client 17:head:0.10921501706484642, middle:0.0, tail0.0
  1%|          | 3/500 [10:02<27:34:32, 199.74s/it]  1%|          | 4/500 [13:20<27:25:45, 199.08s/it]3shot of client 18:head:0.11764705882352941, middle:0.0, tail0.0
3shot of client 19:head:0.05723905723905724, middle:0.0, tail0.0
round 2, local average test acc  0.0842 

round 2, local macro average F1 score  0.0036 

round 2, local weighted average F1 score  0.0149 

round 2, global test acc  0.0100 

round 2, average 3shot acc: [head: 0.1090, middle: 0.0066, tail: 0.0000] 

round 2, global 3shot acc: [head: 0.0370, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.9683, 0.7068, 0.9577, 0.5868, 1.1481, 1.6461, 1.2146, 0.6314, 1.7451,
        0.6408, 0.7079, 1.4325, 1.0102, 0.6403, 1.4115, 1.0579, 0.6798, 0.7002,
        0.5981, 0.8341, 0.6084, 0.6932, 0.8926, 1.0784, 0.8166, 0.6798, 0.7711,
        1.5681, 0.6041, 0.8441, 0.6905, 0.6033, 0.6580, 0.6093, 1.3449, 0.8889,
        0.8438, 0.6806, 1.0431, 0.6179, 0.7018, 0.5973, 0.6014, 0.6077, 0.6183,
        0.8132, 0.5869, 0.6071, 0.6489, 0.6107, 0.5906, 0.5950, 0.6010, 0.5923,
        0.6186, 0.5887, 0.6623, 0.6392, 0.5963, 0.5822, 0.6988, 0.6092, 0.6669,
        0.6032, 0.6616, 0.7900, 0.6036, 0.5974, 0.6086, 0.6031, 0.6011, 0.5771,
        0.5796, 0.5834, 0.6509, 0.6017, 0.6118, 0.6447, 0.6078, 0.5918, 0.5952,
        0.5928, 0.7305, 0.6062, 0.5988, 0.6000, 0.6345, 0.6035, 0.6030, 0.6061,
        0.6002, 0.5996, 0.6035, 0.5872, 0.6014, 0.6415, 0.6655, 0.5922, 0.6009,
        0.6071], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.6472, 0.7010, 0.7141, 0.7215, 0.6729, 0.6930, 0.6664, 0.6731, 0.7018,
        0.6972, 0.6575, 0.6653, 0.6752, 0.6344, 0.6306, 0.6055, 0.6622, 0.6190,
        0.6341, 0.5980, 0.6555, 0.6122, 0.5986, 0.6258, 0.6102, 0.6099, 0.5914,
        0.5745, 0.5938, 0.5884, 0.6038, 0.6189, 0.5984, 0.5896, 0.5840, 0.5977,
        0.5948, 0.5889, 0.5829, 0.5929, 0.5905, 0.5715, 0.5792, 0.5828, 0.5855,
        0.5903, 0.5805, 0.5771, 0.5657, 0.6123, 0.5857, 0.5882, 0.5807, 0.5826,
        0.5777, 0.5959, 0.5695, 0.5582, 0.5749, 0.5934, 0.5769, 0.5800, 0.5865,
        0.5786, 0.5801, 0.5863, 0.5772, 0.5826, 0.5865, 0.5763, 0.5913, 0.6010,
        0.5690, 0.5766, 0.5762, 0.5897, 0.5917, 0.5736, 0.5608, 0.5882, 0.5730,
        0.5618, 0.5867, 0.5906, 0.5878, 0.5884, 0.5784, 0.5892, 0.5736, 0.5971,
        0.5802, 0.5635, 0.5642, 0.5913, 0.5801, 0.5947, 0.5834, 0.5716, 0.5961,
        0.5837], device='cuda:4', grad_fn=<NormBackward1>)
3shot of client 0:head:0.13227513227513227, middle:0.0, tail0.0
3shot of client 1:head:0.22879684418145957, middle:0.0, tail0.0
3shot of client 2:head:0.20134228187919462, middle:0.0, tail0.0
3shot of client 3:head:0.08523908523908524, middle:0.0, tail0.0
3shot of client 4:head:0.16188524590163936, middle:0.0, tail0.0
3shot of client 5:head:0.09197651663405088, middle:0.0, tail0.0
3shot of client 6:head:0.16326530612244897, middle:0.0, tail0.0
3shot of client 7:head:0.078125, middle:0.0, tail0.0
3shot of client 8:head:0.09567198177676538, middle:0.0, tail0.0
3shot of client 9:head:0.0, middle:0.08823529411764706, tail0.0
3shot of client 10:head:0.09776536312849161, middle:0.0, tail0.0
3shot of client 11:head:0.05413105413105413, middle:0.0, tail0.0
3shot of client 12:head:0.23563218390804597, middle:0.0, tail0.0
3shot of client 13:head:0.29012345679012347, middle:0.0, tail0.0
3shot of client 14:head:0.11859838274932614, middle:0.0, tail0.0
3shot of client 15:head:0.09126984126984126, middle:0.0, tail0.0
3shot of client 16:head:0.08783783783783784, middle:0.08823529411764706, tail0.0
3shot of client 17:head:0.16723549488054607, middle:0.0, tail0.0
3shot of client 18:head:0.05514705882352941, middle:0.0, tail0.0
3shot of client 19:head:0.06060606060606061, middle:0.0, tail0.0
round 3, local average test acc  0.0968 

round 3, local macro average F1 score  0.0066 

round 3, local weighted average F1 score  0.0319 

round 3, global test acc  0.0100 

round 3, average 3shot acc: [head: 0.1248, middle: 0.0088, tail: 0.0000] 

round 3, global 3shot acc: [head: 0.0370, middle: 0.0000, tail: 0.0000] 

l_head tensor([1.0440, 0.7568, 1.0465, 0.5905, 1.2630, 1.8934, 1.3802, 0.6619, 1.9872,
        0.6838, 0.7506, 1.6568, 1.0193, 0.6531, 1.5992, 1.1796, 0.6985, 0.7236,
        0.6013, 0.8553, 0.6116, 0.6871, 0.8939, 1.1836, 0.9090, 0.6957, 0.8180,
        1.8001, 0.6075, 0.9413, 0.7305, 0.6068, 0.6815, 0.6123, 1.5251, 0.9585,
        0.9375, 0.7078, 1.1928, 0.6209, 0.7786, 0.6008, 0.6049, 0.6110, 0.6618,
        0.8437, 0.5907, 0.6104, 0.6585, 0.6138, 0.5939, 0.5985, 0.6043, 0.5956,
        0.6253, 0.5924, 0.7009, 0.6677, 0.5997, 0.5856, 0.7122, 0.6126, 0.6790,
        0.6069, 0.6773, 0.8243, 0.6069, 0.6004, 0.6119, 0.6063, 0.6040, 0.5804,
        0.5826, 0.5868, 0.6454, 0.6048, 0.6151, 0.6335, 0.6108, 0.5951, 0.5986,
        0.5965, 0.7632, 0.6097, 0.6019, 0.6034, 0.6600, 0.6069, 0.6063, 0.6096,
        0.6035, 0.6024, 0.6065, 0.5910, 0.6050, 0.6805, 0.6891, 0.5950, 0.6042,
        0.6106], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.6986, 0.7546, 0.7642, 0.7753, 0.7397, 0.7334, 0.7330, 0.7147, 0.7531,
        0.7514, 0.7062, 0.6989, 0.7380, 0.6559, 0.6568, 0.6330, 0.6897, 0.6666,
        0.6519, 0.6083, 0.7000, 0.6363, 0.6234, 0.6649, 0.6417, 0.6317, 0.6030,
        0.5928, 0.6082, 0.5992, 0.6216, 0.6405, 0.6178, 0.6043, 0.5893, 0.6076,
        0.6036, 0.5949, 0.5908, 0.6035, 0.5986, 0.5772, 0.5853, 0.5866, 0.5905,
        0.5931, 0.5843, 0.5835, 0.5657, 0.6370, 0.5847, 0.5940, 0.5986, 0.5954,
        0.5785, 0.5966, 0.5719, 0.5586, 0.5737, 0.6014, 0.5959, 0.5814, 0.5923,
        0.5813, 0.5824, 0.5850, 0.5733, 0.5854, 0.5904, 0.5800, 0.5957, 0.6086,
        0.5688, 0.5758, 0.5768, 0.5897, 0.5962, 0.5744, 0.5615, 0.5882, 0.5734,
        0.5619, 0.5907, 0.5979, 0.5903, 0.5904, 0.5800, 0.5898, 0.5769, 0.5990,
        0.5842, 0.5643, 0.5668, 0.5950, 0.5821, 0.5960, 0.5872, 0.5739, 0.5979,
        0.5873], device='cuda:4', grad_fn=<NormBackward1>)
3shot of client 0:head:0.16666666666666666, middle:0.0, tail0.0
3shot of client 1:head:0.2406311637080868, middle:0.0, tail0.0
3shot of client 2:head:0.20134228187919462, middle:0.0, tail0.05555555555555555
3shot of client 3:head:0.20997920997921, middle:0.007936507936507936, tail0.0
3shot of client 4:head:0.1680327868852459, middle:0.0, tail0.0
3shot of client 5:head:0.12720156555772993, middle:0.0, tail0.0
3shot of client 6:head:0.16326530612244897, middle:0.09333333333333334, tail0.0
3shot of client 7:head:0.0625, middle:0.0, tail0.0
3shot of client 8:head:0.11389521640091116, middle:0.06837606837606838, tail0.0
3shot of client 9:head:0.055776892430278883, middle:0.0, tail0.0
3shot of client 10:head:0.1787709497206704, middle:0.0, tail0.0
3shot of client 11:head:0.30484330484330485, middle:0.011363636363636364, tail0.0
3shot of client 12:head:0.1781609195402299, middle:0.011904761904761904, tail0.0
3shot of client 13:head:0.3117283950617284, middle:0.0, tail0.0
3shot of client 14:head:0.2695417789757412, middle:0.0, tail0.0
3shot of client 15:head:0.1746031746031746, middle:0.0, tail0.0
3shot of client 16:head:0.1858108108108108, middle:0.0, tail0.0
3shot of client 17:head:0.15017064846416384, middle:0.0, tail0.0
3shot of client 18:head:0.4485294117647059, middle:0.0, tail0.0
3shot of client 19:head:0.1414141414141414, middle:0.0125, tail0.0
round 4, local average test acc  0.1487 

round 4, local macro average F1 score  0.0171 

round 4, local weighted average F1 score  0.0734 

round 4, global test acc  0.0174 

round 4, average 3shot acc: [head: 0.1926, middle: 0.0103, tail: 0.0028] 

round 4, global 3shot acc: [head: 0.0644, middle: 0.0000, tail: 0.0000] 

l_head   1%|          | 5/500 [16:30<26:55:42, 195.84s/it]  1%|          | 6/500 [19:43<26:43:17, 194.73s/it]tensor([1.1515, 0.7918, 1.1848, 0.5937, 1.4114, 2.0690, 1.5173, 0.6866, 2.2251,
        0.6886, 0.7758, 1.7628, 1.0974, 0.6977, 1.7774, 1.2950, 0.6945, 0.7809,
        0.6045, 0.9137, 0.6145, 0.7404, 0.9410, 1.3023, 0.9764, 0.7412, 0.9255,
        2.0338, 0.6107, 1.0067, 0.7726, 0.6099, 0.7262, 0.6155, 1.7118, 1.0202,
        0.9892, 0.7565, 1.2693, 0.6237, 0.7897, 0.6038, 0.6082, 0.6140, 0.6820,
        0.9321, 0.5941, 0.6135, 0.7449, 0.6165, 0.5972, 0.6015, 0.6074, 0.5987,
        0.6471, 0.5954, 0.7388, 0.7262, 0.6029, 0.5888, 0.7845, 0.6157, 0.7035,
        0.6104, 0.6885, 0.8223, 0.6102, 0.6032, 0.6151, 0.6094, 0.6069, 0.5834,
        0.5856, 0.5902, 0.6686, 0.6078, 0.6182, 0.6455, 0.6138, 0.5982, 0.6017,
        0.6000, 0.8495, 0.6127, 0.6050, 0.6064, 0.6746, 0.6102, 0.6096, 0.6128,
        0.6066, 0.6052, 0.6097, 0.5945, 0.6080, 0.7589, 0.6953, 0.5979, 0.6073,
        0.6137], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.7675, 0.8626, 0.8311, 0.8420, 0.8136, 0.7681, 0.7876, 0.7677, 0.8133,
        0.8019, 0.7745, 0.7508, 0.7810, 0.7008, 0.6952, 0.6734, 0.7386, 0.7340,
        0.6856, 0.6360, 0.7447, 0.6624, 0.6402, 0.7224, 0.6843, 0.6515, 0.6166,
        0.6040, 0.6236, 0.6079, 0.6556, 0.6607, 0.6175, 0.6351, 0.6003, 0.6187,
        0.6212, 0.6073, 0.6036, 0.6193, 0.6057, 0.5846, 0.5944, 0.5924, 0.6000,
        0.5943, 0.5889, 0.5962, 0.5685, 0.6648, 0.5865, 0.5987, 0.6156, 0.6063,
        0.5831, 0.5991, 0.5759, 0.5573, 0.5750, 0.6138, 0.6141, 0.5817, 0.6028,
        0.5856, 0.5863, 0.5857, 0.5807, 0.5890, 0.5968, 0.5841, 0.6039, 0.6188,
        0.5716, 0.5787, 0.5813, 0.5926, 0.6028, 0.5767, 0.5643, 0.5897, 0.5725,
        0.5610, 0.5917, 0.5997, 0.5904, 0.5947, 0.5847, 0.5912, 0.5789, 0.6029,
        0.5861, 0.5625, 0.5680, 0.5958, 0.5830, 0.6042, 0.5911, 0.5757, 0.6004,
        0.5916], device='cuda:4', grad_fn=<NormBackward1>)
3shot of client 0:head:0.20105820105820105, middle:0.010638297872340425, tail0.0
3shot of client 1:head:0.3076923076923077, middle:0.0390625, tail0.0
3shot of client 2:head:0.28859060402684567, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.20582120582120583, middle:0.007936507936507936, tail0.0
3shot of client 4:head:0.2069672131147541, middle:0.008695652173913044, tail0.0
3shot of client 5:head:0.17221135029354206, middle:0.008, tail0.0
3shot of client 6:head:0.12244897959183673, middle:0.02666666666666667, tail0.0
3shot of client 7:head:0.10416666666666667, middle:0.043478260869565216, tail0.0
3shot of client 8:head:0.19817767653758542, middle:0.03418803418803419, tail0.0
3shot of client 9:head:0.13545816733067728, middle:0.0, tail0.0
3shot of client 10:head:0.2849162011173184, middle:0.0, tail0.0
3shot of client 11:head:0.38746438746438744, middle:0.0, tail0.0
3shot of client 12:head:0.25862068965517243, middle:0.0, tail0.0
3shot of client 13:head:0.3117283950617284, middle:0.0, tail0.0
3shot of client 14:head:0.353099730458221, middle:0.0, tail0.0
3shot of client 15:head:0.25396825396825395, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.19932432432432431, middle:0.0, tail0.0
3shot of client 17:head:0.17406143344709898, middle:0.0, tail0.0
3shot of client 18:head:0.3088235294117647, middle:0.07142857142857142, tail0.0
3shot of client 19:head:0.2255892255892256, middle:0.0875, tail0.0
round 5, local average test acc  0.1829 

round 5, local macro average F1 score  0.0270 

round 5, local weighted average F1 score  0.1097 

round 5, global test acc  0.0274 

round 5, average 3shot acc: [head: 0.2350, middle: 0.0208, tail: 0.0000] 

round 5, global 3shot acc: [head: 0.1015, middle: 0.0000, tail: 0.0000] 

l_head tensor([1.2073, 0.8514, 1.3347, 0.5957, 1.5723, 2.1894, 1.6079, 0.7115, 2.5158,
        0.6910, 0.8758, 1.8841, 1.1777, 0.7198, 1.9901, 1.4274, 0.7073, 0.9191,
        0.6064, 0.9937, 0.6163, 0.7600, 1.0895, 1.4184, 1.0244, 0.7585, 0.9947,
        2.2468, 0.6126, 1.0959, 0.7978, 0.6117, 0.7369, 0.6172, 1.8228, 1.0712,
        1.1137, 0.7874, 1.4239, 0.6256, 0.7816, 0.6059, 0.6100, 0.6158, 0.6856,
        0.9809, 0.5960, 0.6153, 0.7963, 0.6180, 0.5992, 0.6034, 0.6094, 0.6004,
        0.6809, 0.5973, 0.7476, 0.7366, 0.6046, 0.5907, 0.8479, 0.6177, 0.7276,
        0.6124, 0.7088, 0.8854, 0.6121, 0.6050, 0.6168, 0.6112, 0.6085, 0.5852,
        0.5874, 0.5923, 0.6715, 0.6096, 0.6200, 0.6611, 0.6156, 0.6002, 0.6037,
        0.6019, 0.8813, 0.6145, 0.6068, 0.6082, 0.7070, 0.6121, 0.6115, 0.6147,
        0.6085, 0.6070, 0.6115, 0.5967, 0.6098, 0.7979, 0.7116, 0.5997, 0.6092,
        0.6156], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.8139, 0.9799, 0.8850, 0.9019, 0.8878, 0.8055, 0.8618, 0.8469, 0.8849,
        0.8440, 0.8145, 0.8048, 0.8493, 0.7473, 0.7444, 0.7237, 0.7709, 0.8062,
        0.7277, 0.6683, 0.7916, 0.6964, 0.6627, 0.7830, 0.7145, 0.6650, 0.6403,
        0.6343, 0.6414, 0.6337, 0.7192, 0.6727, 0.6297, 0.6565, 0.6121, 0.6344,
        0.6332, 0.6172, 0.6179, 0.6320, 0.6088, 0.5973, 0.6021, 0.6013, 0.6059,
        0.5973, 0.5961, 0.6121, 0.5735, 0.6978, 0.5881, 0.6076, 0.6419, 0.6146,
        0.5917, 0.6008, 0.5836, 0.5606, 0.5764, 0.6288, 0.6396, 0.5881, 0.6148,
        0.5874, 0.5963, 0.5888, 0.5873, 0.5921, 0.6049, 0.5893, 0.6114, 0.6303,
        0.5753, 0.5892, 0.5853, 0.5972, 0.6106, 0.5778, 0.5658, 0.5920, 0.5727,
        0.5613, 0.5948, 0.6042, 0.5916, 0.5975, 0.5908, 0.5931, 0.5775, 0.6040,
        0.5883, 0.5624, 0.5703, 0.5980, 0.5828, 0.6130, 0.5969, 0.5746, 0.5990,
        0.5938], device='cuda:4', grad_fn=<NormBackward1>)
3shot of client 0:head:0.15079365079365079, middle:0.0, tail0.0
3shot of client 1:head:0.2859960552268245, middle:0.125, tail0.030303030303030304
3shot of client 2:head:0.3087248322147651, middle:0.05263157894736842, tail0.0
3shot of client 3:head:0.3367983367983368, middle:0.03968253968253968, tail0.0
3shot of client 4:head:0.35860655737704916, middle:0.0, tail0.0
3shot of client 5:head:0.24266144814090018, middle:0.0, tail0.0
3shot of client 6:head:0.07142857142857142, middle:0.09333333333333334, tail0.0
3shot of client 7:head:0.2708333333333333, middle:0.0, tail0.0
3shot of client 8:head:0.18223234624145787, middle:0.0, tail0.0
3shot of client 9:head:0.099601593625498, middle:0.16176470588235295, tail0.0
3shot of client 10:head:0.32122905027932963, middle:0.023255813953488372, tail0.0
3shot of client 11:head:0.3903133903133903, middle:0.011363636363636364, tail0.0
3shot of client 12:head:0.42528735632183906, middle:0.0, tail0.0
3shot of client 13:head:0.3148148148148148, middle:0.07058823529411765, tail0.0
3shot of client 14:head:0.15633423180592992, middle:0.0, tail0.0
3shot of client 15:head:0.26587301587301587, middle:0.0, tail0.0625
3shot of client 16:head:0.25675675675675674, middle:0.0, tail0.0
3shot of client 17:head:0.24914675767918087, middle:0.06944444444444445, tail0.0
3shot of client 18:head:0.4485294117647059, middle:0.014285714285714285, tail0.0
3shot of client 19:head:0.35353535353535354, middle:0.05, tail0.0
round 6, local average test acc  0.2164 

round 6, local macro average F1 score  0.0462 

round 6, local weighted average F1 score  0.1516 

round 6, global test acc  0.0407 

round 6, average 3shot acc: [head: 0.2745, middle: 0.0356, tail: 0.0046] 

round 6, global 3shot acc: [head: 0.1507, middle: 0.0000, tail: 0.0000] 

l_head   1%|▏         | 7/500 [22:52<26:26:02, 193.03s/it]  2%|▏         | 8/500 [26:08<26:28:29, 193.72s/it]tensor([1.2509, 0.9096, 1.3861, 0.5972, 1.7374, 2.3763, 1.7656, 0.7310, 2.7395,
        0.7409, 0.8918, 2.1111, 1.2143, 0.7457, 2.1500, 1.5426, 0.7155, 0.9178,
        0.6078, 1.0059, 0.6176, 0.8387, 1.0726, 1.5170, 1.0627, 0.7868, 1.0363,
        2.5669, 0.6141, 1.1607, 0.8401, 0.6131, 0.7628, 0.6186, 2.0078, 1.1406,
        1.2048, 0.8433, 1.5368, 0.6270, 0.7960, 0.6073, 0.6115, 0.6172, 0.7181,
        1.0101, 0.5974, 0.6168, 0.8214, 0.6194, 0.6007, 0.6048, 0.6109, 0.6018,
        0.7016, 0.5987, 0.8070, 0.8074, 0.6061, 0.5923, 0.8346, 0.6192, 0.8157,
        0.6140, 0.7309, 0.9390, 0.6136, 0.6064, 0.6181, 0.6124, 0.6100, 0.5867,
        0.5886, 0.5940, 0.6823, 0.6109, 0.6214, 0.6997, 0.6171, 0.6016, 0.6051,
        0.6035, 0.9015, 0.6158, 0.6081, 0.6096, 0.7283, 0.6136, 0.6130, 0.6162,
        0.6099, 0.6085, 0.6129, 0.5983, 0.6112, 0.8088, 0.7375, 0.6009, 0.6106,
        0.6171], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.8558, 1.0804, 0.9489, 0.9619, 0.9628, 0.8528, 0.9068, 0.9138, 0.9333,
        0.8767, 0.8781, 0.8439, 0.9138, 0.7969, 0.7836, 0.7575, 0.7966, 0.8654,
        0.7848, 0.6985, 0.8433, 0.7356, 0.6773, 0.8461, 0.7594, 0.6983, 0.6607,
        0.6551, 0.6576, 0.6560, 0.7921, 0.7030, 0.6419, 0.6790, 0.6307, 0.6437,
        0.6374, 0.6297, 0.6304, 0.6503, 0.6140, 0.6195, 0.6185, 0.6166, 0.6141,
        0.6078, 0.6063, 0.6233, 0.5738, 0.7325, 0.5923, 0.6183, 0.6659, 0.6220,
        0.6003, 0.6091, 0.5934, 0.5683, 0.5856, 0.6433, 0.6603, 0.5955, 0.6282,
        0.5913, 0.6011, 0.5930, 0.5961, 0.5986, 0.6126, 0.5952, 0.6177, 0.6454,
        0.5794, 0.6034, 0.5905, 0.6034, 0.6151, 0.5788, 0.5695, 0.5950, 0.5759,
        0.5608, 0.5971, 0.6054, 0.5925, 0.6033, 0.5980, 0.5913, 0.5802, 0.6060,
        0.5926, 0.5625, 0.5721, 0.5995, 0.5808, 0.6235, 0.6020, 0.5767, 0.6005,
        0.5963], device='cuda:4', grad_fn=<NormBackward1>)
3shot of client 0:head:0.18783068783068782, middle:0.1595744680851064, tail0.0
3shot of client 1:head:0.34911242603550297, middle:0.0859375, tail0.0
3shot of client 2:head:0.23825503355704697, middle:0.13157894736842105, tail0.1111111111111111
3shot of client 3:head:0.35343035343035345, middle:0.10317460317460317, tail0.0
3shot of client 4:head:0.3237704918032787, middle:0.0, tail0.0
3shot of client 5:head:0.24266144814090018, middle:0.064, tail0.0
3shot of client 6:head:0.15306122448979592, middle:0.05333333333333334, tail0.0
3shot of client 7:head:0.22395833333333334, middle:0.043478260869565216, tail0.0
3shot of client 8:head:0.2984054669703872, middle:0.03418803418803419, tail0.0
3shot of client 9:head:0.05976095617529881, middle:0.08823529411764706, tail0.06666666666666667
3shot of client 10:head:0.329608938547486, middle:0.0, tail0.045454545454545456
3shot of client 11:head:0.396011396011396, middle:0.022727272727272728, tail0.0
3shot of client 12:head:0.4166666666666667, middle:0.023809523809523808, tail0.0
3shot of client 13:head:0.31790123456790126, middle:0.047058823529411764, tail0.0
3shot of client 14:head:0.33153638814016173, middle:0.010526315789473684, tail0.0
3shot of client 15:head:0.2777777777777778, middle:0.11290322580645161, tail0.0
3shot of client 16:head:0.14527027027027026, middle:0.10294117647058823, tail0.0
3shot of client 17:head:0.20819112627986347, middle:0.09722222222222222, tail0.0
3shot of client 18:head:0.47058823529411764, middle:0.0, tail0.0
3shot of client 19:head:0.3434343434343434, middle:0.0125, tail0.0
round 7, local average test acc  0.2277 

round 7, local macro average F1 score  0.0582 

round 7, local weighted average F1 score  0.1786 

round 7, global test acc  0.0460 

round 7, average 3shot acc: [head: 0.2834, middle: 0.0597, tail: 0.0112] 

round 7, global 3shot acc: [head: 0.1704, middle: 0.0000, tail: 0.0000] 

l_head tensor([1.3215, 1.0041, 1.4777, 0.5982, 1.8934, 2.5013, 1.8308, 0.7902, 2.9570,
        0.7548, 0.9908, 2.2132, 1.3788, 0.8573, 2.3089, 1.6687, 0.8086, 1.0134,
        0.6088, 1.0612, 0.6187, 0.8668, 1.2048, 1.7525, 1.2006, 0.8754, 1.1350,
        2.7885, 0.6150, 1.2639, 0.9043, 0.6141, 0.7923, 0.6195, 2.2870, 1.2463,
        1.3689, 0.8697, 1.6435, 0.6280, 0.8531, 0.6084, 0.6125, 0.6181, 0.7419,
        1.1174, 0.5985, 0.6177, 0.8834, 0.6205, 0.6017, 0.6058, 0.6118, 0.6027,
        0.7372, 0.5997, 0.7932, 0.8451, 0.6070, 0.5935, 0.8997, 0.6203, 0.8512,
        0.6151, 0.7620, 1.0261, 0.6146, 0.6073, 0.6191, 0.6134, 0.6110, 0.5877,
        0.5897, 0.5950, 0.6922, 0.6119, 0.6224, 0.7360, 0.6181, 0.6025, 0.6061,
        0.6046, 0.9181, 0.6168, 0.6090, 0.6104, 0.7778, 0.6147, 0.6141, 0.6172,
        0.6109, 0.6094, 0.6138, 0.5993, 0.6121, 0.8712, 0.7411, 0.6019, 0.6115,
        0.6180], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.9101, 1.1220, 0.9967, 1.0277, 1.0480, 0.9134, 0.9664, 0.9909, 0.9953,
        0.9273, 0.9505, 0.8613, 0.9885, 0.8515, 0.8219, 0.8082, 0.8429, 0.9313,
        0.8221, 0.7214, 0.8917, 0.7775, 0.7107, 0.9195, 0.7993, 0.7084, 0.6859,
        0.6872, 0.6798, 0.6842, 0.8540, 0.7329, 0.6530, 0.7019, 0.6408, 0.6563,
        0.6423, 0.6520, 0.6453, 0.6740, 0.6263, 0.6448, 0.6304, 0.6369, 0.6278,
        0.6194, 0.6181, 0.6362, 0.5828, 0.7657, 0.5940, 0.6339, 0.6826, 0.6333,
        0.6096, 0.6139, 0.5941, 0.5801, 0.5983, 0.6544, 0.6808, 0.6025, 0.6439,
        0.5945, 0.6050, 0.5957, 0.6057, 0.6050, 0.6198, 0.6007, 0.6225, 0.6635,
        0.5829, 0.6162, 0.5966, 0.6061, 0.6198, 0.5794, 0.5731, 0.6037, 0.5770,
        0.5606, 0.5995, 0.6133, 0.5924, 0.6127, 0.6047, 0.5926, 0.5829, 0.6076,
        0.5984, 0.5646, 0.5764, 0.6030, 0.5806, 0.6293, 0.6039, 0.5804, 0.6023,
        0.6007], device='cuda:4', grad_fn=<NormBackward1>)
3shot of client 0:head:0.12698412698412698, middle:0.13829787234042554, tail0.041666666666666664
3shot of client 1:head:0.3708086785009862, middle:0.1484375, tail0.0
3shot of client 2:head:0.3691275167785235, middle:0.09210526315789473, tail0.0
3shot of client 3:head:0.3991683991683992, middle:0.06349206349206349, tail0.0
3shot of client 4:head:0.4139344262295082, middle:0.008695652173913044, tail0.0
3shot of client 5:head:0.26418786692759294, middle:0.032, tail0.0
3shot of client 6:head:0.20408163265306123, middle:0.13333333333333333, tail0.05263157894736842
3shot of client 7:head:0.3072916666666667, middle:0.043478260869565216, tail0.0
3shot of client 8:head:0.23690205011389523, middle:0.03418803418803419, tail0.0
3shot of client 9:head:0.23107569721115537, middle:0.0, tail0.0
3shot of client 10:head:0.2122905027932961, middle:0.023255813953488372, tail0.0
3shot of client 11:head:0.45014245014245013, middle:0.03409090909090909, tail0.0
3shot of client 12:head:0.3448275862068966, middle:0.0, tail0.0
3shot of client 13:head:0.2993827160493827, middle:0.058823529411764705, tail0.0
3shot of client 14:head:0.3908355795148248, middle:0.021052631578947368, tail0.0
3shot of client 15:head:0.27380952380952384, middle:0.0, tail0.0
3shot of client 16:head:0.2972972972972973, middle:0.029411764705882353, tail0.0
3shot of client 17:head:0.23208191126279865, middle:0.06944444444444445, tail0.058823529411764705
3shot of client 18:head:0.5220588235294118, middle:0.08571428571428572, tail0.0
3shot of client 19:head:0.24242424242424243, middle:0.1125, tail0.0
round 8, local average test acc  0.2469 

round 8, local macro average F1 score  0.0641 

round 8, local weighted average F1 score  0.1863 

round 8, global test acc  0.0528 

round 8, average 3shot acc: [head: 0.3094, middle: 0.0564, tail: 0.0077] 

round 8, global 3shot acc: [head: 0.1830, middle: 0.0131, tail: 0.0000] 

l_head   2%|▏         | 9/500 [29:22<26:28:21, 194.10s/it]  2%|▏         | 10/500 [32:37<26:26:30, 194.27s/it]tensor([1.3847, 1.1700, 1.5370, 0.5989, 2.0940, 2.6413, 1.9700, 0.8517, 3.1778,
        0.7755, 1.0435, 2.3854, 1.4327, 0.9402, 2.4726, 1.7014, 0.8624, 1.1027,
        0.6095, 1.1567, 0.6194, 0.8729, 1.2824, 1.8309, 1.2600, 0.9388, 1.1866,
        3.0056, 0.6158, 1.3410, 0.9430, 0.6148, 0.8477, 0.6203, 2.4665, 1.3492,
        1.4275, 0.9104, 1.8351, 0.6287, 0.8506, 0.6091, 0.6132, 0.6187, 0.8167,
        1.2469, 0.5992, 0.6185, 0.9533, 0.6211, 0.6023, 0.6065, 0.6125, 0.6034,
        0.7729, 0.6004, 0.8086, 0.8750, 0.6076, 0.5943, 0.9294, 0.6212, 0.8813,
        0.6158, 0.8353, 1.0895, 0.6154, 0.6080, 0.6198, 0.6141, 0.6117, 0.5884,
        0.5904, 0.5957, 0.7059, 0.6126, 0.6231, 0.7654, 0.6187, 0.6032, 0.6069,
        0.6053, 0.9471, 0.6175, 0.6098, 0.6111, 0.7964, 0.6154, 0.6149, 0.6180,
        0.6117, 0.6101, 0.6145, 0.6001, 0.6128, 0.8799, 0.7767, 0.6026, 0.6123,
        0.6188], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([0.9465, 1.1657, 1.0339, 1.0962, 1.1243, 0.9864, 1.0222, 1.0625, 1.0669,
        0.9842, 0.9902, 0.9194, 1.0501, 0.9237, 0.8883, 0.8618, 0.8834, 0.9738,
        0.8581, 0.7510, 0.9437, 0.8371, 0.7381, 0.9670, 0.8382, 0.7403, 0.7143,
        0.7171, 0.7048, 0.7197, 0.9239, 0.7557, 0.6708, 0.7250, 0.6667, 0.6738,
        0.6568, 0.6728, 0.6691, 0.6937, 0.6419, 0.6727, 0.6345, 0.6581, 0.6451,
        0.6359, 0.6227, 0.6518, 0.5902, 0.7925, 0.6017, 0.6501, 0.7047, 0.6455,
        0.6201, 0.6183, 0.6067, 0.5953, 0.6135, 0.6656, 0.7088, 0.6114, 0.6604,
        0.6006, 0.6107, 0.5991, 0.6124, 0.6159, 0.6284, 0.6079, 0.6316, 0.6799,
        0.5838, 0.6260, 0.5987, 0.6143, 0.6276, 0.5825, 0.5784, 0.6105, 0.5791,
        0.5597, 0.6041, 0.6184, 0.5947, 0.6186, 0.6132, 0.5959, 0.5842, 0.6099,
        0.6010, 0.5682, 0.5818, 0.6107, 0.5808, 0.6388, 0.6098, 0.5833, 0.6041,
        0.6037], device='cuda:4', grad_fn=<NormBackward1>)
3shot of client 0:head:0.2037037037037037, middle:0.18085106382978725, tail0.0
3shot of client 1:head:0.3668639053254438, middle:0.0859375, tail0.06060606060606061
3shot of client 2:head:0.42953020134228187, middle:0.02631578947368421, tail0.0
3shot of client 3:head:0.30561330561330563, middle:0.14285714285714285, tail0.0
3shot of client 4:head:0.4016393442622951, middle:0.017391304347826087, tail0.0
3shot of client 5:head:0.2974559686888454, middle:0.032, tail0.03125
3shot of client 6:head:0.23129251700680273, middle:0.05333333333333334, tail0.0
3shot of client 7:head:0.20833333333333334, middle:0.06521739130434782, tail0.0
3shot of client 8:head:0.3462414578587699, middle:0.0, tail0.0
3shot of client 9:head:0.14342629482071714, middle:0.0, tail0.0
3shot of client 10:head:0.33519553072625696, middle:0.011627906976744186, tail0.0
3shot of client 11:head:0.50997150997151, middle:0.0, tail0.0
3shot of client 12:head:0.3505747126436782, middle:0.07142857142857142, tail0.0
3shot of client 13:head:0.35185185185185186, middle:0.058823529411764705, tail0.0
3shot of client 14:head:0.4582210242587601, middle:0.0, tail0.08333333333333333
3shot of client 15:head:0.2619047619047619, middle:0.14516129032258066, tail0.0
3shot of client 16:head:0.2668918918918919, middle:0.10294117647058823, tail0.0
3shot of client 17:head:0.27986348122866894, middle:0.125, tail0.0
3shot of client 18:head:0.5992647058823529, middle:0.08571428571428572, tail0.0
3shot of client 19:head:0.3939393939393939, middle:0.0375, tail0.0
round 9, local average test acc  0.2688 

round 9, local macro average F1 score  0.0698 

round 9, local weighted average F1 score  0.2078 

round 9, global test acc  0.0539 

round 9, average 3shot acc: [head: 0.3371, middle: 0.0621, tail: 0.0088] 

round 9, global 3shot acc: [head: 0.1919, middle: 0.0081, tail: 0.0000] 

l_head tensor([1.4491, 1.1771, 1.6303, 0.5997, 2.1588, 2.8039, 2.0761, 0.9280, 3.3561,
        0.8416, 1.1101, 2.5149, 1.4528, 0.9831, 2.6841, 1.8647, 0.8933, 1.1280,
        0.6102, 1.2240, 0.6202, 0.9234, 1.3562, 2.0058, 1.3265, 0.9915, 1.2851,
        3.2809, 0.6166, 1.4422, 0.9462, 0.6156, 0.8912, 0.6211, 2.6049, 1.4379,
        1.3857, 0.9204, 1.9901, 0.6295, 0.9409, 0.6098, 0.6140, 0.6193, 0.8562,
        1.3426, 0.6000, 0.6193, 1.0598, 0.6219, 0.6031, 0.6072, 0.6133, 0.6042,
        0.7706, 0.6011, 0.8314, 0.9183, 0.6084, 0.5952, 0.9500, 0.6220, 0.9300,
        0.6167, 0.8522, 1.1719, 0.6162, 0.6088, 0.6204, 0.6150, 0.6125, 0.5892,
        0.5913, 0.5965, 0.7388, 0.6133, 0.6239, 0.7917, 0.6194, 0.6040, 0.6077,
        0.6061, 0.9845, 0.6183, 0.6105, 0.6119, 0.8636, 0.6162, 0.6157, 0.6187,
        0.6125, 0.6109, 0.6153, 0.6009, 0.6135, 0.9271, 0.8518, 0.6033, 0.6131,
        0.6195], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.0104, 1.2076, 1.0871, 1.1656, 1.1837, 1.0519, 1.0639, 1.1122, 1.1186,
        1.0573, 1.0396, 0.9562, 1.0926, 1.0037, 0.9483, 0.8972, 0.9227, 1.0369,
        0.9051, 0.7880, 0.9855, 0.8884, 0.7746, 1.0030, 0.8828, 0.7789, 0.7393,
        0.7562, 0.7312, 0.7472, 0.9870, 0.7758, 0.6920, 0.7554, 0.6854, 0.6830,
        0.6678, 0.6798, 0.6818, 0.7125, 0.6467, 0.7065, 0.6415, 0.6812, 0.6583,
        0.6528, 0.6286, 0.6672, 0.6063, 0.8221, 0.6094, 0.6634, 0.7380, 0.6569,
        0.6325, 0.6272, 0.6128, 0.6096, 0.6259, 0.6751, 0.7400, 0.6271, 0.6647,
        0.6114, 0.6182, 0.6058, 0.6166, 0.6267, 0.6411, 0.6164, 0.6414, 0.7017,
        0.5892, 0.6375, 0.6053, 0.6217, 0.6387, 0.5842, 0.5838, 0.6248, 0.5830,
        0.5630, 0.6139, 0.6217, 0.5975, 0.6245, 0.6156, 0.5986, 0.5865, 0.6124,
        0.6030, 0.5723, 0.5864, 0.6176, 0.5817, 0.6507, 0.6146, 0.5862, 0.6036,
        0.6064], device='cuda:4', grad_fn=<NormBackward1>)
3shot of client 0:head:0.2222222222222222, middle:0.13829787234042554, tail0.041666666666666664
3shot of client 1:head:0.3037475345167653, middle:0.1015625, tail0.0
3shot of client 2:head:0.40939597315436244, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.3866943866943867, middle:0.14285714285714285, tail0.0
3shot of client 4:head:0.4139344262295082, middle:0.008695652173913044, tail0.0
3shot of client 5:head:0.29158512720156554, middle:0.008, tail0.09375
3shot of client 6:head:0.21768707482993196, middle:0.17333333333333334, tail0.0
3shot of client 7:head:0.20833333333333334, middle:0.043478260869565216, tail0.0
3shot of client 8:head:0.2984054669703872, middle:0.017094017094017096, tail0.038461538461538464
3shot of client 9:head:0.14741035856573706, middle:0.11764705882352941, tail0.2
3shot of client 10:head:0.30726256983240224, middle:0.08139534883720931, tail0.0
3shot of client 11:head:0.38746438746438744, middle:0.03409090909090909, tail0.0
3shot of client 12:head:0.3936781609195402, middle:0.03571428571428571, tail0.0
3shot of client 13:head:0.39197530864197533, middle:0.11764705882352941, tail0.05
3shot of client 14:head:0.4420485175202156, middle:0.021052631578947368, tail0.041666666666666664
3shot of client 15:head:0.2976190476190476, middle:0.1774193548387097, tail0.0
3shot of client 16:head:0.23986486486486486, middle:0.07352941176470588, tail0.0
3shot of client 17:head:0.22525597269624573, middle:0.19444444444444445, tail0.0
3shot of client 18:head:0.5183823529411765, middle:0.12857142857142856, tail0.0
3shot of client 19:head:0.39057239057239057, middle:0.0375, tail0.058823529411764705
round 10, local average test acc  0.2644 

round 10, local macro average F1 score  0.0797 

round 10, local weighted average F1 score  0.2082 

round 10, global test acc  0.0606 

round 10, average 3shot acc: [head: 0.3247, middle: 0.0833, tail: 0.0262] 

round 10, global 3shot acc: [head: 0.2226, middle: 0.0019, tail: 0.0000] 

l_head   2%|▏         | 11/500 [35:50<26:19:49, 193.84s/it]  2%|▏         | 12/500 [39:06<26:21:46, 194.48s/it]tensor([1.4578, 1.3311, 1.6862, 0.6002, 2.2627, 2.9525, 2.2025, 1.0019, 3.5711,
        0.8508, 1.1635, 2.7354, 1.5320, 1.0328, 2.8121, 1.9840, 0.9753, 1.1642,
        0.6108, 1.3061, 0.6208, 0.9594, 1.4558, 2.1327, 1.3658, 1.0811, 1.4424,
        3.4920, 0.6172, 1.5577, 1.0516, 0.6162, 0.9515, 0.6217, 2.8481, 1.5763,
        1.5193, 0.9628, 2.2191, 0.6301, 1.0054, 0.6104, 0.6147, 0.6199, 0.9038,
        1.4646, 0.6006, 0.6199, 1.1368, 0.6224, 0.6036, 0.6079, 0.6139, 0.6048,
        0.8115, 0.6017, 0.9162, 0.9665, 0.6090, 0.5958, 0.9794, 0.6226, 0.9755,
        0.6173, 0.9541, 1.2746, 0.6168, 0.6093, 0.6210, 0.6155, 0.6131, 0.5898,
        0.5919, 0.5971, 0.7687, 0.6139, 0.6245, 0.8335, 0.6199, 0.6046, 0.6083,
        0.6068, 1.0330, 0.6188, 0.6111, 0.6125, 0.9449, 0.6168, 0.6163, 0.6193,
        0.6131, 0.6115, 0.6158, 0.6015, 0.6141, 1.0090, 0.8772, 0.6038, 0.6137,
        0.6201], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.0380, 1.2668, 1.1302, 1.2305, 1.2417, 1.1181, 1.1220, 1.1564, 1.1662,
        1.1233, 1.0870, 0.9820, 1.1443, 1.0675, 0.9738, 0.9228, 0.9701, 1.0816,
        0.9336, 0.8329, 1.0208, 0.9515, 0.8240, 1.0923, 0.9271, 0.8336, 0.7870,
        0.8038, 0.7552, 0.7856, 1.0413, 0.7982, 0.7129, 0.7701, 0.7149, 0.7120,
        0.6859, 0.6982, 0.7030, 0.7277, 0.6619, 0.7411, 0.6567, 0.7046, 0.6701,
        0.6717, 0.6492, 0.6981, 0.6266, 0.8651, 0.6150, 0.6702, 0.7565, 0.6745,
        0.6449, 0.6342, 0.6308, 0.6196, 0.6399, 0.6854, 0.7642, 0.6386, 0.6791,
        0.6199, 0.6300, 0.6143, 0.6200, 0.6391, 0.6444, 0.6198, 0.6506, 0.7107,
        0.5895, 0.6525, 0.6111, 0.6306, 0.6496, 0.5908, 0.5919, 0.6363, 0.5867,
        0.5688, 0.6215, 0.6226, 0.6039, 0.6314, 0.6205, 0.6014, 0.5891, 0.6152,
        0.6054, 0.5780, 0.5926, 0.6257, 0.5843, 0.6635, 0.6190, 0.5880, 0.6058,
        0.6082], device='cuda:4', grad_fn=<NormBackward1>)
3shot of client 0:head:0.2566137566137566, middle:0.1276595744680851, tail0.0
3shot of client 1:head:0.39644970414201186, middle:0.0390625, tail0.0
3shot of client 2:head:0.348993288590604, middle:0.14473684210526316, tail0.0
3shot of client 3:head:0.3596673596673597, middle:0.1984126984126984, tail0.0
3shot of client 4:head:0.4077868852459016, middle:0.10434782608695652, tail0.0
3shot of client 5:head:0.324853228962818, middle:0.04, tail0.09375
3shot of client 6:head:0.23469387755102042, middle:0.13333333333333333, tail0.05263157894736842
3shot of client 7:head:0.21354166666666666, middle:0.10869565217391304, tail0.0
3shot of client 8:head:0.33029612756264237, middle:0.017094017094017096, tail0.038461538461538464
3shot of client 9:head:0.3426294820717131, middle:0.07352941176470588, tail0.0
3shot of client 10:head:0.2988826815642458, middle:0.05813953488372093, tail0.0
3shot of client 11:head:0.29914529914529914, middle:0.011363636363636364, tail0.0
3shot of client 12:head:0.47126436781609193, middle:0.047619047619047616, tail0.0
3shot of client 13:head:0.49074074074074076, middle:0.11764705882352941, tail0.1
3shot of client 14:head:0.32345013477088946, middle:0.09473684210526316, tail0.16666666666666666
3shot of client 15:head:0.3134920634920635, middle:0.20967741935483872, tail0.0
3shot of client 16:head:0.3310810810810811, middle:0.16176470588235295, tail0.0
3shot of client 17:head:0.24573378839590443, middle:0.2638888888888889, tail0.0
3shot of client 18:head:0.5330882352941176, middle:0.1, tail0.11764705882352941
3shot of client 19:head:0.3838383838383838, middle:0.125, tail0.058823529411764705
round 11, local average test acc  0.2851 

round 11, local macro average F1 score  0.0925 

round 11, local weighted average F1 score  0.2324 

round 11, global test acc  0.0721 

round 11, average 3shot acc: [head: 0.3453, middle: 0.1088, tail: 0.0314] 

round 11, global 3shot acc: [head: 0.2426, middle: 0.0254, tail: 0.0000] 

l_head tensor([1.4395, 1.3926, 1.7324, 0.6007, 2.4218, 3.0943, 2.3592, 1.0871, 3.8191,
        0.8868, 1.2352, 2.8390, 1.6863, 1.1869, 2.9504, 2.0597, 1.0298, 1.2473,
        0.6112, 1.4028, 0.6213, 1.0470, 1.5708, 2.2729, 1.4610, 1.1857, 1.5161,
        3.6444, 0.6176, 1.6557, 1.1260, 0.6166, 1.0199, 0.6221, 2.9935, 1.6116,
        1.5762, 1.0102, 2.2993, 0.6306, 1.0981, 0.6108, 0.6151, 0.6203, 0.9593,
        1.5160, 0.6011, 0.6203, 1.3001, 0.6229, 0.6040, 0.6083, 0.6143, 0.6052,
        0.8800, 0.6022, 0.9501, 0.9998, 0.6094, 0.5963, 1.0468, 0.6230, 1.0294,
        0.6178, 1.0347, 1.3656, 0.6172, 0.6098, 0.6214, 0.6159, 0.6135, 0.5902,
        0.5923, 0.5975, 0.7988, 0.6143, 0.6249, 0.8855, 0.6203, 0.6050, 0.6087,
        0.6072, 1.0441, 0.6192, 0.6115, 0.6129, 0.9924, 0.6172, 0.6168, 0.6198,
        0.6135, 0.6119, 0.6162, 0.6020, 0.6145, 1.0215, 0.9444, 0.6042, 0.6141,
        0.6205], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.1158, 1.3116, 1.1628, 1.2881, 1.2985, 1.1714, 1.1717, 1.2004, 1.2067,
        1.1753, 1.1244, 1.0169, 1.2224, 1.1417, 1.0326, 0.9502, 1.0040, 1.1439,
        0.9551, 0.8568, 1.0692, 1.0095, 0.8526, 1.1471, 0.9632, 0.8790, 0.8200,
        0.8378, 0.7906, 0.8156, 1.0944, 0.8197, 0.7289, 0.7914, 0.7359, 0.7342,
        0.7163, 0.7209, 0.7207, 0.7537, 0.6863, 0.7715, 0.6648, 0.7259, 0.6892,
        0.6817, 0.6596, 0.7162, 0.6521, 0.9019, 0.6248, 0.6815, 0.7682, 0.6941,
        0.6631, 0.6386, 0.6508, 0.6213, 0.6559, 0.6971, 0.8051, 0.6595, 0.6890,
        0.6282, 0.6309, 0.6229, 0.6294, 0.6597, 0.6506, 0.6267, 0.6565, 0.7319,
        0.5907, 0.6610, 0.6186, 0.6420, 0.6605, 0.5955, 0.6041, 0.6388, 0.5918,
        0.5753, 0.6303, 0.6274, 0.6072, 0.6389, 0.6324, 0.6044, 0.5926, 0.6192,
        0.6097, 0.5844, 0.5953, 0.6337, 0.5904, 0.6807, 0.6247, 0.5928, 0.6088,
        0.6103], device='cuda:4', grad_fn=<NormBackward1>)
3shot of client 0:head:0.23015873015873015, middle:0.20212765957446807, tail0.08333333333333333
3shot of client 1:head:0.3668639053254438, middle:0.21875, tail0.0
3shot of client 2:head:0.3523489932885906, middle:0.039473684210526314, tail0.0
3shot of client 3:head:0.3804573804573805, middle:0.2698412698412698, tail0.0
3shot of client 4:head:0.3442622950819672, middle:0.14782608695652175, tail0.034482758620689655
3shot of client 5:head:0.3659491193737769, middle:0.072, tail0.09375
3shot of client 6:head:0.24829931972789115, middle:0.17333333333333334, tail0.0
3shot of client 7:head:0.3072916666666667, middle:0.10869565217391304, tail0.0
3shot of client 8:head:0.35079726651480636, middle:0.02564102564102564, tail0.07692307692307693
3shot of client 9:head:0.18725099601593626, middle:0.14705882352941177, tail0.0
3shot of client 10:head:0.4245810055865922, middle:0.023255813953488372, tail0.0
3shot of client 11:head:0.41595441595441596, middle:0.13636363636363635, tail0.043478260869565216
3shot of client 12:head:0.40229885057471265, middle:0.09523809523809523, tail0.0
3shot of client 13:head:0.48148148148148145, middle:0.10588235294117647, tail0.05
3shot of client 14:head:0.3477088948787062, middle:0.031578947368421054, tail0.08333333333333333
3shot of client 15:head:0.3055555555555556, middle:0.08064516129032258, tail0.0
3shot of client 16:head:0.21621621621621623, middle:0.058823529411764705, tail0.0
3shot of client 17:head:0.3447098976109215, middle:0.18055555555555555, tail0.0
3shot of client 18:head:0.5147058823529411, middle:0.14285714285714285, tail0.11764705882352941
3shot of client 19:head:0.3400673400673401, middle:0.0375, tail0.0
round 12, local average test acc  0.2871 

round 12, local macro average F1 score  0.0958 

round 12, local weighted average F1 score  0.2357 

round 12, global test acc  0.0788 

round 12, average 3shot acc: [head: 0.3463, middle: 0.1149, tail: 0.0291] 

round 12, global 3shot acc: [head: 0.2585, middle: 0.0346, tail: 0.0000] 

l_head   3%|▎         | 13/500 [42:24<26:28:16, 195.68s/it]  3%|▎         | 14/500 [45:37<26:16:31, 194.63s/it]tensor([1.5041, 1.4343, 1.8736, 0.6009, 2.5497, 3.3212, 2.4653, 1.0860, 4.0608,
        0.9553, 1.2799, 3.0565, 1.7932, 1.2082, 3.0874, 2.1550, 1.0905, 1.3989,
        0.6115, 1.4435, 0.6216, 1.1451, 1.5475, 2.4163, 1.5335, 1.2482, 1.6466,
        3.8536, 0.6179, 1.8008, 1.1812, 0.6169, 1.0695, 0.6224, 3.1426, 1.7132,
        1.7136, 1.0961, 2.4523, 0.6309, 1.1999, 0.6111, 0.6154, 0.6206, 1.0058,
        1.6429, 0.6014, 0.6206, 1.4149, 0.6232, 0.6043, 0.6086, 0.6146, 0.6055,
        0.9367, 0.6025, 1.0178, 1.0897, 0.6097, 0.5966, 1.0646, 0.6233, 1.0857,
        0.6181, 1.0995, 1.4141, 0.6175, 0.6100, 0.6217, 0.6162, 0.6138, 0.5905,
        0.5926, 0.5978, 0.8404, 0.6146, 0.6252, 0.9426, 0.6206, 0.6053, 0.6090,
        0.6076, 1.0845, 0.6195, 0.6118, 0.6132, 1.0580, 0.6175, 0.6171, 0.6200,
        0.6138, 0.6122, 0.6165, 0.6023, 0.6148, 1.0682, 0.9884, 0.6045, 0.6144,
        0.6208], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.1569, 1.3717, 1.2439, 1.3488, 1.3504, 1.2211, 1.2143, 1.2218, 1.2497,
        1.2160, 1.1633, 1.0490, 1.2619, 1.2083, 1.0608, 0.9890, 1.0415, 1.2063,
        0.9911, 0.8853, 1.1226, 1.0637, 0.8662, 1.2125, 0.9687, 0.9258, 0.8567,
        0.8636, 0.8230, 0.8615, 1.1584, 0.8572, 0.7483, 0.8222, 0.7576, 0.7588,
        0.7378, 0.7337, 0.7343, 0.7909, 0.7011, 0.8126, 0.6902, 0.7534, 0.7114,
        0.6877, 0.6797, 0.7412, 0.6825, 0.9350, 0.6374, 0.6998, 0.7941, 0.7091,
        0.6774, 0.6514, 0.6724, 0.6333, 0.6828, 0.7113, 0.8489, 0.6682, 0.6896,
        0.6386, 0.6388, 0.6285, 0.6381, 0.6821, 0.6695, 0.6326, 0.6692, 0.7469,
        0.5973, 0.6787, 0.6318, 0.6546, 0.6764, 0.5994, 0.6157, 0.6464, 0.5975,
        0.5835, 0.6414, 0.6344, 0.6124, 0.6480, 0.6391, 0.6103, 0.5951, 0.6253,
        0.6135, 0.5920, 0.6000, 0.6430, 0.5939, 0.6894, 0.6344, 0.5983, 0.6148,
        0.6153], device='cuda:4', grad_fn=<NormBackward1>)
3shot of client 0:head:0.2777777777777778, middle:0.18085106382978725, tail0.08333333333333333
3shot of client 1:head:0.41025641025641024, middle:0.15625, tail0.030303030303030304
3shot of client 2:head:0.40939597315436244, middle:0.02631578947368421, tail0.05555555555555555
3shot of client 3:head:0.4074844074844075, middle:0.19047619047619047, tail0.0
3shot of client 4:head:0.4426229508196721, middle:0.043478260869565216, tail0.034482758620689655
3shot of client 5:head:0.30332681017612523, middle:0.128, tail0.09375
3shot of client 6:head:0.30612244897959184, middle:0.24, tail0.0
3shot of client 7:head:0.28125, middle:0.17391304347826086, tail0.08333333333333333
3shot of client 8:head:0.37585421412300685, middle:0.03418803418803419, tail0.07692307692307693
3shot of client 9:head:0.36254980079681276, middle:0.10294117647058823, tail0.0
3shot of client 10:head:0.3687150837988827, middle:0.09302325581395349, tail0.09090909090909091
3shot of client 11:head:0.5413105413105413, middle:0.07954545454545454, tail0.043478260869565216
3shot of client 12:head:0.4942528735632184, middle:0.09523809523809523, tail0.0
3shot of client 13:head:0.5030864197530864, middle:0.12941176470588237, tail0.0
3shot of client 14:head:0.49595687331536387, middle:0.09473684210526316, tail0.08333333333333333
3shot of client 15:head:0.30158730158730157, middle:0.22580645161290322, tail0.0625
3shot of client 16:head:0.2905405405405405, middle:0.16176470588235295, tail0.0
3shot of client 17:head:0.2901023890784983, middle:0.18055555555555555, tail0.17647058823529413
3shot of client 18:head:0.4742647058823529, middle:0.2, tail0.058823529411764705
3shot of client 19:head:0.41414141414141414, middle:0.0625, tail0.058823529411764705
round 13, local average test acc  0.3222 

round 13, local macro average F1 score  0.1150 

round 13, local weighted average F1 score  0.2700 

round 13, global test acc  0.0796 

round 13, average 3shot acc: [head: 0.3875, middle: 0.1299, tail: 0.0516] 

round 13, global 3shot acc: [head: 0.2741, middle: 0.0212, tail: 0.0002] 

l_head tensor([1.5570, 1.5147, 1.9530, 0.6013, 2.7321, 3.4499, 2.6109, 1.1515, 4.1320,
        0.9804, 1.3705, 3.2086, 1.8493, 1.2893, 3.2070, 2.2820, 1.1323, 1.4213,
        0.6119, 1.5599, 0.6220, 1.1885, 1.6616, 2.4405, 1.5271, 1.4188, 1.8066,
        4.0144, 0.6182, 1.8238, 1.2547, 0.6173, 1.1414, 0.6228, 3.3214, 1.7575,
        1.7622, 1.0253, 2.5715, 0.6313, 1.3290, 0.6115, 0.6158, 0.6210, 1.0561,
        1.7159, 0.6018, 0.6210, 1.4724, 0.6236, 0.6047, 0.6090, 0.6150, 0.6059,
        0.9741, 0.6028, 1.0335, 1.1851, 0.6101, 0.5970, 1.1665, 0.6237, 1.1091,
        0.6185, 1.1677, 1.4637, 0.6179, 0.6104, 0.6221, 0.6166, 0.6142, 0.5909,
        0.5930, 0.5982, 0.8729, 0.6149, 0.6256, 0.9684, 0.6210, 0.6057, 0.6094,
        0.6080, 1.1459, 0.6199, 0.6122, 0.6136, 1.1155, 0.6179, 0.6175, 0.6204,
        0.6142, 0.6126, 0.6169, 0.6027, 0.6152, 1.1413, 1.0955, 0.6049, 0.6148,
        0.6212], device='cuda:4', grad_fn=<NormBackward1>)
g_aux tensor([1.1889, 1.4246, 1.2825, 1.3997, 1.3975, 1.2587, 1.2697, 1.2635, 1.2896,
        1.2713, 1.2094, 1.1009, 1.3197, 1.2483, 1.0934, 1.0434, 1.0718, 1.2562,
        1.0423, 0.9213, 1.1477, 1.0997, 0.8891, 1.2525, 1.0231, 0.9651, 0.8771,
        0.8943, 0.8591, 0.8888, 1.1983, 0.8823, 0.7741, 0.8574, 0.7810, 0.7706,
        0.7473, 0.7627, 0.7435, 0.8239, 0.7196, 0.8410, 0.7044, 0.7679, 0.7267,
        0.7030, 0.6916, 0.7797, 0.7244, 0.9464, 0.6458, 0.7147, 0.8096, 0.7372,
        0.6877, 0.6569, 0.6892, 0.6474, 0.7163, 0.7211, 0.8856, 0.6787, 0.6989,
        0.6459, 0.6450, 0.6366, 0.6410, 0.7012, 0.6765, 0.6409, 0.6746, 0.7608,
        0.6028, 0.6962, 0.6490, 0.6698, 0.6908, 0.6024, 0.6212, 0.6496, 0.6037,
        0.5898, 0.6570, 0.6365, 0.6236, 0.6546, 0.6474, 0.6132, 0.6009, 0.6295,
        0.6198, 0.6016, 0.6054, 0.6528, 0.5995, 0.7065, 0.6407, 0.6023, 0.6186,
        0.6173], device='cuda:4', grad_fn=<NormBackward1>)
3shot of client 0:head:0.25925925925925924, middle:0.19148936170212766, tail0.125
3shot of client 1:head:0.3727810650887574, middle:0.15625, tail0.06060606060606061
3shot of client 2:head:0.37919463087248323, middle:0.06578947368421052, tail0.0
3shot of client 3:head:0.3887733887733888, middle:0.30952380952380953, tail0.0
3shot of client 4:head:0.39139344262295084, middle:0.1391304347826087, tail0.034482758620689655
3shot of client 5:head:0.3659491193737769, middle:0.088, tail0.125
3shot of client 6:head:0.35714285714285715, middle:0.22666666666666666, tail0.0
3shot of client 7:head:0.3020833333333333, middle:0.13043478260869565, tail0.0
3shot of client 8:head:0.3712984054669704, middle:0.05982905982905983, tail0.038461538461538464
3shot of client 9:head:0.19123505976095617, middle:0.1323529411764706, tail0.06666666666666667
3shot of client 10:head:0.3575418994413408, middle:0.03488372093023256, tail0.0
3shot of client 11:head:0.5242165242165242, middle:0.022727272727272728, tail0.0
3shot of client 12:head:0.4827586206896552, middle:0.08333333333333333, tail0.047619047619047616
3shot of client 13:head:0.4722222222222222, middle:0.10588235294117647, tail0.1
3shot of client 14:head:0.3477088948787062, middle:0.09473684210526316, tail0.041666666666666664
3shot of client 15:head:0.31746031746031744, middle:0.16129032258064516, tail0.0625
3shot of client 16:head:0.3141891891891892, middle:0.08823529411764706, tail0.0
3shot of client 17:head:0.35494880546075086, middle:0.18055555555555555, tail0.0
3shot of client 18:head:0.5698529411764706, middle:0.1, tail0.0
3shot of client 19:head:0.4175084175084175, middle:0.15, tail0.11764705882352941
round 14, local average test acc  0.3131 

round 14, local macro average F1 score  0.1146 

round 14, local weighted average F1 score  0.2703 

round 14, global test acc  0.0854 

round 14, average 3shot acc: [head: 0.3769, middle: 0.1261, tail: 0.0410] 

round 14, global 3shot acc: [head: 0.2874, middle: 0.0296, tail: 0.0002] 

l_head   3%|▎         | 15/500 [48:50<26:09:41, 194.19s/it]
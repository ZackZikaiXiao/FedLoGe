nohup: ignoring input
./temp/fl_acc_cifar100_resnet34_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N20_100_seed3407_p1_dirichlet0.5_IF0.01_LossCE.txt
Files already downloaded and verified
[500, 477, 455, 434, 415, 396, 378, 361, 344, 328, 314, 299, 286, 273, 260, 248, 237, 226, 216, 206, 197, 188, 179, 171, 163, 156, 149, 142, 135, 129, 123, 118, 112, 107, 102, 98, 93, 89, 85, 81, 77, 74, 70, 67, 64, 61, 58, 56, 53, 51, 48, 46, 44, 42, 40, 38, 36, 35, 33, 32, 30, 29, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 15, 14, 13, 13, 12, 12, 11, 11, 10, 10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5]
10847
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[573, 766, 469, 733, 726, 766, 466, 320, 676, 410, 554, 546, 535, 512, 586, 396, 460, 448, 431, 474]
training set distribution:
[[  8   5  18   0  32  55  32   1  64   2   4  41   7   3  47  19   2   3
    0   6   0   3   5  14   6   4   9  50   0  11   3   0   2   0  38  12
   11   1  19   0   1   0   0   0   1  10   0   0   3   0   0   0   0   0
    1   0   2   2   0   0   1   0   2   0   2   4   0   0   0   0   0   0
    0   0   1   0   0   1   0   0   0   0   2   0   0   0   1   0   0   0
    0   0   0   0   0   1   1   0   0   0]
 [ 99   7  26  25  22   2  54  80   2  28  22  33   7  19 105   0   1   3
    4  13   2  26   9   3   0   4   4   4  37   0  18   1   2   6   5  16
    4   0  15  13   1   0   0   0   3   2   0   0   0   0   2   2   3   9
    1   0   2   0   2   1   0   0   3   0   0   0   0   0   0   7   0   0
    0   0   0   0   0   0   0   0   0   0   0   1   0   2   1   0   0   0
    0   2   0   1   0   0   0   0   0   0]
 [ 14  60   9  13   3  40   0   8   0   6  24  11  75  13  14   6  11   2
    2   7   0   0   0   0   0  10   0   4   0   3   7  10  11   3   5   0
    8   6   1   0   1   8   1   1   5   0   5   2   4   8   0   1   3   0
    2   1   1   1   3   3   2   2   0   0   0   0   0   0   0   0   2   0
    0   1   4   0   6   1   0   0   4   0   3   0   3   0   1   0   1   2
    0   0   0   0   0   0   0   1   0   0]
 [ 23  89  56   2  47   1   7   8  48  33   0  49   1  29   5  32   2  17
   76   5  13  10   0  12   0   0   2   0   9  19  16   2   0  18   2   0
    6   0   0   2   2   1  26   5  10   2   0   1   0   0   4   1   0   1
    1   0   0   0   0   1   3   0   0   8   3   2   0   1   3   0   1   0
    0   4   0   0   0   0   0   0   0   0   0   1   0   1   0   1   3   0
    3   0   1   0   2   0   0   0   0   0]
 [  9  95  66   3  48   7  41  15  36  24  65   1   2   1   0   2   4   8
    0   6  29   0   2  53   7   2  24  19  10  14   0   3   0  25   2   5
    0  30   3   0   4   0   4   7   7   4   0   0   8   4   3   1   0   0
    2   0   0   4   0   0   0   0   1   0   4   0   0   0   0   0   1   3
    1   0   0   1   0   0   2   1   0   0   1   0   0   0   1   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 22  45  14  67   2   2  54  10  18  22  47  12  10  71  16   1  52   4
    7   1  31  36  16   8  25  30   7   0   8   0   3   0   6   6   6  27
    0   0   0   0   4   0   0   0   2   5   4   5   9   1   5   3   3   0
    1   0   6  14   1   1   0   0   1   0   1   3   0   0   0   0   0   4
    1   2   0   0   0   1   0   1   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [  5   0   1  11  50   1  31  30  22  10   1   1   8   4   2   0   2   6
   31   0  15  46   1   7   9   1  18   0   0  10   5   0   7   2  24   2
    6   2   5  18   4   3   3   0   0   0   2   4   3   8   0   3   1   1
    0   2   4   3   0   0   0   6   0   2   0   2   0   2   0   2   3   0
    0   0   0   0   0   2   1   3   0   0   0   0   0   0   1   0   3   0
    0   0   0   2   0   0   1   0   0   1]
 [  0  19   5  26  11  14   5  14   2  11   1  12  20   2   7   6   0   0
    3   0  21   0   3   0   1   1  14   0   2  12   1   9   3   0   4   6
    1   1   5   0   2  10   1   4   1   2   6   0   2   2   1   4   3   1
    0  16   3   0   0   0   1   0   1   1   0   1   0   3   2   0   1   0
    0   1   1   2   0   1   1   2   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [ 44  21  72  58  46  20   1   1  52   0  37  46  14   5  10  11  17   8
    1   1   1   1   8  16  15  40   0   0   0  12   1  10   1   0   0   3
    9   0   5   3   6   5   6   2   7   0   0   5   0   0   2   1   0   0
    7  11   3   0   1   1   2   0   0   0   3   0   4   0   0   1   5   0
    1   0   0   0   0   0   1   0   2   1   0   0   0   0   2   2   0   1
    0   1   0   0   0   0   1   0   0   2]
 [  0  16   3   2  33  70   1  22   1   5  45   9   5   6   3   7   0  14
    7   5   8   5   2   0   1   4   2   5   0   0   1  12   1   7   0   2
    1   2  15  18   0   2   0   0   7  10   3   0   1   2   2   0   5   0
    1   0   7   0   2   0   0   1   0   0   0   0   1   0   0   0   3   1
    0   3   0   3   1   0   0   0   0   0   3   0   2   2   0   2   0   1
    0   1   0   1   0   1   0   0   0   2]
 [  0   0   0  28  16   3  89  14  43   6   9   7   0  12   0   2  62   0
    8  74   2   2   0  26   2   1   8   2   6   0   1   0   2   2   1   2
    5   1   1   0   8   2   0   1   4   7   0  18   0   2   1   0   0  13
    4   0   4   1   0   3   3   0   0   3   3   0   8   0   2   1   0   0
    9   1   2   3   0   1   4   0   1   0   0   1   0   2   0   0   0   0
    0   0   1   0   1   1   0   0   2   0]
 [ 90   0  30  51   5   0   4   3   1   5   1   1   8  11  23  84   0  23
    4   6   0   2   9   0   0   3   0   7   7  17   5   2  21   5   0   3
    0   2   0   2   0   0   0  10   0   1  13   3   0   7   1   2   3   1
    5   0   0   0   6   3   1   1   3   0   5  11   0  12   0   1   0   4
    1   0   4   0   0   0   0   0   1   0   0   3   0   0   0   1   0   1
    2   0   0   0   0   1   1   1   2   0]
 [  9  41   0  22   1  13   6   1   0  53  13   6  47  19   4   2   2  13
   10  15   3   0   0   0  67   8   7   2  37   0  35   0   0  11   0   4
    4   1   2   0   0   8   3   4   2   0   0   0   3   0   5   3   2   8
    5   1   0   5   1   0   1   0   3   0   2   0   0   0   7   0   0   2
    0   0   0   1   3   0   1   0   2   0   1   0   1   0   0   0   0   0
    0   1   0   0   1   0   1   0   0   0]
 [ 14  17   3  80   2  97  18   3   0  17   3   1  13  20   0   1   3   6
    0   0   1  24  40   6   2   1   2   8   0   7   5   1   0   2   1   0
    1   0   5   1  12   4   0  19   6   4   1   5   0   8   0   6   6   0
    2   3   0   0   1   5   0   1   1   6   0   0   0   0   0   1   1   2
    0   0   0   1   3   0   0   2   0   3   0   2   1   0   0   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 30  43   0  19   2   1  17 114   1  68   2   0   6   2   4   9   7  28
    0  11   2   0   7   2  11  12   5  14   9  12   3   2  10   7   0   2
    8   2   0   6  14   4   1   0   0   0  13   1   4   0   8   5   4   0
    6   0   0   4   0   0   2   7   7   2   0   1   2   0   2   3   0   2
    1   0   0   1   0   1   0   2   1   1   0   0   2   2   2   0   0   1
    0   0   0   0   0   1   0   0   1   0]
 [  3   5  43   6  25   7   1  18   0   8   2   2   7   0   0   1   0   0
   37  11   7   0   6   1   3   0  19   0   0   8   0  35  25   0   1  10
    4   0   1  11   6   0   0   4   4   8   5   0  11   9   2   3   0   2
    0   1   1   0   2   2   8   0   4   1   0   0   0   3   1   1   1   0
    0   2   1   2   0   1   0   0   0   3   0   0   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   0   0]
 [ 19   2  21  13   2   0   8  10   1   3  15  15   4  12  17  10  27  40
    1   2   6   1  62  18   2  11  21   7   6   1   0   1   1   1   2   4
   24  15   1   0   2   0   4   1   0   0   2  10   0   0   1   3   4   5
    0   3   0   0   0   0   0   3   0   0   1   0   2   0   0   0   0   0
    0   0   1   0   1   2   3   1   0   0   0   1   1   0   0   0   0   0
    0   1   0   0   2   0   0   0   0   0]
 [  7   5   3   5  21  54   9   0  10   9  20  45  36  35   3  12  23   8
    1   7   0  24   0   4   6  20   6  10   1   0   0   2   0   0   5   0
    0  22   0   6   1   0   0   1   0   0   4   0   3   0   1   0   1   0
    0   0   0   1   0   0   0   6   0   0   1   0   0   0   0   0   0   0
    1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   1
    1   1   1   1   0   0   0   1   0   0]
 [ 87   7  18   0  21   1   0   8   3   2   0   1   6   7   0  10   3  41
    4  35   2   7   7   0   1   2   0  10   3   1  17   2  20   0   0   0
    1   3   0   0   5  20  20   1   5   2   0   2   0   0   9   3   1   1
    2   0   1   0   1  11   1   1   0   3   0   0   3   1   0   3   1   0
    0   1   1   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   1   0   0   0   0]
 [ 17   0  67   3  26   8   0   1  40  16   3   6  10   2   0  33  19   2
   20   1  54   1   2   1   5   2   1   0   0   2   2  26   0  12   6   0
    0   1   7   1   4   7   1   7   0   4   0   0   2   0   1   5   5   0
    0   0   2   0  13   1   5   1   1   0   0   0   3   0   4   0   0   0
    2   0   0   1   0   1   0   0   0   3   0   1   0   0   0   1   0   0
    0   0   1   1   0   0   0   0   0   0]]
Total size of training set
10847
local test distribution:
[[  7   4  16   0  29  50  29   0  59   1   3  37   6   2  43  17   1   2
    0   5   0   2   4  12   5   3   8  46   0  10   2   0   1   0  35  11
   10   0  17   0   0   0   0   0   0   9   0   0   2   0   0   0   0   0
    0   0   1   1   0   0   0   0   1   0   1   3   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 91   6  23  23  20   1  49  73   1  25  20  30   6  17  96   0   0   2
    3  11   1  23   8   2   0   3   3   3  34   0  16   0   1   5   4  14
    3   0  13  11   0   0   0   0   2   1   0   0   0   0   1   1   2   8
    0   0   1   0   1   0   0   0   2   0   0   0   0   0   0   6   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0
    0   1   0   0   0   0   0   0   0   0]
 [ 12  55   8  11   2  36   0   7   0   5  22  10  69  11  12   5  10   1
    1   6   0   0   0   0   0   9   0   3   0   2   6   9  10   2   4   0
    7   5   0   0   0   7   0   0   4   0   4   1   3   7   0   0   2   0
    1   0   0   0   2   2   1   1   0   0   0   0   0   0   0   0   1   0
    0   0   3   0   5   0   0   0   3   0   2   0   2   0   0   0   0   1
    0   0   0   0   0   0   0   0   0   0]
 [ 21  82  51   1  43   0   6   7  44  30   0  45   0  26   4  29   1  15
   70   4  11   9   0  11   0   0   1   0   8  17  14   1   0  16   1   0
    5   0   0   1   1   0  23   4   9   1   0   0   0   0   3   0   0   0
    0   0   0   0   0   0   2   0   0   7   2   1   0   0   2   0   0   0
    0   3   0   0   0   0   0   0   0   0   0   0   0   0   0   0   2   0
    2   0   0   0   1   0   0   0   0   0]
 [  8  87  60   2  44   6  37  13  33  22  59   0   1   0   0   1   3   7
    0   5  26   0   1  48   6   1  22  17   9  12   0   2   0  23   1   4
    0  27   2   0   3   0   3   6   6   3   0   0   7   3   2   0   0   0
    1   0   0   3   0   0   0   0   0   0   3   0   0   0   0   0   0   2
    0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 20  41  12  61   1   1  49   9  16  20  43  11   9  65  14   0  47   3
    6   0  28  33  14   7  23  27   6   0   7   0   2   0   5   5   5  24
    0   0   0   0   3   0   0   0   1   4   3   4   8   0   4   2   2   0
    0   0   5  12   0   0   0   0   0   0   0   2   0   0   0   0   0   3
    0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  4   0   0  10  46   0  28  27  20   9   0   0   7   3   1   0   1   5
   28   0  13  42   0   6   8   0  16   0   0   9   4   0   6   1  22   1
    5   1   4  16   3   2   2   0   0   0   1   3   2   7   0   2   0   0
    0   1   3   2   0   0   0   5   0   1   0   1   0   1   0   1   2   0
    0   0   0   0   0   1   0   2   0   0   0   0   0   0   0   0   2   0
    0   0   0   1   0   0   0   0   0   0]
 [  0  17   4  23  10  12   4  12   1  10   0  11  18   1   6   5   0   0
    2   0  19   0   2   0   0   0  12   0   1  11   0   8   2   0   3   5
    0   0   4   0   1   9   0   3   0   1   5   0   1   1   0   3   2   0
    0  14   2   0   0   0   0   0   0   0   0   0   0   2   1   0   0   0
    0   0   0   1   0   0   0   1   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 40  19  66  53  42  18   0   0  47   0  34  42  12   4   9  10  15   7
    0   0   0   0   7  14  13  36   0   0   0  11   0   9   0   0   0   2
    8   0   4   2   5   4   5   1   6   0   0   4   0   0   1   0   0   0
    6  10   2   0   0   0   1   0   0   0   2   0   3   0   0   0   4   0
    0   0   0   0   0   0   0   0   1   0   0   0   0   0   1   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0  14   2   1  30  64   0  20   0   4  41   8   4   5   2   6   0  12
    6   4   7   4   1   0   0   3   1   4   0   0   0  11   0   6   0   1
    0   1  13  16   0   1   0   0   6   9   2   0   0   1   1   0   4   0
    0   0   6   0   1   0   0   0   0   0   0   0   0   0   0   0   2   0
    0   2   0   2   0   0   0   0   0   0   2   0   1   1   0   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0   0   0  25  14   2  82  12  39   5   8   6   0  11   0   1  57   0
    7  68   1   1   0  23   1   0   7   1   5   0   0   0   1   1   0   1
    4   0   0   0   7   1   0   0   3   6   0  16   0   1   0   0   0  11
    3   0   3   0   0   2   2   0   0   2   2   0   7   0   1   0   0   0
    8   0   1   2   0   0   3   0   0   0   0   0   0   1   0   0   0   0
    0   0   0   0   0   0   0   0   1   0]
 [ 82   0  27  47   4   0   3   2   0   4   0   0   7  10  21  77   0  21
    3   5   0   1   8   0   0   2   0   6   6  15   4   1  19   4   0   2
    0   1   0   1   0   0   0   9   0   0  11   2   0   6   0   1   2   0
    4   0   0   0   5   2   0   0   2   0   4  10   0  11   0   0   0   3
    0   0   3   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   1   0]
 [  8  37   0  20   0  11   5   0   0  48  11   5  43  17   3   1   1  11
    9  13   2   0   0   0  61   7   6   1  34   0  32   0   0  10   0   3
    3   0   1   0   0   7   2   3   1   0   0   0   2   0   4   2   1   7
    4   0   0   4   0   0   0   0   2   0   1   0   0   0   6   0   0   1
    0   0   0   0   2   0   0   0   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 12  15   2  73   1  89  16   2   0  15   2   0  11  18   0   0   2   5
    0   0   0  22  36   5   1   0   1   7   0   6   4   0   0   1   0   0
    0   0   4   0  11   3   0  17   5   3   0   4   0   7   0   5   5   0
    1   2   0   0   0   4   0   0   0   5   0   0   0   0   0   0   0   1
    0   0   0   0   2   0   0   1   0   2   0   1   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 27  39   0  17   1   0  15 105   0  62   1   0   5   1   3   8   6  25
    0  10   1   0   6   1  10  11   4  12   8  11   2   1   9   6   0   1
    7   1   0   5  12   3   0   0   0   0  11   0   3   0   7   4   3   0
    5   0   0   3   0   0   1   6   6   1   0   0   1   0   1   2   0   1
    0   0   0   0   0   0   0   1   0   0   0   0   1   1   1   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  2   4  39   5  23   6   0  16   0   7   1   1   6   0   0   0   0   0
   34  10   6   0   5   0   2   0  17   0   0   7   0  32  23   0   0   9
    3   0   0  10   5   0   0   3   3   7   4   0  10   8   1   2   0   1
    0   0   0   0   1   1   7   0   3   0   0   0   0   2   0   0   0   0
    0   1   0   1   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 17   1  19  11   1   0   7   9   0   2  13  13   3  11  15   9  24  36
    0   1   5   0  57  16   1  10  19   6   5   0   0   0   0   0   1   3
   22  13   0   0   1   0   3   0   0   0   1   9   0   0   0   2   3   4
    0   2   0   0   0   0   0   2   0   0   0   0   1   0   0   0   0   0
    0   0   0   0   0   1   2   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   1   0   0   0   0   0]
 [  6   4   2   4  19  49   8   0   9   8  18  41  33  32   2  11  21   7
    0   6   0  22   0   3   5  18   5   9   0   0   0   1   0   0   4   0
    0  20   0   5   0   0   0   0   0   0   3   0   2   0   0   0   0   0
    0   0   0   0   0   0   0   5   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 80   6  16   0  19   0   0   7   2   1   0   0   5   6   0   9   2  37
    3  32   1   6   6   0   0   1   0   9   2   0  15   1  18   0   0   0
    0   2   0   0   4  18  18   0   4   1   0   1   0   0   8   2   0   0
    1   0   0   0   0  10   0   0   0   2   0   0   2   0   0   2   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 15   0  61   2  23   7   0   0  36  14   2   5   9   1   0  30  17   1
   18   0  49   0   1   0   4   1   0   0   0   1   1  23   0  11   5   0
    0   0   6   0   3   6   0   6   0   3   0   0   1   0   0   4   4   0
    0   0   1   0  11   0   4   0   0   0   0   0   2   0   3   0   0   0
    1   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]]
Total size of testing set
9199
[452 431 408 389 372 352 338 321 307 292 278 265 254 241 231 219 208 197
 190 180 170 165 156 148 140 132 128 124 119 112 102  99  95  91  85  81
  77  71  68  67  59  61  56  52  50  48  45  44  41  41  32  30  30  31
  26  29  24  25  21  21  18  19  16  18  15  17  16  16  14  11   9  11
   9   7   7   6   9   2   6   5   5   6   5   3   4   4   2   2   4   1
   3   1   0   1   2   0   0   0   2   2]
20

  0%|          | 0/500 [00:00<?, ?it/s]
  0%|          | 1/500 [03:35<29:49:31, 215.17s/it]3shot of client 0:head:0.11375661375661375, middle:0.0, tail0.0
3shot of client 1:head:0.1893491124260355, middle:0.0, tail0.0
3shot of client 2:head:0.03691275167785235, middle:0.0, tail0.0
3shot of client 3:head:0.060291060291060294, middle:0.0, tail0.0
3shot of client 4:head:0.05327868852459016, middle:0.0, tail0.0
3shot of client 5:head:0.12720156555772993, middle:0.0, tail0.0
3shot of client 6:head:0.07482993197278912, middle:0.0, tail0.0
3shot of client 7:head:0.11979166666666667, middle:0.0, tail0.0
3shot of client 8:head:0.1070615034168565, middle:0.0, tail0.0
3shot of client 9:head:0.0796812749003984, middle:0.0, tail0.0
3shot of client 10:head:0.03910614525139665, middle:0.0, tail0.0
3shot of client 11:head:0.1339031339031339, middle:0.0, tail0.0
3shot of client 12:head:0.10632183908045977, middle:0.0, tail0.0
3shot of client 13:head:0.22530864197530864, middle:0.0, tail0.0
3shot of client 14:head:0.2695417789757412, middle:0.0, tail0.0
3shot of client 15:head:0.12698412698412698, middle:0.0, tail0.0
3shot of client 16:head:0.05067567567567568, middle:0.0, tail0.0
3shot of client 17:head:0.11604095563139932, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.08571428571428572, tail0.0
3shot of client 19:head:0.0, middle:0.1375, tail0.0
round 0, local average test acc  0.0795 

round 0, local macro average F1 score  0.0036 

round 0, local weighted average F1 score  0.0161 

round 0, global test acc  0.0100 

round 0, average 3shot acc: [head: 0.1015, middle: 0.0112, tail: 0.0000] 

round 0, global 3shot acc: [head: 0.0370, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.8880, 0.7086, 0.8274, 0.5936, 0.9163, 1.5540, 0.9402, 0.6588, 1.4485,
        0.6773, 0.6580, 1.3444, 0.8940, 0.6393, 1.3822, 0.9836, 0.6151, 0.7986,
        0.5694, 0.7387, 0.5825, 0.6737, 0.7230, 0.9216, 0.9029, 0.6895, 0.9351,
        1.3312, 0.5764, 0.8843, 0.6742, 0.5866, 0.6633, 0.5829, 1.1401, 0.8605,
        0.8469, 0.6731, 0.7966, 0.5665, 0.6921, 0.5801, 0.6050, 0.5724, 0.6216,
        0.7848, 0.5509, 0.5702, 0.6184, 0.5796, 0.5670, 0.5634, 0.5667, 0.5893,
        0.5886, 0.5884, 0.6573, 0.6183, 0.5915, 0.5790, 0.7034, 0.5711, 0.6607,
        0.5873, 0.6533, 0.6511, 0.5869, 0.5837, 0.5924, 0.5840, 0.5804, 0.5930,
        0.5821, 0.5857, 0.6197, 0.5865, 0.5705, 0.5728, 0.5758, 0.5885, 0.5720,
        0.5612, 0.7131, 0.5586, 0.5818, 0.5802, 0.6380, 0.5969, 0.5655, 0.5787,
        0.5951, 0.5704, 0.5840, 0.6003, 0.5529, 0.6242, 0.6748, 0.5670, 0.5972,
        0.5850], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([0.9483, 0.8139, 0.8474, 0.7344, 0.6921, 0.9005, 0.8504, 0.9161, 0.8572,
        0.7653, 0.8785, 0.7971, 0.7216, 0.7236, 0.9732, 0.7588, 0.9052, 0.6435,
        0.7690, 0.7812, 0.8570, 0.7236, 0.8992, 0.7416, 0.9321, 0.7101, 0.7028,
        0.7126, 0.7827, 0.6093, 0.6914, 0.6717, 0.6595, 0.6266, 0.7925, 0.6734,
        0.6342, 0.6918, 0.6160, 0.6733, 0.5947, 0.6452, 0.6671, 0.6025, 0.5970,
        0.6180, 0.6303, 0.6720, 0.6234, 0.6316, 0.5721, 0.5822, 0.5944, 0.6909,
        0.5868, 0.6443, 0.5791, 0.6478, 0.6603, 0.5826, 0.5909, 0.5875, 0.6069,
        0.5807, 0.5890, 0.6240, 0.6207, 0.6354, 0.6231, 0.5795, 0.6168, 0.5974,
        0.6279, 0.6064, 0.5958, 0.5564, 0.6589, 0.5770, 0.6077, 0.6040, 0.5888,
        0.5776, 0.5954, 0.6049, 0.6370, 0.5980, 0.5720, 0.5865, 0.6119, 0.5810,
        0.6084, 0.5695, 0.5759, 0.5793, 0.5853, 0.5894, 0.5821, 0.5679, 0.5980,
        0.5932], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.12433862433862433, middle:0.0, tail0.0
3shot of client 1:head:0.14398422090729784, middle:0.0, tail0.0
3shot of client 2:head:0.040268456375838924, middle:0.0, tail0.0
3shot of client 3:head:0.060291060291060294, middle:0.0, tail0.0
3shot of client 4:head:0.055327868852459015, middle:0.0, tail0.0
3shot of client 5:head:0.003913894324853229, middle:0.04, tail0.0
3shot of client 6:head:0.034013605442176874, middle:0.0, tail0.0
3shot of client 7:head:0.046875, middle:0.0, tail0.0
3shot of client 8:head:0.12072892938496584, middle:0.0, tail0.0
3shot of client 9:head:0.027888446215139442, middle:0.058823529411764705, tail0.0
3shot of client 10:head:0.19273743016759776, middle:0.0, tail0.0
3shot of client 11:head:0.05982905982905983, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.03571428571428571, tail0.0
3shot of client 13:head:0.22530864197530864, middle:0.0, tail0.0
3shot of client 14:head:0.04582210242587601, middle:0.0, tail0.0
3shot of client 15:head:0.09126984126984126, middle:0.0, tail0.0
3shot of client 16:head:0.125, middle:0.0, tail0.0
3shot of client 17:head:0.06825938566552901, middle:0.0, tail0.0
3shot of client 18:head:0.0, middle:0.12857142857142856, tail0.0
3shot of client 19:head:0.2053872053872054, middle:0.0, tail0.0
round 1, local average test acc  0.0661 

round 1, local macro average F1 score  0.0035 

round 1, local weighted average F1 score  0.0148 

round 1, global test acc  0.0102 

round 1, average 3shot acc: [head: 0.0836, middle: 0.0132, tail: 0.0000] 

round 1, global 3shot acc: [head: 0.0007, middle: 0.0385, tail: 0.0000] 

l_head tensor([1.0766, 0.8031, 1.0965, 0.5941, 1.4420, 2.2448, 1.6022, 0.6538, 2.2294,
        0.7431, 0.7479, 1.8732, 0.9549, 0.6718, 2.0777, 1.3271, 0.6898, 0.8190,
        0.5701, 0.8632, 0.5830, 0.7407, 0.9385, 1.0954, 1.1142, 0.7904, 1.0650,
        1.7293, 0.5770, 1.0206, 0.7948, 0.5873, 0.6850, 0.5835, 1.8019, 1.0042,
        1.0056, 0.7227, 1.1362, 0.5671, 0.7515, 0.5807, 0.6056, 0.5730, 0.6659,
        0.9567, 0.5516, 0.5709, 0.7303, 0.5802, 0.5677, 0.5640, 0.5673, 0.5899,
        0.6519, 0.5890, 0.7666, 0.6690, 0.5921, 0.5796, 0.6929, 0.5717, 0.9096,
        0.5879, 0.6411, 0.8619, 0.5875, 0.5843, 0.5930, 0.5846, 0.5811, 0.5936,
        0.5827, 0.5863, 0.6481, 0.5872, 0.5711, 0.6142, 0.5765, 0.5889, 0.5726,
        0.5618, 0.7899, 0.5593, 0.5824, 0.5808, 0.6536, 0.5975, 0.5661, 0.5793,
        0.5957, 0.5710, 0.5846, 0.6009, 0.5536, 0.6441, 0.6554, 0.5676, 0.5978,
        0.5856], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux 
  0%|          | 2/500 [07:10<29:47:44, 215.39s/it]
  1%|          | 3/500 [10:45<29:41:25, 215.06s/it]tensor([1.3454, 1.2156, 1.1899, 1.0289, 0.9756, 1.2307, 1.2353, 1.3313, 1.2518,
        1.1751, 1.2934, 1.1663, 0.9120, 0.9823, 1.3653, 1.1101, 1.2937, 0.8331,
        1.0919, 1.0499, 1.1773, 0.9040, 1.2035, 1.0332, 1.2638, 0.9774, 0.8991,
        0.9747, 1.0754, 0.7785, 0.8496, 0.8123, 0.8935, 0.7287, 1.0808, 0.7847,
        0.7310, 0.8561, 0.7024, 0.8135, 0.6728, 0.7368, 0.8318, 0.7086, 0.6329,
        0.7119, 0.7150, 0.7727, 0.6776, 0.7208, 0.6006, 0.6173, 0.6283, 0.8854,
        0.6160, 0.7684, 0.6021, 0.8309, 0.7647, 0.6459, 0.6666, 0.6468, 0.6781,
        0.6410, 0.6020, 0.6206, 0.6427, 0.7209, 0.6593, 0.6777, 0.6496, 0.6481,
        0.7313, 0.6229, 0.6208, 0.5687, 0.7188, 0.5870, 0.6211, 0.6162, 0.6204,
        0.6074, 0.6665, 0.6248, 0.6446, 0.6291, 0.5912, 0.6104, 0.6492, 0.5742,
        0.6115, 0.5856, 0.5840, 0.6058, 0.6224, 0.5906, 0.5978, 0.5897, 0.6241,
        0.6252], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.1402116402116402, middle:0.0, tail0.0
3shot of client 1:head:0.1854043392504931, middle:0.0, tail0.0
3shot of client 2:head:0.053691275167785234, middle:0.0, tail0.0
3shot of client 3:head:0.15592515592515593, middle:0.0, tail0.0
3shot of client 4:head:0.06967213114754098, middle:0.0, tail0.0
3shot of client 5:head:0.06457925636007827, middle:0.0, tail0.0
3shot of client 6:head:0.1598639455782313, middle:0.0, tail0.0
3shot of client 7:head:0.0625, middle:0.0, tail0.0
3shot of client 8:head:0.05466970387243736, middle:0.0, tail0.0
3shot of client 9:head:0.01195219123505976, middle:0.029411764705882353, tail0.0
3shot of client 10:head:0.13966480446927373, middle:0.0, tail0.0
3shot of client 11:head:0.23646723646723647, middle:0.0, tail0.0
3shot of client 12:head:0.040229885057471264, middle:0.0, tail0.0
3shot of client 13:head:0.29012345679012347, middle:0.011764705882352941, tail0.0
3shot of client 14:head:0.013477088948787063, middle:0.07368421052631578, tail0.0
3shot of client 15:head:0.10317460317460317, middle:0.016129032258064516, tail0.0
3shot of client 16:head:0.08108108108108109, middle:0.0, tail0.0
3shot of client 17:head:0.017064846416382253, middle:0.0, tail0.11764705882352941
3shot of client 18:head:0.3639705882352941, middle:0.0, tail0.0
3shot of client 19:head:0.03367003367003367, middle:0.0625, tail0.0
round 2, local average test acc  0.0888 

round 2, local macro average F1 score  0.0096 

round 2, local weighted average F1 score  0.0445 

round 2, global test acc  0.0111 

round 2, average 3shot acc: [head: 0.1139, middle: 0.0097, tail: 0.0059] 

round 2, global 3shot acc: [head: 0.0411, middle: 0.0000, tail: 0.0000] 

l_head tensor([1.3398, 0.9732, 1.3907, 0.5942, 1.8366, 2.7101, 2.0332, 0.6694, 2.9161,
        0.8659, 0.9315, 2.4905, 1.0402, 0.8010, 2.6494, 1.7396, 0.7254, 0.8472,
        0.5702, 1.0055, 0.5832, 0.7846, 1.0387, 1.3341, 1.4026, 0.8800, 1.3121,
        2.3710, 0.5771, 1.2970, 0.9480, 0.5874, 0.7565, 0.5836, 2.3858, 1.1465,
        1.3224, 0.8096, 1.4946, 0.5673, 0.8571, 0.5808, 0.6058, 0.5731, 0.6649,
        1.2413, 0.5518, 0.5710, 0.8546, 0.5804, 0.5678, 0.5641, 0.5675, 0.5901,
        0.7029, 0.5891, 0.8135, 0.8120, 0.5922, 0.5798, 0.7127, 0.5718, 1.0069,
        0.5880, 0.7012, 0.8965, 0.5876, 0.5845, 0.5932, 0.5847, 0.5812, 0.5937,
        0.5828, 0.5865, 0.6762, 0.5873, 0.5712, 0.6879, 0.5766, 0.5890, 0.5728,
        0.5620, 0.8476, 0.5594, 0.5826, 0.5810, 0.6860, 0.5976, 0.5662, 0.5795,
        0.5958, 0.5711, 0.5847, 0.6011, 0.5537, 0.6152, 0.7121, 0.5678, 0.5980,
        0.5858], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([1.6958, 1.7352, 1.5633, 1.3752, 1.3056, 1.6069, 1.6462, 1.7695, 1.6977,
        1.5819, 1.7608, 1.5313, 1.2223, 1.2440, 1.8745, 1.5351, 1.6819, 1.0197,
        1.5001, 1.3263, 1.4988, 1.1412, 1.6039, 1.3999, 1.7476, 1.2401, 1.1633,
        1.2213, 1.4142, 0.9691, 1.1040, 1.0933, 1.0842, 0.9567, 1.3632, 0.9814,
        0.9460, 1.1078, 0.9321, 1.0278, 0.7809, 0.8924, 1.0775, 0.8904, 0.7275,
        0.8267, 0.8352, 0.9427, 0.7856, 0.9099, 0.7239, 0.6386, 0.6688, 1.0566,
        0.6895, 0.9246, 0.6539, 0.9988, 0.8939, 0.7171, 0.7909, 0.7126, 0.8121,
        0.7010, 0.6585, 0.6843, 0.6992, 0.8993, 0.7471, 0.6738, 0.7455, 0.7282,
        0.8457, 0.6482, 0.6396, 0.5904, 0.7811, 0.6143, 0.6492, 0.6623, 0.6851,
        0.6238, 0.7202, 0.6697, 0.6603, 0.6252, 0.6179, 0.6419, 0.6727, 0.6554,
        0.7019, 0.6132, 0.6250, 0.6095, 0.6338, 0.6128, 0.6402, 0.6113, 0.7274,
        0.6534], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.20105820105820105, middle:0.0, tail0.0
3shot of client 1:head:0.22090729783037474, middle:0.0, tail0.030303030303030304
3shot of client 2:head:0.27181208053691275, middle:0.0, tail0.0
3shot of client 3:head:0.1704781704781705, middle:0.0, tail0.0
3shot of client 4:head:0.14549180327868852, middle:0.017391304347826087, tail0.0
3shot of client 5:head:0.11154598825831702, middle:0.024, tail0.0
3shot of client 6:head:0.07482993197278912, middle:0.0, tail0.0
3shot of client 7:head:0.125, middle:0.0, tail0.0
3shot of client 8:head:0.08200455580865604, middle:0.07692307692307693, tail0.0
3shot of client 9:head:0.2788844621513944, middle:0.0, tail0.0
3shot of client 10:head:0.276536312849162, middle:0.0, tail0.0
3shot of client 11:head:0.15669515669515668, middle:0.0, tail0.0
3shot of client 12:head:0.15804597701149425, middle:0.011904761904761904, tail0.0
3shot of client 13:head:0.3333333333333333, middle:0.0, tail0.0
3shot of client 14:head:0.2749326145552561, middle:0.0, tail0.0
3shot of client 15:head:0.1388888888888889, middle:0.016129032258064516, tail0.0
3shot of client 16:head:0.19594594594594594, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.20477815699658702, middle:0.0, tail0.0
3shot of client 18:head:0.3272058823529412, middle:0.0, tail0.0
3shot of client 19:head:0.16835016835016836, middle:0.0375, tail0.0
round 3, local average test acc  0.1510 

round 3, local macro average F1 score  0.0199 

round 3, local weighted average F1 score  0.0878 

round 3, global test acc  0.0230 

round 3, average 3shot acc: [head: 0.1958, middle: 0.0099, tail: 0.0015] 

round 3, global 3shot acc: [head: 0.0715, middle: 0.0142, tail: 0.0000] 

l_head tensor([1.5887, 1.0305, 1.6773, 0.5943, 2.2662, 3.1346, 2.5471, 0.7328, 3.3521,
        0.9671, 0.9238, 3.0006, 1.2477, 0.8337, 3.5000, 2.0018, 0.7298, 0.8821,
        0.5703, 1.1461, 0.5832, 0.9159, 1.1687, 1.6143, 1.5186, 1.0240, 1.4926,
        2.8915, 0.5772, 1.5520, 0.9075, 0.5875, 0.7873, 0.5837, 3.0346, 1.4610,
        1.5159, 0.7699, 1.8398, 0.5673, 0.8599, 0.5808, 0.6058, 0.5732, 0.7599,
        1.3771, 0.5518, 0.5710, 0.9498, 0.5804, 0.5679, 0.5641, 0.5675, 0.5901,
        0.8295, 0.5892, 0.8040, 0.9209, 0.5923, 0.5798, 0.8051, 0.5719, 1.0188,
        0.5881, 0.7396, 1.0457, 0.5877, 0.5845, 0.5932, 0.5848, 0.5813, 0.5938,
        0.5829, 0.5865, 0.7139, 0.5874, 0.5713, 0.7449, 0.5766, 0.5890, 0.5728,
        0.5620, 0.9295, 0.5595, 0.5826, 0.5810, 0.7161, 0.5976, 0.5663, 0.5795,
        0.5959, 0.5712, 0.5848, 0.6011, 0.5538, 0.6264, 0.7148, 0.5678, 0.5980,
        0.5858], device='cuda:2', grad_fn=<NormBackward1>)
g_head 
  1%|          | 4/500 [14:20<29:37:06, 214.97s/it]
  1%|          | 5/500 [17:51<29:21:20, 213.50s/it]tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([2.0724, 2.1405, 1.9211, 1.7657, 1.7189, 2.0322, 2.0227, 2.3447, 2.1431,
        1.9846, 2.2075, 1.8819, 1.5863, 1.5998, 2.3247, 2.0833, 2.0936, 1.3319,
        1.9245, 1.6731, 1.8355, 1.4313, 2.0319, 1.8472, 2.0788, 1.5658, 1.4265,
        1.4822, 1.6930, 1.1541, 1.3237, 1.3196, 1.3021, 1.1424, 1.6682, 1.2098,
        1.1546, 1.3996, 1.1168, 1.2976, 0.9217, 1.0762, 1.3738, 1.0608, 0.8157,
        0.9615, 1.0051, 1.1026, 0.9099, 1.0802, 0.8064, 0.7145, 0.7335, 1.2785,
        0.7488, 1.1245, 0.7047, 1.2255, 1.0061, 0.8233, 0.8550, 0.8373, 0.9433,
        0.7888, 0.7039, 0.7734, 0.7722, 1.0427, 0.8568, 0.8057, 0.7821, 0.7649,
        0.9164, 0.7379, 0.7139, 0.6357, 0.8447, 0.6216, 0.7265, 0.7065, 0.6939,
        0.7004, 0.7635, 0.7322, 0.7087, 0.6850, 0.6658, 0.6635, 0.7531, 0.6965,
        0.7682, 0.6672, 0.6394, 0.6209, 0.6597, 0.6388, 0.6441, 0.6339, 0.7129,
        0.6886], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.24074074074074073, middle:0.010638297872340425, tail0.0
3shot of client 1:head:0.23274161735700197, middle:0.1328125, tail0.0
3shot of client 2:head:0.24496644295302014, middle:0.0, tail0.0
3shot of client 3:head:0.17255717255717257, middle:0.03968253968253968, tail0.0
3shot of client 4:head:0.20901639344262296, middle:0.06086956521739131, tail0.0
3shot of client 5:head:0.2309197651663405, middle:0.016, tail0.0
3shot of client 6:head:0.19387755102040816, middle:0.0, tail0.0
3shot of client 7:head:0.19791666666666666, middle:0.021739130434782608, tail0.0
3shot of client 8:head:0.20501138952164008, middle:0.0, tail0.0
3shot of client 9:head:0.21115537848605578, middle:0.0, tail0.0
3shot of client 10:head:0.28212290502793297, middle:0.0, tail0.0
3shot of client 11:head:0.2564102564102564, middle:0.011363636363636364, tail0.0
3shot of client 12:head:0.2557471264367816, middle:0.03571428571428571, tail0.0
3shot of client 13:head:0.31790123456790126, middle:0.058823529411764705, tail0.0
3shot of client 14:head:0.16711590296495957, middle:0.0, tail0.041666666666666664
3shot of client 15:head:0.17857142857142858, middle:0.11290322580645161, tail0.0
3shot of client 16:head:0.19256756756756757, middle:0.0, tail0.0
3shot of client 17:head:0.2627986348122867, middle:0.0, tail0.058823529411764705
3shot of client 18:head:0.3014705882352941, middle:0.02857142857142857, tail0.0
3shot of client 19:head:0.1919191919191919, middle:0.0375, tail0.0
round 4, local average test acc  0.1787 

round 4, local macro average F1 score  0.0333 

round 4, local weighted average F1 score  0.1178 

round 4, global test acc  0.0326 

round 4, average 3shot acc: [head: 0.2273, middle: 0.0283, tail: 0.0050] 

round 4, global 3shot acc: [head: 0.1004, middle: 0.0212, tail: 0.0000] 

l_head tensor([2.0165, 1.1784, 1.9070, 0.5943, 2.7560, 3.6784, 3.0600, 0.7954, 3.9758,
        1.0031, 1.0243, 3.5557, 1.4370, 0.9668, 4.0258, 2.2837, 0.8624, 1.0938,
        0.5703, 1.2900, 0.5833, 0.9240, 1.2447, 1.9241, 1.6706, 1.1631, 1.7000,
        3.5350, 0.5772, 1.7983, 0.9607, 0.5875, 0.8111, 0.5837, 3.6713, 1.7085,
        1.7455, 0.8814, 2.1788, 0.5674, 1.0032, 0.5809, 0.6059, 0.5732, 0.8912,
        1.6749, 0.5519, 0.5711, 1.1243, 0.5805, 0.5679, 0.5642, 0.5676, 0.5902,
        0.9022, 0.5892, 0.9513, 0.9873, 0.5923, 0.5799, 0.8554, 0.5719, 1.3457,
        0.5881, 0.8364, 1.1706, 0.5877, 0.5846, 0.5933, 0.5848, 0.5813, 0.5938,
        0.5829, 0.5866, 0.7135, 0.5874, 0.5713, 0.7741, 0.5767, 0.5891, 0.5729,
        0.5621, 0.9738, 0.5595, 0.5827, 0.5811, 0.7328, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 0.6920, 0.7662, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([2.4469, 2.5779, 2.2641, 2.1874, 2.0605, 2.3316, 2.4322, 2.7481, 2.5960,
        2.3283, 2.6407, 2.2858, 1.9189, 1.8693, 2.7817, 2.5464, 2.5542, 1.6417,
        2.2262, 2.0106, 2.2159, 1.7589, 2.4134, 2.1940, 2.5031, 1.9609, 1.7164,
        1.8014, 2.0279, 1.3940, 1.6346, 1.6325, 1.5480, 1.3301, 1.9753, 1.4099,
        1.3828, 1.5971, 1.3238, 1.5836, 1.0551, 1.2490, 1.5828, 1.2525, 0.9532,
        1.1220, 1.2295, 1.3073, 1.0121, 1.2347, 0.8912, 0.7813, 0.8650, 1.5355,
        0.8527, 1.4756, 0.8108, 1.4104, 1.1380, 1.0142, 1.0823, 0.9377, 1.0687,
        0.9162, 0.7707, 0.9611, 0.8879, 1.3123, 0.9384, 0.8591, 0.8593, 0.8416,
        1.0340, 0.8010, 0.7759, 0.7155, 1.0089, 0.6661, 0.7288, 0.7626, 0.7381,
        0.8106, 0.8702, 0.7746, 0.8095, 0.7469, 0.7329, 0.7283, 0.8051, 0.6979,
        0.8233, 0.7424, 0.6827, 0.7147, 0.7780, 0.6572, 0.6880, 0.6862, 0.7475,
        0.7256], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.1746031746031746, middle:0.06382978723404255, tail0.0
3shot of client 1:head:0.2485207100591716, middle:0.1328125, tail0.0
3shot of client 2:head:0.28523489932885904, middle:0.0, tail0.0
3shot of client 3:head:0.24324324324324326, middle:0.09523809523809523, tail0.0
3shot of client 4:head:0.29098360655737704, middle:0.017391304347826087, tail0.0
3shot of client 5:head:0.2309197651663405, middle:0.0, tail0.03125
3shot of client 6:head:0.19387755102040816, middle:0.08, tail0.0
3shot of client 7:head:0.1875, middle:0.021739130434782608, tail0.0
3shot of client 8:head:0.18223234624145787, middle:0.09401709401709402, tail0.0
3shot of client 9:head:0.199203187250996, middle:0.11764705882352941, tail0.0
3shot of client 10:head:0.22625698324022347, middle:0.06976744186046512, tail0.0
3shot of client 11:head:0.31339031339031337, middle:0.07954545454545454, tail0.0
3shot of client 12:head:0.2471264367816092, middle:0.08333333333333333, tail0.0
3shot of client 13:head:0.3395061728395062, middle:0.011764705882352941, tail0.0
3shot of client 14:head:0.3045822102425876, middle:0.021052631578947368, tail0.0
3shot of client 15:head:0.20634920634920634, middle:0.0, tail0.0
3shot of client 16:head:0.23986486486486486, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.25597269624573377, middle:0.0, tail0.058823529411764705
3shot of client 18:head:0.4007352941176471, middle:0.04285714285714286, tail0.0
3shot of client 19:head:0.3367003367003367, middle:0.0, tail0.058823529411764705
round 5, local average test acc  0.2038 

round 5, local macro average F1 score  0.0425 

round 5, local weighted average F1 score  0.1354 


  1%|          | 6/500 [21:14<28:50:28, 210.18s/it]
  1%|▏         | 7/500 [24:37<28:27:44, 207.84s/it]round 5, global test acc  0.0322 

round 5, average 3shot acc: [head: 0.2553, middle: 0.0473, tail: 0.0074] 

round 5, global 3shot acc: [head: 0.1056, middle: 0.0142, tail: 0.0000] 

l_head tensor([2.2169, 1.4485, 2.1096, 0.5944, 3.2070, 4.2007, 3.4972, 0.8124, 4.5074,
        1.0830, 1.1706, 4.1540, 1.7057, 0.9689, 4.4190, 2.5632, 1.0420, 1.1507,
        0.5703, 1.4304, 0.5833, 1.0106, 1.5190, 2.3891, 1.8831, 1.2320, 1.8935,
        4.0327, 0.5773, 2.0633, 1.0969, 0.5875, 0.9252, 0.5837, 4.1774, 1.8721,
        2.0600, 0.9206, 2.6237, 0.5674, 1.1164, 0.5809, 0.6059, 0.5732, 0.8662,
        1.7593, 0.5519, 0.5711, 1.3781, 0.5805, 0.5679, 0.5642, 0.5676, 0.5902,
        0.8852, 0.5892, 0.9878, 1.1238, 0.5923, 0.5799, 0.9187, 0.5719, 1.5187,
        0.5882, 0.9034, 1.3576, 0.5878, 0.5846, 0.5933, 0.5848, 0.5813, 0.5939,
        0.5829, 0.5866, 0.7651, 0.5874, 0.5713, 0.8278, 0.5767, 0.5891, 0.5729,
        0.5621, 1.0696, 0.5596, 0.5827, 0.5811, 0.7838, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 0.7891, 0.8106, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([2.8176, 2.9097, 2.6738, 2.5743, 2.4470, 2.6573, 2.8333, 3.2816, 2.9893,
        2.5708, 3.0741, 2.6352, 2.3105, 2.2158, 3.3135, 2.7678, 2.8053, 1.9363,
        2.6144, 2.3507, 2.4976, 2.0570, 2.7592, 2.4717, 2.8352, 2.2369, 1.9732,
        2.1245, 2.3807, 1.6433, 2.0132, 1.9798, 1.8098, 1.5496, 2.2890, 1.5695,
        1.6185, 1.7998, 1.5165, 1.8237, 1.2071, 1.4639, 1.8398, 1.4047, 1.0570,
        1.2018, 1.3363, 1.4674, 1.1415, 1.4703, 1.0204, 0.8940, 0.9302, 1.7157,
        0.9984, 1.6610, 0.9182, 1.6160, 1.3268, 1.1610, 1.1714, 1.0811, 1.1720,
        1.0754, 0.8965, 1.0731, 1.0169, 1.6176, 1.0670, 0.9576, 0.9619, 0.9452,
        1.1148, 0.9220, 0.8543, 0.7470, 1.0354, 0.8025, 0.8697, 0.8556, 0.8329,
        0.9809, 0.9272, 0.8613, 0.8777, 0.8059, 0.7702, 0.7873, 0.9226, 0.8319,
        0.9363, 0.7430, 0.7223, 0.8021, 0.7990, 0.7572, 0.6938, 0.7387, 0.8293,
        0.8617], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.2275132275132275, middle:0.0425531914893617, tail0.0
3shot of client 1:head:0.27613412228796846, middle:0.171875, tail0.0
3shot of client 2:head:0.26174496644295303, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.21413721413721415, middle:0.09523809523809523, tail0.0
3shot of client 4:head:0.2459016393442623, middle:0.0, tail0.0
3shot of client 5:head:0.21135029354207435, middle:0.04, tail0.0
3shot of client 6:head:0.21428571428571427, middle:0.08, tail0.0
3shot of client 7:head:0.19270833333333334, middle:0.06521739130434782, tail0.08333333333333333
3shot of client 8:head:0.23690205011389523, middle:0.042735042735042736, tail0.0
3shot of client 9:head:0.2589641434262948, middle:0.0, tail0.0
3shot of client 10:head:0.3128491620111732, middle:0.011627906976744186, tail0.0
3shot of client 11:head:0.35327635327635326, middle:0.0, tail0.0
3shot of client 12:head:0.2614942528735632, middle:0.047619047619047616, tail0.0
3shot of client 13:head:0.25617283950617287, middle:0.023529411764705882, tail0.0
3shot of client 14:head:0.32075471698113206, middle:0.021052631578947368, tail0.08333333333333333
3shot of client 15:head:0.17063492063492064, middle:0.016129032258064516, tail0.0
3shot of client 16:head:0.23986486486486486, middle:0.029411764705882353, tail0.0
3shot of client 17:head:0.2593856655290102, middle:0.0, tail0.17647058823529413
3shot of client 18:head:0.5477941176470589, middle:0.0, tail0.0
3shot of client 19:head:0.2828282828282828, middle:0.1, tail0.058823529411764705
round 6, local average test acc  0.2120 

round 6, local macro average F1 score  0.0500 

round 6, local weighted average F1 score  0.1586 

round 6, global test acc  0.0372 

round 6, average 3shot acc: [head: 0.2672, middle: 0.0400, tail: 0.0201] 

round 6, global 3shot acc: [head: 0.1348, middle: 0.0031, tail: 0.0000] 

l_head tensor([2.5643, 1.4629, 2.3220, 0.5944, 3.7645, 4.4628, 3.7832, 1.0070, 5.1367,
        1.1831, 1.2877, 4.5443, 1.9329, 1.0571, 4.7882, 2.7917, 0.9207, 1.1251,
        0.5703, 1.5617, 0.5833, 1.1351, 1.7999, 2.6640, 1.9860, 1.3355, 2.1856,
        4.5929, 0.5773, 2.2000, 1.2891, 0.5875, 0.8942, 0.5837, 4.5832, 2.2226,
        2.3741, 0.9237, 2.9877, 0.5674, 1.1336, 0.5809, 0.6059, 0.5732, 0.9087,
        1.9227, 0.5519, 0.5711, 1.3762, 0.5805, 0.5680, 0.5642, 0.5676, 0.5902,
        1.0798, 0.5893, 1.0482, 1.1510, 0.5923, 0.5799, 1.0393, 0.5719, 1.7352,
        0.5882, 0.9667, 1.5579, 0.5878, 0.5846, 0.5933, 0.5848, 0.5813, 0.5939,
        0.5829, 0.5866, 0.8055, 0.5874, 0.5713, 0.9007, 0.5767, 0.5891, 0.5729,
        0.5621, 1.1817, 0.5596, 0.5827, 0.5811, 0.9243, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 0.8122, 0.8496, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([3.1702, 3.2688, 3.0300, 2.9559, 2.7701, 2.9731, 3.2356, 3.6076, 3.4810,
        2.8063, 3.4180, 2.9557, 2.6023, 2.4098, 3.6756, 3.0799, 3.1773, 2.2743,
        2.8786, 2.6510, 2.7144, 2.3568, 3.1818, 2.8502, 3.0548, 2.4965, 2.2303,
        2.4776, 2.6605, 1.8568, 2.3151, 2.2013, 2.0997, 1.7852, 2.6073, 1.8285,
        1.7684, 2.0815, 1.7039, 2.1220, 1.4264, 1.6436, 2.0643, 1.6214, 1.2359,
        1.3839, 1.5275, 1.6867, 1.2695, 1.6816, 1.1745, 0.9381, 1.0752, 1.8894,
        1.1228, 1.8918, 1.0618, 1.7927, 1.5330, 1.2656, 1.3805, 1.1873, 1.3273,
        1.2112, 0.9532, 1.2669, 1.1199, 1.8930, 1.1772, 1.1037, 1.0514, 1.0082,
        1.2492, 0.9923, 0.9533, 0.8572, 1.2509, 0.8693, 0.9530, 0.9605, 0.9109,
        1.0275, 1.0865, 0.9756, 0.9534, 0.9191, 0.8693, 0.8302, 1.0041, 0.9126,
        1.0794, 0.8315, 0.8318, 0.8905, 0.8964, 0.8602, 0.7752, 0.8183, 0.9130,
        0.9699], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.2222222222222222, middle:0.07446808510638298, tail0.0
3shot of client 1:head:0.26627218934911245, middle:0.1640625, tail0.0
3shot of client 2:head:0.3624161073825503, middle:0.039473684210526314, tail0.0
3shot of client 3:head:0.2806652806652807, middle:0.21428571428571427, tail0.0
3shot of client 4:head:0.319672131147541, middle:0.043478260869565216, tail0.0
3shot of client 5:head:0.20156555772994128, middle:0.0, tail0.03125

  2%|▏         | 8/500 [28:00<28:11:06, 206.23s/it]3shot of client 6:head:0.2653061224489796, middle:0.06666666666666667, tail0.0
3shot of client 7:head:0.19270833333333334, middle:0.06521739130434782, tail0.0
3shot of client 8:head:0.20273348519362186, middle:0.07692307692307693, tail0.038461538461538464
3shot of client 9:head:0.14741035856573706, middle:0.029411764705882353, tail0.0
3shot of client 10:head:0.3715083798882682, middle:0.046511627906976744, tail0.0
3shot of client 11:head:0.4700854700854701, middle:0.0, tail0.0
3shot of client 12:head:0.2471264367816092, middle:0.08333333333333333, tail0.047619047619047616
3shot of client 13:head:0.28703703703703703, middle:0.058823529411764705, tail0.0
3shot of client 14:head:0.33423180592991913, middle:0.010526315789473684, tail0.041666666666666664
3shot of client 15:head:0.2619047619047619, middle:0.16129032258064516, tail0.0
3shot of client 16:head:0.2972972972972973, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.2696245733788396, middle:0.041666666666666664, tail0.058823529411764705
3shot of client 18:head:0.4963235294117647, middle:0.04285714285714286, tail0.0
3shot of client 19:head:0.2962962962962963, middle:0.0, tail0.0
round 7, local average test acc  0.2329 

round 7, local macro average F1 score  0.0596 

round 7, local weighted average F1 score  0.1834 

round 7, global test acc  0.0465 

round 7, average 3shot acc: [head: 0.2896, middle: 0.0617, tail: 0.0109] 

round 7, global 3shot acc: [head: 0.1515, middle: 0.0215, tail: 0.0000] 

l_head tensor([2.6564, 1.7517, 2.6162, 0.5944, 4.0718, 4.7709, 4.2372, 0.9444, 5.6411,
        1.2824, 1.5175, 5.0297, 2.3685, 1.1191, 5.1767, 3.0159, 1.1391, 1.3782,
        0.5704, 1.7342, 0.5833, 1.2563, 1.9438, 2.9757, 2.1634, 1.4902, 2.4654,
        5.1055, 0.5773, 2.4847, 1.3580, 0.5875, 1.0126, 0.5837, 5.0233, 2.3424,
        2.6000, 0.9630, 3.3395, 0.5674, 1.2966, 0.5809, 0.6059, 0.5732, 0.9129,
        2.2395, 0.5519, 0.5711, 1.5803, 0.5805, 0.5680, 0.5642, 0.5676, 0.5902,
        1.1666, 0.5893, 1.1016, 1.2076, 0.5923, 0.5799, 1.1095, 0.5719, 1.8781,
        0.5882, 1.0155, 1.6082, 0.5878, 0.5846, 0.5933, 0.5848, 0.5813, 0.5939,
        0.5829, 0.5866, 0.8510, 0.5874, 0.5713, 0.8976, 0.5767, 0.5891, 0.5729,
        0.5621, 1.4238, 0.5596, 0.5827, 0.5811, 0.9221, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 0.9140, 0.8990, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([3.4797, 3.6017, 3.3781, 3.3510, 3.0389, 3.3189, 3.5351, 4.0192, 3.8130,
        3.1149, 3.7277, 3.2738, 2.9082, 2.6183, 3.9932, 3.4090, 3.4764, 2.5877,
        3.2864, 2.8838, 2.9974, 2.6969, 3.4396, 3.1436, 3.2749, 2.8025, 2.5158,
        2.7990, 2.9815, 2.1073, 2.5965, 2.4674, 2.3149, 1.9306, 2.8456, 2.0067,
        1.9675, 2.3321, 1.9895, 2.4035, 1.5754, 1.7478, 2.3334, 1.8603, 1.4236,
        1.5838, 1.7469, 1.9589, 1.3633, 1.9394, 1.2733, 1.0831, 1.1894, 2.0736,
        1.2879, 2.2003, 1.1556, 2.0574, 1.6942, 1.4139, 1.6078, 1.3965, 1.4758,
        1.3565, 1.0773, 1.4106, 1.2826, 2.1195, 1.2671, 1.3194, 1.1989, 1.1604,
        1.5114, 1.1057, 1.0682, 0.9728, 1.3852, 0.9641, 1.0983, 1.0378, 1.0307,
        1.1659, 1.1493, 1.0320, 1.0286, 1.0016, 0.9501, 0.8727, 1.0478, 1.0258,
        1.0972, 1.0147, 0.9210, 1.0262, 1.0423, 0.9218, 0.8255, 0.9400, 0.9512,
        0.9988], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.22486772486772486, middle:0.14893617021276595, tail0.0
3shot of client 1:head:0.3510848126232742, middle:0.0703125, tail0.0
3shot of client 2:head:0.35570469798657717, middle:0.039473684210526314, tail0.0
3shot of client 3:head:0.32224532224532226, middle:0.14285714285714285, tail0.0
3shot of client 4:head:0.35860655737704916, middle:0.034782608695652174, tail0.0
3shot of client 5:head:0.19765166340508805, middle:0.056, tail0.0
3shot of client 6:head:0.2687074829931973, middle:0.06666666666666667, tail0.05263157894736842
3shot of client 7:head:0.20833333333333334, middle:0.043478260869565216, tail0.16666666666666666
3shot of client 8:head:0.2072892938496583, middle:0.09401709401709402, tail0.0
3shot of client 9:head:0.19123505976095617, middle:0.04411764705882353, tail0.0
3shot of client 10:head:0.30446927374301674, middle:0.023255813953488372, tail0.0
3shot of client 11:head:0.4131054131054131, middle:0.056818181818181816, tail0.0
3shot of client 12:head:0.3879310344827586, middle:0.023809523809523808, tail0.047619047619047616
3shot of client 13:head:0.4074074074074074, middle:0.058823529411764705, tail0.05
3shot of client 14:head:0.4123989218328841, middle:0.010526315789473684, tail0.041666666666666664
3shot of client 15:head:0.24603174603174602, middle:0.04838709677419355, tail0.0
3shot of client 16:head:0.3108108108108108, middle:0.0, tail0.0
3shot of client 17:head:0.3037542662116041, middle:0.027777777777777776, tail0.11764705882352941
3shot of client 18:head:0.4889705882352941, middle:0.08571428571428572, tail0.0
3shot of client 19:head:0.2895622895622896, middle:0.0625, tail0.058823529411764705
round 8, local average test acc  0.2502 

round 8, local macro average F1 score  0.0711 

round 8, local weighted average F1 score  0.2035 

round 8, global test acc  0.0527 

round 8, average 3shot acc: [head: 0.3125, middle: 0.0569, tail: 0.0268] 

round 8, global 3shot acc: [head: 0.1756, middle: 0.0204, tail: 0.0000] 

l_head tensor([3.0162, 1.9527, 2.9127, 0.5944, 4.4287, 5.2143, 4.5506, 1.0034, 6.0638,
        1.4250, 1.6470, 5.4598, 2.3202, 1.3495, 5.5587, 3.2481, 1.1876, 1.5900,
        0.5704, 1.9516, 0.5833, 1.4697, 2.0701, 3.3653, 2.3082, 1.6455, 2.7329,
        5.6222, 0.5773, 2.7736, 1.4144, 0.5875, 1.1921, 0.5837, 5.3214, 2.6687,
        2.7872, 0.9823, 3.9682, 0.5674, 1.4522, 0.5809, 0.6059, 0.5732, 0.9463,
        2.4783, 0.5519, 0.5711, 1.6794, 0.5805, 0.5680, 0.5642, 0.5676, 0.5902,
        1.1578, 0.5893, 1.1748, 1.4262, 0.5923, 0.5799, 1.2243, 0.5719, 2.0204,
        0.5882, 1.1563, 1.7553, 0.5878, 0.5846, 0.5933, 0.5848, 0.5813, 0.5939,
        0.5829, 0.5866, 0.9910, 0.5874, 0.5713, 1.0016, 0.5767, 0.5891, 0.5729,
        0.5621, 1.4143, 0.5596, 0.5827, 0.5811, 0.9694, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 1.1002, 0.9485, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head 
  2%|▏         | 9/500 [31:24<28:00:45, 205.39s/it]
  2%|▏         | 10/500 [34:47<27:52:49, 204.84s/it]tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([3.8229, 3.8939, 3.6344, 3.5884, 3.3157, 3.6336, 3.8194, 4.3284, 4.1353,
        3.4613, 4.1385, 3.5457, 3.2372, 2.8932, 4.3976, 3.6098, 3.7817, 2.8893,
        3.6238, 3.1876, 3.2376, 3.0580, 3.7537, 3.4039, 3.5357, 3.0707, 2.7901,
        3.1435, 3.2335, 2.3369, 2.8509, 2.7026, 2.5306, 2.1700, 3.1039, 2.2957,
        2.1774, 2.5986, 2.2571, 2.6894, 1.7641, 2.0372, 2.6181, 2.0425, 1.4704,
        1.6947, 1.9494, 2.2104, 1.5931, 2.1616, 1.4392, 1.2534, 1.3314, 2.1791,
        1.4468, 2.4910, 1.3815, 2.2359, 1.8254, 1.6013, 1.8618, 1.5763, 1.6231,
        1.5094, 1.2330, 1.5496, 1.4260, 2.3410, 1.4493, 1.4790, 1.3279, 1.3421,
        1.7068, 1.1891, 1.1697, 1.0445, 1.6278, 1.0422, 1.2316, 1.1744, 1.1683,
        1.2890, 1.2905, 1.2011, 1.1555, 1.1720, 1.0736, 1.0453, 1.2336, 1.1392,
        1.1869, 1.1183, 0.9786, 1.0865, 1.0960, 1.0167, 0.9642, 1.0505, 1.1681,
        1.1829], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.28835978835978837, middle:0.1595744680851064, tail0.0
3shot of client 1:head:0.39250493096646943, middle:0.03125, tail0.030303030303030304
3shot of client 2:head:0.3288590604026846, middle:0.14473684210526316, tail0.0
3shot of client 3:head:0.2869022869022869, middle:0.1984126984126984, tail0.0
3shot of client 4:head:0.3401639344262295, middle:0.02608695652173913, tail0.0
3shot of client 5:head:0.24266144814090018, middle:0.024, tail0.0
3shot of client 6:head:0.25510204081632654, middle:0.14666666666666667, tail0.0
3shot of client 7:head:0.22916666666666666, middle:0.043478260869565216, tail0.0
3shot of client 8:head:0.20273348519362186, middle:0.05128205128205128, tail0.0
3shot of client 9:head:0.29880478087649404, middle:0.029411764705882353, tail0.0
3shot of client 10:head:0.3268156424581006, middle:0.023255813953488372, tail0.0
3shot of client 11:head:0.4586894586894587, middle:0.022727272727272728, tail0.0
3shot of client 12:head:0.3448275862068966, middle:0.09523809523809523, tail0.047619047619047616
3shot of client 13:head:0.35802469135802467, middle:0.09411764705882353, tail0.0
3shot of client 14:head:0.38274932614555257, middle:0.010526315789473684, tail0.041666666666666664
3shot of client 15:head:0.3253968253968254, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.28040540540540543, middle:0.08823529411764706, tail0.0
3shot of client 17:head:0.3515358361774744, middle:0.013888888888888888, tail0.17647058823529413
3shot of client 18:head:0.5661764705882353, middle:0.014285714285714285, tail0.0
3shot of client 19:head:0.3872053872053872, middle:0.05, tail0.058823529411764705
round 9, local average test acc  0.2666 

round 9, local macro average F1 score  0.0694 

round 9, local weighted average F1 score  0.2037 

round 9, global test acc  0.0550 

round 9, average 3shot acc: [head: 0.3324, middle: 0.0666, tail: 0.0177] 

round 9, global 3shot acc: [head: 0.1604, middle: 0.0450, tail: 0.0000] 

l_head tensor([3.3037, 2.1145, 3.2618, 0.5944, 4.7787, 5.4976, 4.9705, 1.0536, 6.6392,
        1.5153, 1.7277, 5.9466, 2.5074, 1.4531, 5.9282, 3.3922, 1.3365, 1.8186,
        0.5704, 1.9933, 0.5833, 1.6056, 2.3922, 3.7574, 2.5121, 1.7739, 3.0241,
        5.9413, 0.5773, 2.9434, 1.5949, 0.5875, 1.2098, 0.5837, 5.6054, 2.9434,
        3.0711, 1.1028, 4.1664, 0.5674, 1.5236, 0.5809, 0.6059, 0.5732, 1.0276,
        2.8144, 0.5519, 0.5711, 1.9298, 0.5805, 0.5680, 0.5642, 0.5676, 0.5902,
        1.2358, 0.5893, 1.2999, 1.5208, 0.5923, 0.5799, 1.4402, 0.5719, 2.1714,
        0.5882, 1.1933, 1.8546, 0.5878, 0.5846, 0.5933, 0.5848, 0.5813, 0.5939,
        0.5829, 0.5866, 0.9654, 0.5874, 0.5713, 0.9885, 0.5767, 0.5891, 0.5729,
        0.5621, 1.5682, 0.5596, 0.5827, 0.5811, 1.0503, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 1.3679, 0.9874, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([4.1457, 4.1484, 3.9313, 3.8965, 3.5536, 3.9604, 4.1616, 4.6382, 4.4253,
        3.7294, 4.4225, 3.8288, 3.4508, 3.1534, 4.7667, 3.8607, 4.0755, 3.1697,
        3.8892, 3.4326, 3.4724, 3.2167, 4.0994, 3.7412, 3.7814, 3.3118, 2.9043,
        3.3610, 3.4986, 2.5445, 3.1096, 3.0000, 2.8428, 2.4767, 3.3599, 2.5112,
        2.3348, 2.8311, 2.4439, 2.9048, 1.9882, 2.3135, 2.9788, 2.2131, 1.6654,
        1.8977, 2.1448, 2.5214, 1.8077, 2.3912, 1.5771, 1.3634, 1.4774, 2.3888,
        1.5835, 2.7391, 1.4702, 2.4790, 2.0657, 1.8077, 1.9678, 1.7577, 1.8128,
        1.6782, 1.3745, 1.7834, 1.5698, 2.6842, 1.6440, 1.5319, 1.5489, 1.5597,
        1.8490, 1.3281, 1.3868, 1.1944, 1.6647, 1.1866, 1.3572, 1.2756, 1.2857,
        1.4878, 1.4162, 1.3514, 1.3722, 1.2768, 1.1511, 1.2094, 1.3968, 1.1561,
        1.3657, 1.1627, 1.0989, 1.1929, 1.3071, 1.1340, 1.1149, 1.2076, 1.3269,
        1.3406], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.2830687830687831, middle:0.1702127659574468, tail0.0
3shot of client 1:head:0.3629191321499014, middle:0.0859375, tail0.0
3shot of client 2:head:0.3221476510067114, middle:0.02631578947368421, tail0.0
3shot of client 3:head:0.340956340956341, middle:0.16666666666666666, tail0.0
3shot of client 4:head:0.3831967213114754, middle:0.034782608695652174, tail0.0
3shot of client 5:head:0.2837573385518591, middle:0.072, tail0.0625
3shot of client 6:head:0.19387755102040816, middle:0.10666666666666667, tail0.0
3shot of client 7:head:0.21354166666666666, middle:0.043478260869565216, tail0.08333333333333333
3shot of client 8:head:0.30068337129840544, middle:0.06837606837606838, tail0.038461538461538464
3shot of client 9:head:0.24701195219123506, middle:0.058823529411764705, tail0.06666666666666667
3shot of client 10:head:0.388268156424581, middle:0.08139534883720931, tail0.0
3shot of client 11:head:0.49002849002849, middle:0.022727272727272728, tail0.0
3shot of client 12:head:0.3879310344827586, middle:0.07142857142857142, tail0.0
3shot of client 13:head:0.4104938271604938, middle:0.03529411764705882, tail0.0
3shot of client 14:head:0.4474393530997305, middle:0.06315789473684211, tail0.0
3shot of client 15:head:0.26587301587301587, middle:0.16129032258064516, tail0.0
3shot of client 16:head:0.28040540540540543, middle:0.04411764705882353, tail0.0
3shot of client 17:head:0.3378839590443686, middle:0.1111111111111111, tail0.0

  2%|▏         | 11/500 [38:10<27:45:18, 204.33s/it]
  2%|▏         | 12/500 [41:34<27:39:26, 204.03s/it]3shot of client 18:head:0.5661764705882353, middle:0.05714285714285714, tail0.0
3shot of client 19:head:0.3569023569023569, middle:0.0625, tail0.058823529411764705
round 10, local average test acc  0.2767 

round 10, local macro average F1 score  0.0803 

round 10, local weighted average F1 score  0.2301 

round 10, global test acc  0.0595 

round 10, average 3shot acc: [head: 0.3431, middle: 0.0772, tail: 0.0155] 

round 10, global 3shot acc: [head: 0.2174, middle: 0.0031, tail: 0.0000] 

l_head tensor([3.6257, 2.3714, 3.5060, 0.5944, 5.2241, 5.9259, 5.2143, 1.1416, 6.8447,
        1.7646, 1.8418, 6.3365, 2.7747, 1.5825, 6.2827, 3.7353, 1.3329, 1.8792,
        0.5704, 2.2361, 0.5833, 1.6867, 2.7157, 4.0191, 2.5640, 1.8721, 3.4044,
        6.2705, 0.5773, 3.2941, 1.7000, 0.5875, 1.3138, 0.5837, 5.8510, 3.1843,
        3.2077, 1.1823, 4.4733, 0.5674, 1.5926, 0.5809, 0.6059, 0.5732, 1.1247,
        2.9542, 0.5519, 0.5711, 1.9525, 0.5805, 0.5680, 0.5642, 0.5676, 0.5902,
        1.3874, 0.5893, 1.4417, 1.7344, 0.5923, 0.5799, 1.4006, 0.5719, 2.2565,
        0.5882, 1.2867, 2.1047, 0.5878, 0.5846, 0.5933, 0.5848, 0.5813, 0.5939,
        0.5829, 0.5866, 1.0954, 0.5874, 0.5713, 1.0500, 0.5767, 0.5891, 0.5729,
        0.5621, 1.7890, 0.5596, 0.5827, 0.5811, 1.0507, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 1.4519, 1.1591, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([4.4633, 4.4794, 4.1610, 4.1897, 3.7867, 4.1930, 4.4557, 4.7170, 4.7012,
        4.0528, 4.6906, 4.0255, 3.7245, 3.3722, 5.1128, 4.1970, 4.3489, 3.4221,
        4.1926, 3.7208, 3.6808, 3.5425, 4.3148, 3.9197, 4.0589, 3.6099, 3.1953,
        3.5961, 3.6289, 2.7440, 3.4125, 3.2948, 3.1166, 2.6153, 3.6101, 2.7427,
        2.5305, 3.0258, 2.6412, 3.1669, 2.1215, 2.4789, 3.1952, 2.4510, 1.8801,
        2.1118, 2.4496, 2.6885, 1.9650, 2.5656, 1.7471, 1.4825, 1.5533, 2.5903,
        1.6846, 2.9340, 1.6329, 2.7685, 2.2227, 2.0575, 2.1569, 2.0727, 1.9562,
        1.9152, 1.4440, 2.0517, 1.7543, 2.9179, 1.8551, 1.7279, 1.6390, 1.6032,
        2.0365, 1.5225, 1.5131, 1.4160, 1.8742, 1.2947, 1.5015, 1.4824, 1.4185,
        1.5177, 1.5312, 1.4729, 1.5067, 1.4278, 1.3691, 1.2923, 1.5132, 1.2874,
        1.5081, 1.3540, 1.2258, 1.3223, 1.5145, 1.3018, 1.2711, 1.2965, 1.3769,
        1.4240], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.24867724867724866, middle:0.24468085106382978, tail0.0
3shot of client 1:head:0.3865877712031558, middle:0.1328125, tail0.0
3shot of client 2:head:0.40268456375838924, middle:0.02631578947368421, tail0.0
3shot of client 3:head:0.3659043659043659, middle:0.23015873015873015, tail0.0
3shot of client 4:head:0.39959016393442626, middle:0.05217391304347826, tail0.0
3shot of client 5:head:0.2309197651663405, middle:0.0, tail0.0
3shot of client 6:head:0.3231292517006803, middle:0.13333333333333333, tail0.0
3shot of client 7:head:0.20833333333333334, middle:0.13043478260869565, tail0.0
3shot of client 8:head:0.3439635535307517, middle:0.05982905982905983, tail0.07692307692307693
3shot of client 9:head:0.23107569721115537, middle:0.11764705882352941, tail0.06666666666666667
3shot of client 10:head:0.41620111731843573, middle:0.023255813953488372, tail0.0
3shot of client 11:head:0.45014245014245013, middle:0.011363636363636364, tail0.0
3shot of client 12:head:0.45689655172413796, middle:0.05952380952380952, tail0.0
3shot of client 13:head:0.4660493827160494, middle:0.058823529411764705, tail0.0
3shot of client 14:head:0.31266846361185985, middle:0.042105263157894736, tail0.041666666666666664
3shot of client 15:head:0.2976190476190476, middle:0.11290322580645161, tail0.0
3shot of client 16:head:0.2905405405405405, middle:0.014705882352941176, tail0.05555555555555555
3shot of client 17:head:0.310580204778157, middle:0.09722222222222222, tail0.11764705882352941
3shot of client 18:head:0.5294117647058824, middle:0.15714285714285714, tail0.0
3shot of client 19:head:0.41414141414141414, middle:0.1, tail0.058823529411764705
round 11, local average test acc  0.2880 

round 11, local macro average F1 score  0.0860 

round 11, local weighted average F1 score  0.2388 

round 11, global test acc  0.0672 

round 11, average 3shot acc: [head: 0.3543, middle: 0.0902, tail: 0.0209] 

round 11, global 3shot acc: [head: 0.2230, middle: 0.0269, tail: 0.0000] 

l_head tensor([3.7499, 2.3988, 3.8209, 0.5944, 5.3691, 6.2829, 5.5242, 1.2119, 7.1277,
        1.8766, 2.0959, 6.6725, 3.0801, 1.5166, 6.5723, 3.8124, 1.4169, 2.1298,
        0.5704, 2.4605, 0.5833, 1.7977, 2.8279, 4.3390, 2.6887, 2.0084, 3.4936,
        6.7831, 0.5773, 3.5532, 1.7881, 0.5875, 1.4724, 0.5837, 6.1981, 3.3693,
        3.4851, 1.2815, 4.7863, 0.5674, 1.7912, 0.5809, 0.6059, 0.5732, 1.1828,
        3.3127, 0.5519, 0.5711, 1.9935, 0.5805, 0.5680, 0.5642, 0.5676, 0.5902,
        1.4448, 0.5893, 1.5135, 1.9016, 0.5923, 0.5799, 1.5920, 0.5719, 2.3185,
        0.5882, 1.3835, 2.2281, 0.5878, 0.5846, 0.5933, 0.5848, 0.5813, 0.5939,
        0.5829, 0.5866, 1.1419, 0.5874, 0.5713, 1.0992, 0.5767, 0.5891, 0.5729,
        0.5621, 1.8576, 0.5596, 0.5827, 0.5811, 1.1531, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 1.4727, 1.1868, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([4.7592, 4.7622, 4.4106, 4.3976, 4.0182, 4.3463, 4.8218, 4.9747, 4.8935,
        4.3203, 4.9258, 4.2746, 3.9763, 3.5682, 5.3845, 4.3906, 4.5905, 3.7124,
        4.4914, 3.9085, 3.9542, 3.9248, 4.7117, 4.2399, 4.3456, 3.8357, 3.3418,
        3.7985, 3.9354, 3.0334, 3.6343, 3.5137, 3.3072, 2.9248, 3.8138, 2.9570,
        2.7111, 3.3171, 2.9384, 3.3920, 2.3143, 2.7374, 3.3726, 2.6755, 2.0469,
        2.3158, 2.5727, 2.8840, 2.1935, 2.8416, 1.8943, 1.6898, 1.7488, 2.7676,
        1.8962, 3.2182, 1.8544, 2.8988, 2.5919, 2.1651, 2.2922, 2.2087, 2.1177,
        2.1058, 1.6006, 2.2175, 1.8828, 3.1781, 1.9786, 1.8921, 1.7968, 1.7327,
        2.2042, 1.6439, 1.6403, 1.5344, 2.0832, 1.3706, 1.8688, 1.5914, 1.5711,
        1.6724, 1.7327, 1.6006, 1.6380, 1.5841, 1.4744, 1.4183, 1.6269, 1.5125,
        1.6043, 1.4417, 1.3355, 1.4983, 1.6142, 1.4110, 1.3410, 1.4294, 1.5005,
        1.4826], device='cuda:2', grad_fn=<NormBackward1>)

  3%|▎         | 13/500 [44:57<27:35:01, 203.90s/it]3shot of client 0:head:0.29365079365079366, middle:0.24468085106382978, tail0.0
3shot of client 1:head:0.40433925049309666, middle:0.1640625, tail0.030303030303030304
3shot of client 2:head:0.41946308724832215, middle:0.07894736842105263, tail0.0
3shot of client 3:head:0.39293139293139295, middle:0.20634920634920634, tail0.03333333333333333
3shot of client 4:head:0.45286885245901637, middle:0.034782608695652174, tail0.034482758620689655
3shot of client 5:head:0.2602739726027397, middle:0.056, tail0.0625
3shot of client 6:head:0.35374149659863946, middle:0.12, tail0.0
3shot of client 7:head:0.2604166666666667, middle:0.08695652173913043, tail0.0
3shot of client 8:head:0.39863325740318906, middle:0.02564102564102564, tail0.07692307692307693
3shot of client 9:head:0.23904382470119523, middle:0.08823529411764706, tail0.0
3shot of client 10:head:0.4692737430167598, middle:0.03488372093023256, tail0.0
3shot of client 11:head:0.41595441595441596, middle:0.06818181818181818, tail0.08695652173913043
3shot of client 12:head:0.4511494252873563, middle:0.09523809523809523, tail0.0
3shot of client 13:head:0.5, middle:0.047058823529411764, tail0.0
3shot of client 14:head:0.4420485175202156, middle:0.042105263157894736, tail0.041666666666666664
3shot of client 15:head:0.2896825396825397, middle:0.0967741935483871, tail0.0
3shot of client 16:head:0.23986486486486486, middle:0.1323529411764706, tail0.0
3shot of client 17:head:0.3003412969283277, middle:0.041666666666666664, tail0.17647058823529413
3shot of client 18:head:0.4852941176470588, middle:0.22857142857142856, tail0.0
3shot of client 19:head:0.3265993265993266, middle:0.15, tail0.11764705882352941
round 12, local average test acc  0.3026 

round 12, local macro average F1 score  0.1016 

round 12, local weighted average F1 score  0.2639 

round 12, global test acc  0.0702 

round 12, average 3shot acc: [head: 0.3698, middle: 0.1021, tail: 0.0330] 

round 12, global 3shot acc: [head: 0.1985, middle: 0.0615, tail: 0.0013] 

l_head tensor([4.2041, 2.5673, 3.9273, 0.5944, 5.5583, 6.5931, 5.8477, 1.2647, 7.4894,
        1.8781, 2.3389, 7.0920, 3.3045, 1.6931, 7.0906, 4.0158, 1.6808, 2.5371,
        0.5704, 2.5851, 0.5833, 1.9201, 2.8351, 4.6486, 2.8872, 2.0872, 3.7646,
        7.0854, 0.5773, 3.7442, 1.8753, 0.5875, 1.5853, 0.5837, 6.6095, 3.5762,
        3.6368, 1.4461, 5.1772, 0.5674, 1.9720, 0.5809, 0.6059, 0.5732, 1.2235,
        3.5297, 0.5519, 0.5711, 2.1138, 0.5805, 0.5680, 0.5642, 0.5676, 0.5902,
        1.5638, 0.5893, 1.7014, 1.9226, 0.5923, 0.5799, 1.6414, 0.5719, 2.4370,
        0.5882, 1.4873, 2.3136, 0.5878, 0.5846, 0.5933, 0.5848, 0.5813, 0.5939,
        0.5829, 0.5866, 1.2488, 0.5874, 0.5713, 1.1214, 0.5767, 0.5891, 0.5729,
        0.5621, 1.9934, 0.5596, 0.5827, 0.5811, 1.1809, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 1.6343, 1.3448, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([5.0178, 5.0216, 4.5667, 4.6832, 4.2688, 4.6201, 5.0210, 5.2113, 5.1703,
        4.6038, 5.0506, 4.5021, 4.2511, 3.7742, 5.6251, 4.5781, 4.8138, 3.9734,
        4.6633, 4.0849, 4.1599, 4.1621, 5.0069, 4.5282, 4.4380, 4.1025, 3.6112,
        4.0361, 4.2428, 3.1496, 3.9084, 3.7801, 3.4833, 3.1878, 4.1191, 3.1627,
        2.8952, 3.5719, 3.1267, 3.6372, 2.4976, 3.0373, 3.6445, 2.7772, 2.2753,
        2.5142, 2.8048, 3.2317, 2.4003, 3.0647, 2.1534, 1.8609, 1.9887, 3.0043,
        2.0958, 3.5811, 1.9984, 3.1412, 2.7569, 2.5018, 2.4961, 2.5530, 2.3733,
        2.3421, 1.8132, 2.4319, 2.0355, 3.3063, 2.2163, 2.0655, 1.9716, 1.9635,
        2.4816, 1.8511, 1.8499, 1.8241, 2.3205, 1.6599, 1.8618, 1.7380, 1.7938,
        1.8324, 1.8889, 1.7808, 1.6866, 1.6580, 1.6313, 1.5959, 1.6858, 1.6483,
        1.8476, 1.6628, 1.5216, 1.6335, 1.7915, 1.5037, 1.5481, 1.5260, 1.6622,
        1.7704], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.3253968253968254, middle:0.22340425531914893, tail0.125
3shot of client 1:head:0.4418145956607495, middle:0.0234375, tail0.06060606060606061
3shot of client 2:head:0.3926174496644295, middle:0.06578947368421052, tail0.0
3shot of client 3:head:0.43243243243243246, middle:0.21428571428571427, tail0.0
3shot of client 4:head:0.4016393442622951, middle:0.0782608695652174, tail0.0
3shot of client 5:head:0.3776908023483366, middle:0.04, tail0.15625
3shot of client 6:head:0.29931972789115646, middle:0.09333333333333334, tail0.0
3shot of client 7:head:0.2708333333333333, middle:0.08695652173913043, tail0.08333333333333333
3shot of client 8:head:0.3348519362186788, middle:0.08547008547008547, tail0.038461538461538464
3shot of client 9:head:0.3745019920318725, middle:0.07352941176470588, tail0.0
3shot of client 10:head:0.4245810055865922, middle:0.10465116279069768, tail0.0
3shot of client 11:head:0.5270655270655271, middle:0.045454545454545456, tail0.0
3shot of client 12:head:0.40804597701149425, middle:0.10714285714285714, tail0.0
3shot of client 13:head:0.49074074074074076, middle:0.1411764705882353, tail0.0
3shot of client 14:head:0.3719676549865229, middle:0.06315789473684211, tail0.041666666666666664
3shot of client 15:head:0.32142857142857145, middle:0.16129032258064516, tail0.0
3shot of client 16:head:0.27702702702702703, middle:0.11764705882352941, tail0.05555555555555555
3shot of client 17:head:0.37542662116040953, middle:0.1111111111111111, tail0.058823529411764705
3shot of client 18:head:0.5661764705882353, middle:0.18571428571428572, tail0.0
3shot of client 19:head:0.39057239057239057, middle:0.175, tail0.17647058823529413
round 13, local average test acc  0.3199 

round 13, local macro average F1 score  0.1085 

round 13, local weighted average F1 score  0.2776 

round 13, global test acc  0.0797 

round 13, average 3shot acc: [head: 0.3902, middle: 0.1098, tail: 0.0398] 

round 13, global 3shot acc: [head: 0.2419, middle: 0.0535, tail: 0.0011] 

l_head tensor([4.5016, 2.8425, 4.2226, 0.5944, 5.7846, 6.7891, 6.2272, 1.2849, 7.8705,
        1.8630, 2.3677, 7.6043, 3.6605, 1.7045, 7.4651, 4.2809, 1.8299, 2.7610,
        0.5704, 2.6866, 0.5833, 2.1413, 2.9678, 4.6003, 3.1183, 2.2700, 3.9650,
        7.3262, 0.5773, 3.9475, 2.0634, 0.5875, 1.8267, 0.5837, 6.7209, 3.8537,
        3.9479, 1.4465, 5.4525, 0.5674, 2.1431, 0.5809, 0.6059, 0.5732, 1.2758,
        3.6513, 0.5519, 0.5711, 2.3680, 0.5805, 0.5680, 0.5642, 0.5676, 0.5902,
        1.5913, 0.5893, 1.7787, 2.0174, 0.5923, 0.5799, 1.7867, 0.5719, 2.5845,
        0.5882, 1.5550, 2.3567, 0.5878, 0.5846, 0.5933, 0.5848, 0.5813, 0.5939,
        0.5829, 0.5866, 1.2676, 0.5874, 0.5713, 1.2031, 0.5767, 0.5891, 0.5729,
        0.5621, 2.2246, 0.5596, 0.5827, 0.5811, 1.3003, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 1.7377, 1.4738, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head 
  3%|▎         | 14/500 [48:20<27:28:39, 203.54s/it]
  3%|▎         | 15/500 [51:44<27:25:23, 203.55s/it]tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([5.3340, 5.2048, 4.8393, 4.9321, 4.3690, 4.8183, 5.2329, 5.2899, 5.3137,
        4.8568, 5.2287, 4.8363, 4.5318, 4.0115, 5.9055, 4.7307, 5.0480, 4.2523,
        5.0287, 4.4865, 4.3379, 4.4213, 5.2192, 4.7081, 4.7112, 4.2680, 3.8791,
        4.2611, 4.5024, 3.3908, 4.1259, 3.8757, 3.7927, 3.4160, 4.2221, 3.4139,
        3.1389, 3.7679, 3.3852, 3.9575, 2.6546, 3.2401, 3.9652, 2.9733, 2.4125,
        2.6649, 3.0151, 3.4919, 2.6528, 3.3768, 2.3190, 2.0593, 2.1624, 3.2668,
        2.3290, 3.6476, 2.2130, 3.4068, 2.9645, 2.6913, 2.7772, 2.6968, 2.5263,
        2.6140, 1.9995, 2.6153, 2.2159, 3.5387, 2.2937, 2.2855, 2.1904, 2.3029,
        2.7215, 2.0551, 2.0056, 1.8591, 2.5674, 1.7646, 2.0111, 1.9636, 2.0024,
        2.0342, 2.0266, 2.0349, 2.0578, 1.9262, 1.8126, 1.8486, 2.0656, 1.7113,
        2.0161, 1.7770, 1.7655, 1.7526, 1.8400, 1.6057, 1.7304, 1.8012, 1.8754,
        2.0355], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.30423280423280424, middle:0.30851063829787234, tail0.0
3shot of client 1:head:0.43984220907297833, middle:0.0390625, tail0.030303030303030304
3shot of client 2:head:0.4563758389261745, middle:0.06578947368421052, tail0.0
3shot of client 3:head:0.4386694386694387, middle:0.1984126984126984, tail0.0
3shot of client 4:head:0.45491803278688525, middle:0.06086956521739131, tail0.034482758620689655
3shot of client 5:head:0.27984344422700586, middle:0.064, tail0.125
3shot of client 6:head:0.3231292517006803, middle:0.13333333333333333, tail0.0
3shot of client 7:head:0.234375, middle:0.06521739130434782, tail0.08333333333333333
3shot of client 8:head:0.37813211845102507, middle:0.05982905982905983, tail0.038461538461538464
3shot of client 9:head:0.250996015936255, middle:0.1323529411764706, tail0.0
3shot of client 10:head:0.36033519553072624, middle:0.05813953488372093, tail0.0
3shot of client 11:head:0.46153846153846156, middle:0.03409090909090909, tail0.043478260869565216
3shot of client 12:head:0.4454022988505747, middle:0.09523809523809523, tail0.047619047619047616
3shot of client 13:head:0.4783950617283951, middle:0.12941176470588237, tail0.0
3shot of client 14:head:0.4716981132075472, middle:0.11578947368421053, tail0.0
3shot of client 15:head:0.30952380952380953, middle:0.22580645161290322, tail0.0625
3shot of client 16:head:0.3885135135135135, middle:0.04411764705882353, tail0.05555555555555555
3shot of client 17:head:0.3651877133105802, middle:0.06944444444444445, tail0.23529411764705882
3shot of client 18:head:0.5661764705882353, middle:0.14285714285714285, tail0.0
3shot of client 19:head:0.4276094276094276, middle:0.125, tail0.17647058823529413
round 14, local average test acc  0.3213 

round 14, local macro average F1 score  0.1155 

round 14, local weighted average F1 score  0.2876 

round 14, global test acc  0.0799 

round 14, average 3shot acc: [head: 0.3917, middle: 0.1084, tail: 0.0466] 

round 14, global 3shot acc: [head: 0.2256, middle: 0.0546, tail: 0.0102] 

l_head tensor([4.6540, 2.8899, 4.2048, 0.5944, 6.0130, 6.9532, 6.4668, 1.2983, 8.1338,
        2.0670, 2.5394, 8.0727, 3.8952, 2.0366, 7.6415, 4.4937, 1.9543, 2.6985,
        0.5704, 2.9318, 0.5833, 2.1701, 3.2621, 4.8048, 3.2592, 2.2961, 4.3014,
        7.6102, 0.5773, 4.1610, 2.1749, 0.5875, 1.8672, 0.5837, 7.0446, 4.1333,
        4.1916, 1.4948, 5.6437, 0.5674, 2.3684, 0.5809, 0.6059, 0.5732, 1.3706,
        3.8878, 0.5519, 0.5711, 2.4638, 0.5805, 0.5680, 0.5642, 0.5676, 0.5902,
        1.5734, 0.5893, 1.8424, 2.0812, 0.5923, 0.5799, 1.8890, 0.5719, 2.8156,
        0.5882, 1.5950, 2.6400, 0.5878, 0.5846, 0.5933, 0.5848, 0.5813, 0.5939,
        0.5829, 0.5866, 1.3371, 0.5874, 0.5713, 1.2495, 0.5767, 0.5891, 0.5729,
        0.5621, 2.4520, 0.5596, 0.5827, 0.5811, 1.3903, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 1.8271, 1.4864, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([5.6649, 5.3854, 5.0250, 5.1721, 4.5658, 4.9594, 5.4271, 5.5255, 5.5457,
        5.0878, 5.4551, 5.0360, 4.8701, 4.1248, 6.2151, 4.9376, 5.2034, 4.5021,
        5.2889, 4.6684, 4.5584, 4.6437, 5.6077, 4.9028, 4.9063, 4.5037, 4.0464,
        4.3555, 4.6503, 3.5498, 4.3452, 4.1393, 3.9930, 3.5969, 4.4230, 3.6204,
        3.4545, 4.0633, 3.6075, 4.0872, 2.9794, 3.3848, 4.2321, 3.1894, 2.6464,
        2.8920, 3.2191, 3.6693, 2.8087, 3.5816, 2.5785, 2.1984, 2.4003, 3.4417,
        2.4695, 3.9171, 2.3507, 3.6220, 3.0764, 2.8736, 3.0430, 2.9110, 2.6480,
        2.7243, 2.1750, 2.8535, 2.5158, 3.9622, 2.6389, 2.4558, 2.3418, 2.2827,
        2.9547, 2.2942, 2.1664, 2.0932, 2.7803, 1.9188, 2.1355, 2.1386, 2.0825,
        2.1812, 2.2732, 2.2626, 2.1707, 2.1333, 1.9858, 1.9351, 2.2631, 1.9975,
        2.2247, 1.9037, 1.8531, 1.9022, 2.0644, 1.8557, 1.8904, 1.9486, 2.0083,
        2.2966], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.3148148148148148, middle:0.2765957446808511, tail0.041666666666666664
3shot of client 1:head:0.43984220907297833, middle:0.15625, tail0.0
3shot of client 2:head:0.3422818791946309, middle:0.10526315789473684, tail0.0
3shot of client 3:head:0.48232848232848236, middle:0.24603174603174602, tail0.0
3shot of client 4:head:0.4323770491803279, middle:0.08695652173913043, tail0.0
3shot of client 5:head:0.34442270058708413, middle:0.072, tail0.0625
3shot of client 6:head:0.3299319727891156, middle:0.17333333333333334, tail0.05263157894736842
3shot of client 7:head:0.2552083333333333, middle:0.10869565217391304, tail0.08333333333333333
3shot of client 8:head:0.4054669703872437, middle:0.05982905982905983, tail0.07692307692307693
3shot of client 9:head:0.24701195219123506, middle:0.10294117647058823, tail0.0
3shot of client 10:head:0.44972067039106145, middle:0.11627906976744186, tail0.0
3shot of client 11:head:0.5470085470085471, middle:0.045454545454545456, tail0.0
3shot of client 12:head:0.39655172413793105, middle:0.09523809523809523, tail0.047619047619047616
3shot of client 13:head:0.5370370370370371, middle:0.11764705882352941, tail0.05
3shot of client 14:head:0.4474393530997305, middle:0.08421052631578947, tail0.0
3shot of client 15:head:0.3531746031746032, middle:0.1774193548387097, tail0.0625
3shot of client 16:head:0.3716216216216216, middle:0.10294117647058823, tail0.0

  3%|▎         | 16/500 [55:08<27:22:45, 203.65s/it]3shot of client 17:head:0.3822525597269625, middle:0.16666666666666666, tail0.058823529411764705
3shot of client 18:head:0.5661764705882353, middle:0.2, tail0.0
3shot of client 19:head:0.45791245791245794, middle:0.2, tail0.11764705882352941
round 15, local average test acc  0.3358 

round 15, local macro average F1 score  0.1238 

round 15, local weighted average F1 score  0.3000 

round 15, global test acc  0.0876 

round 15, average 3shot acc: [head: 0.4051, middle: 0.1347, tail: 0.0327] 

round 15, global 3shot acc: [head: 0.2541, middle: 0.0569, tail: 0.0089] 

l_head tensor([4.6382, 3.1692, 4.4442, 0.5944, 6.2924, 7.2106, 6.8348, 1.5190, 8.2964,
        2.2042, 2.6982, 8.2972, 4.0922, 2.2422, 8.0199, 4.6147, 2.0762, 2.8620,
        0.5704, 3.0086, 0.5833, 2.3752, 3.3232, 4.9592, 3.5069, 2.3813, 4.4897,
        7.8118, 0.5773, 4.3204, 2.2394, 0.5875, 1.8861, 0.5837, 7.0317, 4.3376,
        4.3636, 1.6089, 5.8570, 0.5674, 2.4163, 0.5809, 0.6059, 0.5732, 1.5093,
        4.0715, 0.5519, 0.5711, 2.6093, 0.5805, 0.5680, 0.5642, 0.5676, 0.5902,
        1.7141, 0.5893, 1.9596, 2.3027, 0.5923, 0.5799, 2.0112, 0.5719, 2.8264,
        0.5882, 1.7150, 2.7836, 0.5878, 0.5846, 0.5933, 0.5848, 0.5813, 0.5939,
        0.5829, 0.5866, 1.3770, 0.5874, 0.5713, 1.3487, 0.5767, 0.5891, 0.5729,
        0.5621, 2.6944, 0.5596, 0.5827, 0.5811, 1.5315, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 2.0049, 1.5418, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([5.8383, 5.5754, 5.2377, 5.3526, 4.7144, 5.1006, 5.7206, 5.7360, 5.7205,
        5.3231, 5.6859, 5.2386, 5.0609, 4.3765, 6.5291, 5.1668, 5.4070, 4.7431,
        5.5142, 4.8948, 4.7645, 4.8562, 5.7904, 5.2376, 5.1001, 4.6822, 4.2804,
        4.5599, 4.8408, 3.7792, 4.6262, 4.3552, 4.2296, 3.9057, 4.5945, 3.8301,
        3.5989, 4.2900, 3.7423, 4.2586, 3.1425, 3.5423, 4.3970, 3.3511, 2.8879,
        3.1268, 3.3961, 3.9224, 3.0656, 3.8277, 2.6835, 2.4255, 2.5190, 3.7833,
        2.6271, 4.2358, 2.5923, 3.8298, 3.3930, 2.9890, 3.1780, 3.1221, 2.8270,
        2.8839, 2.2840, 3.1090, 2.8047, 4.1569, 2.8303, 2.7120, 2.5045, 2.5842,
        3.2099, 2.4917, 2.3642, 2.1918, 3.0627, 2.0292, 2.3820, 2.2880, 2.2786,
        2.4982, 2.4084, 2.3266, 2.4704, 2.3019, 2.1481, 2.1384, 2.4187, 2.1739,
        2.4730, 2.1713, 2.0386, 2.1825, 2.2825, 2.0792, 2.0856, 2.0995, 2.2592,
        2.4092], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.3201058201058201, middle:0.2553191489361702, tail0.041666666666666664
3shot of client 1:head:0.4358974358974359, middle:0.15625, tail0.0
3shot of client 2:head:0.31543624161073824, middle:0.09210526315789473, tail0.05555555555555555
3shot of client 3:head:0.40124740124740127, middle:0.2698412698412698, tail0.0
3shot of client 4:head:0.430327868852459, middle:0.1391304347826087, tail0.10344827586206896
3shot of client 5:head:0.350293542074364, middle:0.032, tail0.09375
3shot of client 6:head:0.3435374149659864, middle:0.14666666666666667, tail0.10526315789473684
3shot of client 7:head:0.3229166666666667, middle:0.15217391304347827, tail0.16666666666666666
3shot of client 8:head:0.428246013667426, middle:0.05982905982905983, tail0.038461538461538464
3shot of client 9:head:0.28286852589641437, middle:0.1323529411764706, tail0.0
3shot of client 10:head:0.44972067039106145, middle:0.05813953488372093, tail0.0
3shot of client 11:head:0.5042735042735043, middle:0.09090909090909091, tail0.0
3shot of client 12:head:0.4425287356321839, middle:0.10714285714285714, tail0.047619047619047616
3shot of client 13:head:0.44753086419753085, middle:0.12941176470588237, tail0.05
3shot of client 14:head:0.3881401617250674, middle:0.1368421052631579, tail0.041666666666666664
3shot of client 15:head:0.2619047619047619, middle:0.16129032258064516, tail0.1875
3shot of client 16:head:0.375, middle:0.058823529411764705, tail0.0
3shot of client 17:head:0.3651877133105802, middle:0.19444444444444445, tail0.058823529411764705
3shot of client 18:head:0.5588235294117647, middle:0.2, tail0.0
3shot of client 19:head:0.45791245791245794, middle:0.1375, tail0.11764705882352941
round 16, local average test acc  0.3287 

round 16, local macro average F1 score  0.1258 

round 16, local weighted average F1 score  0.2971 

round 16, global test acc  0.0961 

round 16, average 3shot acc: [head: 0.3941, middle: 0.1355, tail: 0.0554] 

round 16, global 3shot acc: [head: 0.2596, middle: 0.0869, tail: 0.0072] 

l_head tensor([4.8274, 3.3589, 4.5798, 0.5944, 6.5606, 7.3784, 7.0060, 1.4903, 8.5179,
        2.4141, 2.9546, 8.6929, 4.0926, 2.4217, 8.3604, 4.9191, 2.1623, 3.1694,
        0.5704, 3.2699, 0.5833, 2.6464, 3.5066, 5.1741, 3.5264, 2.5047, 4.6430,
        8.1359, 0.5773, 4.7129, 2.2695, 0.5875, 2.0423, 0.5837, 7.1339, 4.6406,
        4.5609, 1.6391, 6.2926, 0.5674, 2.4936, 0.5809, 0.6059, 0.5732, 1.5309,
        4.3305, 0.5519, 0.5711, 2.8744, 0.5805, 0.5680, 0.5642, 0.5676, 0.5902,
        1.7963, 0.5893, 2.1195, 2.3991, 0.5923, 0.5799, 2.0601, 0.5719, 3.0670,
        0.5882, 1.8098, 2.9203, 0.5878, 0.5846, 0.5933, 0.5848, 0.5813, 0.5939,
        0.5829, 0.5866, 1.4376, 0.5874, 0.5713, 1.4779, 0.5767, 0.5891, 0.5729,
        0.5621, 2.9408, 0.5596, 0.5827, 0.5811, 1.6197, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 1.9779, 1.3885, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux 
  3%|▎         | 17/500 [58:31<27:18:09, 203.50s/it]
  4%|▎         | 18/500 [1:01:55<27:15:54, 203.64s/it]tensor([6.0314, 5.7442, 5.4653, 5.5639, 4.8649, 5.3382, 5.8680, 5.9031, 5.8725,
        5.5356, 5.8308, 5.4878, 5.2684, 4.5744, 6.7689, 5.3920, 5.7732, 5.0304,
        5.7127, 5.2012, 4.9066, 5.0536, 6.0257, 5.4315, 5.3965, 4.9085, 4.5089,
        4.9067, 5.1378, 4.0758, 4.8918, 4.6899, 4.4157, 4.1243, 4.8582, 4.0640,
        3.8122, 4.6000, 3.9780, 4.3742, 3.2937, 3.8954, 4.7270, 3.5407, 3.0668,
        3.3324, 3.6776, 4.1104, 3.2636, 4.1662, 2.9071, 2.6113, 2.8327, 3.9523,
        2.8338, 4.4660, 2.8858, 4.0588, 3.5833, 3.2547, 3.3911, 3.3234, 2.9982,
        3.0920, 2.5037, 3.3294, 2.9567, 4.3253, 3.0306, 2.9970, 2.7112, 2.7911,
        3.2865, 2.6843, 2.6618, 2.3543, 3.1360, 2.3010, 2.5019, 2.4149, 2.4280,
        2.6838, 2.4631, 2.5445, 2.5437, 2.4927, 2.3538, 2.4064, 2.6601, 2.3481,
        2.6707, 2.4517, 2.2099, 2.3918, 2.4828, 2.3609, 2.2964, 2.3511, 2.3983,
        2.6147], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.35978835978835977, middle:0.2872340425531915, tail0.125
3shot of client 1:head:0.4378698224852071, middle:0.09375, tail0.0
3shot of client 2:head:0.4261744966442953, middle:0.11842105263157894, tail0.0
3shot of client 3:head:0.4407484407484408, middle:0.3968253968253968, tail0.0
3shot of client 4:head:0.5163934426229508, middle:0.06086956521739131, tail0.0
3shot of client 5:head:0.4227005870841487, middle:0.048, tail0.21875
3shot of client 6:head:0.30612244897959184, middle:0.14666666666666667, tail0.05263157894736842
3shot of client 7:head:0.265625, middle:0.15217391304347827, tail0.25
3shot of client 8:head:0.4214123006833713, middle:0.07692307692307693, tail0.07692307692307693
3shot of client 9:head:0.26294820717131473, middle:0.08823529411764706, tail0.06666666666666667
3shot of client 10:head:0.4553072625698324, middle:0.10465116279069768, tail0.0
3shot of client 11:head:0.5356125356125356, middle:0.07954545454545454, tail0.08695652173913043
3shot of client 12:head:0.5201149425287356, middle:0.07142857142857142, tail0.0
3shot of client 13:head:0.4845679012345679, middle:0.18823529411764706, tail0.1
3shot of client 14:head:0.5606469002695418, middle:0.08421052631578947, tail0.08333333333333333
3shot of client 15:head:0.373015873015873, middle:0.14516129032258066, tail0.0625
3shot of client 16:head:0.3716216216216216, middle:0.04411764705882353, tail0.0
3shot of client 17:head:0.378839590443686, middle:0.18055555555555555, tail0.11764705882352941
3shot of client 18:head:0.5882352941176471, middle:0.17142857142857143, tail0.11764705882352941
3shot of client 19:head:0.468013468013468, middle:0.1875, tail0.17647058823529413
round 17, local average test acc  0.3572 

round 17, local macro average F1 score  0.1454 

round 17, local weighted average F1 score  0.3230 

round 17, global test acc  0.1049 

round 17, average 3shot acc: [head: 0.4298, middle: 0.1363, tail: 0.0767] 

round 17, global 3shot acc: [head: 0.2789, middle: 0.1035, tail: 0.0057] 

l_head tensor([4.9955, 3.4664, 4.8270, 0.5944, 6.6970, 7.6054, 7.3923, 1.5279, 8.5752,
        2.3867, 3.1028, 8.9491, 4.2794, 2.4238, 8.4903, 5.0641, 2.2441, 3.2818,
        0.5704, 3.4451, 0.5833, 2.7836, 3.6492, 5.4108, 3.6329, 2.6413, 4.9091,
        8.4825, 0.5773, 4.9061, 2.4543, 0.5875, 2.1465, 0.5837, 7.5086, 4.7403,
        4.8260, 1.7808, 6.4866, 0.5674, 2.5283, 0.5809, 0.6059, 0.5732, 1.6618,
        4.6913, 0.5519, 0.5711, 3.0274, 0.5805, 0.5680, 0.5642, 0.5676, 0.5902,
        2.0134, 0.5893, 2.2702, 2.6015, 0.5923, 0.5799, 2.2449, 0.5719, 3.2057,
        0.5882, 1.9726, 3.3572, 0.5878, 0.5846, 0.5933, 0.5848, 0.5813, 0.5939,
        0.5829, 0.5866, 1.4519, 0.5874, 0.5713, 1.6727, 0.5767, 0.5891, 0.5729,
        0.5621, 3.1593, 0.5596, 0.5827, 0.5811, 1.6960, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 2.1811, 1.5163, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([6.2459, 6.0421, 5.6423, 5.7885, 5.1352, 5.5583, 6.1728, 6.1244, 6.1044,
        5.7426, 6.0462, 5.7217, 5.4765, 4.8622, 6.9350, 5.7239, 5.8551, 5.2645,
        6.0578, 5.3861, 5.2706, 5.2101, 6.2268, 5.8107, 5.6415, 5.0852, 4.7075,
        5.0346, 5.4331, 4.2016, 5.0853, 4.9982, 4.7121, 4.3128, 5.0517, 4.2692,
        4.0130, 4.8405, 4.2303, 4.7637, 3.4594, 4.0698, 4.9334, 3.7891, 3.1910,
        3.5935, 3.8753, 4.3954, 3.4999, 4.4433, 3.1002, 2.7854, 3.0361, 4.0246,
        3.0114, 4.6714, 3.0371, 4.3758, 3.6976, 3.5679, 3.6297, 3.5862, 3.1214,
        3.3962, 2.7310, 3.5426, 3.1058, 4.7346, 3.2475, 3.2383, 2.9086, 3.0256,
        3.5185, 2.8955, 2.8504, 2.8592, 3.3783, 2.5177, 2.6444, 2.6582, 2.6516,
        2.9172, 2.7397, 2.7213, 2.7143, 2.8019, 2.5586, 2.6628, 2.8089, 2.5169,
        2.8110, 2.5826, 2.3995, 2.6255, 2.6650, 2.4977, 2.5056, 2.6154, 2.6200,
        2.8409], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.3439153439153439, middle:0.32978723404255317, tail0.08333333333333333
3shot of client 1:head:0.4437869822485207, middle:0.125, tail0.0
3shot of client 2:head:0.47315436241610737, middle:0.10526315789473684, tail0.0
3shot of client 3:head:0.4303534303534304, middle:0.3492063492063492, tail0.0
3shot of client 4:head:0.5, middle:0.11304347826086956, tail0.034482758620689655
3shot of client 5:head:0.3698630136986301, middle:0.056, tail0.1875
3shot of client 6:head:0.3231292517006803, middle:0.14666666666666667, tail0.0
3shot of client 7:head:0.3229166666666667, middle:0.17391304347826086, tail0.0
3shot of client 8:head:0.4510250569476082, middle:0.15384615384615385, tail0.0
3shot of client 9:head:0.3386454183266932, middle:0.17647058823529413, tail0.13333333333333333
3shot of client 10:head:0.5279329608938548, middle:0.08139534883720931, tail0.045454545454545456
3shot of client 11:head:0.5299145299145299, middle:0.056818181818181816, tail0.043478260869565216
3shot of client 12:head:0.5, middle:0.10714285714285714, tail0.047619047619047616
3shot of client 13:head:0.5185185185185185, middle:0.15294117647058825, tail0.1
3shot of client 14:head:0.49595687331536387, middle:0.09473684210526316, tail0.08333333333333333
3shot of client 15:head:0.3253968253968254, middle:0.1935483870967742, tail0.0625
3shot of client 16:head:0.3918918918918919, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.4197952218430034, middle:0.1388888888888889, tail0.058823529411764705
3shot of client 18:head:0.5294117647058824, middle:0.14285714285714285, tail0.11764705882352941
3shot of client 19:head:0.4983164983164983, middle:0.2125, tail0.11764705882352941
round 18, local average test acc  0.3634 

round 18, local macro average F1 score  0.1468 

round 18, local weighted average F1 score  0.3335 

round 18, global test acc  0.1071 

round 18, average 3shot acc: [head: 0.4367, middle: 0.1462, tail: 0.0558] 

round 18, global 3shot acc: [head: 0.2807, middle: 0.0981, tail: 0.0123] 

l_head 
  4%|▍         | 19/500 [1:05:19<27:13:05, 203.71s/it]
  4%|▍         | 20/500 [1:08:42<27:08:46, 203.60s/it]tensor([4.9273, 3.7492, 5.0842, 0.5944, 6.7622, 7.8667, 7.7211, 1.6047, 8.7966,
        2.5000, 3.3375, 9.2292, 4.5410, 2.5005, 8.8052, 5.4354, 2.6099, 3.3132,
        0.5704, 3.6076, 0.5833, 2.9107, 3.7375, 5.6975, 3.6420, 2.8288, 5.2287,
        8.8370, 0.5773, 5.1089, 2.5544, 0.5875, 2.2570, 0.5837, 7.8054, 5.1681,
        4.8905, 1.8640, 6.6747, 0.5674, 2.6934, 0.5809, 0.6059, 0.5732, 1.7267,
        4.9304, 0.5519, 0.5711, 3.0843, 0.5805, 0.5680, 0.5642, 0.5676, 0.5902,
        2.0943, 0.5893, 2.3932, 2.7117, 0.5923, 0.5799, 2.4021, 0.5719, 3.4038,
        0.5882, 1.9924, 3.5329, 0.5878, 0.5846, 0.5933, 0.5848, 0.5813, 0.5939,
        0.5829, 0.5866, 1.6157, 0.5874, 0.5713, 1.6494, 0.5767, 0.5891, 0.5729,
        0.5621, 3.3453, 0.5596, 0.5827, 0.5811, 1.7951, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 2.3547, 1.7249, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([6.5122, 6.2697, 5.8475, 5.9380, 5.3061, 5.7409, 6.2633, 6.2895, 6.2419,
        6.0167, 6.2482, 5.9420, 5.7261, 5.0118, 7.2076, 5.9937, 6.1149, 5.4517,
        6.2915, 5.7433, 5.4502, 5.5972, 6.4102, 5.9931, 5.8544, 5.2546, 4.8755,
        5.3443, 5.5390, 4.4733, 5.2779, 5.1392, 4.9332, 4.5806, 5.3680, 4.5889,
        4.1501, 5.1601, 4.3999, 4.9112, 3.8055, 4.3052, 5.2355, 4.0441, 3.5177,
        3.7900, 4.0696, 4.5518, 3.7227, 4.5466, 3.3996, 3.0227, 3.2449, 4.3671,
        3.3205, 5.1121, 3.2989, 4.5257, 3.9445, 3.8219, 3.7954, 3.8233, 3.4612,
        3.5703, 2.9277, 3.6671, 3.4459, 4.9276, 3.4126, 3.5059, 3.0989, 3.2909,
        3.7640, 3.0925, 3.0417, 2.9447, 3.6300, 2.7322, 2.9839, 2.9612, 2.8901,
        2.9875, 2.9920, 2.9269, 2.9922, 2.8345, 2.7306, 2.7580, 3.0188, 2.7548,
        3.0093, 2.7521, 2.6282, 2.8111, 2.9155, 2.6461, 2.6459, 2.6375, 2.9226,
        2.9627], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.37566137566137564, middle:0.26595744680851063, tail0.125
3shot of client 1:head:0.4437869822485207, middle:0.28125, tail0.0
3shot of client 2:head:0.5100671140939598, middle:0.14473684210526316, tail0.0
3shot of client 3:head:0.48232848232848236, middle:0.29365079365079366, tail0.0
3shot of client 4:head:0.5655737704918032, middle:0.0782608695652174, tail0.06896551724137931
3shot of client 5:head:0.3796477495107632, middle:0.048, tail0.0625
3shot of client 6:head:0.35714285714285715, middle:0.14666666666666667, tail0.05263157894736842
3shot of client 7:head:0.328125, middle:0.17391304347826086, tail0.16666666666666666
3shot of client 8:head:0.46924829157175396, middle:0.07692307692307693, tail0.038461538461538464
3shot of client 9:head:0.22709163346613545, middle:0.11764705882352941, tail0.0
3shot of client 10:head:0.4860335195530726, middle:0.13953488372093023, tail0.0
3shot of client 11:head:0.5669515669515669, middle:0.14772727272727273, tail0.043478260869565216
3shot of client 12:head:0.5373563218390804, middle:0.08333333333333333, tail0.09523809523809523
3shot of client 13:head:0.5339506172839507, middle:0.12941176470588237, tail0.05
3shot of client 14:head:0.40431266846361186, middle:0.10526315789473684, tail0.041666666666666664
3shot of client 15:head:0.373015873015873, middle:0.1935483870967742, tail0.25
3shot of client 16:head:0.39864864864864863, middle:0.07352941176470588, tail0.05555555555555555
3shot of client 17:head:0.3924914675767918, middle:0.2222222222222222, tail0.0
3shot of client 18:head:0.625, middle:0.21428571428571427, tail0.058823529411764705
3shot of client 19:head:0.47474747474747475, middle:0.2875, tail0.11764705882352941
round 19, local average test acc  0.3740 

round 19, local macro average F1 score  0.1509 

round 19, local weighted average F1 score  0.3420 

round 19, global test acc  0.1133 

round 19, average 3shot acc: [head: 0.4466, middle: 0.1612, tail: 0.0613] 

round 19, global 3shot acc: [head: 0.2778, middle: 0.1104, tail: 0.0204] 

l_head tensor([5.1606, 4.0844, 5.3193, 0.5944, 6.9064, 8.2361, 7.7937, 1.7001, 9.1761,
        2.5822, 3.3568, 9.6288, 4.5684, 2.7360, 9.1219, 5.6121, 2.5737, 3.6504,
        0.5704, 3.8974, 0.5833, 3.1118, 3.8551, 5.8084, 3.8261, 3.0352, 5.4306,
        9.0727, 0.5773, 5.2760, 2.7008, 0.5875, 2.4349, 0.5837, 8.0590, 5.3023,
        4.9835, 1.9393, 6.8083, 0.5674, 2.7819, 0.5809, 0.6059, 0.5732, 1.8514,
        5.0708, 0.5519, 0.5711, 3.3511, 0.5805, 0.5680, 0.5642, 0.5676, 0.5902,
        2.1035, 0.5893, 2.5959, 2.8177, 0.5923, 0.5799, 2.4909, 0.5719, 3.5173,
        0.5882, 2.1233, 3.5764, 0.5878, 0.5846, 0.5933, 0.5848, 0.5813, 0.5939,
        0.5829, 0.5866, 1.5790, 0.5874, 0.5713, 1.7675, 0.5767, 0.5891, 0.5729,
        0.5621, 3.4956, 0.5596, 0.5827, 0.5811, 1.9438, 0.5977, 0.5664, 0.5796,
        0.5959, 0.5712, 0.5848, 0.6012, 0.5539, 2.4433, 1.8013, 0.5679, 0.5981,
        0.5859], device='cuda:2', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([6.8660, 6.4628, 6.1251, 6.0927, 5.4623, 5.9443, 6.3908, 6.4125, 6.5252,
        6.2775, 6.5400, 6.2057, 5.9266, 5.1323, 7.4238, 6.2600, 6.3515, 5.7858,
        6.5045, 6.0365, 5.5773, 5.8681, 6.5449, 6.2293, 6.1588, 5.4195, 5.0631,
        5.5507, 5.6940, 4.6308, 5.5750, 5.3781, 5.1148, 4.8992, 5.4926, 4.7769,
        4.3652, 5.3836, 4.7328, 5.2685, 4.0524, 4.4194, 5.4936, 4.3336, 3.7284,
        3.9532, 4.4550, 4.9566, 3.9907, 4.8732, 3.5514, 3.2760, 3.3476, 4.5922,
        3.5686, 5.2685, 3.4527, 4.8869, 4.1694, 3.9853, 4.0600, 4.0382, 3.7282,
        4.0210, 3.2051, 4.0592, 3.5916, 5.2313, 3.6974, 3.6908, 3.3734, 3.5950,
        3.8669, 3.3631, 3.2132, 3.1882, 3.9743, 2.8178, 3.1177, 3.0861, 3.2129,
        3.3143, 3.3006, 3.0720, 3.2350, 3.1974, 2.9151, 3.0075, 3.3473, 3.0968,
        3.3077, 2.8950, 2.9178, 2.9751, 3.1150, 2.8885, 2.9398, 2.9453, 3.2630,
        3.2257], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.41534391534391535, middle:0.1702127659574468, tail0.16666666666666666
3shot of client 1:head:0.4477317554240631, middle:0.1875, tail0.0
3shot of client 2:head:0.5067114093959731, middle:0.19736842105263158, tail0.05555555555555555
3shot of client 3:head:0.5343035343035343, middle:0.2857142857142857, tail0.06666666666666667
3shot of client 4:head:0.5635245901639344, middle:0.09565217391304348, tail0.034482758620689655

  4%|▍         | 21/500 [1:12:05<27:04:58, 203.55s/it]3shot of client 5:head:0.36007827788649704, middle:0.016, tail0.125
3shot of client 6:head:0.35034013605442177, middle:0.17333333333333334, tail0.0
3shot of client 7:head:0.328125, middle:0.1956521739130435, tail0.08333333333333333
3shot of client 8:head:0.489749430523918, middle:0.1282051282051282, tail0.07692307692307693
3shot of client 9:head:0.4262948207171315, middle:0.19117647058823528, tail0.0
3shot of client 10:head:0.46368715083798884, middle:0.09302325581395349, tail0.0
3shot of client 11:head:0.49002849002849, middle:0.1590909090909091, tail0.0
3shot of client 12:head:0.5431034482758621, middle:0.19047619047619047, tail0.0
3shot of client 13:head:0.5895061728395061, middle:0.2, tail0.05
3shot of client 14:head:0.5094339622641509, middle:0.12631578947368421, tail0.125
3shot of client 15:head:0.38095238095238093, middle:0.25806451612903225, tail0.0
3shot of client 16:head:0.3277027027027027, middle:0.19117647058823528, tail0.0
3shot of client 17:head:0.4539249146757679, middle:0.1111111111111111, tail0.058823529411764705
3shot of client 18:head:0.6139705882352942, middle:0.24285714285714285, tail0.058823529411764705
3shot of client 19:head:0.4983164983164983, middle:0.2125, tail0.11764705882352941
round 20, local average test acc  0.3890 

round 20, local macro average F1 score  0.1599 

round 20, local weighted average F1 score  0.3583 

round 20, global test acc  0.1299 

round 20, average 3shot acc: [head: 0.4646, middle: 0.1713, tail: 0.0509] 

round 20, global 3shot acc: [head: 0.3126, middle: 0.1212, tail: 0.0298] 

l_head tensor([ 5.4080,  4.2509,  5.4586,  0.5944,  7.1991,  8.3727,  8.1172,  1.8060,
         9.4415,  2.6656,  3.5492, 10.0523,  4.7981,  2.6736,  9.2850,  5.9285,
         2.6339,  3.7425,  0.5704,  4.0769,  0.5833,  3.2038,  4.1436,  5.9826,
         4.0123,  3.0581,  5.5106,  9.2795,  0.5773,  5.4862,  2.8901,  0.5875,
         2.6504,  0.5837,  8.2017,  5.4488,  5.3058,  1.9635,  7.1014,  0.5674,
         2.9034,  0.5809,  0.6059,  0.5732,  1.9855,  5.3982,  0.5519,  0.5711,
         3.5455,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  2.3335,  0.5893,
         2.8122,  2.8963,  0.5923,  0.5799,  2.5759,  0.5719,  3.7242,  0.5882,
         2.1958,  3.6492,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  1.6634,  0.5874,  0.5713,  1.9005,  0.5767,  0.5891,
         0.5729,  0.5621,  3.7613,  0.5596,  0.5827,  0.5811,  2.1619,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  2.5090,
         1.8908,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([7.0343, 6.7482, 6.3108, 6.4406, 5.6955, 6.2593, 6.7342, 6.6792, 6.7543,
        6.3743, 6.7002, 6.4285, 6.2795, 5.4491, 7.6531, 6.4604, 6.5843, 5.9883,
        6.7805, 6.1285, 5.7721, 5.9870, 6.8935, 6.4035, 6.3880, 5.6217, 5.2588,
        5.8696, 5.9056, 4.9600, 5.7480, 5.6074, 5.3779, 5.1034, 5.9292, 5.0222,
        4.7253, 5.5417, 4.8745, 5.4117, 4.2985, 4.7568, 5.8025, 4.6490, 3.9589,
        4.2747, 4.5244, 5.1782, 4.2107, 5.0101, 3.9360, 3.5693, 3.6770, 4.8017,
        3.7432, 5.4181, 3.6516, 5.1236, 4.2940, 4.2511, 4.4673, 4.3691, 3.8730,
        4.1295, 3.3943, 4.3168, 3.8571, 5.3516, 4.0464, 4.0131, 3.6568, 3.8192,
        4.3447, 3.4843, 3.5623, 3.2800, 4.1295, 3.1792, 3.3704, 3.2787, 3.3322,
        3.6193, 3.5560, 3.2277, 3.5211, 3.3573, 3.1405, 3.2723, 3.6523, 3.3357,
        3.3913, 3.2283, 3.1552, 3.2683, 3.3334, 3.0860, 2.9643, 3.2050, 3.4023,
        3.5033], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.37037037037037035, middle:0.2127659574468085, tail0.125
3shot of client 1:head:0.4319526627218935, middle:0.265625, tail0.030303030303030304
3shot of client 2:head:0.4597315436241611, middle:0.14473684210526316, tail0.05555555555555555
3shot of client 3:head:0.4594594594594595, middle:0.38095238095238093, tail0.03333333333333333
3shot of client 4:head:0.5512295081967213, middle:0.14782608695652175, tail0.0
3shot of client 5:head:0.4931506849315068, middle:0.104, tail0.09375
3shot of client 6:head:0.391156462585034, middle:0.21333333333333335, tail0.05263157894736842
3shot of client 7:head:0.3333333333333333, middle:0.32608695652173914, tail0.16666666666666666
3shot of client 8:head:0.46924829157175396, middle:0.1282051282051282, tail0.038461538461538464
3shot of client 9:head:0.3545816733067729, middle:0.17647058823529413, tail0.13333333333333333
3shot of client 10:head:0.5251396648044693, middle:0.09302325581395349, tail0.0
3shot of client 11:head:0.5128205128205128, middle:0.09090909090909091, tail0.13043478260869565
3shot of client 12:head:0.5459770114942529, middle:0.17857142857142858, tail0.047619047619047616
3shot of client 13:head:0.5339506172839507, middle:0.12941176470588237, tail0.1
3shot of client 14:head:0.3881401617250674, middle:0.15789473684210525, tail0.20833333333333334
3shot of client 15:head:0.373015873015873, middle:0.3064516129032258, tail0.0625
3shot of client 16:head:0.34797297297297297, middle:0.17647058823529413, tail0.05555555555555555
3shot of client 17:head:0.4778156996587031, middle:0.09722222222222222, tail0.11764705882352941
3shot of client 18:head:0.6360294117647058, middle:0.17142857142857143, tail0.11764705882352941
3shot of client 19:head:0.4377104377104377, middle:0.2, tail0.11764705882352941
round 21, local average test acc  0.3857 

round 21, local macro average F1 score  0.1702 

round 21, local weighted average F1 score  0.3643 

round 21, global test acc  0.1271 

round 21, average 3shot acc: [head: 0.4546, middle: 0.1851, tail: 0.0843] 

round 21, global 3shot acc: [head: 0.2978, middle: 0.1246, tail: 0.0304] 

l_head tensor([ 5.6358,  4.2223,  5.6920,  0.5944,  7.3239,  8.6356,  8.3609,  1.8575,
         9.6068,  2.6174,  3.7040, 10.3287,  4.9772,  2.9107,  9.4974,  6.0883,
         2.8090,  3.8740,  0.5704,  4.2996,  0.5833,  3.2878,  4.1935,  6.2864,
         4.1959,  3.1539,  5.7633,  9.5683,  0.5773,  5.7328,  3.2334,  0.5875,
         2.6213,  0.5837,  8.2925,  5.7788,  5.6178,  1.9562,  7.2843,  0.5674,
         3.0873,  0.5809,  0.6059,  0.5732,  2.0011,  5.5513,  0.5519,  0.5711,
         3.7863,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  2.2441,  0.5893,
         2.9138,  2.9836,  0.5923,  0.5799,  2.7921,  0.5719,  3.8915,  0.5882,
         2.3488,  3.8671,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  1.6885,  0.5874,  0.5713,  1.9908,  0.5767,  0.5891,
         0.5729,  0.5621,  3.7546,  0.5596,  0.5827,  0.5811,  2.2217,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  2.7008,
         2.0069,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head 
  4%|▍         | 22/500 [1:15:29<27:01:38, 203.55s/it]
  5%|▍         | 23/500 [1:18:47<26:44:52, 201.87s/it]tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([7.2426, 6.8966, 6.6226, 6.6775, 5.8563, 6.3990, 6.9497, 6.8365, 6.8994,
        6.6046, 6.9394, 6.6702, 6.5254, 5.6243, 7.8628, 6.6858, 6.7001, 6.3054,
        6.8423, 6.4306, 6.0590, 6.3412, 7.0696, 6.7247, 6.7487, 5.8815, 5.4353,
        6.0931, 6.1322, 5.1376, 6.0366, 6.0429, 5.7157, 5.3373, 6.0481, 5.2411,
        4.8581, 5.8971, 5.1310, 5.6786, 4.4797, 4.9341, 5.9843, 4.7362, 4.2234,
        4.4871, 4.6540, 5.3891, 4.4064, 5.2513, 4.0351, 3.8565, 3.9088, 5.1182,
        3.9513, 5.7817, 3.9673, 5.4657, 4.5553, 4.4456, 4.7304, 4.4766, 4.0535,
        4.3457, 3.7190, 4.4933, 4.1041, 5.6482, 4.2639, 4.1086, 3.9461, 4.1344,
        4.5564, 3.8139, 3.8440, 3.5822, 4.3331, 3.4364, 3.8362, 3.6463, 3.5206,
        4.0466, 3.6833, 3.5601, 3.5785, 3.5900, 3.4274, 3.4833, 3.7855, 3.4009,
        3.6667, 3.4020, 3.2579, 3.5437, 3.6051, 3.3106, 3.2736, 3.4052, 3.6323,
        3.6647], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.41798941798941797, middle:0.30851063829787234, tail0.16666666666666666
3shot of client 1:head:0.4457593688362919, middle:0.3046875, tail0.030303030303030304
3shot of client 2:head:0.4798657718120805, middle:0.18421052631578946, tail0.1111111111111111
3shot of client 3:head:0.4885654885654886, middle:0.373015873015873, tail0.0
3shot of client 4:head:0.5614754098360656, middle:0.1565217391304348, tail0.034482758620689655
3shot of client 5:head:0.4931506849315068, middle:0.064, tail0.09375
3shot of client 6:head:0.41156462585034015, middle:0.13333333333333333, tail0.05263157894736842
3shot of client 7:head:0.3958333333333333, middle:0.13043478260869565, tail0.25
3shot of client 8:head:0.4715261958997722, middle:0.09401709401709402, tail0.07692307692307693
3shot of client 9:head:0.41434262948207173, middle:0.14705882352941177, tail0.13333333333333333
3shot of client 10:head:0.5698324022346368, middle:0.10465116279069768, tail0.0
3shot of client 11:head:0.5441595441595442, middle:0.07954545454545454, tail0.0
3shot of client 12:head:0.5402298850574713, middle:0.14285714285714285, tail0.09523809523809523
3shot of client 13:head:0.595679012345679, middle:0.18823529411764706, tail0.1
3shot of client 14:head:0.444743935309973, middle:0.15789473684210525, tail0.20833333333333334
3shot of client 15:head:0.4087301587301587, middle:0.3387096774193548, tail0.0625
3shot of client 16:head:0.42567567567567566, middle:0.17647058823529413, tail0.0
3shot of client 17:head:0.4880546075085324, middle:0.2638888888888889, tail0.11764705882352941
3shot of client 18:head:0.5551470588235294, middle:0.22857142857142856, tail0.11764705882352941
3shot of client 19:head:0.48148148148148145, middle:0.25, tail0.17647058823529413
round 22, local average test acc  0.4078 

round 22, local macro average F1 score  0.1820 

round 22, local weighted average F1 score  0.3852 

round 22, global test acc  0.1330 

round 22, average 3shot acc: [head: 0.4817, middle: 0.1913, tail: 0.0914] 

round 22, global 3shot acc: [head: 0.3193, middle: 0.1269, tail: 0.0294] 

l_head tensor([ 5.6658,  4.5672,  6.1194,  0.5944,  7.4689,  8.9724,  8.7366,  1.9751,
         9.9042,  2.8491,  3.8101, 10.5560,  5.1839,  3.0937,  9.5238,  6.4673,
         2.8601,  4.0541,  0.5704,  4.4314,  0.5833,  3.3967,  4.4185,  6.3591,
         4.3263,  3.2560,  5.9891,  9.7168,  0.5773,  5.9894,  3.1785,  0.5875,
         2.7032,  0.5837,  8.6075,  6.0870,  5.8630,  2.0993,  7.4990,  0.5674,
         3.0855,  0.5809,  0.6059,  0.5732,  1.9950,  5.7734,  0.5519,  0.5711,
         4.0809,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  2.4719,  0.5893,
         3.0251,  3.1073,  0.5923,  0.5799,  3.0187,  0.5719,  4.1401,  0.5882,
         2.5084,  4.1104,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  1.8798,  0.5874,  0.5713,  2.0843,  0.5767,  0.5891,
         0.5729,  0.5621,  3.9646,  0.5596,  0.5827,  0.5811,  2.5164,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  2.9355,
         2.2210,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([7.5139, 7.0108, 6.8457, 6.7978, 6.0243, 6.6714, 7.1771, 7.2104, 7.2567,
        6.7853, 7.1476, 6.9775, 6.7331, 5.8294, 8.0940, 6.9146, 7.0542, 6.5003,
        7.2988, 6.6301, 6.2854, 6.5017, 7.5027, 6.8932, 7.0295, 6.0198, 5.5914,
        6.3038, 6.4402, 5.4221, 6.1828, 6.2158, 5.7969, 5.5350, 6.2034, 5.5013,
        5.1389, 6.0652, 5.4889, 5.9530, 4.7828, 5.0813, 6.2306, 5.0406, 4.5570,
        4.7758, 5.0744, 5.7662, 4.5689, 5.5161, 4.3340, 4.0255, 4.1608, 5.3267,
        4.2044, 6.0197, 4.1931, 5.7217, 4.8123, 4.8358, 4.8858, 4.7416, 4.3004,
        4.6367, 3.9808, 4.6811, 4.4522, 5.9915, 4.5069, 4.4722, 4.0514, 4.3343,
        4.7573, 3.9115, 4.0581, 3.8548, 4.5991, 3.6479, 4.0136, 3.9173, 3.8290,
        4.0256, 3.9937, 3.8995, 3.9125, 3.8694, 3.7428, 3.7738, 4.0130, 3.6751,
        4.0262, 3.7613, 3.5485, 3.5906, 3.8886, 3.7035, 3.4974, 3.6673, 3.8310,
        3.9760], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.3968253968253968, middle:0.2765957446808511, tail0.16666666666666666
3shot of client 1:head:0.46153846153846156, middle:0.1953125, tail0.09090909090909091
3shot of client 2:head:0.4429530201342282, middle:0.25, tail0.1111111111111111
3shot of client 3:head:0.5051975051975052, middle:0.42063492063492064, tail0.0
3shot of client 4:head:0.5594262295081968, middle:0.20869565217391303, tail0.10344827586206896
3shot of client 5:head:0.48532289628180036, middle:0.064, tail0.09375
3shot of client 6:head:0.3843537414965986, middle:0.28, tail0.05263157894736842
3shot of client 7:head:0.3333333333333333, middle:0.2391304347826087, tail0.16666666666666666
3shot of client 8:head:0.5125284738041003, middle:0.13675213675213677, tail0.0
3shot of client 9:head:0.42231075697211157, middle:0.22058823529411764, tail0.06666666666666667
3shot of client 10:head:0.4692737430167598, middle:0.11627906976744186, tail0.045454545454545456
3shot of client 11:head:0.6125356125356125, middle:0.07954545454545454, tail0.08695652173913043
3shot of client 12:head:0.5086206896551724, middle:0.10714285714285714, tail0.19047619047619047
3shot of client 13:head:0.5648148148148148, middle:0.18823529411764706, tail0.15

  5%|▍         | 24/500 [1:22:10<26:45:17, 202.35s/it]3shot of client 14:head:0.5714285714285714, middle:0.06315789473684211, tail0.25
3shot of client 15:head:0.376984126984127, middle:0.2903225806451613, tail0.125
3shot of client 16:head:0.38175675675675674, middle:0.17647058823529413, tail0.1111111111111111
3shot of client 17:head:0.4778156996587031, middle:0.3055555555555556, tail0.0
3shot of client 18:head:0.6580882352941176, middle:0.22857142857142856, tail0.058823529411764705
3shot of client 19:head:0.5420875420875421, middle:0.2875, tail0.23529411764705882
round 23, local average test acc  0.4126 

round 23, local macro average F1 score  0.1869 

round 23, local weighted average F1 score  0.3887 

round 23, global test acc  0.1315 

round 23, average 3shot acc: [head: 0.4834, middle: 0.2067, tail: 0.1052] 

round 23, global 3shot acc: [head: 0.3270, middle: 0.1265, tail: 0.0219] 

l_head tensor([ 5.9855,  4.6018,  6.3334,  0.5944,  7.7062,  9.3002,  9.0015,  2.0921,
        10.1360,  2.9474,  3.9491, 10.9391,  5.3849,  3.0856,  9.8507,  6.5541,
         3.0967,  4.3425,  0.5704,  4.7728,  0.5833,  3.8257,  4.5366,  6.6617,
         4.5468,  3.4700,  6.3121,  9.9880,  0.5773,  6.1436,  3.5390,  0.5875,
         2.9195,  0.5837,  8.7814,  6.3584,  6.0728,  2.1851,  7.7201,  0.5674,
         3.2665,  0.5809,  0.6059,  0.5732,  2.0277,  6.0438,  0.5519,  0.5711,
         4.3542,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  2.4882,  0.5893,
         3.1707,  3.2138,  0.5923,  0.5799,  2.9923,  0.5719,  4.1617,  0.5882,
         2.6360,  4.1179,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  1.9902,  0.5874,  0.5713,  2.1960,  0.5767,  0.5891,
         0.5729,  0.5621,  4.0298,  0.5596,  0.5827,  0.5811,  2.5123,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  2.9589,
         2.2476,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([7.6858, 7.3283, 7.1824, 7.0302, 6.2501, 6.9354, 7.2779, 7.5928, 7.2910,
        7.0500, 7.2669, 7.1512, 6.9416, 6.0486, 8.2892, 7.3419, 7.2683, 6.8782,
        7.6011, 7.0666, 6.5536, 6.6961, 7.4737, 7.0957, 7.2284, 6.2469, 5.9291,
        6.5389, 6.8128, 5.6654, 6.4662, 6.5074, 5.9722, 5.7849, 6.4359, 5.7030,
        5.2921, 6.3181, 5.7104, 6.1154, 5.0225, 5.2449, 6.4692, 5.2772, 4.7674,
        4.9818, 5.2655, 5.8441, 5.0630, 5.7316, 4.6486, 4.2689, 4.4093, 5.6343,
        4.4171, 6.3191, 4.4448, 5.8674, 5.0377, 5.1638, 5.0419, 4.9963, 4.4849,
        4.9309, 4.1053, 4.9099, 4.6475, 6.0318, 4.6845, 4.6581, 4.3438, 4.7420,
        5.0811, 4.1968, 4.1873, 4.0660, 4.9575, 3.9874, 4.1754, 4.2324, 4.0941,
        4.3476, 4.1867, 3.9996, 4.1690, 4.1445, 3.9414, 3.9972, 4.3664, 3.9644,
        4.2570, 3.9209, 3.8793, 4.1092, 4.0992, 3.8199, 3.5867, 3.9135, 4.1367,
        4.4545], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.4417989417989418, middle:0.2553191489361702, tail0.20833333333333334
3shot of client 1:head:0.4536489151873767, middle:0.1953125, tail0.030303030303030304
3shot of client 2:head:0.4899328859060403, middle:0.18421052631578946, tail0.1111111111111111
3shot of client 3:head:0.48440748440748443, middle:0.373015873015873, tail0.0
3shot of client 4:head:0.5983606557377049, middle:0.1826086956521739, tail0.06896551724137931
3shot of client 5:head:0.487279843444227, middle:0.112, tail0.09375
3shot of client 6:head:0.41836734693877553, middle:0.21333333333333335, tail0.05263157894736842
3shot of client 7:head:0.3958333333333333, middle:0.1956521739130435, tail0.25
3shot of client 8:head:0.45558086560364464, middle:0.18803418803418803, tail0.038461538461538464
3shot of client 9:head:0.41832669322709165, middle:0.19117647058823528, tail0.06666666666666667
3shot of client 10:head:0.553072625698324, middle:0.18604651162790697, tail0.0
3shot of client 11:head:0.5669515669515669, middle:0.13636363636363635, tail0.13043478260869565
3shot of client 12:head:0.5977011494252874, middle:0.16666666666666666, tail0.19047619047619047
3shot of client 13:head:0.6111111111111112, middle:0.2, tail0.15
3shot of client 14:head:0.477088948787062, middle:0.09473684210526316, tail0.125
3shot of client 15:head:0.4126984126984127, middle:0.22580645161290322, tail0.0625
3shot of client 16:head:0.4155405405405405, middle:0.17647058823529413, tail0.05555555555555555
3shot of client 17:head:0.4778156996587031, middle:0.2916666666666667, tail0.17647058823529413
3shot of client 18:head:0.6838235294117647, middle:0.24285714285714285, tail0.23529411764705882
3shot of client 19:head:0.49158249158249157, middle:0.2625, tail0.23529411764705882
round 24, local average test acc  0.4226 

round 24, local macro average F1 score  0.1981 

round 24, local weighted average F1 score  0.4001 

round 24, global test acc  0.1385 

round 24, average 3shot acc: [head: 0.4965, middle: 0.2037, tail: 0.1141] 

round 24, global 3shot acc: [head: 0.3344, middle: 0.1377, tail: 0.0264] 

l_head tensor([ 6.1661,  4.7948,  6.5337,  0.5944,  7.9142,  9.5289,  8.9955,  2.1647,
        10.3741,  3.0290,  4.1370, 11.3752,  5.5002,  3.4014,  9.9172,  6.7014,
         3.1397,  4.4217,  0.5704,  4.9445,  0.5833,  3.9189,  4.8728,  6.8503,
         4.7559,  3.5047,  6.4824, 10.2622,  0.5773,  6.4363,  3.7049,  0.5875,
         3.1088,  0.5837,  8.8957,  6.6371,  6.4908,  2.2773,  7.9704,  0.5674,
         3.4532,  0.5809,  0.6059,  0.5732,  2.1495,  6.2402,  0.5519,  0.5711,
         4.5171,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  2.6834,  0.5893,
         3.2173,  3.3922,  0.5923,  0.5799,  3.0861,  0.5719,  4.3687,  0.5882,
         2.7545,  4.2486,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  2.0390,  0.5874,  0.5713,  2.2454,  0.5767,  0.5891,
         0.5729,  0.5621,  4.1770,  0.5596,  0.5827,  0.5811,  2.5355,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  2.9576,
         2.3667,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux 
  5%|▌         | 25/500 [1:25:34<26:44:04, 202.62s/it]
  5%|▌         | 26/500 [1:28:58<26:44:02, 203.04s/it]tensor([7.9599, 7.4708, 7.3014, 7.2229, 6.5728, 7.3180, 7.5311, 7.5975, 7.5834,
        7.2780, 7.6014, 7.4477, 7.2433, 6.3719, 8.4667, 7.3942, 7.3428, 6.9516,
        7.7832, 7.2538, 6.7101, 6.9622, 7.7975, 7.4539, 7.4644, 6.4781, 6.1180,
        6.8482, 6.8996, 5.8315, 6.7058, 6.8548, 6.3264, 6.1412, 6.6599, 6.0472,
        5.4823, 6.5043, 5.8818, 6.3911, 5.1859, 5.5633, 6.7151, 5.4714, 4.9320,
        5.2436, 5.5415, 6.2377, 5.1541, 6.0924, 4.8864, 4.5427, 4.6580, 5.7767,
        4.6937, 6.4375, 4.7993, 6.1369, 5.4527, 5.4676, 5.2748, 5.2033, 4.6344,
        5.1640, 4.3761, 5.3417, 4.9667, 6.6421, 4.9150, 5.0165, 4.5818, 4.8723,
        5.2185, 4.4039, 4.4897, 4.3312, 5.1062, 4.0934, 4.4682, 4.2985, 4.3732,
        4.5113, 4.4587, 4.3291, 4.4552, 4.3945, 4.1573, 4.2106, 4.5403, 4.0736,
        4.3520, 4.1238, 4.0839, 4.2058, 4.2774, 4.0642, 3.9153, 4.1014, 4.3640,
        4.6318], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.4074074074074074, middle:0.3191489361702128, tail0.125
3shot of client 1:head:0.5108481262327417, middle:0.1796875, tail0.030303030303030304
3shot of client 2:head:0.4228187919463087, middle:0.27631578947368424, tail0.16666666666666666
3shot of client 3:head:0.4677754677754678, middle:0.3888888888888889, tail0.03333333333333333
3shot of client 4:head:0.5307377049180327, middle:0.10434782608695652, tail0.10344827586206896
3shot of client 5:head:0.5636007827788649, middle:0.064, tail0.15625
3shot of client 6:head:0.35034013605442177, middle:0.22666666666666666, tail0.05263157894736842
3shot of client 7:head:0.3854166666666667, middle:0.15217391304347827, tail0.25
3shot of client 8:head:0.5284738041002278, middle:0.15384615384615385, tail0.07692307692307693
3shot of client 9:head:0.44621513944223107, middle:0.22058823529411764, tail0.06666666666666667
3shot of client 10:head:0.5921787709497207, middle:0.09302325581395349, tail0.0
3shot of client 11:head:0.4358974358974359, middle:0.1590909090909091, tail0.21739130434782608
3shot of client 12:head:0.5373563218390804, middle:0.16666666666666666, tail0.2857142857142857
3shot of client 13:head:0.5339506172839507, middle:0.18823529411764706, tail0.1
3shot of client 14:head:0.48247978436657685, middle:0.14736842105263157, tail0.16666666666666666
3shot of client 15:head:0.35714285714285715, middle:0.3387096774193548, tail0.0625
3shot of client 16:head:0.3277027027027027, middle:0.36764705882352944, tail0.05555555555555555
3shot of client 17:head:0.5085324232081911, middle:0.2777777777777778, tail0.058823529411764705
3shot of client 18:head:0.6617647058823529, middle:0.21428571428571427, tail0.17647058823529413
3shot of client 19:head:0.5757575757575758, middle:0.2625, tail0.11764705882352941
round 25, local average test acc  0.4131 

round 25, local macro average F1 score  0.2018 

round 25, local weighted average F1 score  0.3939 

round 25, global test acc  0.1542 

round 25, average 3shot acc: [head: 0.4813, middle: 0.2150, tail: 0.1151] 

round 25, global 3shot acc: [head: 0.3107, middle: 0.1527, tail: 0.0651] 

l_head tensor([ 6.2303,  5.0317,  6.5009,  0.5944,  8.0466,  9.7824,  9.2027,  2.2698,
        10.5204,  3.1685,  4.4898, 11.5846,  5.7348,  3.5644, 10.1885,  6.7902,
         3.3862,  4.6692,  0.5704,  5.1401,  0.5833,  4.0215,  5.0016,  7.0471,
         4.8421,  3.6749,  6.6915, 10.5501,  0.5773,  6.6416,  3.7457,  0.5875,
         3.2267,  0.5837,  9.2474,  6.8068,  6.7094,  2.4573,  8.1276,  0.5674,
         3.4243,  0.5809,  0.6059,  0.5732,  2.3311,  6.4893,  0.5519,  0.5711,
         4.7271,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  2.7356,  0.5893,
         3.4459,  3.5203,  0.5923,  0.5799,  3.3112,  0.5719,  4.5995,  0.5882,
         2.7175,  4.3627,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  2.0920,  0.5874,  0.5713,  2.2979,  0.5767,  0.5891,
         0.5729,  0.5621,  4.3719,  0.5596,  0.5827,  0.5811,  2.6413,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  3.1795,
         2.5260,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([8.0908, 7.6917, 7.5778, 7.5711, 6.6646, 7.4665, 7.7110, 7.9309, 7.6490,
        7.6169, 7.7062, 7.6062, 7.4775, 6.4844, 8.6633, 7.6569, 7.5236, 7.2573,
        8.0150, 7.4113, 7.0352, 7.2142, 8.0374, 7.5881, 7.7013, 6.7165, 6.3992,
        6.9750, 7.1430, 6.1107, 6.8669, 7.0730, 6.4915, 6.3467, 6.7638, 6.1705,
        5.7904, 6.8107, 6.1742, 6.7001, 5.5109, 5.9324, 6.9713, 5.7513, 5.2965,
        5.6273, 5.8740, 6.5073, 5.3959, 6.3140, 5.1679, 4.7578, 5.0735, 6.0252,
        5.0289, 6.9428, 4.9672, 6.4684, 5.6524, 5.7893, 5.7665, 5.5547, 4.8664,
        5.4198, 4.5910, 5.4750, 5.1934, 6.9829, 5.3885, 5.0772, 4.8233, 5.2164,
        5.6444, 4.5962, 4.7694, 4.5281, 5.4473, 4.3385, 4.7855, 4.7386, 4.5871,
        4.8028, 4.8613, 4.8013, 4.6786, 4.4813, 4.3477, 4.5577, 4.7615, 4.3815,
        4.6968, 4.4155, 4.2389, 4.4048, 4.6449, 4.2645, 4.2560, 4.3865, 4.6031,
        4.7249], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.41005291005291006, middle:0.3404255319148936, tail0.08333333333333333
3shot of client 1:head:0.4556213017751479, middle:0.3671875, tail0.0
3shot of client 2:head:0.48322147651006714, middle:0.2631578947368421, tail0.16666666666666666
3shot of client 3:head:0.4365904365904366, middle:0.30952380952380953, tail0.06666666666666667
3shot of client 4:head:0.625, middle:0.14782608695652175, tail0.0
3shot of client 5:head:0.538160469667319, middle:0.088, tail0.1875
3shot of client 6:head:0.36394557823129253, middle:0.30666666666666664, tail0.0
3shot of client 7:head:0.3229166666666667, middle:0.17391304347826086, tail0.25
3shot of client 8:head:0.48291571753986334, middle:0.17094017094017094, tail0.07692307692307693
3shot of client 9:head:0.42231075697211157, middle:0.23529411764705882, tail0.0
3shot of client 10:head:0.5642458100558659, middle:0.1511627906976744, tail0.0
3shot of client 11:head:0.5270655270655271, middle:0.13636363636363635, tail0.08695652173913043
3shot of client 12:head:0.6063218390804598, middle:0.14285714285714285, tail0.19047619047619047
3shot of client 13:head:0.6049382716049383, middle:0.25882352941176473, tail0.05
3shot of client 14:head:0.3746630727762803, middle:0.2, tail0.20833333333333334
3shot of client 15:head:0.36904761904761907, middle:0.3387096774193548, tail0.125
3shot of client 16:head:0.375, middle:0.36764705882352944, tail0.05555555555555555
3shot of client 17:head:0.5187713310580204, middle:0.2361111111111111, tail0.17647058823529413
3shot of client 18:head:0.625, middle:0.35714285714285715, tail0.23529411764705882
3shot of client 19:head:0.5656565656565656, middle:0.2, tail0.17647058823529413
round 26, local average test acc  0.4192 

round 26, local macro average F1 score  0.2057 

round 26, local weighted average F1 score  0.3971 

round 26, global test acc  0.1473 

round 26, average 3shot acc: [head: 0.4836, middle: 0.2396, tail: 0.1068] 

round 26, global 3shot acc: [head: 0.2996, middle: 0.1900, tail: 0.0362] 

l_head 
  5%|▌         | 27/500 [1:32:16<26:29:35, 201.64s/it]
  6%|▌         | 28/500 [1:35:40<26:31:21, 202.29s/it]tensor([ 6.2600,  5.1632,  6.7090,  0.5944,  8.0553, 10.1731,  9.4188,  2.4040,
        10.9069,  3.1766,  4.7290, 11.9123,  5.8288,  3.8624, 10.5239,  7.1718,
         3.3872,  4.6857,  0.5704,  5.1625,  0.5833,  4.0445,  4.9838,  7.2932,
         4.9597,  3.7990,  6.8927, 10.7550,  0.5773,  6.7132,  3.8837,  0.5875,
         3.3222,  0.5837,  9.4722,  7.1563,  6.7850,  2.4469,  8.4723,  0.5674,
         3.5302,  0.5809,  0.6059,  0.5732,  2.4618,  6.5467,  0.5519,  0.5711,
         4.7204,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  2.7877,  0.5893,
         3.5625,  3.6674,  0.5923,  0.5799,  3.3846,  0.5719,  4.8404,  0.5882,
         2.8482,  4.5967,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  2.0935,  0.5874,  0.5713,  2.2852,  0.5767,  0.5891,
         0.5729,  0.5621,  4.4126,  0.5596,  0.5827,  0.5811,  2.5437,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  3.2520,
         2.6252,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([8.4973, 7.9687, 7.7831, 7.7117, 6.9067, 7.6527, 7.8886, 7.9874, 7.8452,
        7.7703, 7.8566, 7.8712, 7.8167, 6.7562, 8.8177, 8.1625, 7.7338, 7.3800,
        8.2285, 7.5726, 7.3433, 7.4505, 8.2717, 7.9314, 7.9776, 6.8535, 6.5217,
        7.1232, 7.6687, 6.3682, 7.1699, 7.4906, 6.5349, 6.5382, 7.1769, 6.4106,
        6.1492, 7.1157, 6.5200, 6.9432, 5.7711, 6.0277, 7.1983, 5.8834, 5.5462,
        5.7435, 6.2270, 6.8191, 5.7939, 6.6435, 5.4673, 5.0487, 5.1590, 6.4124,
        5.2221, 7.0615, 5.2665, 6.7691, 5.8282, 6.0107, 5.8418, 5.8291, 5.2159,
        5.8444, 4.9211, 6.0968, 5.4198, 7.0665, 5.5530, 5.4823, 5.0091, 5.3754,
        5.9476, 5.0340, 4.9685, 4.7252, 5.7317, 4.6464, 5.0378, 4.9669, 4.9997,
        5.0617, 4.9747, 4.9574, 5.0317, 5.0032, 4.6766, 4.7723, 4.9568, 4.6681,
        5.1878, 4.7558, 4.4002, 4.7844, 4.6984, 4.5744, 4.5920, 4.5351, 4.9003,
        4.9556], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.42063492063492064, middle:0.35106382978723405, tail0.16666666666666666
3shot of client 1:head:0.4930966469428008, middle:0.3046875, tail0.06060606060606061
3shot of client 2:head:0.4563758389261745, middle:0.23684210526315788, tail0.1111111111111111
3shot of client 3:head:0.5696465696465697, middle:0.38095238095238093, tail0.03333333333333333
3shot of client 4:head:0.5922131147540983, middle:0.12173913043478261, tail0.06896551724137931
3shot of client 5:head:0.5322896281800391, middle:0.144, tail0.1875
3shot of client 6:head:0.4217687074829932, middle:0.24, tail0.05263157894736842
3shot of client 7:head:0.3645833333333333, middle:0.2608695652173913, tail0.25
3shot of client 8:head:0.5148063781321185, middle:0.19658119658119658, tail0.07692307692307693
3shot of client 9:head:0.47410358565737054, middle:0.22058823529411764, tail0.0
3shot of client 10:head:0.5111731843575419, middle:0.12790697674418605, tail0.13636363636363635
3shot of client 11:head:0.5897435897435898, middle:0.14772727272727273, tail0.13043478260869565
3shot of client 12:head:0.5948275862068966, middle:0.20238095238095238, tail0.2857142857142857
3shot of client 13:head:0.6141975308641975, middle:0.27058823529411763, tail0.15
3shot of client 14:head:0.33423180592991913, middle:0.09473684210526316, tail0.16666666666666666
3shot of client 15:head:0.38492063492063494, middle:0.25806451612903225, tail0.125
3shot of client 16:head:0.4358108108108108, middle:0.3088235294117647, tail0.05555555555555555
3shot of client 17:head:0.4641638225255973, middle:0.2916666666666667, tail0.29411764705882354
3shot of client 18:head:0.6764705882352942, middle:0.2, tail0.17647058823529413
3shot of client 19:head:0.5084175084175084, middle:0.2375, tail0.29411764705882354
round 27, local average test acc  0.4296 

round 27, local macro average F1 score  0.2153 

round 27, local weighted average F1 score  0.4196 

round 27, global test acc  0.1585 

round 27, average 3shot acc: [head: 0.4977, middle: 0.2298, tail: 0.1411] 

round 27, global 3shot acc: [head: 0.3400, middle: 0.1888, tail: 0.0374] 

l_head tensor([ 6.5457,  5.2420,  6.9773,  0.5944,  8.2809, 10.2359,  9.6564,  2.4660,
        10.9572,  3.3085,  4.8672, 11.9678,  5.9486,  4.0240, 10.6392,  7.3351,
         3.5589,  4.7645,  0.5704,  5.1714,  0.5833,  4.2843,  5.0081,  7.2860,
         5.2433,  4.0392,  7.1612, 11.1148,  0.5773,  6.9495,  3.8558,  0.5875,
         3.5317,  0.5837,  9.6802,  7.4334,  6.9381,  2.6221,  8.4104,  0.5674,
         3.6743,  0.5809,  0.6059,  0.5732,  2.3958,  6.9127,  0.5519,  0.5711,
         4.8832,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  2.8436,  0.5893,
         3.6915,  3.7420,  0.5923,  0.5799,  3.5752,  0.5719,  5.0971,  0.5882,
         2.9709,  4.7441,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  2.2198,  0.5874,  0.5713,  2.5655,  0.5767,  0.5891,
         0.5729,  0.5621,  4.5408,  0.5596,  0.5827,  0.5811,  2.6759,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  3.2016,
         2.7930,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([8.6312, 8.2722, 7.9933, 7.9578, 7.1337, 8.0332, 8.1015, 8.2851, 8.0094,
        7.8751, 8.0627, 8.0280, 7.9900, 7.0681, 9.2131, 8.4413, 8.0238, 7.7533,
        8.6950, 7.9412, 7.5622, 7.6478, 8.6043, 8.1931, 8.2749, 7.2898, 6.7619,
        7.4477, 7.6892, 6.7233, 7.3765, 7.7602, 6.9591, 6.7950, 7.6646, 6.7375,
        6.0973, 7.2152, 6.7395, 7.3362, 6.0473, 6.3355, 7.5531, 6.2246, 5.8801,
        6.0148, 6.1487, 6.9975, 6.0183, 6.7566, 5.6464, 5.3335, 5.4885, 6.5295,
        5.5471, 7.1585, 5.4542, 6.8136, 6.0964, 6.1774, 6.1247, 6.0926, 5.4329,
        6.0499, 5.2325, 6.0642, 5.6932, 7.2982, 5.8559, 5.7012, 5.4120, 5.6792,
        6.0751, 5.3454, 5.2409, 5.0214, 5.9629, 4.9485, 5.3218, 5.0833, 5.1870,
        5.2427, 5.3671, 5.1610, 5.2078, 5.0289, 4.9424, 5.0509, 5.3020, 5.0443,
        5.3076, 5.0551, 4.7869, 5.0598, 5.0436, 4.7094, 4.6944, 4.8112, 5.2070,
        5.2923], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.40476190476190477, middle:0.32978723404255317, tail0.20833333333333334
3shot of client 1:head:0.5167652859960552, middle:0.3046875, tail0.030303030303030304

  6%|▌         | 29/500 [1:39:03<26:30:56, 202.67s/it]3shot of client 2:head:0.4463087248322148, middle:0.34210526315789475, tail0.05555555555555555
3shot of client 3:head:0.5197505197505198, middle:0.42063492063492064, tail0.0
3shot of client 4:head:0.6557377049180327, middle:0.24347826086956523, tail0.06896551724137931
3shot of client 5:head:0.5851272015655578, middle:0.128, tail0.1875
3shot of client 6:head:0.4557823129251701, middle:0.22666666666666666, tail0.05263157894736842
3shot of client 7:head:0.390625, middle:0.1956521739130435, tail0.4166666666666667
3shot of client 8:head:0.5945330296127562, middle:0.1452991452991453, tail0.0
3shot of client 9:head:0.40239043824701193, middle:0.10294117647058823, tail0.0
3shot of client 10:head:0.5893854748603352, middle:0.18604651162790697, tail0.045454545454545456
3shot of client 11:head:0.5527065527065527, middle:0.23863636363636365, tail0.13043478260869565
3shot of client 12:head:0.5977011494252874, middle:0.25, tail0.23809523809523808
3shot of client 13:head:0.5679012345679012, middle:0.2823529411764706, tail0.2
3shot of client 14:head:0.6118598382749326, middle:0.1368421052631579, tail0.125
3shot of client 15:head:0.47619047619047616, middle:0.3064516129032258, tail0.125
3shot of client 16:head:0.44256756756756754, middle:0.35294117647058826, tail0.05555555555555555
3shot of client 17:head:0.5392491467576792, middle:0.3194444444444444, tail0.058823529411764705
3shot of client 18:head:0.7095588235294118, middle:0.3, tail0.23529411764705882
3shot of client 19:head:0.6397306397306397, middle:0.225, tail0.23529411764705882
round 28, local average test acc  0.4613 

round 28, local macro average F1 score  0.2325 

round 28, local weighted average F1 score  0.4438 

round 28, global test acc  0.1630 

round 28, average 3shot acc: [head: 0.5349, middle: 0.2518, tail: 0.1234] 

round 28, global 3shot acc: [head: 0.3541, middle: 0.1862, tail: 0.0404] 

l_head tensor([ 6.6406,  5.1109,  7.3018,  0.5944,  8.3392, 10.6079,  9.9275,  2.6857,
        11.1466,  3.3899,  5.1823, 12.1841,  6.1219,  4.0671, 10.8893,  7.6092,
         3.7724,  4.7735,  0.5704,  5.3850,  0.5833,  4.3304,  5.1135,  7.4828,
         5.3768,  4.0692,  7.2872, 11.3653,  0.5773,  7.1477,  4.2039,  0.5875,
         3.5412,  0.5837,  9.9190,  7.7395,  7.1654,  2.8226,  8.6273,  0.5674,
         3.7989,  0.5809,  0.6059,  0.5732,  2.4579,  7.0415,  0.5519,  0.5711,
         5.5215,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  2.9282,  0.5893,
         3.7293,  3.9429,  0.5923,  0.5799,  3.7904,  0.5719,  5.1493,  0.5882,
         3.0533,  4.7860,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  2.3923,  0.5874,  0.5713,  2.6328,  0.5767,  0.5891,
         0.5729,  0.5621,  4.8694,  0.5596,  0.5827,  0.5811,  2.7498,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  3.3873,
         2.7009,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([8.9099, 8.4570, 8.4525, 8.1645, 7.5351, 8.0958, 8.3998, 8.6969, 8.2673,
        8.3954, 8.3331, 8.4832, 8.1764, 7.2745, 9.3948, 8.4694, 8.2636, 8.0568,
        8.8570, 8.3569, 7.8003, 7.9488, 8.6396, 8.4571, 8.4585, 7.4333, 7.0917,
        7.9495, 8.0001, 6.7660, 7.7090, 8.0599, 7.2691, 6.9545, 7.8418, 6.9610,
        6.5363, 7.5735, 6.8941, 7.4290, 6.2464, 6.6015, 7.7680, 6.4228, 5.9610,
        6.4181, 6.4193, 7.2086, 6.2092, 7.1541, 5.9019, 5.5815, 5.6169, 6.7908,
        5.7565, 7.6535, 5.6832, 7.2223, 6.3660, 6.5020, 6.3170, 6.4164, 5.8012,
        6.2178, 5.5038, 6.3042, 6.0318, 7.7857, 6.0811, 6.1001, 5.7037, 6.0875,
        6.4583, 5.3880, 5.6334, 5.2964, 6.1363, 5.1781, 5.5301, 5.4401, 5.6156,
        5.4959, 5.4369, 5.4234, 5.5061, 5.4387, 5.2129, 5.3074, 5.5915, 5.2591,
        5.4948, 5.3748, 4.9974, 5.3226, 5.4347, 5.1305, 4.9591, 4.9690, 5.4449,
        5.5887], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.5052910052910053, middle:0.26595744680851063, tail0.16666666666666666
3shot of client 1:head:0.5877712031558185, middle:0.328125, tail0.06060606060606061
3shot of client 2:head:0.5671140939597316, middle:0.25, tail0.2777777777777778
3shot of client 3:head:0.5093555093555093, middle:0.4603174603174603, tail0.06666666666666667
3shot of client 4:head:0.680327868852459, middle:0.23478260869565218, tail0.06896551724137931
3shot of client 5:head:0.5851272015655578, middle:0.136, tail0.15625
3shot of client 6:head:0.43197278911564624, middle:0.37333333333333335, tail0.10526315789473684
3shot of client 7:head:0.4270833333333333, middle:0.17391304347826086, tail0.25
3shot of client 8:head:0.5580865603644647, middle:0.18803418803418803, tail0.038461538461538464
3shot of client 9:head:0.5059760956175299, middle:0.17647058823529413, tail0.06666666666666667
3shot of client 10:head:0.5810055865921788, middle:0.1511627906976744, tail0.045454545454545456
3shot of client 11:head:0.6438746438746439, middle:0.18181818181818182, tail0.21739130434782608
3shot of client 12:head:0.6091954022988506, middle:0.17857142857142858, tail0.23809523809523808
3shot of client 13:head:0.5987654320987654, middle:0.25882352941176473, tail0.15
3shot of client 14:head:0.5606469002695418, middle:0.15789473684210525, tail0.25
3shot of client 15:head:0.376984126984127, middle:0.4032258064516129, tail0.0
3shot of client 16:head:0.4155405405405405, middle:0.27941176470588236, tail0.05555555555555555
3shot of client 17:head:0.4812286689419795, middle:0.375, tail0.29411764705882354
3shot of client 18:head:0.7316176470588235, middle:0.38571428571428573, tail0.29411764705882354
3shot of client 19:head:0.5925925925925926, middle:0.3, tail0.29411764705882354
round 29, local average test acc  0.4745 

round 29, local macro average F1 score  0.2442 

round 29, local weighted average F1 score  0.4498 

round 29, global test acc  0.1644 

round 29, average 3shot acc: [head: 0.5475, middle: 0.2629, tail: 0.1548] 

round 29, global 3shot acc: [head: 0.3641, middle: 0.1688, tail: 0.0472] 

l_head tensor([ 6.6995,  5.3176,  7.5871,  0.5944,  8.6686, 10.8678, 10.0455,  2.8806,
        11.4669,  3.5732,  5.3577, 12.5658,  6.3181,  4.3753, 10.9960,  8.0589,
         3.8048,  5.0300,  0.5704,  5.4581,  0.5833,  4.7082,  5.2391,  7.6764,
         5.5050,  4.3055,  7.4794, 11.6082,  0.5773,  7.4105,  4.2019,  0.5875,
         3.8616,  0.5837,  9.9397,  7.8036,  7.4001,  2.8042,  8.6851,  0.5674,
         3.8468,  0.5809,  0.6059,  0.5732,  2.5932,  7.0650,  0.5519,  0.5711,
         5.6841,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  3.0485,  0.5893,
         3.8851,  4.0605,  0.5923,  0.5799,  3.7033,  0.5719,  5.4221,  0.5882,
         3.2553,  4.8014,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  2.3390,  0.5874,  0.5713,  2.8084,  0.5767,  0.5891,
         0.5729,  0.5621,  4.9782,  0.5596,  0.5827,  0.5811,  2.7362,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  3.3566,
         2.8411,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head 
  6%|▌         | 30/500 [1:42:27<26:30:12, 203.00s/it]
  6%|▌         | 31/500 [1:45:52<26:30:26, 203.47s/it]tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([9.1634, 8.7124, 8.5414, 8.5700, 7.5279, 8.5005, 8.6687, 9.0470, 8.4238,
        8.5181, 8.5308, 8.7417, 8.6727, 7.4370, 9.7477, 8.7754, 8.6061, 8.2776,
        9.1648, 8.3564, 7.9563, 8.1177, 8.8864, 8.6317, 8.5977, 7.7431, 7.3053,
        8.2224, 8.1961, 7.2215, 7.9495, 8.1679, 7.3539, 7.2775, 8.0334, 7.2995,
        6.7279, 7.8892, 7.0982, 7.5383, 6.6446, 6.8719, 8.1953, 6.6517, 6.2395,
        6.5621, 6.7790, 7.2997, 6.3471, 7.2208, 6.2202, 5.8421, 6.0131, 7.0280,
        6.0303, 7.7345, 5.9845, 7.5109, 6.7678, 6.6905, 6.6948, 6.7296, 6.1087,
        6.5957, 5.7595, 6.6155, 6.5365, 7.8299, 6.3531, 6.4311, 5.8879, 6.3296,
        6.8204, 5.7700, 5.9170, 5.5521, 6.4767, 5.4252, 5.9161, 5.7127, 5.7625,
        5.6751, 5.7670, 5.7254, 5.8430, 5.7754, 5.5472, 5.4750, 5.9192, 5.3807,
        5.9475, 5.5162, 5.2843, 5.6399, 5.4790, 5.2543, 5.3342, 5.3489, 5.7296,
        5.9549], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.5105820105820106, middle:0.2978723404255319, tail0.3333333333333333
3shot of client 1:head:0.5641025641025641, middle:0.3515625, tail0.06060606060606061
3shot of client 2:head:0.4697986577181208, middle:0.25, tail0.16666666666666666
3shot of client 3:head:0.5467775467775468, middle:0.4126984126984127, tail0.06666666666666667
3shot of client 4:head:0.5860655737704918, middle:0.23478260869565218, tail0.034482758620689655
3shot of client 5:head:0.6105675146771037, middle:0.16, tail0.21875
3shot of client 6:head:0.45918367346938777, middle:0.26666666666666666, tail0.10526315789473684
3shot of client 7:head:0.3958333333333333, middle:0.2391304347826087, tail0.4166666666666667
3shot of client 8:head:0.5353075170842825, middle:0.2564102564102564, tail0.07692307692307693
3shot of client 9:head:0.4860557768924303, middle:0.27941176470588236, tail0.13333333333333333
3shot of client 10:head:0.5726256983240223, middle:0.19767441860465115, tail0.0
3shot of client 11:head:0.5811965811965812, middle:0.17045454545454544, tail0.30434782608695654
3shot of client 12:head:0.6350574712643678, middle:0.23809523809523808, tail0.14285714285714285
3shot of client 13:head:0.5864197530864198, middle:0.2823529411764706, tail0.15
3shot of client 14:head:0.5983827493261455, middle:0.24210526315789474, tail0.20833333333333334
3shot of client 15:head:0.5, middle:0.3548387096774194, tail0.125
3shot of client 16:head:0.4527027027027027, middle:0.36764705882352944, tail0.05555555555555555
3shot of client 17:head:0.447098976109215, middle:0.3333333333333333, tail0.47058823529411764
3shot of client 18:head:0.6838235294117647, middle:0.44285714285714284, tail0.23529411764705882
3shot of client 19:head:0.5791245791245792, middle:0.3, tail0.23529411764705882
round 30, local average test acc  0.4739 

round 30, local macro average F1 score  0.2477 

round 30, local weighted average F1 score  0.4568 

round 30, global test acc  0.1842 

round 30, average 3shot acc: [head: 0.5400, middle: 0.2839, tail: 0.1770] 

round 30, global 3shot acc: [head: 0.4274, middle: 0.1896, tail: 0.0415] 

l_head tensor([ 6.8232,  5.2691,  7.7858,  0.5944,  8.7205, 11.0925, 10.2853,  2.8767,
        11.6754,  3.7243,  5.5624, 12.9580,  6.5011,  4.4432, 11.1237,  8.1907,
         4.0624,  5.0548,  0.5704,  5.7365,  0.5833,  4.8081,  5.5017,  7.9025,
         5.7902,  4.4921,  7.7719, 11.7870,  0.5773,  7.5457,  4.2879,  0.5875,
         3.9401,  0.5837, 10.0993,  8.0508,  7.5761,  3.1029,  8.9642,  0.5674,
         3.8583,  0.5809,  0.6059,  0.5732,  2.5876,  7.3835,  0.5519,  0.5711,
         5.7477,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  2.9776,  0.5893,
         3.9085,  4.2228,  0.5923,  0.5799,  4.0072,  0.5719,  5.5965,  0.5882,
         3.2639,  4.9442,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  2.4290,  0.5874,  0.5713,  2.8577,  0.5767,  0.5891,
         0.5729,  0.5621,  5.0996,  0.5596,  0.5827,  0.5811,  2.8343,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  3.4591,
         3.2376,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([9.3654, 8.7864, 8.8614, 8.5855, 7.9371, 8.6496, 8.8548, 9.2920, 8.7065,
        8.7055, 8.8390, 8.9105, 8.8099, 7.9143, 9.7149, 9.0701, 8.8327, 8.4791,
        9.5103, 8.6158, 8.2783, 8.4059, 9.1169, 8.8954, 9.0799, 7.9198, 7.5698,
        8.2974, 8.4797, 7.3917, 8.0468, 8.5178, 7.6823, 7.2966, 8.2856, 7.6477,
        7.0524, 8.1677, 7.5089, 8.0488, 6.8058, 7.2313, 8.3875, 7.0635, 6.6062,
        6.9080, 6.9922, 7.8233, 6.6253, 7.6171, 6.5428, 6.1805, 6.2940, 7.2211,
        6.2699, 7.9697, 6.2091, 7.8643, 6.7751, 6.9300, 6.9891, 6.8303, 6.3223,
        6.8838, 6.0245, 6.7604, 6.6102, 8.3053, 6.7760, 6.6631, 6.2297, 6.4865,
        6.9932, 5.9605, 6.3286, 5.8842, 6.7410, 5.6879, 6.1887, 6.0187, 6.0335,
        6.0579, 6.0455, 5.8785, 6.0645, 5.7630, 5.8317, 5.7829, 6.0215, 5.7791,
        6.2469, 5.7250, 5.6208, 5.9145, 5.8594, 5.7355, 5.5253, 5.5877, 6.0962,
        6.2802], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.5343915343915344, middle:0.3404255319148936, tail0.20833333333333334
3shot of client 1:head:0.5542406311637081, middle:0.3125, tail0.030303030303030304
3shot of client 2:head:0.33557046979865773, middle:0.32894736842105265, tail0.3333333333333333
3shot of client 3:head:0.5239085239085239, middle:0.4444444444444444, tail0.06666666666666667
3shot of client 4:head:0.6659836065573771, middle:0.2608695652173913, tail0.10344827586206896
3shot of client 5:head:0.598825831702544, middle:0.144, tail0.1875
3shot of client 6:head:0.3673469387755102, middle:0.37333333333333335, tail0.21052631578947367
3shot of client 7:head:0.3854166666666667, middle:0.2391304347826087, tail0.4166666666666667
3shot of client 8:head:0.5535307517084282, middle:0.23076923076923078, tail0.07692307692307693
3shot of client 9:head:0.4581673306772908, middle:0.2647058823529412, tail0.06666666666666667
3shot of client 10:head:0.5670391061452514, middle:0.10465116279069768, tail0.09090909090909091
3shot of client 11:head:0.5641025641025641, middle:0.2159090909090909, tail0.21739130434782608
3shot of client 12:head:0.5948275862068966, middle:0.2261904761904762, tail0.19047619047619047

  6%|▋         | 32/500 [1:49:16<26:28:26, 203.65s/it]3shot of client 13:head:0.6327160493827161, middle:0.35294117647058826, tail0.15
3shot of client 14:head:0.3935309973045822, middle:0.30526315789473685, tail0.2916666666666667
3shot of client 15:head:0.36507936507936506, middle:0.5, tail0.0
3shot of client 16:head:0.4189189189189189, middle:0.38235294117647056, tail0.05555555555555555
3shot of client 17:head:0.47440273037542663, middle:0.3333333333333333, tail0.35294117647058826
3shot of client 18:head:0.6838235294117647, middle:0.2714285714285714, tail0.17647058823529413
3shot of client 19:head:0.5959595959595959, middle:0.225, tail0.17647058823529413
round 31, local average test acc  0.4550 

round 31, local macro average F1 score  0.2486 

round 31, local weighted average F1 score  0.4426 

round 31, global test acc  0.1730 

round 31, average 3shot acc: [head: 0.5134, middle: 0.2928, tail: 0.1701] 

round 31, global 3shot acc: [head: 0.3681, middle: 0.1873, tail: 0.0530] 

l_head tensor([ 6.9371,  5.3922,  7.8266,  0.5944,  8.9285, 11.2194, 10.4065,  3.0220,
        11.7222,  3.6640,  5.9060, 13.1777,  6.7055,  4.5384, 11.3210,  8.3695,
         4.1320,  5.0046,  0.5704,  5.6764,  0.5833,  4.8464,  5.8020,  7.9328,
         5.9385,  4.8152,  7.8387, 11.9795,  0.5773,  7.7333,  4.5196,  0.5875,
         3.9566,  0.5837, 10.4197,  8.3334,  7.8199,  3.1524,  9.2274,  0.5674,
         4.1933,  0.5809,  0.6059,  0.5732,  2.7627,  7.6581,  0.5519,  0.5711,
         5.9494,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  3.0427,  0.5893,
         4.2475,  4.4175,  0.5923,  0.5799,  4.0855,  0.5719,  5.6575,  0.5882,
         3.3006,  5.0947,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  2.7606,  0.5874,  0.5713,  2.9945,  0.5767,  0.5891,
         0.5729,  0.5621,  5.1799,  0.5596,  0.5827,  0.5811,  2.9548,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  3.6745,
         3.1647,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([9.5776, 9.0960, 9.0921, 8.8410, 8.0197, 9.1329, 9.0860, 9.3273, 8.9434,
        9.0711, 8.8851, 9.2366, 9.1067, 7.9886, 9.9268, 9.3800, 9.0965, 8.5661,
        9.5399, 8.7482, 8.4869, 8.5286, 9.5157, 9.1759, 9.2097, 8.3824, 7.7893,
        8.6656, 8.7292, 7.5668, 8.4278, 9.0865, 7.9148, 7.7441, 8.6219, 7.9185,
        7.4978, 8.3762, 7.6273, 8.2329, 7.0313, 7.3708, 8.7843, 7.2671, 6.8932,
        7.1022, 7.3558, 8.0535, 6.8784, 7.7177, 6.8842, 6.4233, 6.6070, 7.3774,
        6.5340, 8.2569, 6.5720, 8.0222, 7.1131, 7.3956, 7.3476, 7.1365, 6.4801,
        7.1748, 6.2161, 7.2271, 6.8089, 8.4710, 6.8882, 6.8679, 6.5046, 6.8016,
        7.1887, 6.4725, 6.5658, 6.1162, 7.1044, 5.9499, 6.3502, 6.1940, 6.4237,
        6.2240, 6.3932, 6.1946, 6.3879, 6.2457, 6.0025, 6.1174, 6.3475, 5.9792,
        6.4995, 6.1285, 5.8416, 6.1160, 6.3858, 5.9111, 5.9419, 5.9086, 6.4689,
        6.4604], device='cuda:2', grad_fn=<NormBackward1>)
3shot of client 0:head:0.5026455026455027, middle:0.35106382978723405, tail0.20833333333333334
3shot of client 1:head:0.5522682445759369, middle:0.390625, tail0.09090909090909091
3shot of client 2:head:0.5167785234899329, middle:0.2631578947368421, tail0.3333333333333333
3shot of client 3:head:0.5945945945945946, middle:0.4523809523809524, tail0.13333333333333333
3shot of client 4:head:0.6454918032786885, middle:0.28695652173913044, tail0.1724137931034483
3shot of client 5:head:0.6203522504892368, middle:0.168, tail0.21875
3shot of client 6:head:0.46258503401360546, middle:0.3333333333333333, tail0.05263157894736842
3shot of client 7:head:0.46875, middle:0.2608695652173913, tail0.3333333333333333
3shot of client 8:head:0.5535307517084282, middle:0.27350427350427353, tail0.11538461538461539
3shot of client 9:head:0.5219123505976095, middle:0.22058823529411764, tail0.13333333333333333
3shot of client 10:head:0.6508379888268156, middle:0.22093023255813954, tail0.13636363636363635
3shot of client 11:head:0.5555555555555556, middle:0.2840909090909091, tail0.21739130434782608
3shot of client 12:head:0.6637931034482759, middle:0.17857142857142858, tail0.19047619047619047
3shot of client 13:head:0.7098765432098766, middle:0.38823529411764707, tail0.1
3shot of client 14:head:0.5579514824797843, middle:0.22105263157894736, tail0.20833333333333334
3shot of client 15:head:0.42857142857142855, middle:0.4032258064516129, tail0.0625
3shot of client 16:head:0.4864864864864865, middle:0.3235294117647059, tail0.1111111111111111
3shot of client 17:head:0.5255972696245734, middle:0.4305555555555556, tail0.23529411764705882
3shot of client 18:head:0.625, middle:0.38571428571428573, tail0.17647058823529413
3shot of client 19:head:0.5892255892255892, middle:0.35, tail0.23529411764705882
round 32, local average test acc  0.4951 

round 32, local macro average F1 score  0.2677 

round 32, local weighted average F1 score  0.4848 

round 32, global test acc  0.2000 

round 32, average 3shot acc: [head: 0.5616, middle: 0.3093, tail: 0.1732] 

round 32, global 3shot acc: [head: 0.4030, middle: 0.2412, tail: 0.0606] 

l_head tensor([ 7.0422,  5.5413,  8.2680,  0.5944,  9.0469, 11.4410, 10.4364,  3.1641,
        11.8997,  3.8624,  6.0136, 13.5417,  6.7252,  4.6079, 11.5468,  8.5128,
         4.1985,  5.0737,  0.5704,  5.8799,  0.5833,  5.0225,  5.7636,  8.2866,
         6.1010,  4.8953,  8.1328, 12.2680,  0.5773,  7.8969,  4.7172,  0.5875,
         4.1596,  0.5837, 10.5986,  8.6763,  7.9564,  3.1590,  9.4005,  0.5674,
         4.1515,  0.5809,  0.6059,  0.5732,  2.8567,  7.8723,  0.5519,  0.5711,
         6.1179,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  3.1165,  0.5893,
         4.3205,  4.6273,  0.5923,  0.5799,  4.3525,  0.5719,  5.6929,  0.5882,
         3.6633,  5.3052,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  2.7966,  0.5874,  0.5713,  3.2619,  0.5767,  0.5891,
         0.5729,  0.5621,  5.3629,  0.5596,  0.5827,  0.5811,  3.1710,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  3.8204,
         3.3475,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux 
  7%|▋         | 33/500 [1:52:39<26:24:41, 203.60s/it]
  7%|▋         | 34/500 [1:56:03<26:21:38, 203.65s/it]tensor([ 9.9067,  9.3306,  9.4009,  9.1334,  8.3831,  9.3603,  9.2761,  9.7588,
         9.2750,  9.3188,  9.3518,  9.3247,  9.5135,  8.3743, 10.0515,  9.4265,
         9.2433,  8.9723,  9.8281,  9.2747,  8.8260,  8.8358,  9.7888,  9.3659,
         9.6110,  8.4140,  7.9947,  9.0048,  8.9994,  7.9449,  8.7099,  9.1409,
         8.2929,  8.1268,  9.0376,  8.2141,  7.6327,  8.7582,  7.9468,  8.4123,
         7.2735,  7.7040,  8.9654,  7.5563,  7.0262,  7.4439,  7.5935,  8.2854,
         7.0895,  8.1073,  7.0905,  6.6223,  6.7713,  7.6952,  6.8137,  8.4744,
         6.8253,  8.5317,  7.4516,  7.6687,  7.5185,  7.3620,  6.7442,  7.2543,
         6.4854,  7.5647,  7.2704,  8.7944,  7.3621,  7.2484,  6.7501,  7.2071,
         7.7036,  6.5377,  6.7066,  6.4485,  7.2970,  6.2591,  6.6708,  6.5819,
         6.5432,  6.5734,  6.7294,  6.4271,  6.6666,  6.5321,  6.2936,  6.3910,
         6.6436,  6.4336,  6.7137,  6.4533,  6.0601,  6.4341,  6.4959,  6.0180,
         6.1694,  6.2557,  6.7827,  6.6929], device='cuda:2',
       grad_fn=<NormBackward1>)
3shot of client 0:head:0.4947089947089947, middle:0.3617021276595745, tail0.3333333333333333
3shot of client 1:head:0.5897435897435898, middle:0.421875, tail0.06060606060606061
3shot of client 2:head:0.5335570469798657, middle:0.3026315789473684, tail0.16666666666666666
3shot of client 3:head:0.6029106029106029, middle:0.46825396825396826, tail0.03333333333333333
3shot of client 4:head:0.6311475409836066, middle:0.24347826086956523, tail0.10344827586206896
3shot of client 5:head:0.5831702544031311, middle:0.144, tail0.125
3shot of client 6:head:0.45918367346938777, middle:0.3333333333333333, tail0.15789473684210525
3shot of client 7:head:0.3854166666666667, middle:0.32608695652173914, tail0.3333333333333333
3shot of client 8:head:0.5876993166287016, middle:0.23076923076923078, tail0.11538461538461539
3shot of client 9:head:0.5537848605577689, middle:0.35294117647058826, tail0.06666666666666667
3shot of client 10:head:0.49162011173184356, middle:0.19767441860465115, tail0.13636363636363635
3shot of client 11:head:0.5413105413105413, middle:0.36363636363636365, tail0.2608695652173913
3shot of client 12:head:0.6810344827586207, middle:0.2261904761904762, tail0.23809523809523808
3shot of client 13:head:0.7067901234567902, middle:0.3411764705882353, tail0.25
3shot of client 14:head:0.5849056603773585, middle:0.21052631578947367, tail0.20833333333333334
3shot of client 15:head:0.4087301587301587, middle:0.46774193548387094, tail0.1875
3shot of client 16:head:0.36824324324324326, middle:0.4852941176470588, tail0.1111111111111111
3shot of client 17:head:0.5870307167235495, middle:0.375, tail0.17647058823529413
3shot of client 18:head:0.6838235294117647, middle:0.4, tail0.23529411764705882
3shot of client 19:head:0.6195286195286195, middle:0.325, tail0.17647058823529413
round 33, local average test acc  0.4934 

round 33, local macro average F1 score  0.2765 

round 33, local weighted average F1 score  0.4841 

round 33, global test acc  0.1934 

round 33, average 3shot acc: [head: 0.5547, middle: 0.3289, tail: 0.1738] 

round 33, global 3shot acc: [head: 0.3604, middle: 0.2508, tail: 0.0657] 

l_head tensor([ 7.1107,  5.4929,  8.4971,  0.5944,  9.2327, 11.6082, 10.7187,  3.3406,
        12.0254,  3.8228,  6.0360, 13.7951,  6.8251,  4.7273, 11.7227,  8.6769,
         4.5824,  5.2547,  0.5704,  5.9908,  0.5833,  5.2385,  5.8757,  8.2880,
         6.4964,  5.0839,  8.5505, 12.4148,  0.5773,  8.0497,  4.8121,  0.5875,
         4.2221,  0.5837, 10.5703,  8.9284,  8.2525,  3.2292,  9.5155,  0.5674,
         4.1983,  0.5809,  0.6059,  0.5732,  2.9477,  8.0356,  0.5519,  0.5711,
         6.2041,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  3.3531,  0.5893,
         4.3934,  4.6174,  0.5923,  0.5799,  4.4405,  0.5719,  6.0251,  0.5882,
         3.7173,  5.4656,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  2.8737,  0.5874,  0.5713,  3.2334,  0.5767,  0.5891,
         0.5729,  0.5621,  5.4735,  0.5596,  0.5827,  0.5811,  3.2236,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  3.9110,
         3.4452,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([10.0988,  9.6232,  9.5509,  9.5452,  8.7916,  9.5787,  9.4116, 10.0432,
         9.4675,  9.4911,  9.7303,  9.7548,  9.8187,  8.5618, 10.3752,  9.5871,
         9.4864,  9.0974,  9.9312,  9.4874,  9.1547,  8.9926, 10.0832,  9.7849,
         9.8139,  8.8643,  8.2960,  9.2377,  9.3307,  8.1253,  9.0300,  9.4138,
         8.5236,  8.3926,  9.1500,  8.6509,  7.8514,  9.1204,  8.2195,  8.6226,
         7.6437,  8.0233,  9.1670,  7.7421,  7.3057,  7.6450,  7.7664,  8.5769,
         7.3635,  8.3001,  7.3017,  6.9662,  7.1106,  8.1541,  7.0164,  8.9533,
         7.1322,  8.6229,  7.7093,  8.0341,  7.6432,  7.6737,  7.0435,  7.6335,
         6.8945,  7.8789,  7.4782,  9.0068,  7.4891,  7.6504,  7.0692,  7.2555,
         7.7371,  6.9825,  7.1181,  6.7784,  7.7670,  6.5628,  7.0475,  6.9377,
         6.9329,  7.0771,  7.0478,  6.6619,  7.0703,  6.9563,  6.5894,  6.6947,
         7.0695,  6.6082,  6.9329,  6.6030,  6.4991,  6.9386,  6.7793,  6.3950,
         6.4934,  6.4399,  7.0318,  6.7359], device='cuda:2',
       grad_fn=<NormBackward1>)
3shot of client 0:head:0.5317460317460317, middle:0.3617021276595745, tail0.2916666666666667
3shot of client 1:head:0.6232741617357002, middle:0.4375, tail0.09090909090909091
3shot of client 2:head:0.610738255033557, middle:0.3026315789473684, tail0.2222222222222222
3shot of client 3:head:0.6257796257796258, middle:0.5, tail0.1
3shot of client 4:head:0.6885245901639344, middle:0.3130434782608696, tail0.10344827586206896
3shot of client 5:head:0.5714285714285714, middle:0.344, tail0.1875
3shot of client 6:head:0.48639455782312924, middle:0.41333333333333333, tail0.21052631578947367
3shot of client 7:head:0.4375, middle:0.32608695652173914, tail0.25
3shot of client 8:head:0.5990888382687927, middle:0.1794871794871795, tail0.15384615384615385
3shot of client 9:head:0.42231075697211157, middle:0.45588235294117646, tail0.13333333333333333
3shot of client 10:head:0.547486033519553, middle:0.23255813953488372, tail0.09090909090909091
3shot of client 11:head:0.5327635327635327, middle:0.3409090909090909, tail0.21739130434782608
3shot of client 12:head:0.6896551724137931, middle:0.25, tail0.2857142857142857
3shot of client 13:head:0.6327160493827161, middle:0.3176470588235294, tail0.15
3shot of client 14:head:0.5067385444743935, middle:0.21052631578947367, tail0.2916666666666667
3shot of client 15:head:0.49206349206349204, middle:0.5483870967741935, tail0.0
3shot of client 16:head:0.5067567567567568, middle:0.36764705882352944, tail0.1111111111111111
3shot of client 17:head:0.5597269624573379, middle:0.4166666666666667, tail0.29411764705882354
3shot of client 18:head:0.6286764705882353, middle:0.44285714285714284, tail0.29411764705882354
3shot of client 19:head:0.6195286195286195, middle:0.375, tail0.17647058823529413
round 34, local average test acc  0.5077 

round 34, local macro average F1 score  0.2865 

round 34, local weighted average F1 score  0.5020 

round 34, global test acc  0.2111 

  7%|▋         | 35/500 [1:59:28<26:21:10, 204.02s/it]round 34, average 3shot acc: [head: 0.5656, middle: 0.3568, tail: 0.1827] 

round 34, global 3shot acc: [head: 0.4289, middle: 0.2196, tail: 0.0813] 

l_head tensor([ 7.2369,  5.6775,  8.8443,  0.5944,  9.5268, 11.8741, 10.8129,  3.4397,
        12.3074,  3.9420,  6.3051, 14.0483,  7.0652,  4.8544, 11.9756,  8.9639,
         4.9214,  5.4664,  0.5704,  6.1256,  0.5833,  5.3557,  5.9598,  8.6250,
         6.3677,  5.2961,  8.5757, 12.7373,  0.5773,  8.0709,  4.9508,  0.5875,
         4.3109,  0.5837, 10.8759,  9.0520,  8.2076,  3.2517,  9.7147,  0.5674,
         4.3671,  0.5809,  0.6059,  0.5732,  3.0375,  8.2672,  0.5519,  0.5711,
         6.4052,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  3.3161,  0.5893,
         4.4678,  5.0054,  0.5923,  0.5799,  4.4869,  0.5719,  6.0051,  0.5882,
         4.0118,  5.7626,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  2.8860,  0.5874,  0.5713,  3.2521,  0.5767,  0.5891,
         0.5729,  0.5621,  5.6626,  0.5596,  0.5827,  0.5811,  3.3295,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  4.1103,
         3.5883,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux tensor([10.3362, 10.0361, 10.0099,  9.6105,  8.8879,  9.9596,  9.7972, 10.1709,
         9.6512,  9.7705,  9.6628,  9.9670,  9.9898,  8.8394, 10.6697,  9.8911,
         9.7709,  9.3933, 10.2943,  9.8198,  9.2120,  9.3765, 10.4689, 10.1002,
        10.1728,  9.0718,  8.6336,  9.5717,  9.6401,  8.3526,  9.2566,  9.5495,
         8.7146,  8.4314,  9.4543,  8.6656,  8.2124,  9.1777,  8.5576,  8.8531,
         7.8915,  8.1769,  9.4646,  8.2590,  7.7729,  7.8845,  8.1114,  8.8607,
         7.6679,  8.7256,  7.7285,  7.2881,  7.4706,  8.3059,  7.3578,  9.1101,
         7.5038,  8.9685,  7.8791,  8.3326,  7.9611,  8.1841,  7.5216,  8.0989,
         7.1450,  8.1051,  7.7658,  9.3040,  7.8939,  8.0315,  7.4112,  7.8166,
         8.3516,  7.2437,  7.3965,  7.1006,  7.8366,  6.8029,  7.3254,  7.1567,
         7.0623,  7.3074,  7.1875,  7.1560,  7.2450,  7.1574,  6.9565,  6.9928,
         7.3097,  6.8244,  7.3345,  7.0196,  6.7860,  7.0885,  7.1032,  6.7865,
         6.6894,  6.7616,  7.1883,  7.1386], device='cuda:2',
       grad_fn=<NormBackward1>)
3shot of client 0:head:0.5185185185185185, middle:0.3829787234042553, tail0.3333333333333333
3shot of client 1:head:0.621301775147929, middle:0.4296875, tail0.09090909090909091
3shot of client 2:head:0.44966442953020136, middle:0.42105263157894735, tail0.3888888888888889
3shot of client 3:head:0.5696465696465697, middle:0.5317460317460317, tail0.03333333333333333
3shot of client 4:head:0.7090163934426229, middle:0.23478260869565218, tail0.1724137931034483
3shot of client 5:head:0.6614481409001957, middle:0.192, tail0.3125
3shot of client 6:head:0.48639455782312924, middle:0.41333333333333333, tail0.15789473684210525
3shot of client 7:head:0.421875, middle:0.34782608695652173, tail0.3333333333333333
3shot of client 8:head:0.5808656036446469, middle:0.3247863247863248, tail0.11538461538461539
3shot of client 9:head:0.4820717131474104, middle:0.3382352941176471, tail0.13333333333333333
3shot of client 10:head:0.6005586592178771, middle:0.22093023255813954, tail0.13636363636363635
3shot of client 11:head:0.5270655270655271, middle:0.29545454545454547, tail0.2608695652173913
3shot of client 12:head:0.6551724137931034, middle:0.3333333333333333, tail0.23809523809523808
3shot of client 13:head:0.5524691358024691, middle:0.4117647058823529, tail0.1
3shot of client 14:head:0.49595687331536387, middle:0.21052631578947367, tail0.16666666666666666
3shot of client 15:head:0.3888888888888889, middle:0.532258064516129, tail0.0625
3shot of client 16:head:0.4594594594594595, middle:0.4264705882352941, tail0.1111111111111111
3shot of client 17:head:0.5426621160409556, middle:0.4027777777777778, tail0.4117647058823529
3shot of client 18:head:0.7720588235294118, middle:0.32857142857142857, tail0.23529411764705882
3shot of client 19:head:0.5791245791245792, middle:0.35, tail0.23529411764705882
round 35, local average test acc  0.4995 

round 35, local macro average F1 score  0.2867 

round 35, local weighted average F1 score  0.4901 

round 35, global test acc  0.2079 

round 35, average 3shot acc: [head: 0.5537, middle: 0.3564, tail: 0.2015] 

round 35, global 3shot acc: [head: 0.3885, middle: 0.2592, tail: 0.0757] 

l_head tensor([ 7.3072,  6.0181,  8.8930,  0.5944,  9.6415, 12.0811, 10.8990,  3.5808,
        12.4070,  4.0960,  6.5854, 14.2303,  7.2219,  5.0047, 12.0173,  9.2002,
         5.0390,  5.7292,  0.5704,  6.1890,  0.5833,  5.6792,  6.0889,  8.7266,
         6.4932,  5.5597,  8.7699, 12.9345,  0.5773,  8.2074,  5.1429,  0.5875,
         4.4487,  0.5837, 11.1012,  9.3124,  8.4245,  3.2462,  9.8045,  0.5674,
         4.4419,  0.5809,  0.6059,  0.5732,  3.1101,  8.2437,  0.5519,  0.5711,
         6.5500,  0.5805,  0.5680,  0.5642,  0.5676,  0.5902,  3.3868,  0.5893,
         4.7453,  5.1255,  0.5923,  0.5799,  4.4620,  0.5719,  6.2581,  0.5882,
         4.1213,  5.8696,  0.5878,  0.5846,  0.5933,  0.5848,  0.5813,  0.5939,
         0.5829,  0.5866,  2.8894,  0.5874,  0.5713,  3.5179,  0.5767,  0.5891,
         0.5729,  0.5621,  6.0424,  0.5596,  0.5827,  0.5811,  3.4474,  0.5977,
         0.5664,  0.5796,  0.5959,  0.5712,  0.5848,  0.6012,  0.5539,  4.0256,
         3.6788,  0.5679,  0.5981,  0.5859], device='cuda:2',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:2', grad_fn=<NormBackward1>)
g_aux   7%|▋         | 36/500 [2:02:52<26:18:21, 204.10s/it]  7%|▋         | 37/500 [2:06:16<26:15:20, 204.15s/it]
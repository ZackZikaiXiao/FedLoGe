nohup: ignoring input
./temp/fl_acc_cifar100_resnet34_cons_frac0.2_iidFalse_iter500_ep5_lr0.03_N20_100_seed3407_p1_dirichlet0.5_IF0.01_LossCE.txt
Files already downloaded and verified
[500, 477, 455, 434, 415, 396, 378, 361, 344, 328, 314, 299, 286, 273, 260, 248, 237, 226, 216, 206, 197, 188, 179, 171, 163, 156, 149, 142, 135, 129, 123, 118, 112, 107, 102, 98, 93, 89, 85, 81, 77, 74, 70, 67, 64, 61, 58, 56, 53, 51, 48, 46, 44, 42, 40, 38, 36, 35, 33, 32, 30, 29, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 15, 14, 13, 13, 12, 12, 11, 11, 10, 10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5]
10847
Files already downloaded and verified
Into non-iid sampling
clients_sizes:[573, 766, 469, 733, 726, 766, 466, 320, 676, 410, 554, 546, 535, 512, 586, 396, 460, 448, 431, 474]
training set distribution:
[[  8   5  18   0  32  55  32   1  64   2   4  41   7   3  47  19   2   3
    0   6   0   3   5  14   6   4   9  50   0  11   3   0   2   0  38  12
   11   1  19   0   1   0   0   0   1  10   0   0   3   0   0   0   0   0
    1   0   2   2   0   0   1   0   2   0   2   4   0   0   0   0   0   0
    0   0   1   0   0   1   0   0   0   0   2   0   0   0   1   0   0   0
    0   0   0   0   0   1   1   0   0   0]
 [ 99   7  26  25  22   2  54  80   2  28  22  33   7  19 105   0   1   3
    4  13   2  26   9   3   0   4   4   4  37   0  18   1   2   6   5  16
    4   0  15  13   1   0   0   0   3   2   0   0   0   0   2   2   3   9
    1   0   2   0   2   1   0   0   3   0   0   0   0   0   0   7   0   0
    0   0   0   0   0   0   0   0   0   0   0   1   0   2   1   0   0   0
    0   2   0   1   0   0   0   0   0   0]
 [ 14  60   9  13   3  40   0   8   0   6  24  11  75  13  14   6  11   2
    2   7   0   0   0   0   0  10   0   4   0   3   7  10  11   3   5   0
    8   6   1   0   1   8   1   1   5   0   5   2   4   8   0   1   3   0
    2   1   1   1   3   3   2   2   0   0   0   0   0   0   0   0   2   0
    0   1   4   0   6   1   0   0   4   0   3   0   3   0   1   0   1   2
    0   0   0   0   0   0   0   1   0   0]
 [ 23  89  56   2  47   1   7   8  48  33   0  49   1  29   5  32   2  17
   76   5  13  10   0  12   0   0   2   0   9  19  16   2   0  18   2   0
    6   0   0   2   2   1  26   5  10   2   0   1   0   0   4   1   0   1
    1   0   0   0   0   1   3   0   0   8   3   2   0   1   3   0   1   0
    0   4   0   0   0   0   0   0   0   0   0   1   0   1   0   1   3   0
    3   0   1   0   2   0   0   0   0   0]
 [  9  95  66   3  48   7  41  15  36  24  65   1   2   1   0   2   4   8
    0   6  29   0   2  53   7   2  24  19  10  14   0   3   0  25   2   5
    0  30   3   0   4   0   4   7   7   4   0   0   8   4   3   1   0   0
    2   0   0   4   0   0   0   0   1   0   4   0   0   0   0   0   1   3
    1   0   0   1   0   0   2   1   0   0   1   0   0   0   1   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 22  45  14  67   2   2  54  10  18  22  47  12  10  71  16   1  52   4
    7   1  31  36  16   8  25  30   7   0   8   0   3   0   6   6   6  27
    0   0   0   0   4   0   0   0   2   5   4   5   9   1   5   3   3   0
    1   0   6  14   1   1   0   0   1   0   1   3   0   0   0   0   0   4
    1   2   0   0   0   1   0   1   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [  5   0   1  11  50   1  31  30  22  10   1   1   8   4   2   0   2   6
   31   0  15  46   1   7   9   1  18   0   0  10   5   0   7   2  24   2
    6   2   5  18   4   3   3   0   0   0   2   4   3   8   0   3   1   1
    0   2   4   3   0   0   0   6   0   2   0   2   0   2   0   2   3   0
    0   0   0   0   0   2   1   3   0   0   0   0   0   0   1   0   3   0
    0   0   0   2   0   0   1   0   0   1]
 [  0  19   5  26  11  14   5  14   2  11   1  12  20   2   7   6   0   0
    3   0  21   0   3   0   1   1  14   0   2  12   1   9   3   0   4   6
    1   1   5   0   2  10   1   4   1   2   6   0   2   2   1   4   3   1
    0  16   3   0   0   0   1   0   1   1   0   1   0   3   2   0   1   0
    0   1   1   2   0   1   1   2   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   0]
 [ 44  21  72  58  46  20   1   1  52   0  37  46  14   5  10  11  17   8
    1   1   1   1   8  16  15  40   0   0   0  12   1  10   1   0   0   3
    9   0   5   3   6   5   6   2   7   0   0   5   0   0   2   1   0   0
    7  11   3   0   1   1   2   0   0   0   3   0   4   0   0   1   5   0
    1   0   0   0   0   0   1   0   2   1   0   0   0   0   2   2   0   1
    0   1   0   0   0   0   1   0   0   2]
 [  0  16   3   2  33  70   1  22   1   5  45   9   5   6   3   7   0  14
    7   5   8   5   2   0   1   4   2   5   0   0   1  12   1   7   0   2
    1   2  15  18   0   2   0   0   7  10   3   0   1   2   2   0   5   0
    1   0   7   0   2   0   0   1   0   0   0   0   1   0   0   0   3   1
    0   3   0   3   1   0   0   0   0   0   3   0   2   2   0   2   0   1
    0   1   0   1   0   1   0   0   0   2]
 [  0   0   0  28  16   3  89  14  43   6   9   7   0  12   0   2  62   0
    8  74   2   2   0  26   2   1   8   2   6   0   1   0   2   2   1   2
    5   1   1   0   8   2   0   1   4   7   0  18   0   2   1   0   0  13
    4   0   4   1   0   3   3   0   0   3   3   0   8   0   2   1   0   0
    9   1   2   3   0   1   4   0   1   0   0   1   0   2   0   0   0   0
    0   0   1   0   1   1   0   0   2   0]
 [ 90   0  30  51   5   0   4   3   1   5   1   1   8  11  23  84   0  23
    4   6   0   2   9   0   0   3   0   7   7  17   5   2  21   5   0   3
    0   2   0   2   0   0   0  10   0   1  13   3   0   7   1   2   3   1
    5   0   0   0   6   3   1   1   3   0   5  11   0  12   0   1   0   4
    1   0   4   0   0   0   0   0   1   0   0   3   0   0   0   1   0   1
    2   0   0   0   0   1   1   1   2   0]
 [  9  41   0  22   1  13   6   1   0  53  13   6  47  19   4   2   2  13
   10  15   3   0   0   0  67   8   7   2  37   0  35   0   0  11   0   4
    4   1   2   0   0   8   3   4   2   0   0   0   3   0   5   3   2   8
    5   1   0   5   1   0   1   0   3   0   2   0   0   0   7   0   0   2
    0   0   0   1   3   0   1   0   2   0   1   0   1   0   0   0   0   0
    0   1   0   0   1   0   1   0   0   0]
 [ 14  17   3  80   2  97  18   3   0  17   3   1  13  20   0   1   3   6
    0   0   1  24  40   6   2   1   2   8   0   7   5   1   0   2   1   0
    1   0   5   1  12   4   0  19   6   4   1   5   0   8   0   6   6   0
    2   3   0   0   1   5   0   1   1   6   0   0   0   0   0   1   1   2
    0   0   0   1   3   0   0   2   0   3   0   2   1   0   0   0   0   0
    0   0   1   0   0   0   0   0   0   0]
 [ 30  43   0  19   2   1  17 114   1  68   2   0   6   2   4   9   7  28
    0  11   2   0   7   2  11  12   5  14   9  12   3   2  10   7   0   2
    8   2   0   6  14   4   1   0   0   0  13   1   4   0   8   5   4   0
    6   0   0   4   0   0   2   7   7   2   0   1   2   0   2   3   0   2
    1   0   0   1   0   1   0   2   1   1   0   0   2   2   2   0   0   1
    0   0   0   0   0   1   0   0   1   0]
 [  3   5  43   6  25   7   1  18   0   8   2   2   7   0   0   1   0   0
   37  11   7   0   6   1   3   0  19   0   0   8   0  35  25   0   1  10
    4   0   1  11   6   0   0   4   4   8   5   0  11   9   2   3   0   2
    0   1   1   0   2   2   8   0   4   1   0   0   0   3   1   1   1   0
    0   2   1   2   0   1   0   0   0   3   0   0   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   0   0]
 [ 19   2  21  13   2   0   8  10   1   3  15  15   4  12  17  10  27  40
    1   2   6   1  62  18   2  11  21   7   6   1   0   1   1   1   2   4
   24  15   1   0   2   0   4   1   0   0   2  10   0   0   1   3   4   5
    0   3   0   0   0   0   0   3   0   0   1   0   2   0   0   0   0   0
    0   0   1   0   1   2   3   1   0   0   0   1   1   0   0   0   0   0
    0   1   0   0   2   0   0   0   0   0]
 [  7   5   3   5  21  54   9   0  10   9  20  45  36  35   3  12  23   8
    1   7   0  24   0   4   6  20   6  10   1   0   0   2   0   0   5   0
    0  22   0   6   1   0   0   1   0   0   4   0   3   0   1   0   1   0
    0   0   0   1   0   0   0   6   0   0   1   0   0   0   0   0   0   0
    1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   1
    1   1   1   1   0   0   0   1   0   0]
 [ 87   7  18   0  21   1   0   8   3   2   0   1   6   7   0  10   3  41
    4  35   2   7   7   0   1   2   0  10   3   1  17   2  20   0   0   0
    1   3   0   0   5  20  20   1   5   2   0   2   0   0   9   3   1   1
    2   0   1   0   1  11   1   1   0   3   0   0   3   1   0   3   1   0
    0   1   1   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   1   0   0   0   0]
 [ 17   0  67   3  26   8   0   1  40  16   3   6  10   2   0  33  19   2
   20   1  54   1   2   1   5   2   1   0   0   2   2  26   0  12   6   0
    0   1   7   1   4   7   1   7   0   4   0   0   2   0   1   5   5   0
    0   0   2   0  13   1   5   1   1   0   0   0   3   0   4   0   0   0
    2   0   0   1   0   1   0   0   0   3   0   1   0   0   0   1   0   0
    0   0   1   1   0   0   0   0   0   0]]
Total size of training set
10847
local test distribution:
[[  7   4  16   0  29  50  29   0  59   1   3  37   6   2  43  17   1   2
    0   5   0   2   4  12   5   3   8  46   0  10   2   0   1   0  35  11
   10   0  17   0   0   0   0   0   0   9   0   0   2   0   0   0   0   0
    0   0   1   1   0   0   0   0   1   0   1   3   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 91   6  23  23  20   1  49  73   1  25  20  30   6  17  96   0   0   2
    3  11   1  23   8   2   0   3   3   3  34   0  16   0   1   5   4  14
    3   0  13  11   0   0   0   0   2   1   0   0   0   0   1   1   2   8
    0   0   1   0   1   0   0   0   2   0   0   0   0   0   0   6   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0
    0   1   0   0   0   0   0   0   0   0]
 [ 12  55   8  11   2  36   0   7   0   5  22  10  69  11  12   5  10   1
    1   6   0   0   0   0   0   9   0   3   0   2   6   9  10   2   4   0
    7   5   0   0   0   7   0   0   4   0   4   1   3   7   0   0   2   0
    1   0   0   0   2   2   1   1   0   0   0   0   0   0   0   0   1   0
    0   0   3   0   5   0   0   0   3   0   2   0   2   0   0   0   0   1
    0   0   0   0   0   0   0   0   0   0]
 [ 21  82  51   1  43   0   6   7  44  30   0  45   0  26   4  29   1  15
   70   4  11   9   0  11   0   0   1   0   8  17  14   1   0  16   1   0
    5   0   0   1   1   0  23   4   9   1   0   0   0   0   3   0   0   0
    0   0   0   0   0   0   2   0   0   7   2   1   0   0   2   0   0   0
    0   3   0   0   0   0   0   0   0   0   0   0   0   0   0   0   2   0
    2   0   0   0   1   0   0   0   0   0]
 [  8  87  60   2  44   6  37  13  33  22  59   0   1   0   0   1   3   7
    0   5  26   0   1  48   6   1  22  17   9  12   0   2   0  23   1   4
    0  27   2   0   3   0   3   6   6   3   0   0   7   3   2   0   0   0
    1   0   0   3   0   0   0   0   0   0   3   0   0   0   0   0   0   2
    0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 20  41  12  61   1   1  49   9  16  20  43  11   9  65  14   0  47   3
    6   0  28  33  14   7  23  27   6   0   7   0   2   0   5   5   5  24
    0   0   0   0   3   0   0   0   1   4   3   4   8   0   4   2   2   0
    0   0   5  12   0   0   0   0   0   0   0   2   0   0   0   0   0   3
    0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  4   0   0  10  46   0  28  27  20   9   0   0   7   3   1   0   1   5
   28   0  13  42   0   6   8   0  16   0   0   9   4   0   6   1  22   1
    5   1   4  16   3   2   2   0   0   0   1   3   2   7   0   2   0   0
    0   1   3   2   0   0   0   5   0   1   0   1   0   1   0   1   2   0
    0   0   0   0   0   1   0   2   0   0   0   0   0   0   0   0   2   0
    0   0   0   1   0   0   0   0   0   0]
 [  0  17   4  23  10  12   4  12   1  10   0  11  18   1   6   5   0   0
    2   0  19   0   2   0   0   0  12   0   1  11   0   8   2   0   3   5
    0   0   4   0   1   9   0   3   0   1   5   0   1   1   0   3   2   0
    0  14   2   0   0   0   0   0   0   0   0   0   0   2   1   0   0   0
    0   0   0   1   0   0   0   1   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 40  19  66  53  42  18   0   0  47   0  34  42  12   4   9  10  15   7
    0   0   0   0   7  14  13  36   0   0   0  11   0   9   0   0   0   2
    8   0   4   2   5   4   5   1   6   0   0   4   0   0   1   0   0   0
    6  10   2   0   0   0   1   0   0   0   2   0   3   0   0   0   4   0
    0   0   0   0   0   0   0   0   1   0   0   0   0   0   1   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0  14   2   1  30  64   0  20   0   4  41   8   4   5   2   6   0  12
    6   4   7   4   1   0   0   3   1   4   0   0   0  11   0   6   0   1
    0   1  13  16   0   1   0   0   6   9   2   0   0   1   1   0   4   0
    0   0   6   0   1   0   0   0   0   0   0   0   0   0   0   0   2   0
    0   2   0   2   0   0   0   0   0   0   2   0   1   1   0   1   0   0
    0   0   0   0   0   0   0   0   0   1]
 [  0   0   0  25  14   2  82  12  39   5   8   6   0  11   0   1  57   0
    7  68   1   1   0  23   1   0   7   1   5   0   0   0   1   1   0   1
    4   0   0   0   7   1   0   0   3   6   0  16   0   1   0   0   0  11
    3   0   3   0   0   2   2   0   0   2   2   0   7   0   1   0   0   0
    8   0   1   2   0   0   3   0   0   0   0   0   0   1   0   0   0   0
    0   0   0   0   0   0   0   0   1   0]
 [ 82   0  27  47   4   0   3   2   0   4   0   0   7  10  21  77   0  21
    3   5   0   1   8   0   0   2   0   6   6  15   4   1  19   4   0   2
    0   1   0   1   0   0   0   9   0   0  11   2   0   6   0   1   2   0
    4   0   0   0   5   2   0   0   2   0   4  10   0  11   0   0   0   3
    0   0   3   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0
    1   0   0   0   0   0   0   0   1   0]
 [  8  37   0  20   0  11   5   0   0  48  11   5  43  17   3   1   1  11
    9  13   2   0   0   0  61   7   6   1  34   0  32   0   0  10   0   3
    3   0   1   0   0   7   2   3   1   0   0   0   2   0   4   2   1   7
    4   0   0   4   0   0   0   0   2   0   1   0   0   0   6   0   0   1
    0   0   0   0   2   0   0   0   1   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 12  15   2  73   1  89  16   2   0  15   2   0  11  18   0   0   2   5
    0   0   0  22  36   5   1   0   1   7   0   6   4   0   0   1   0   0
    0   0   4   0  11   3   0  17   5   3   0   4   0   7   0   5   5   0
    1   2   0   0   0   4   0   0   0   5   0   0   0   0   0   0   0   1
    0   0   0   0   2   0   0   1   0   2   0   1   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 27  39   0  17   1   0  15 105   0  62   1   0   5   1   3   8   6  25
    0  10   1   0   6   1  10  11   4  12   8  11   2   1   9   6   0   1
    7   1   0   5  12   3   0   0   0   0  11   0   3   0   7   4   3   0
    5   0   0   3   0   0   1   6   6   1   0   0   1   0   1   2   0   1
    0   0   0   0   0   0   0   1   0   0   0   0   1   1   1   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [  2   4  39   5  23   6   0  16   0   7   1   1   6   0   0   0   0   0
   34  10   6   0   5   0   2   0  17   0   0   7   0  32  23   0   0   9
    3   0   0  10   5   0   0   3   3   7   4   0  10   8   1   2   0   1
    0   0   0   0   1   1   7   0   3   0   0   0   0   2   0   0   0   0
    0   1   0   1   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 17   1  19  11   1   0   7   9   0   2  13  13   3  11  15   9  24  36
    0   1   5   0  57  16   1  10  19   6   5   0   0   0   0   0   1   3
   22  13   0   0   1   0   3   0   0   0   1   9   0   0   0   2   3   4
    0   2   0   0   0   0   0   2   0   0   0   0   1   0   0   0   0   0
    0   0   0   0   0   1   2   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   1   0   0   0   0   0]
 [  6   4   2   4  19  49   8   0   9   8  18  41  33  32   2  11  21   7
    0   6   0  22   0   3   5  18   5   9   0   0   0   1   0   0   4   0
    0  20   0   5   0   0   0   0   0   0   3   0   2   0   0   0   0   0
    0   0   0   0   0   0   0   5   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 80   6  16   0  19   0   0   7   2   1   0   0   5   6   0   9   2  37
    3  32   1   6   6   0   0   1   0   9   2   0  15   1  18   0   0   0
    0   2   0   0   4  18  18   0   4   1   0   1   0   0   8   2   0   0
    1   0   0   0   0  10   0   0   0   2   0   0   2   0   0   2   0   0
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 [ 15   0  61   2  23   7   0   0  36  14   2   5   9   1   0  30  17   1
   18   0  49   0   1   0   4   1   0   0   0   1   1  23   0  11   5   0
    0   0   6   0   3   6   0   6   0   3   0   0   1   0   0   4   4   0
    0   0   1   0  11   0   4   0   0   0   0   0   2   0   3   0   0   0
    1   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]]
Total size of testing set
9199
[452 431 408 389 372 352 338 321 307 292 278 265 254 241 231 219 208 197
 190 180 170 165 156 148 140 132 128 124 119 112 102  99  95  91  85  81
  77  71  68  67  59  61  56  52  50  48  45  44  41  41  32  30  30  31
  26  29  24  25  21  21  18  19  16  18  15  17  16  16  14  11   9  11
   9   7   7   6   9   2   6   5   5   6   5   3   4   4   2   2   4   1
   3   1   0   1   2   0   0   0   2   2]
20

  0%|          | 0/500 [00:00<?, ?it/s]
  0%|          | 1/500 [04:30<37:29:27, 270.48s/it]3shot of client 0:head:0.11375661375661375, middle:0.0, tail0.0
3shot of client 1:head:0.045364891518737675, middle:0.0, tail0.0
3shot of client 2:head:0.18456375838926176, middle:0.0, tail0.0
3shot of client 3:head:0.09147609147609148, middle:0.0, tail0.0
3shot of client 4:head:0.12295081967213115, middle:0.0, tail0.0
3shot of client 5:head:0.06457925636007827, middle:0.0, tail0.0
3shot of client 6:head:0.07482993197278912, middle:0.0, tail0.0
3shot of client 7:head:0.07291666666666667, middle:0.0, tail0.0
3shot of client 8:head:0.1070615034168565, middle:0.0, tail0.0
3shot of client 9:head:0.035856573705179286, middle:0.0, tail0.0
3shot of client 10:head:0.15921787709497207, middle:0.0, tail0.0
3shot of client 11:head:0.21937321937321938, middle:0.0, tail0.0
3shot of client 12:head:0.10632183908045977, middle:0.0, tail0.0
3shot of client 13:head:0.0, middle:0.058823529411764705, tail0.0
3shot of client 14:head:0.0, middle:0.08421052631578947, tail0.0
3shot of client 15:head:0.09126984126984126, middle:0.0, tail0.0
3shot of client 16:head:0.19256756756756757, middle:0.0, tail0.0
3shot of client 17:head:0.10921501706484642, middle:0.0, tail0.0
3shot of client 18:head:0.13602941176470587, middle:0.0, tail0.0
3shot of client 19:head:0.0, middle:0.0375, tail0.0
round 0, local average test acc  0.0754 

round 0, local macro average F1 score  0.0032 

round 0, local weighted average F1 score  0.0140 

round 0, global test acc  0.0100 

round 0, average 3shot acc: [head: 0.0964, middle: 0.0090, tail: 0.0000] 

round 0, global 3shot acc: [head: 0.0370, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.8037, 0.7498, 0.9242, 0.5941, 0.8677, 1.5404, 1.1033, 0.6257, 1.4001,
        0.6589, 0.6876, 1.4341, 0.8028, 0.6368, 1.2803, 0.9539, 0.6211, 0.7829,
        0.5697, 0.7449, 0.5830, 0.6431, 0.7353, 0.9142, 0.7522, 0.6686, 0.8945,
        1.0632, 0.5767, 0.8678, 0.7186, 0.5870, 0.6423, 0.5834, 1.1401, 0.8590,
        0.8070, 0.6125, 0.8170, 0.5664, 0.6813, 0.5804, 0.6053, 0.5726, 0.6043,
        0.7620, 0.5514, 0.5703, 0.5947, 0.5800, 0.5672, 0.5636, 0.5672, 0.5896,
        0.6144, 0.5888, 0.6263, 0.6063, 0.5920, 0.5793, 0.6905, 0.5714, 0.6420,
        0.5876, 0.7123, 0.6270, 0.5872, 0.5841, 0.5928, 0.5847, 0.5808, 0.5932,
        0.5824, 0.5861, 0.6104, 0.5868, 0.5709, 0.5674, 0.5759, 0.5888, 0.5725,
        0.5614, 0.7483, 0.5590, 0.5821, 0.5804, 0.6252, 0.5971, 0.5659, 0.5791,
        0.5954, 0.5706, 0.5843, 0.6006, 0.5533, 0.6361, 0.6977, 0.5672, 0.5975,
        0.5857], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0430, 0.0436, 0.0433, 0.0376, 0.0336, 0.0384, 0.0543, 0.0536, 0.0419,
        0.0469, 0.0413, 0.0375, 0.0409, 0.0351, 0.0418, 0.0381, 0.0504, 0.0314,
        0.0352, 0.0450, 0.0463, 0.0321, 0.0410, 0.0402, 0.0620, 0.0357, 0.0372,
        0.0338, 0.0397, 0.0293, 0.0360, 0.0354, 0.0333, 0.0350, 0.0365, 0.0306,
        0.0316, 0.0397, 0.0271, 0.0293, 0.0315, 0.0312, 0.0276, 0.0298, 0.0274,
        0.0299, 0.0325, 0.0360, 0.0339, 0.0305, 0.0292, 0.0294, 0.0296, 0.0428,
        0.0318, 0.0283, 0.0262, 0.0347, 0.0376, 0.0273, 0.0341, 0.0325, 0.0351,
        0.0262, 0.0300, 0.0292, 0.0361, 0.0281, 0.0401, 0.0282, 0.0277, 0.0310,
        0.0446, 0.0256, 0.0305, 0.0293, 0.0322, 0.0303, 0.0350, 0.0303, 0.0324,
        0.0312, 0.0272, 0.0292, 0.0318, 0.0306, 0.0301, 0.0261, 0.0282, 0.0276,
        0.0259, 0.0265, 0.0319, 0.0288, 0.0303, 0.0291, 0.0292, 0.0271, 0.0358,
        0.0234], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.12433862433862433, middle:0.0, tail0.0
3shot of client 1:head:0.14792899408284024, middle:0.0, tail0.0
3shot of client 2:head:0.2348993288590604, middle:0.0, tail0.0
3shot of client 3:head:0.062370062370062374, middle:0.0, tail0.0
3shot of client 4:head:0.0942622950819672, middle:0.0, tail0.0
3shot of client 5:head:0.11937377690802348, middle:0.0, tail0.0
3shot of client 6:head:0.047619047619047616, middle:0.0, tail0.0
3shot of client 7:head:0.09895833333333333, middle:0.0, tail0.0
3shot of client 8:head:0.12300683371298406, middle:0.0, tail0.0
3shot of client 9:head:0.11952191235059761, middle:0.0, tail0.0
3shot of client 10:head:0.2206703910614525, middle:0.0, tail0.0
3shot of client 11:head:0.05982905982905983, middle:0.0, tail0.0
3shot of client 12:head:0.0, middle:0.07142857142857142, tail0.0
3shot of client 13:head:0.05864197530864197, middle:0.0, tail0.0
3shot of client 14:head:0.04582210242587601, middle:0.0, tail0.0
3shot of client 15:head:0.04365079365079365, middle:0.0, tail0.0
3shot of client 16:head:0.05067567567567568, middle:0.0, tail0.0
3shot of client 17:head:0.0, middle:0.05555555555555555, tail0.0
3shot of client 18:head:0.07352941176470588, middle:0.0, tail0.0
3shot of client 19:head:0.20202020202020202, middle:0.0, tail0.0
round 1, local average test acc  0.0745 

round 1, local macro average F1 score  0.0042 

round 1, local weighted average F1 score  0.0180 

round 1, global test acc  0.0118 

round 1, average 3shot acc: [head: 0.0964, middle: 0.0063, tail: 0.0000] 

round 1, global 3shot acc: [head: 0.0437, middle: 0.0000, tail: 0.0000] 

l_head tensor([0.9903, 0.7655, 1.1051, 0.5950, 1.2863, 2.1068, 1.7134, 0.6259, 2.1248,
        0.7053, 0.7721, 1.9171, 0.9575, 0.7073, 1.9403, 1.1600, 0.6684, 0.7616,
        0.5706, 0.8444, 0.5839, 0.7502, 0.8686, 1.1237, 0.8972, 0.7043, 1.1069,
        1.7094, 0.5776, 1.0452, 0.8510, 0.5879, 0.7681, 0.5842, 1.7485, 1.0129,
        0.9820, 0.6500, 1.1531, 0.5674, 0.6743, 0.5813, 0.6062, 0.5736, 0.6249,
        0.9308, 0.5523, 0.5712, 0.6506, 0.5809, 0.5682, 0.5645, 0.5681, 0.5905,
        0.6401, 0.5896, 0.6591, 0.7443, 0.5929, 0.5802, 0.6341, 0.5723, 0.7610,
        0.5885, 0.7958, 0.6895, 0.5881, 0.5850, 0.5938, 0.5856, 0.5817, 0.5940,
        0.5833, 0.5870, 0.7204, 0.5877, 0.5718, 0.6084, 0.5769, 0.5896, 0.5733,
        0.5623, 0.7454, 0.5599, 0.5830, 0.5813, 0.6794, 0.5981, 0.5668, 0.5800,
        0.5963, 0.5715, 0.5852, 0.6015, 0.5542, 0.6936, 0.7065, 0.5681, 0.5984,
        0.5865], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux 
  0%|          | 2/500 [08:49<36:30:29, 263.92s/it]
  1%|          | 3/500 [13:09<36:09:55, 261.96s/it]tensor([0.0443, 0.0296, 0.0295, 0.0312, 0.0244, 0.0361, 0.0409, 0.0330, 0.0309,
        0.0308, 0.0272, 0.0274, 0.0194, 0.0235, 0.0418, 0.0408, 0.0387, 0.0203,
        0.0346, 0.0314, 0.0274, 0.0255, 0.0320, 0.0218, 0.0304, 0.0212, 0.0228,
        0.0171, 0.0240, 0.0167, 0.0268, 0.0239, 0.0256, 0.0124, 0.0245, 0.0170,
        0.0148, 0.0144, 0.0123, 0.0213, 0.0126, 0.0126, 0.0178, 0.0175, 0.0094,
        0.0115, 0.0138, 0.0196, 0.0120, 0.0136, 0.0089, 0.0085, 0.0064, 0.0254,
        0.0081, 0.0177, 0.0075, 0.0221, 0.0172, 0.0090, 0.0155, 0.0099, 0.0150,
        0.0118, 0.0078, 0.0149, 0.0117, 0.0229, 0.0121, 0.0100, 0.0085, 0.0117,
        0.0177, 0.0068, 0.0090, 0.0054, 0.0102, 0.0072, 0.0069, 0.0086, 0.0070,
        0.0113, 0.0109, 0.0120, 0.0052, 0.0097, 0.0053, 0.0048, 0.0113, 0.0047,
        0.0083, 0.0073, 0.0056, 0.0084, 0.0069, 0.0063, 0.0055, 0.0067, 0.0096,
        0.0085], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.21164021164021163, middle:0.0, tail0.0
3shot of client 1:head:0.20907297830374755, middle:0.0, tail0.0
3shot of client 2:head:0.006711409395973154, middle:0.05263157894736842, tail0.0
3shot of client 3:head:0.09563409563409564, middle:0.0, tail0.0
3shot of client 4:head:0.09221311475409837, middle:0.0, tail0.0
3shot of client 5:head:0.10763209393346379, middle:0.0, tail0.03125
3shot of client 6:head:0.14285714285714285, middle:0.0, tail0.0
3shot of client 7:head:0.11979166666666667, middle:0.0, tail0.0
3shot of client 8:head:0.009111617312072893, middle:0.05982905982905983, tail0.0
3shot of client 9:head:0.05179282868525897, middle:0.0, tail0.0
3shot of client 10:head:0.10614525139664804, middle:0.0, tail0.0
3shot of client 11:head:0.245014245014245, middle:0.0, tail0.0
3shot of client 12:head:0.10344827586206896, middle:0.0, tail0.0
3shot of client 13:head:0.07407407407407407, middle:0.0, tail0.1
3shot of client 14:head:0.029649595687331536, middle:0.07368421052631578, tail0.0
3shot of client 15:head:0.12301587301587301, middle:0.0, tail0.0
3shot of client 16:head:0.09121621621621621, middle:0.0, tail0.0
3shot of client 17:head:0.05802047781569966, middle:0.0, tail0.0
3shot of client 18:head:0.45588235294117646, middle:0.0, tail0.0
3shot of client 19:head:0.04377104377104377, middle:0.0625, tail0.0
round 2, local average test acc  0.0933 

round 2, local macro average F1 score  0.0100 

round 2, local weighted average F1 score  0.0448 

round 2, global test acc  0.0122 

round 2, average 3shot acc: [head: 0.1188, middle: 0.0124, tail: 0.0066] 

round 2, global 3shot acc: [head: 0.0452, middle: 0.0000, tail: 0.0000] 

l_head tensor([1.1952, 0.8805, 1.4396, 0.5952, 1.8205, 2.6300, 2.1105, 0.6488, 2.8251,
        0.7765, 0.8151, 2.3999, 1.0566, 0.7367, 2.3793, 1.6112, 0.7152, 0.8309,
        0.5708, 0.9544, 0.5841, 0.7273, 0.8681, 1.4287, 1.1213, 0.8383, 1.2808,
        2.4219, 0.5778, 1.2343, 0.8811, 0.5881, 0.7402, 0.5844, 2.2238, 1.3029,
        1.2293, 0.6861, 1.5218, 0.5676, 0.6953, 0.5815, 0.6064, 0.5738, 0.6583,
        1.0897, 0.5525, 0.5714, 0.7355, 0.5811, 0.5684, 0.5646, 0.5683, 0.5906,
        0.6608, 0.5898, 0.7703, 0.8176, 0.5931, 0.5804, 0.7066, 0.5724, 0.8108,
        0.5887, 0.7619, 0.8235, 0.5883, 0.5851, 0.5939, 0.5858, 0.5819, 0.5942,
        0.5835, 0.5872, 0.7460, 0.5879, 0.5719, 0.6668, 0.5771, 0.5898, 0.5735,
        0.5625, 0.7965, 0.5601, 0.5832, 0.5815, 0.6935, 0.5982, 0.5670, 0.5802,
        0.5965, 0.5717, 0.5854, 0.6017, 0.5544, 0.8086, 0.7136, 0.5683, 0.5986,
        0.5867], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0405, 0.0397, 0.0300, 0.0313, 0.0236, 0.0382, 0.0403, 0.0538, 0.0328,
        0.0441, 0.0346, 0.0263, 0.0281, 0.0253, 0.0535, 0.0304, 0.0419, 0.0220,
        0.0260, 0.0337, 0.0299, 0.0284, 0.0373, 0.0295, 0.0484, 0.0190, 0.0190,
        0.0223, 0.0331, 0.0161, 0.0355, 0.0186, 0.0185, 0.0160, 0.0226, 0.0195,
        0.0161, 0.0231, 0.0191, 0.0189, 0.0152, 0.0163, 0.0203, 0.0177, 0.0094,
        0.0114, 0.0171, 0.0197, 0.0111, 0.0148, 0.0157, 0.0105, 0.0086, 0.0320,
        0.0104, 0.0184, 0.0077, 0.0186, 0.0156, 0.0140, 0.0129, 0.0137, 0.0167,
        0.0122, 0.0066, 0.0099, 0.0135, 0.0154, 0.0134, 0.0144, 0.0087, 0.0115,
        0.0166, 0.0069, 0.0076, 0.0061, 0.0123, 0.0051, 0.0097, 0.0082, 0.0138,
        0.0101, 0.0115, 0.0087, 0.0097, 0.0077, 0.0067, 0.0044, 0.0074, 0.0059,
        0.0087, 0.0069, 0.0064, 0.0052, 0.0065, 0.0103, 0.0041, 0.0049, 0.0133,
        0.0118], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.1455026455026455, middle:0.0, tail0.0
3shot of client 1:head:0.21499013806706113, middle:0.0, tail0.0
3shot of client 2:head:0.27181208053691275, middle:0.0, tail0.0
3shot of client 3:head:0.09355509355509356, middle:0.0, tail0.0
3shot of client 4:head:0.1721311475409836, middle:0.0, tail0.0
3shot of client 5:head:0.0958904109589041, middle:0.0, tail0.0
3shot of client 6:head:0.08163265306122448, middle:0.0, tail0.0
3shot of client 7:head:0.140625, middle:0.0, tail0.0
3shot of client 8:head:0.05466970387243736, middle:0.07692307692307693, tail0.0
3shot of client 9:head:0.26294820717131473, middle:0.0, tail0.0
3shot of client 10:head:0.14804469273743018, middle:0.0, tail0.0
3shot of client 11:head:0.23931623931623933, middle:0.0, tail0.0
3shot of client 12:head:0.1235632183908046, middle:0.0, tail0.0
3shot of client 13:head:0.26851851851851855, middle:0.0, tail0.0
3shot of client 14:head:0.2884097035040431, middle:0.031578947368421054, tail0.0
3shot of client 15:head:0.17063492063492064, middle:0.0, tail0.0
3shot of client 16:head:0.13851351351351351, middle:0.0, tail0.05555555555555555
3shot of client 17:head:0.17064846416382254, middle:0.0, tail0.0
3shot of client 18:head:0.3272058823529412, middle:0.0, tail0.0
3shot of client 19:head:0.08080808080808081, middle:0.0, tail0.0
round 3, local average test acc  0.1340 

round 3, local macro average F1 score  0.0168 

round 3, local weighted average F1 score  0.0753 

round 3, global test acc  0.0191 

round 3, average 3shot acc: [head: 0.1745, middle: 0.0054, tail: 0.0028] 

round 3, global 3shot acc: [head: 0.0374, middle: 0.0346, tail: 0.0000] 

l_head tensor([1.5313, 1.0082, 1.6870, 0.5952, 2.2690, 3.3598, 2.7334, 0.7161, 3.3899,
        0.8104, 0.9050, 3.0130, 1.1619, 0.7966, 3.1318, 1.9279, 0.7650, 0.9093,
        0.5709, 1.0184, 0.5841, 0.9637, 1.0805, 1.7979, 1.2759, 1.0255, 1.5425,
        3.0448, 0.5778, 1.5437, 0.9239, 0.5882, 0.7761, 0.5845, 2.6877, 1.6132,
        1.5740, 0.7305, 1.9478, 0.5676, 0.7684, 0.5815, 0.6064, 0.5738, 0.7778,
        1.3692, 0.5526, 0.5714, 0.8685, 0.5811, 0.5684, 0.5647, 0.5684, 0.5907,
        0.7390, 0.5899, 0.7972, 0.9196, 0.5931, 0.5804, 0.8245, 0.5725, 0.9793,
        0.5887, 0.7788, 0.9050, 0.5883, 0.5852, 0.5940, 0.5858, 0.5819, 0.5942,
        0.5835, 0.5872, 0.7802, 0.5879, 0.5720, 0.7046, 0.5771, 0.5898, 0.5735,
        0.5625, 0.9028, 0.5601, 0.5832, 0.5816, 0.7067, 0.5983, 0.5670, 0.5802,
        0.5965, 0.5718, 0.5854, 0.6017, 0.5545, 0.8095, 0.7660, 0.5683, 0.5987,
        0.5867], device='cuda:1', grad_fn=<NormBackward1>)
g_head 
  1%|          | 4/500 [17:30<36:01:58, 261.53s/it]
  1%|          | 5/500 [21:50<35:53:13, 261.00s/it]tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0347, 0.0448, 0.0353, 0.0273, 0.0321, 0.0396, 0.0361, 0.0517, 0.0372,
        0.0336, 0.0474, 0.0277, 0.0357, 0.0278, 0.0432, 0.0372, 0.0372, 0.0256,
        0.0390, 0.0254, 0.0395, 0.0282, 0.0351, 0.0425, 0.0353, 0.0235, 0.0264,
        0.0255, 0.0251, 0.0173, 0.0256, 0.0331, 0.0251, 0.0211, 0.0248, 0.0225,
        0.0160, 0.0371, 0.0200, 0.0260, 0.0120, 0.0142, 0.0216, 0.0132, 0.0123,
        0.0140, 0.0152, 0.0155, 0.0158, 0.0213, 0.0111, 0.0079, 0.0096, 0.0187,
        0.0080, 0.0166, 0.0112, 0.0223, 0.0184, 0.0130, 0.0194, 0.0125, 0.0147,
        0.0098, 0.0082, 0.0121, 0.0104, 0.0249, 0.0108, 0.0127, 0.0104, 0.0123,
        0.0123, 0.0133, 0.0088, 0.0077, 0.0172, 0.0069, 0.0085, 0.0079, 0.0107,
        0.0116, 0.0140, 0.0081, 0.0130, 0.0106, 0.0078, 0.0066, 0.0091, 0.0104,
        0.0083, 0.0071, 0.0080, 0.0077, 0.0085, 0.0080, 0.0072, 0.0065, 0.0080,
        0.0093], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.17989417989417988, middle:0.02127659574468085, tail0.0
3shot of client 1:head:0.22287968441814596, middle:0.0, tail0.0
3shot of client 2:head:0.08053691275167785, middle:0.02631578947368421, tail0.0
3shot of client 3:head:0.16424116424116425, middle:0.007936507936507936, tail0.0
3shot of client 4:head:0.22131147540983606, middle:0.0, tail0.0
3shot of client 5:head:0.20939334637964774, middle:0.0, tail0.0
3shot of client 6:head:0.19727891156462585, middle:0.0, tail0.0
3shot of client 7:head:0.109375, middle:0.0, tail0.0
3shot of client 8:head:0.2255125284738041, middle:0.0, tail0.0
3shot of client 9:head:0.11155378486055777, middle:0.0, tail0.0
3shot of client 10:head:0.18994413407821228, middle:0.0, tail0.0
3shot of client 11:head:0.2336182336182336, middle:0.0, tail0.0
3shot of client 12:head:0.21551724137931033, middle:0.011904761904761904, tail0.0
3shot of client 13:head:0.18209876543209877, middle:0.03529411764705882, tail0.0
3shot of client 14:head:0.29649595687331537, middle:0.0, tail0.0
3shot of client 15:head:0.1349206349206349, middle:0.03225806451612903, tail0.0
3shot of client 16:head:0.1554054054054054, middle:0.04411764705882353, tail0.0
3shot of client 17:head:0.23208191126279865, middle:0.0, tail0.0
3shot of client 18:head:0.5, middle:0.0, tail0.0
3shot of client 19:head:0.13804713804713806, middle:0.075, tail0.0
round 4, local average test acc  0.1547 

round 4, local macro average F1 score  0.0249 

round 4, local weighted average F1 score  0.0926 

round 4, global test acc  0.0213 

round 4, average 3shot acc: [head: 0.2000, middle: 0.0127, tail: 0.0000] 

round 4, global 3shot acc: [head: 0.0744, middle: 0.0038, tail: 0.0004] 

l_head tensor([1.8419, 1.1136, 1.8749, 0.5952, 2.8658, 3.9355, 3.2507, 0.7911, 4.0017,
        0.9584, 0.9779, 3.5368, 1.3942, 0.9771, 3.7454, 2.2333, 0.8494, 1.0268,
        0.5709, 1.1823, 0.5842, 1.0144, 1.2294, 2.0929, 1.5377, 1.0747, 1.6363,
        3.6979, 0.5779, 1.7937, 0.9573, 0.5882, 0.7950, 0.5845, 3.1926, 1.8556,
        1.7312, 0.7682, 2.3987, 0.5676, 0.8550, 0.5816, 0.6064, 0.5738, 0.7534,
        1.6636, 0.5526, 0.5715, 0.9915, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        0.7749, 0.5899, 0.8377, 0.9580, 0.5931, 0.5804, 0.7832, 0.5725, 1.1411,
        0.5888, 0.8944, 1.0126, 0.5883, 0.5852, 0.5940, 0.5858, 0.5820, 0.5943,
        0.5836, 0.5873, 0.7750, 0.5880, 0.5720, 0.7145, 0.5771, 0.5898, 0.5736,
        0.5625, 0.9941, 0.5602, 0.5833, 0.5816, 0.8099, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 0.8470, 0.8056, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0436, 0.0395, 0.0310, 0.0371, 0.0308, 0.0366, 0.0429, 0.0453, 0.0409,
        0.0321, 0.0350, 0.0375, 0.0291, 0.0363, 0.0515, 0.0354, 0.0515, 0.0349,
        0.0394, 0.0375, 0.0337, 0.0338, 0.0504, 0.0327, 0.0416, 0.0292, 0.0244,
        0.0308, 0.0303, 0.0174, 0.0320, 0.0339, 0.0256, 0.0157, 0.0309, 0.0271,
        0.0241, 0.0256, 0.0196, 0.0269, 0.0128, 0.0205, 0.0253, 0.0146, 0.0103,
        0.0158, 0.0176, 0.0266, 0.0172, 0.0233, 0.0118, 0.0106, 0.0157, 0.0346,
        0.0102, 0.0314, 0.0107, 0.0278, 0.0158, 0.0189, 0.0222, 0.0134, 0.0163,
        0.0141, 0.0086, 0.0144, 0.0119, 0.0243, 0.0131, 0.0132, 0.0116, 0.0134,
        0.0204, 0.0118, 0.0102, 0.0079, 0.0128, 0.0083, 0.0146, 0.0092, 0.0080,
        0.0112, 0.0099, 0.0128, 0.0079, 0.0091, 0.0070, 0.0057, 0.0126, 0.0078,
        0.0101, 0.0072, 0.0058, 0.0089, 0.0129, 0.0096, 0.0075, 0.0068, 0.0091,
        0.0088], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.16666666666666666, middle:0.0, tail0.0
3shot of client 1:head:0.2465483234714004, middle:0.0625, tail0.0
3shot of client 2:head:0.2684563758389262, middle:0.0, tail0.0
3shot of client 3:head:0.2286902286902287, middle:0.11904761904761904, tail0.0
3shot of client 4:head:0.24795081967213115, middle:0.008695652173913044, tail0.0
3shot of client 5:head:0.22309197651663404, middle:0.016, tail0.0
3shot of client 6:head:0.10884353741496598, middle:0.05333333333333334, tail0.0
3shot of client 7:head:0.16145833333333334, middle:0.043478260869565216, tail0.0
3shot of client 8:head:0.08200455580865604, middle:0.017094017094017096, tail0.0
3shot of client 9:head:0.2788844621513944, middle:0.014705882352941176, tail0.0
3shot of client 10:head:0.2541899441340782, middle:0.03488372093023256, tail0.0
3shot of client 11:head:0.1168091168091168, middle:0.07954545454545454, tail0.0
3shot of client 12:head:0.1925287356321839, middle:0.023809523809523808, tail0.0
3shot of client 13:head:0.33641975308641975, middle:0.03529411764705882, tail0.0
3shot of client 14:head:0.2722371967654987, middle:0.0, tail0.0
3shot of client 15:head:0.21825396825396826, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.15878378378378377, middle:0.0, tail0.0
3shot of client 17:head:0.18088737201365188, middle:0.0, tail0.0
3shot of client 18:head:0.45588235294117646, middle:0.0, tail0.0
3shot of client 19:head:0.19865319865319866, middle:0.0, tail0.0
round 5, local average test acc  0.1728 

round 5, local macro average F1 score  0.0285 

round 5, local weighted average F1 score  0.1041 

round 5, global test acc  0.0376 

round 5, average 3shot acc: [head: 0.2199, middle: 0.0286, tail: 0.0000] 


  1%|          | 6/500 [26:10<35:45:41, 260.61s/it]
  1%|▏         | 7/500 [30:30<35:40:20, 260.49s/it]round 5, global 3shot acc: [head: 0.1281, middle: 0.0108, tail: 0.0004] 

l_head tensor([2.2109, 1.3000, 2.1847, 0.5952, 3.3033, 4.5119, 3.6951, 0.8523, 4.5698,
        1.0012, 1.1668, 4.1471, 1.5760, 1.1186, 4.3393, 2.5366, 1.0171, 1.3340,
        0.5709, 1.4591, 0.5842, 1.0898, 1.5350, 2.5563, 1.8250, 1.1867, 1.8771,
        4.1024, 0.5779, 2.0494, 1.1201, 0.5882, 0.9115, 0.5845, 3.6274, 2.0460,
        2.0140, 0.7929, 2.8590, 0.5677, 1.0239, 0.5816, 0.6064, 0.5738, 0.8284,
        1.7566, 0.5526, 0.5715, 1.2249, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        0.7850, 0.5899, 0.8914, 1.0406, 0.5932, 0.5805, 0.8607, 0.5725, 1.3942,
        0.5888, 0.9683, 1.1766, 0.5883, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 0.8520, 0.5880, 0.5720, 0.7711, 0.5771, 0.5898, 0.5736,
        0.5626, 1.1494, 0.5602, 0.5833, 0.5816, 0.9025, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 0.8800, 0.9279, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0429, 0.0446, 0.0448, 0.0400, 0.0371, 0.0342, 0.0422, 0.0407, 0.0458,
        0.0303, 0.0516, 0.0361, 0.0336, 0.0340, 0.0352, 0.0491, 0.0388, 0.0263,
        0.0420, 0.0392, 0.0390, 0.0345, 0.0331, 0.0465, 0.0466, 0.0311, 0.0304,
        0.0284, 0.0325, 0.0212, 0.0322, 0.0332, 0.0254, 0.0207, 0.0325, 0.0212,
        0.0185, 0.0392, 0.0176, 0.0291, 0.0136, 0.0189, 0.0235, 0.0183, 0.0120,
        0.0149, 0.0216, 0.0254, 0.0160, 0.0316, 0.0099, 0.0107, 0.0117, 0.0274,
        0.0157, 0.0260, 0.0126, 0.0250, 0.0242, 0.0167, 0.0277, 0.0172, 0.0196,
        0.0115, 0.0120, 0.0199, 0.0151, 0.0391, 0.0218, 0.0096, 0.0211, 0.0137,
        0.0181, 0.0131, 0.0116, 0.0092, 0.0135, 0.0094, 0.0115, 0.0120, 0.0095,
        0.0131, 0.0132, 0.0113, 0.0088, 0.0091, 0.0100, 0.0077, 0.0129, 0.0109,
        0.0120, 0.0064, 0.0065, 0.0100, 0.0076, 0.0097, 0.0105, 0.0074, 0.0133,
        0.0146], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.2328042328042328, middle:0.0, tail0.0
3shot of client 1:head:0.3254437869822485, middle:0.0, tail0.0
3shot of client 2:head:0.2550335570469799, middle:0.0, tail0.0
3shot of client 3:head:0.20166320166320167, middle:0.1111111111111111, tail0.0
3shot of client 4:head:0.22950819672131148, middle:0.0, tail0.0
3shot of client 5:head:0.19765166340508805, middle:0.008, tail0.0
3shot of client 6:head:0.1836734693877551, middle:0.02666666666666667, tail0.0
3shot of client 7:head:0.11979166666666667, middle:0.0, tail0.08333333333333333
3shot of client 8:head:0.0979498861047836, middle:0.008547008547008548, tail0.0
3shot of client 9:head:0.09561752988047809, middle:0.0, tail0.0
3shot of client 10:head:0.2346368715083799, middle:0.0, tail0.0
3shot of client 11:head:0.20797720797720798, middle:0.0, tail0.0
3shot of client 12:head:0.2959770114942529, middle:0.023809523809523808, tail0.0
3shot of client 13:head:0.20987654320987653, middle:0.0, tail0.0
3shot of client 14:head:0.2830188679245283, middle:0.042105263157894736, tail0.0
3shot of client 15:head:0.14285714285714285, middle:0.016129032258064516, tail0.0625
3shot of client 16:head:0.13851351351351351, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.2593856655290102, middle:0.013888888888888888, tail0.0
3shot of client 18:head:0.5147058823529411, middle:0.014285714285714285, tail0.0
3shot of client 19:head:0.13468013468013468, middle:0.05, tail0.11764705882352941
round 6, local average test acc  0.1699 

round 6, local macro average F1 score  0.0345 

round 6, local weighted average F1 score  0.1186 

round 6, global test acc  0.0323 

round 6, average 3shot acc: [head: 0.2180, middle: 0.0165, tail: 0.0132] 

round 6, global 3shot acc: [head: 0.0941, middle: 0.0246, tail: 0.0011] 

l_head tensor([2.5282, 1.5189, 2.3215, 0.5952, 3.8669, 4.7952, 4.0043, 0.8578, 5.1420,
        1.1629, 1.3080, 4.5670, 1.7985, 1.1535, 4.6866, 2.7457, 0.9849, 1.2527,
        0.5709, 1.5323, 0.5842, 1.1648, 1.7642, 2.9627, 1.8824, 1.3449, 2.1682,
        4.7163, 0.5779, 2.3181, 1.2864, 0.5882, 0.9230, 0.5845, 4.2682, 2.3272,
        2.3586, 0.8416, 3.2633, 0.5677, 1.1263, 0.5816, 0.6064, 0.5738, 0.8610,
        2.0210, 0.5526, 0.5715, 1.1415, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        0.9652, 0.5899, 0.9991, 1.1806, 0.5932, 0.5805, 0.9223, 0.5725, 1.5888,
        0.5888, 0.9757, 1.3629, 0.5884, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 0.8905, 0.5880, 0.5720, 0.8724, 0.5771, 0.5898, 0.5736,
        0.5626, 1.3957, 0.5602, 0.5833, 0.5816, 0.8719, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 0.9443, 0.9140, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0502, 0.0413, 0.0398, 0.0411, 0.0348, 0.0457, 0.0433, 0.0551, 0.0498,
        0.0324, 0.0419, 0.0440, 0.0368, 0.0319, 0.0686, 0.0571, 0.0385, 0.0353,
        0.0417, 0.0337, 0.0314, 0.0358, 0.0359, 0.0391, 0.0430, 0.0272, 0.0227,
        0.0408, 0.0438, 0.0227, 0.0410, 0.0274, 0.0279, 0.0219, 0.0393, 0.0229,
        0.0195, 0.0351, 0.0262, 0.0323, 0.0140, 0.0180, 0.0293, 0.0204, 0.0160,
        0.0174, 0.0214, 0.0227, 0.0128, 0.0263, 0.0120, 0.0092, 0.0156, 0.0286,
        0.0135, 0.0173, 0.0143, 0.0228, 0.0216, 0.0171, 0.0205, 0.0188, 0.0158,
        0.0174, 0.0128, 0.0287, 0.0141, 0.0414, 0.0157, 0.0175, 0.0147, 0.0156,
        0.0205, 0.0145, 0.0146, 0.0106, 0.0157, 0.0048, 0.0109, 0.0092, 0.0097,
        0.0149, 0.0189, 0.0129, 0.0090, 0.0117, 0.0083, 0.0094, 0.0138, 0.0079,
        0.0241, 0.0096, 0.0123, 0.0098, 0.0084, 0.0117, 0.0103, 0.0072, 0.0128,
        0.0149], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.2037037037037037, middle:0.0, tail0.0
3shot of client 1:head:0.23471400394477318, middle:0.015625, tail0.0
3shot of client 2:head:0.3288590604026846, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.2910602910602911, middle:0.023809523809523808, tail0.0
3shot of client 4:head:0.32581967213114754, middle:0.0, tail0.0
3shot of client 5:head:0.1506849315068493, middle:0.016, tail0.0
3shot of client 6:head:0.1836734693877551, middle:0.0, tail0.0
3shot of client 7:head:0.16145833333333334, middle:0.043478260869565216, tail0.0

  2%|▏         | 8/500 [34:51<35:38:22, 260.78s/it]3shot of client 8:head:0.15034168564920272, middle:0.03418803418803419, tail0.038461538461538464
3shot of client 9:head:0.16334661354581673, middle:0.0, tail0.0
3shot of client 10:head:0.3240223463687151, middle:0.011627906976744186, tail0.0
3shot of client 11:head:0.358974358974359, middle:0.03409090909090909, tail0.0
3shot of client 12:head:0.2471264367816092, middle:0.03571428571428571, tail0.0
3shot of client 13:head:0.24382716049382716, middle:0.0, tail0.0
3shot of client 14:head:0.3477088948787062, middle:0.0, tail0.041666666666666664
3shot of client 15:head:0.24206349206349206, middle:0.03225806451612903, tail0.0
3shot of client 16:head:0.28716216216216217, middle:0.0, tail0.0
3shot of client 17:head:0.2593856655290102, middle:0.0, tail0.0
3shot of client 18:head:0.35661764705882354, middle:0.07142857142857142, tail0.0
3shot of client 19:head:0.23232323232323232, middle:0.0, tail0.0
round 7, local average test acc  0.1974 

round 7, local macro average F1 score  0.0427 

round 7, local weighted average F1 score  0.1436 

round 7, global test acc  0.0361 

round 7, average 3shot acc: [head: 0.2546, middle: 0.0166, tail: 0.0040] 

round 7, global 3shot acc: [head: 0.0959, middle: 0.0323, tail: 0.0038] 

l_head tensor([2.7566, 1.4916, 2.5784, 0.5952, 4.1574, 5.0383, 4.2524, 0.9428, 5.5017,
        1.2717, 1.4379, 5.0992, 2.1639, 1.2208, 5.0330, 2.8934, 1.1537, 1.4093,
        0.5709, 1.6809, 0.5842, 1.2528, 1.8919, 3.1985, 2.1200, 1.3764, 2.3640,
        5.2886, 0.5779, 2.5532, 1.3510, 0.5882, 1.0259, 0.5845, 4.6228, 2.6915,
        2.6333, 0.9006, 3.5015, 0.5677, 1.2556, 0.5816, 0.6064, 0.5738, 0.8950,
        2.2631, 0.5526, 0.5715, 1.3056, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        1.1456, 0.5899, 1.0174, 1.2077, 0.5932, 0.5805, 1.0005, 0.5725, 1.8110,
        0.5888, 1.0403, 1.5276, 0.5884, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 0.9496, 0.5880, 0.5720, 1.0396, 0.5771, 0.5898, 0.5736,
        0.5626, 1.5378, 0.5602, 0.5833, 0.5816, 0.9210, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 1.0703, 1.1118, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0446, 0.0414, 0.0459, 0.0422, 0.0348, 0.0403, 0.0405, 0.0441, 0.0491,
        0.0313, 0.0366, 0.0389, 0.0372, 0.0318, 0.0368, 0.0615, 0.0500, 0.0357,
        0.0484, 0.0429, 0.0442, 0.0364, 0.0393, 0.0392, 0.0366, 0.0346, 0.0269,
        0.0317, 0.0267, 0.0260, 0.0313, 0.0429, 0.0304, 0.0208, 0.0342, 0.0217,
        0.0220, 0.0357, 0.0167, 0.0307, 0.0151, 0.0250, 0.0308, 0.0193, 0.0151,
        0.0175, 0.0235, 0.0336, 0.0177, 0.0351, 0.0116, 0.0113, 0.0155, 0.0276,
        0.0142, 0.0227, 0.0130, 0.0231, 0.0333, 0.0199, 0.0364, 0.0190, 0.0226,
        0.0155, 0.0109, 0.0260, 0.0171, 0.0473, 0.0169, 0.0125, 0.0196, 0.0148,
        0.0266, 0.0148, 0.0152, 0.0105, 0.0210, 0.0090, 0.0141, 0.0150, 0.0125,
        0.0204, 0.0182, 0.0185, 0.0089, 0.0096, 0.0088, 0.0111, 0.0141, 0.0108,
        0.0171, 0.0076, 0.0129, 0.0100, 0.0112, 0.0108, 0.0093, 0.0068, 0.0209,
        0.0113], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.10846560846560846, middle:0.0851063829787234, tail0.041666666666666664
3shot of client 1:head:0.3136094674556213, middle:0.015625, tail0.0
3shot of client 2:head:0.2550335570469799, middle:0.013157894736842105, tail0.1111111111111111
3shot of client 3:head:0.2765072765072765, middle:0.12698412698412698, tail0.0
3shot of client 4:head:0.3114754098360656, middle:0.0, tail0.0
3shot of client 5:head:0.21135029354207435, middle:0.016, tail0.0
3shot of client 6:head:0.20408163265306123, middle:0.013333333333333334, tail0.0
3shot of client 7:head:0.08854166666666667, middle:0.06521739130434782, tail0.08333333333333333
3shot of client 8:head:0.17995444191343962, middle:0.06837606837606838, tail0.0
3shot of client 9:head:0.24302788844621515, middle:0.014705882352941176, tail0.0
3shot of client 10:head:0.2541899441340782, middle:0.0, tail0.0
3shot of client 11:head:0.2792022792022792, middle:0.045454545454545456, tail0.0
3shot of client 12:head:0.2988505747126437, middle:0.0, tail0.0
3shot of client 13:head:0.345679012345679, middle:0.03529411764705882, tail0.0
3shot of client 14:head:0.33423180592991913, middle:0.031578947368421054, tail0.0
3shot of client 15:head:0.2261904761904762, middle:0.0, tail0.0
3shot of client 16:head:0.2668918918918919, middle:0.0, tail0.0
3shot of client 17:head:0.23208191126279865, middle:0.0, tail0.11764705882352941
3shot of client 18:head:0.3713235294117647, middle:0.0, tail0.0
3shot of client 19:head:0.2356902356902357, middle:0.0875, tail0.0
round 8, local average test acc  0.1986 

round 8, local macro average F1 score  0.0446 

round 8, local weighted average F1 score  0.1559 

round 8, global test acc  0.0564 

round 8, average 3shot acc: [head: 0.2518, middle: 0.0309, tail: 0.0177] 

round 8, global 3shot acc: [head: 0.1744, middle: 0.0308, tail: 0.0028] 

l_head tensor([3.0936, 1.7521, 2.9028, 0.5952, 4.5196, 5.3472, 4.6321, 1.0071, 6.0154,
        1.4235, 1.6395, 5.4909, 2.2684, 1.2861, 5.4457, 3.1466, 1.2828, 1.6953,
        0.5709, 1.8586, 0.5842, 1.4293, 2.0582, 3.3655, 2.3105, 1.4159, 2.6336,
        5.6847, 0.5779, 2.8164, 1.4865, 0.5882, 1.1244, 0.5845, 4.9747, 2.9280,
        2.8536, 0.9380, 4.0065, 0.5677, 1.3306, 0.5816, 0.6064, 0.5738, 1.0589,
        2.4484, 0.5526, 0.5715, 1.4556, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        1.0108, 0.5899, 1.1170, 1.3602, 0.5932, 0.5805, 1.1513, 0.5725, 1.9502,
        0.5888, 1.0817, 1.6988, 0.5884, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 1.0046, 0.5880, 0.5720, 1.0380, 0.5771, 0.5898, 0.5736,
        0.5626, 1.5530, 0.5602, 0.5833, 0.5816, 1.0485, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 1.1168, 1.0608, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux 
  2%|▏         | 9/500 [39:12<35:34:39, 260.85s/it]
  2%|▏         | 10/500 [43:32<35:27:13, 260.48s/it]tensor([0.0493, 0.0456, 0.0401, 0.0390, 0.0340, 0.0418, 0.0330, 0.0629, 0.0441,
        0.0418, 0.0455, 0.0403, 0.0453, 0.0329, 0.0438, 0.0464, 0.0379, 0.0401,
        0.0419, 0.0363, 0.0413, 0.0394, 0.0311, 0.0368, 0.0446, 0.0347, 0.0247,
        0.0335, 0.0361, 0.0236, 0.0447, 0.0389, 0.0300, 0.0239, 0.0327, 0.0238,
        0.0184, 0.0348, 0.0254, 0.0323, 0.0176, 0.0344, 0.0335, 0.0213, 0.0156,
        0.0178, 0.0248, 0.0199, 0.0190, 0.0284, 0.0152, 0.0125, 0.0206, 0.0279,
        0.0158, 0.0286, 0.0163, 0.0266, 0.0322, 0.0265, 0.0315, 0.0213, 0.0263,
        0.0153, 0.0114, 0.0218, 0.0120, 0.0353, 0.0211, 0.0155, 0.0158, 0.0165,
        0.0167, 0.0154, 0.0119, 0.0099, 0.0233, 0.0060, 0.0083, 0.0091, 0.0116,
        0.0179, 0.0251, 0.0157, 0.0139, 0.0120, 0.0111, 0.0106, 0.0162, 0.0108,
        0.0109, 0.0112, 0.0102, 0.0132, 0.0104, 0.0156, 0.0084, 0.0095, 0.0115,
        0.0197], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.2222222222222222, middle:0.0851063829787234, tail0.0
3shot of client 1:head:0.3708086785009862, middle:0.0234375, tail0.0
3shot of client 2:head:0.30201342281879195, middle:0.039473684210526314, tail0.05555555555555555
3shot of client 3:head:0.29313929313929316, middle:0.12698412698412698, tail0.0
3shot of client 4:head:0.32786885245901637, middle:0.0, tail0.0
3shot of client 5:head:0.2563600782778865, middle:0.008, tail0.03125
3shot of client 6:head:0.23809523809523808, middle:0.05333333333333334, tail0.0
3shot of client 7:head:0.13541666666666666, middle:0.043478260869565216, tail0.0
3shot of client 8:head:0.22323462414578588, middle:0.008547008547008548, tail0.0
3shot of client 9:head:0.2788844621513944, middle:0.014705882352941176, tail0.0
3shot of client 10:head:0.2011173184357542, middle:0.0, tail0.0
3shot of client 11:head:0.2621082621082621, middle:0.03409090909090909, tail0.0
3shot of client 12:head:0.27873563218390807, middle:0.08333333333333333, tail0.0
3shot of client 13:head:0.2777777777777778, middle:0.08235294117647059, tail0.0
3shot of client 14:head:0.38005390835579517, middle:0.021052631578947368, tail0.0
3shot of client 15:head:0.32936507936507936, middle:0.016129032258064516, tail0.0
3shot of client 16:head:0.19594594594594594, middle:0.11764705882352941, tail0.0
3shot of client 17:head:0.3037542662116041, middle:0.013888888888888888, tail0.0
3shot of client 18:head:0.5, middle:0.0, tail0.0
3shot of client 19:head:0.35353535353535354, middle:0.0375, tail0.0
round 9, local average test acc  0.2259 

round 9, local macro average F1 score  0.0492 

round 9, local weighted average F1 score  0.1654 

round 9, global test acc  0.0497 

round 9, average 3shot acc: [head: 0.2865, middle: 0.0405, tail: 0.0043] 

round 9, global 3shot acc: [head: 0.1630, middle: 0.0219, tail: 0.0000] 

l_head tensor([3.3827, 1.8946, 3.1994, 0.5952, 4.9131, 5.6845, 5.1213, 1.0673, 6.5783,
        1.5247, 1.6932, 5.7748, 2.3446, 1.4113, 5.8134, 3.2455, 1.3685, 1.7665,
        0.5709, 2.0335, 0.5842, 1.5204, 2.3733, 3.7370, 2.4574, 1.5818, 2.8730,
        5.9683, 0.5779, 2.9804, 1.6139, 0.5882, 1.2204, 0.5845, 5.2875, 3.1169,
        3.0654, 1.0042, 4.2481, 0.5677, 1.4802, 0.5816, 0.6064, 0.5738, 1.0566,
        2.7549, 0.5526, 0.5715, 1.7797, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        1.1234, 0.5899, 1.2632, 1.4759, 0.5932, 0.5805, 1.2680, 0.5725, 2.1154,
        0.5888, 1.1458, 1.8805, 0.5884, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 0.9621, 0.5880, 0.5720, 1.1282, 0.5771, 0.5898, 0.5736,
        0.5626, 1.7199, 0.5602, 0.5833, 0.5816, 1.0751, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 1.3349, 1.0836, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0466, 0.0449, 0.0458, 0.0495, 0.0368, 0.0441, 0.0410, 0.0601, 0.0462,
        0.0405, 0.0481, 0.0467, 0.0419, 0.0434, 0.0525, 0.0369, 0.0483, 0.0406,
        0.0494, 0.0293, 0.0376, 0.0439, 0.0574, 0.0455, 0.0497, 0.0450, 0.0302,
        0.0335, 0.0387, 0.0274, 0.0383, 0.0391, 0.0285, 0.0190, 0.0360, 0.0315,
        0.0272, 0.0341, 0.0231, 0.0340, 0.0173, 0.0223, 0.0249, 0.0227, 0.0155,
        0.0191, 0.0226, 0.0285, 0.0212, 0.0331, 0.0123, 0.0143, 0.0177, 0.0293,
        0.0175, 0.0276, 0.0165, 0.0407, 0.0255, 0.0173, 0.0319, 0.0229, 0.0238,
        0.0165, 0.0118, 0.0191, 0.0139, 0.0317, 0.0230, 0.0159, 0.0260, 0.0224,
        0.0219, 0.0146, 0.0135, 0.0090, 0.0187, 0.0085, 0.0150, 0.0125, 0.0143,
        0.0169, 0.0241, 0.0166, 0.0135, 0.0129, 0.0111, 0.0096, 0.0152, 0.0106,
        0.0150, 0.0092, 0.0100, 0.0132, 0.0119, 0.0103, 0.0102, 0.0097, 0.0124,
        0.0235], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.23809523809523808, middle:0.09574468085106383, tail0.0
3shot of client 1:head:0.3510848126232742, middle:0.0078125, tail0.0
3shot of client 2:head:0.31543624161073824, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.1891891891891892, middle:0.1746031746031746, tail0.0
3shot of client 4:head:0.32786885245901637, middle:0.0, tail0.0
3shot of client 5:head:0.24070450097847357, middle:0.056, tail0.0
3shot of client 6:head:0.2108843537414966, middle:0.08, tail0.0
3shot of client 7:head:0.18229166666666666, middle:0.0, tail0.0
3shot of client 8:head:0.21867881548974943, middle:0.042735042735042736, tail0.0
3shot of client 9:head:0.13147410358565736, middle:0.0, tail0.0
3shot of client 10:head:0.4022346368715084, middle:0.03488372093023256, tail0.0
3shot of client 11:head:0.42165242165242167, middle:0.0, tail0.0
3shot of client 12:head:0.34770114942528735, middle:0.03571428571428571, tail0.0
3shot of client 13:head:0.33024691358024694, middle:0.058823529411764705, tail0.0
3shot of client 14:head:0.39622641509433965, middle:0.0, tail0.0
3shot of client 15:head:0.1984126984126984, middle:0.016129032258064516, tail0.0625
3shot of client 16:head:0.22972972972972974, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.3412969283276451, middle:0.013888888888888888, tail0.0
3shot of client 18:head:0.4264705882352941, middle:0.0, tail0.058823529411764705
3shot of client 19:head:0.3400673400673401, middle:0.05, tail0.0
round 10, local average test acc  0.2294 

round 10, local macro average F1 score  0.0552 

round 10, local weighted average F1 score  0.1853 

round 10, global test acc  0.0582 

round 10, average 3shot acc: [head: 0.2920, middle: 0.0347, tail: 0.0061] 

round 10, global 3shot acc: [head: 0.2056, middle: 0.0073, tail: 0.0017] 

l_head 
  2%|▏         | 11/500 [47:53<35:23:46, 260.58s/it]
  2%|▏         | 12/500 [52:15<35:22:28, 260.96s/it]tensor([3.6273, 2.0600, 3.3931, 0.5952, 5.2408, 5.9882, 5.3048, 1.1395, 6.8913,
        1.7096, 1.8509, 6.2579, 2.5232, 1.4917, 6.1772, 3.5935, 1.4580, 1.7966,
        0.5709, 2.2468, 0.5842, 1.6129, 2.6293, 3.9079, 2.5612, 1.7048, 3.2817,
        6.3001, 0.5779, 3.3764, 1.7501, 0.5882, 1.3590, 0.5845, 5.6185, 3.2915,
        3.3155, 1.0724, 4.5003, 0.5677, 1.6021, 0.5816, 0.6064, 0.5738, 1.1614,
        2.8496, 0.5526, 0.5715, 1.7354, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        1.2679, 0.5899, 1.3695, 1.5521, 0.5932, 0.5805, 1.4298, 0.5725, 2.2395,
        0.5888, 1.1766, 2.0684, 0.5884, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 1.0299, 0.5880, 0.5720, 1.1243, 0.5771, 0.5898, 0.5736,
        0.5626, 1.9295, 0.5602, 0.5833, 0.5816, 1.1202, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 1.5393, 1.0840, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0485, 0.0653, 0.0535, 0.0396, 0.0389, 0.0410, 0.0416, 0.0515, 0.0594,
        0.0481, 0.0507, 0.0455, 0.0513, 0.0360, 0.0429, 0.0516, 0.0459, 0.0411,
        0.0660, 0.0436, 0.0508, 0.0366, 0.0410, 0.0532, 0.0474, 0.0369, 0.0321,
        0.0420, 0.0387, 0.0314, 0.0449, 0.0416, 0.0313, 0.0306, 0.0450, 0.0275,
        0.0264, 0.0441, 0.0239, 0.0256, 0.0161, 0.0296, 0.0401, 0.0225, 0.0224,
        0.0180, 0.0265, 0.0260, 0.0194, 0.0318, 0.0146, 0.0124, 0.0184, 0.0263,
        0.0160, 0.0249, 0.0168, 0.0284, 0.0348, 0.0198, 0.0342, 0.0230, 0.0204,
        0.0235, 0.0152, 0.0278, 0.0157, 0.0395, 0.0243, 0.0128, 0.0186, 0.0213,
        0.0213, 0.0186, 0.0156, 0.0101, 0.0284, 0.0080, 0.0142, 0.0115, 0.0167,
        0.0150, 0.0237, 0.0173, 0.0183, 0.0123, 0.0130, 0.0102, 0.0209, 0.0104,
        0.0188, 0.0092, 0.0139, 0.0124, 0.0168, 0.0147, 0.0091, 0.0100, 0.0136,
        0.0129], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.21693121693121692, middle:0.11702127659574468, tail0.0
3shot of client 1:head:0.3727810650887574, middle:0.015625, tail0.0
3shot of client 2:head:0.38926174496644295, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.33264033264033266, middle:0.12698412698412698, tail0.0
3shot of client 4:head:0.3176229508196721, middle:0.0, tail0.0
3shot of client 5:head:0.16634050880626222, middle:0.008, tail0.0
3shot of client 6:head:0.2653061224489796, middle:0.06666666666666667, tail0.0
3shot of client 7:head:0.16666666666666666, middle:0.10869565217391304, tail0.0
3shot of client 8:head:0.2733485193621868, middle:0.0, tail0.0
3shot of client 9:head:0.1752988047808765, middle:0.014705882352941176, tail0.0
3shot of client 10:head:0.3770949720670391, middle:0.011627906976744186, tail0.0
3shot of client 11:head:0.45014245014245013, middle:0.022727272727272728, tail0.0
3shot of client 12:head:0.3160919540229885, middle:0.10714285714285714, tail0.0
3shot of client 13:head:0.3611111111111111, middle:0.047058823529411764, tail0.0
3shot of client 14:head:0.33153638814016173, middle:0.031578947368421054, tail0.0
3shot of client 15:head:0.2261904761904762, middle:0.0, tail0.0
3shot of client 16:head:0.2533783783783784, middle:0.0, tail0.0
3shot of client 17:head:0.29692832764505117, middle:0.013888888888888888, tail0.0
3shot of client 18:head:0.4485294117647059, middle:0.04285714285714286, tail0.0
3shot of client 19:head:0.3333333333333333, middle:0.0, tail0.058823529411764705
round 11, local average test acc  0.2383 

round 11, local macro average F1 score  0.0555 

round 11, local weighted average F1 score  0.1818 

round 11, global test acc  0.0502 

round 11, average 3shot acc: [head: 0.3035, middle: 0.0374, tail: 0.0029] 

round 11, global 3shot acc: [head: 0.1652, middle: 0.0131, tail: 0.0047] 

l_head tensor([3.9238, 2.1988, 3.7496, 0.5952, 5.5252, 6.3108, 5.6624, 1.1083, 7.2870,
        1.8899, 2.0409, 6.7191, 2.8243, 1.6161, 6.5435, 3.7991, 1.4923, 2.1127,
        0.5709, 2.4609, 0.5842, 1.9287, 2.7949, 3.9975, 2.7092, 1.9205, 3.3595,
        6.7110, 0.5779, 3.5881, 1.8376, 0.5882, 1.4354, 0.5845, 6.0597, 3.5488,
        3.6526, 1.1781, 4.8436, 0.5677, 1.7546, 0.5816, 0.6064, 0.5738, 1.2022,
        3.1486, 0.5526, 0.5715, 1.8044, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        1.2798, 0.5899, 1.4934, 1.6828, 0.5932, 0.5805, 1.5950, 0.5725, 2.5038,
        0.5888, 1.3188, 2.2178, 0.5884, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 1.1062, 0.5880, 0.5720, 1.1852, 0.5771, 0.5898, 0.5736,
        0.5626, 2.0136, 0.5602, 0.5833, 0.5816, 1.2358, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 1.5635, 1.2484, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0545, 0.0448, 0.0445, 0.0401, 0.0347, 0.0456, 0.0463, 0.0549, 0.0465,
        0.0444, 0.0485, 0.0460, 0.0403, 0.0376, 0.0741, 0.0372, 0.0478, 0.0480,
        0.0589, 0.0443, 0.0511, 0.0405, 0.0652, 0.0475, 0.0528, 0.0327, 0.0308,
        0.0371, 0.0490, 0.0257, 0.0455, 0.0385, 0.0236, 0.0285, 0.0373, 0.0304,
        0.0301, 0.0394, 0.0288, 0.0381, 0.0176, 0.0318, 0.0327, 0.0292, 0.0180,
        0.0206, 0.0211, 0.0329, 0.0200, 0.0350, 0.0133, 0.0143, 0.0244, 0.0388,
        0.0146, 0.0436, 0.0204, 0.0256, 0.0373, 0.0179, 0.0330, 0.0241, 0.0216,
        0.0229, 0.0100, 0.0158, 0.0180, 0.0276, 0.0237, 0.0255, 0.0197, 0.0187,
        0.0266, 0.0199, 0.0124, 0.0136, 0.0299, 0.0098, 0.0211, 0.0144, 0.0121,
        0.0232, 0.0217, 0.0170, 0.0169, 0.0204, 0.0106, 0.0122, 0.0144, 0.0107,
        0.0162, 0.0117, 0.0124, 0.0155, 0.0201, 0.0124, 0.0111, 0.0102, 0.0121,
        0.0184], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.21957671957671956, middle:0.13829787234042554, tail0.0
3shot of client 1:head:0.3510848126232742, middle:0.109375, tail0.0
3shot of client 2:head:0.3691275167785235, middle:0.02631578947368421, tail0.0
3shot of client 3:head:0.23492723492723494, middle:0.1349206349206349, tail0.0
3shot of client 4:head:0.32991803278688525, middle:0.0, tail0.0
3shot of client 5:head:0.2465753424657534, middle:0.032, tail0.0
3shot of client 6:head:0.2925170068027211, middle:0.09333333333333334, tail0.0
3shot of client 7:head:0.15104166666666666, middle:0.021739130434782608, tail0.0

  3%|▎         | 13/500 [56:40<35:29:07, 262.31s/it]3shot of client 8:head:0.31662870159453305, middle:0.008547008547008548, tail0.07692307692307693
3shot of client 9:head:0.14342629482071714, middle:0.014705882352941176, tail0.0
3shot of client 10:head:0.39664804469273746, middle:0.011627906976744186, tail0.0
3shot of client 11:head:0.2706552706552707, middle:0.045454545454545456, tail0.0
3shot of client 12:head:0.3563218390804598, middle:0.07142857142857142, tail0.0
3shot of client 13:head:0.3487654320987654, middle:0.058823529411764705, tail0.0
3shot of client 14:head:0.4501347708894879, middle:0.021052631578947368, tail0.0
3shot of client 15:head:0.25, middle:0.04838709677419355, tail0.0625
3shot of client 16:head:0.21621621621621623, middle:0.10294117647058823, tail0.0
3shot of client 17:head:0.35494880546075086, middle:0.013888888888888888, tail0.0
3shot of client 18:head:0.27205882352941174, middle:0.08571428571428572, tail0.0
3shot of client 19:head:0.2828282828282828, middle:0.075, tail0.058823529411764705
round 12, local average test acc  0.2340 

round 12, local macro average F1 score  0.0662 

round 12, local weighted average F1 score  0.1922 

round 12, global test acc  0.0675 

round 12, average 3shot acc: [head: 0.2927, middle: 0.0557, tail: 0.0099] 

round 12, global 3shot acc: [head: 0.2011, middle: 0.0431, tail: 0.0043] 

l_head tensor([4.3438, 2.2887, 3.9193, 0.5952, 5.6979, 6.6342, 5.9286, 1.1350, 7.4064,
        1.8585, 2.2676, 7.1136, 3.1079, 1.8078, 6.9542, 4.0503, 1.7564, 2.4723,
        0.5709, 2.5343, 0.5842, 1.9058, 2.8383, 4.2468, 2.9429, 1.9644, 3.7104,
        6.9540, 0.5779, 3.8942, 1.9297, 0.5882, 1.5290, 0.5845, 6.4545, 3.6168,
        3.6991, 1.3544, 5.2489, 0.5677, 1.9795, 0.5816, 0.6064, 0.5738, 1.3071,
        3.3696, 0.5526, 0.5715, 1.8658, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        1.3438, 0.5899, 1.5320, 1.7488, 0.5932, 0.5805, 1.6596, 0.5725, 2.7343,
        0.5888, 1.4730, 2.3423, 0.5884, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 1.2135, 0.5880, 0.5720, 1.1680, 0.5771, 0.5898, 0.5736,
        0.5626, 2.1629, 0.5602, 0.5833, 0.5816, 1.2394, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 1.7357, 1.3269, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0528, 0.0539, 0.0463, 0.0480, 0.0419, 0.0435, 0.0384, 0.0579, 0.0502,
        0.0474, 0.0415, 0.0560, 0.0474, 0.0420, 0.0538, 0.0419, 0.0454, 0.0471,
        0.0712, 0.0412, 0.0421, 0.0418, 0.0500, 0.0500, 0.0500, 0.0492, 0.0309,
        0.0388, 0.0455, 0.0328, 0.0519, 0.0402, 0.0328, 0.0269, 0.0364, 0.0325,
        0.0292, 0.0440, 0.0230, 0.0308, 0.0217, 0.0402, 0.0474, 0.0257, 0.0230,
        0.0171, 0.0302, 0.0321, 0.0238, 0.0342, 0.0190, 0.0156, 0.0187, 0.0343,
        0.0220, 0.0476, 0.0150, 0.0389, 0.0282, 0.0256, 0.0365, 0.0289, 0.0230,
        0.0275, 0.0156, 0.0245, 0.0164, 0.0325, 0.0271, 0.0163, 0.0262, 0.0209,
        0.0207, 0.0266, 0.0143, 0.0149, 0.0259, 0.0090, 0.0144, 0.0135, 0.0135,
        0.0211, 0.0148, 0.0181, 0.0132, 0.0133, 0.0151, 0.0122, 0.0247, 0.0114,
        0.0203, 0.0114, 0.0117, 0.0143, 0.0216, 0.0138, 0.0112, 0.0120, 0.0114,
        0.0178], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.2804232804232804, middle:0.0425531914893617, tail0.0
3shot of client 1:head:0.32938856015779094, middle:0.015625, tail0.0
3shot of client 2:head:0.23825503355704697, middle:0.05263157894736842, tail0.0
3shot of client 3:head:0.316008316008316, middle:0.1111111111111111, tail0.0
3shot of client 4:head:0.36475409836065575, middle:0.0, tail0.0
3shot of client 5:head:0.20939334637964774, middle:0.016, tail0.0625
3shot of client 6:head:0.29591836734693877, middle:0.08, tail0.0
3shot of client 7:head:0.21354166666666666, middle:0.043478260869565216, tail0.08333333333333333
3shot of client 8:head:0.21867881548974943, middle:0.02564102564102564, tail0.07692307692307693
3shot of client 9:head:0.29880478087649404, middle:0.014705882352941176, tail0.0
3shot of client 10:head:0.41620111731843573, middle:0.011627906976744186, tail0.0
3shot of client 11:head:0.4358974358974359, middle:0.011363636363636364, tail0.0
3shot of client 12:head:0.3994252873563218, middle:0.03571428571428571, tail0.0
3shot of client 13:head:0.345679012345679, middle:0.08235294117647059, tail0.0
3shot of client 14:head:0.29649595687331537, middle:0.08421052631578947, tail0.0
3shot of client 15:head:0.3134920634920635, middle:0.11290322580645161, tail0.0
3shot of client 16:head:0.22635135135135134, middle:0.10294117647058823, tail0.0
3shot of client 17:head:0.35494880546075086, middle:0.013888888888888888, tail0.0
3shot of client 18:head:0.47058823529411764, middle:0.0, tail0.0
3shot of client 19:head:0.39057239057239057, middle:0.0875, tail0.11764705882352941
round 13, local average test acc  0.2541 

round 13, local macro average F1 score  0.0687 

round 13, local weighted average F1 score  0.2097 

round 13, global test acc  0.0782 

round 13, average 3shot acc: [head: 0.3207, middle: 0.0472, tail: 0.0170] 

round 13, global 3shot acc: [head: 0.2537, middle: 0.0362, tail: 0.0006] 

l_head tensor([4.6363, 2.5107, 4.2172, 0.5952, 6.0190, 6.9513, 6.3487, 1.3061, 7.7452,
        1.9095, 2.3799, 7.5988, 3.2833, 1.9061, 7.2589, 4.3113, 1.9010, 2.5573,
        0.5709, 2.5283, 0.5842, 2.1266, 3.0370, 4.2909, 3.2266, 2.0426, 3.9715,
        7.0640, 0.5779, 3.9557, 2.0425, 0.5882, 1.5893, 0.5845, 6.6326, 3.8186,
        3.8824, 1.3417, 5.4768, 0.5677, 2.1867, 0.5816, 0.6064, 0.5738, 1.3507,
        3.5260, 0.5526, 0.5715, 2.1860, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        1.4776, 0.5899, 1.6462, 1.9303, 0.5932, 0.5805, 1.7972, 0.5725, 2.9089,
        0.5888, 1.5386, 2.3898, 0.5884, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 1.3331, 0.5880, 0.5720, 1.2048, 0.5771, 0.5898, 0.5736,
        0.5626, 2.3253, 0.5602, 0.5833, 0.5816, 1.3458, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 1.8367, 1.4533, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux 
  3%|▎         | 14/500 [1:01:04<35:29:27, 262.90s/it]
  3%|▎         | 15/500 [1:05:30<35:31:56, 263.74s/it]tensor([0.0553, 0.0619, 0.0563, 0.0410, 0.0451, 0.0477, 0.0439, 0.0599, 0.0502,
        0.0501, 0.0582, 0.0478, 0.0486, 0.0358, 0.0517, 0.0515, 0.0460, 0.0466,
        0.0596, 0.0381, 0.0529, 0.0496, 0.0420, 0.0574, 0.0578, 0.0438, 0.0375,
        0.0382, 0.0500, 0.0351, 0.0450, 0.0436, 0.0292, 0.0326, 0.0403, 0.0262,
        0.0242, 0.0468, 0.0287, 0.0479, 0.0217, 0.0321, 0.0419, 0.0244, 0.0193,
        0.0187, 0.0301, 0.0300, 0.0245, 0.0372, 0.0168, 0.0154, 0.0281, 0.0295,
        0.0200, 0.0331, 0.0208, 0.0357, 0.0441, 0.0250, 0.0433, 0.0279, 0.0284,
        0.0209, 0.0182, 0.0322, 0.0176, 0.0402, 0.0230, 0.0207, 0.0246, 0.0261,
        0.0187, 0.0216, 0.0150, 0.0151, 0.0293, 0.0092, 0.0168, 0.0182, 0.0168,
        0.0201, 0.0262, 0.0165, 0.0173, 0.0111, 0.0171, 0.0171, 0.0181, 0.0127,
        0.0226, 0.0119, 0.0132, 0.0191, 0.0172, 0.0153, 0.0146, 0.0104, 0.0158,
        0.0290], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.25132275132275134, middle:0.2127659574468085, tail0.0
3shot of client 1:head:0.39447731755424065, middle:0.03125, tail0.0
3shot of client 2:head:0.412751677852349, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.2806652806652807, middle:0.07936507936507936, tail0.03333333333333333
3shot of client 4:head:0.3422131147540984, middle:0.034782608695652174, tail0.0
3shot of client 5:head:0.22504892367906065, middle:0.024, tail0.0
3shot of client 6:head:0.24489795918367346, middle:0.02666666666666667, tail0.0
3shot of client 7:head:0.1875, middle:0.06521739130434782, tail0.08333333333333333
3shot of client 8:head:0.28018223234624146, middle:0.008547008547008548, tail0.0
3shot of client 9:head:0.17131474103585656, middle:0.04411764705882353, tail0.0
3shot of client 10:head:0.44692737430167595, middle:0.03488372093023256, tail0.0
3shot of client 11:head:0.4472934472934473, middle:0.022727272727272728, tail0.0
3shot of client 12:head:0.367816091954023, middle:0.08333333333333333, tail0.0
3shot of client 13:head:0.41358024691358025, middle:0.08235294117647059, tail0.0
3shot of client 14:head:0.41509433962264153, middle:0.05263157894736842, tail0.041666666666666664
3shot of client 15:head:0.21031746031746032, middle:0.12903225806451613, tail0.0
3shot of client 16:head:0.40540540540540543, middle:0.029411764705882353, tail0.0
3shot of client 17:head:0.3447098976109215, middle:0.0, tail0.0
3shot of client 18:head:0.5257352941176471, middle:0.02857142857142857, tail0.0
3shot of client 19:head:0.36363636363636365, middle:0.1, tail0.058823529411764705
round 14, local average test acc  0.2674 

round 14, local macro average F1 score  0.0725 

round 14, local weighted average F1 score  0.2253 

round 14, global test acc  0.0734 

round 14, average 3shot acc: [head: 0.3365, middle: 0.0551, tail: 0.0109] 

round 14, global 3shot acc: [head: 0.2278, middle: 0.0265, tail: 0.0106] 

l_head tensor([4.7266, 2.7936, 4.2213, 0.5952, 6.1175, 7.0769, 6.4506, 1.3454, 8.0425,
        2.0998, 2.5899, 7.9649, 3.5233, 2.0894, 7.3312, 4.4881, 1.9731, 2.6618,
        0.5709, 2.7534, 0.5842, 2.2066, 3.2061, 4.5504, 3.1928, 2.3019, 4.1674,
        7.4338, 0.5779, 4.1850, 2.0691, 0.5882, 1.7499, 0.5845, 6.9589, 3.9309,
        4.1324, 1.3900, 5.6840, 0.5677, 2.4978, 0.5816, 0.6064, 0.5738, 1.3985,
        3.8634, 0.5526, 0.5715, 2.2518, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        1.5808, 0.5899, 1.7467, 1.9477, 0.5932, 0.5805, 1.8358, 0.5725, 2.9883,
        0.5888, 1.6640, 2.6272, 0.5884, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 1.4331, 0.5880, 0.5720, 1.4455, 0.5771, 0.5898, 0.5736,
        0.5626, 2.5475, 0.5602, 0.5833, 0.5816, 1.4044, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 1.9150, 1.4720, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0673, 0.0490, 0.0496, 0.0570, 0.0347, 0.0584, 0.0413, 0.0480, 0.0510,
        0.0523, 0.0415, 0.0473, 0.0571, 0.0426, 0.0524, 0.0622, 0.0468, 0.0489,
        0.0525, 0.0385, 0.0538, 0.0497, 0.0563, 0.0465, 0.0738, 0.0450, 0.0303,
        0.0452, 0.0449, 0.0334, 0.0502, 0.0341, 0.0309, 0.0277, 0.0500, 0.0318,
        0.0318, 0.0384, 0.0264, 0.0417, 0.0235, 0.0401, 0.0391, 0.0345, 0.0190,
        0.0190, 0.0293, 0.0338, 0.0237, 0.0401, 0.0170, 0.0163, 0.0276, 0.0314,
        0.0247, 0.0345, 0.0167, 0.0310, 0.0434, 0.0260, 0.0326, 0.0276, 0.0246,
        0.0247, 0.0213, 0.0460, 0.0200, 0.0639, 0.0342, 0.0198, 0.0228, 0.0274,
        0.0212, 0.0171, 0.0212, 0.0143, 0.0363, 0.0111, 0.0146, 0.0207, 0.0183,
        0.0223, 0.0217, 0.0277, 0.0154, 0.0131, 0.0149, 0.0152, 0.0239, 0.0155,
        0.0196, 0.0104, 0.0121, 0.0191, 0.0155, 0.0167, 0.0175, 0.0137, 0.0209,
        0.0252], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.2777777777777778, middle:0.14893617021276595, tail0.041666666666666664
3shot of client 1:head:0.39644970414201186, middle:0.09375, tail0.0
3shot of client 2:head:0.30201342281879195, middle:0.07894736842105263, tail0.0
3shot of client 3:head:0.34511434511434513, middle:0.10317460317460317, tail0.0
3shot of client 4:head:0.3360655737704918, middle:0.05217391304347826, tail0.0
3shot of client 5:head:0.3659491193737769, middle:0.016, tail0.09375
3shot of client 6:head:0.2687074829931973, middle:0.12, tail0.0
3shot of client 7:head:0.17708333333333334, middle:0.06521739130434782, tail0.08333333333333333
3shot of client 8:head:0.33712984054669703, middle:0.042735042735042736, tail0.07692307692307693
3shot of client 9:head:0.14741035856573706, middle:0.029411764705882353, tail0.0
3shot of client 10:head:0.29329608938547486, middle:0.05813953488372093, tail0.0
3shot of client 11:head:0.42165242165242167, middle:0.011363636363636364, tail0.043478260869565216
3shot of client 12:head:0.3936781609195402, middle:0.07142857142857142, tail0.0
3shot of client 13:head:0.38271604938271603, middle:0.09411764705882353, tail0.0
3shot of client 14:head:0.39622641509433965, middle:0.031578947368421054, tail0.0
3shot of client 15:head:0.2896825396825397, middle:0.11290322580645161, tail0.0
3shot of client 16:head:0.36486486486486486, middle:0.029411764705882353, tail0.0
3shot of client 17:head:0.3515358361774744, middle:0.013888888888888888, tail0.0
3shot of client 18:head:0.4963235294117647, middle:0.11428571428571428, tail0.0
3shot of client 19:head:0.3838383838383838, middle:0.1375, tail0.058823529411764705
round 15, local average test acc  0.2708 

round 15, local macro average F1 score  0.0833 

round 15, local weighted average F1 score  0.2316 

round 15, global test acc  0.0884 

round 15, average 3shot acc: [head: 0.3364, middle: 0.0712, tail: 0.0199] 

round 15, global 3shot acc: [head: 0.2593, middle: 0.0638, tail: 0.0038] 

l_head 
  3%|▎         | 16/500 [1:09:57<35:34:10, 264.57s/it]
  3%|▎         | 17/500 [1:14:24<35:36:10, 265.36s/it]tensor([4.8751, 2.9211, 4.3708, 0.5952, 6.4239, 7.3423, 6.8261, 1.4305, 8.2221,
        2.2433, 2.6683, 8.1559, 3.7224, 2.3108, 7.7821, 4.5578, 2.0635, 2.7645,
        0.5709, 2.8672, 0.5842, 2.4443, 3.3615, 4.6325, 3.4908, 2.4633, 4.4109,
        7.7571, 0.5779, 4.4330, 2.2112, 0.5882, 2.0177, 0.5845, 7.1192, 4.2445,
        4.2950, 1.5438, 5.9288, 0.5677, 2.7685, 0.5816, 0.6064, 0.5738, 1.4096,
        4.0100, 0.5526, 0.5715, 2.3993, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        1.6666, 0.5899, 1.8576, 2.1996, 0.5932, 0.5805, 2.0477, 0.5725, 2.9856,
        0.5888, 1.7481, 2.8165, 0.5884, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 1.5060, 0.5880, 0.5720, 1.3924, 0.5771, 0.5898, 0.5736,
        0.5626, 2.7471, 0.5602, 0.5833, 0.5816, 1.5308, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 1.9992, 1.5656, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0583, 0.0653, 0.0491, 0.0605, 0.0375, 0.0502, 0.0481, 0.0555, 0.0481,
        0.0545, 0.0506, 0.0485, 0.0613, 0.0525, 0.0548, 0.0454, 0.0588, 0.0506,
        0.0756, 0.0417, 0.0470, 0.0519, 0.0640, 0.0516, 0.0650, 0.0440, 0.0320,
        0.0351, 0.0505, 0.0335, 0.0571, 0.0406, 0.0328, 0.0324, 0.0401, 0.0405,
        0.0307, 0.0442, 0.0218, 0.0346, 0.0247, 0.0379, 0.0517, 0.0363, 0.0268,
        0.0183, 0.0289, 0.0342, 0.0321, 0.0441, 0.0177, 0.0181, 0.0240, 0.0376,
        0.0221, 0.0312, 0.0171, 0.0529, 0.0298, 0.0258, 0.0408, 0.0248, 0.0243,
        0.0279, 0.0147, 0.0263, 0.0186, 0.0442, 0.0330, 0.0197, 0.0209, 0.0327,
        0.0289, 0.0275, 0.0206, 0.0138, 0.0503, 0.0110, 0.0172, 0.0147, 0.0273,
        0.0254, 0.0197, 0.0191, 0.0238, 0.0121, 0.0175, 0.0123, 0.0241, 0.0185,
        0.0255, 0.0108, 0.0115, 0.0122, 0.0277, 0.0128, 0.0129, 0.0114, 0.0183,
        0.0209], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.30952380952380953, middle:0.13829787234042554, tail0.041666666666666664
3shot of client 1:head:0.4280078895463511, middle:0.140625, tail0.0
3shot of client 2:head:0.2751677852348993, middle:0.013157894736842105, tail0.0
3shot of client 3:head:0.37214137214137216, middle:0.15873015873015872, tail0.03333333333333333
3shot of client 4:head:0.3668032786885246, middle:0.09565217391304348, tail0.06896551724137931
3shot of client 5:head:0.34637964774951074, middle:0.008, tail0.125
3shot of client 6:head:0.2687074829931973, middle:0.14666666666666667, tail0.0
3shot of client 7:head:0.22916666666666666, middle:0.15217391304347827, tail0.08333333333333333
3shot of client 8:head:0.4715261958997722, middle:0.008547008547008548, tail0.0
3shot of client 9:head:0.23107569721115537, middle:0.04411764705882353, tail0.0
3shot of client 10:head:0.34916201117318435, middle:0.03488372093023256, tail0.0
3shot of client 11:head:0.3732193732193732, middle:0.0, tail0.08695652173913043
3shot of client 12:head:0.40804597701149425, middle:0.08333333333333333, tail0.0
3shot of client 13:head:0.39814814814814814, middle:0.1411764705882353, tail0.0
3shot of client 14:head:0.2857142857142857, middle:0.07368421052631578, tail0.0
3shot of client 15:head:0.2857142857142857, middle:0.0967741935483871, tail0.0
3shot of client 16:head:0.2635135135135135, middle:0.08823529411764706, tail0.0
3shot of client 17:head:0.34812286689419797, middle:0.08333333333333333, tail0.0
3shot of client 18:head:0.5147058823529411, middle:0.014285714285714285, tail0.0
3shot of client 19:head:0.4377104377104377, middle:0.0875, tail0.058823529411764705
round 16, local average test acc  0.2815 

round 16, local macro average F1 score  0.0892 

round 16, local weighted average F1 score  0.2412 

round 16, global test acc  0.0972 

round 16, average 3shot acc: [head: 0.3481, middle: 0.0805, tail: 0.0249] 

round 16, global 3shot acc: [head: 0.2948, middle: 0.0646, tail: 0.0017] 

l_head tensor([4.8985, 3.0514, 4.5657, 0.5952, 6.6726, 7.6897, 6.9311, 1.3840, 8.4706,
        2.3738, 2.9238, 8.5299, 3.9417, 2.4177, 8.1028, 4.7721, 2.0864, 2.8428,
        0.5709, 3.0247, 0.5842, 2.6258, 3.5908, 4.7689, 3.6383, 2.4379, 4.6180,
        8.0792, 0.5779, 4.6239, 2.3713, 0.5882, 2.0234, 0.5845, 7.3683, 4.5611,
        4.5663, 1.6426, 6.3193, 0.5677, 2.7489, 0.5816, 0.6064, 0.5738, 1.5350,
        4.2925, 0.5526, 0.5715, 2.8164, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        1.7071, 0.5899, 1.9011, 2.1970, 0.5932, 0.5805, 2.0488, 0.5725, 3.1448,
        0.5888, 1.9322, 2.9386, 0.5884, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 1.5498, 0.5880, 0.5720, 1.4753, 0.5771, 0.5898, 0.5736,
        0.5626, 3.0093, 0.5602, 0.5833, 0.5816, 1.6500, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 2.0336, 1.6172, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0714, 0.0652, 0.0528, 0.0578, 0.0409, 0.0553, 0.0471, 0.0567, 0.0588,
        0.0598, 0.0556, 0.0505, 0.0510, 0.0487, 0.0854, 0.0452, 0.0532, 0.0496,
        0.0562, 0.0443, 0.0516, 0.0468, 0.0627, 0.0649, 0.0811, 0.0425, 0.0361,
        0.0626, 0.0664, 0.0334, 0.0539, 0.0363, 0.0307, 0.0422, 0.0557, 0.0456,
        0.0391, 0.0540, 0.0402, 0.0331, 0.0204, 0.0453, 0.0479, 0.0402, 0.0218,
        0.0234, 0.0257, 0.0356, 0.0328, 0.0384, 0.0220, 0.0188, 0.0251, 0.0403,
        0.0245, 0.0315, 0.0221, 0.0412, 0.0351, 0.0318, 0.0394, 0.0227, 0.0242,
        0.0300, 0.0191, 0.0294, 0.0177, 0.0420, 0.0436, 0.0285, 0.0253, 0.0335,
        0.0279, 0.0236, 0.0170, 0.0153, 0.0334, 0.0111, 0.0162, 0.0152, 0.0190,
        0.0242, 0.0272, 0.0263, 0.0193, 0.0186, 0.0178, 0.0138, 0.0173, 0.0134,
        0.0239, 0.0147, 0.0147, 0.0148, 0.0225, 0.0207, 0.0158, 0.0109, 0.0156,
        0.0255], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.3201058201058201, middle:0.14893617021276595, tail0.0
3shot of client 1:head:0.40236686390532544, middle:0.03125, tail0.0
3shot of client 2:head:0.40939597315436244, middle:0.02631578947368421, tail0.0
3shot of client 3:head:0.28482328482328484, middle:0.2698412698412698, tail0.0
3shot of client 4:head:0.3770491803278688, middle:0.06086956521739131, tail0.0
3shot of client 5:head:0.4070450097847358, middle:0.032, tail0.09375
3shot of client 6:head:0.1598639455782313, middle:0.10666666666666667, tail0.0

  4%|▎         | 18/500 [1:18:51<35:37:06, 266.03s/it]3shot of client 7:head:0.19270833333333334, middle:0.043478260869565216, tail0.08333333333333333
3shot of client 8:head:0.36446469248291574, middle:0.03418803418803419, tail0.07692307692307693
3shot of client 9:head:0.1553784860557769, middle:0.029411764705882353, tail0.0
3shot of client 10:head:0.3463687150837989, middle:0.023255813953488372, tail0.0
3shot of client 11:head:0.3732193732193732, middle:0.09090909090909091, tail0.0
3shot of client 12:head:0.3936781609195402, middle:0.08333333333333333, tail0.0
3shot of client 13:head:0.4783950617283951, middle:0.09411764705882353, tail0.05
3shot of client 14:head:0.48247978436657685, middle:0.021052631578947368, tail0.041666666666666664
3shot of client 15:head:0.3611111111111111, middle:0.06451612903225806, tail0.0
3shot of client 16:head:0.36486486486486486, middle:0.029411764705882353, tail0.0
3shot of client 17:head:0.4197952218430034, middle:0.08333333333333333, tail0.0
3shot of client 18:head:0.5110294117647058, middle:0.04285714285714286, tail0.058823529411764705
3shot of client 19:head:0.3872053872053872, middle:0.15, tail0.0
round 17, local average test acc  0.2890 

round 17, local macro average F1 score  0.0949 

round 17, local weighted average F1 score  0.2499 

round 17, global test acc  0.0938 

round 17, average 3shot acc: [head: 0.3596, middle: 0.0733, tail: 0.0202] 

round 17, global 3shot acc: [head: 0.3274, middle: 0.0208, tail: 0.0000] 

l_head tensor([5.1514, 3.1483, 4.6207, 0.5952, 7.0369, 8.0266, 7.4124, 1.4672, 8.5855,
        2.4433, 3.0062, 8.7929, 4.1967, 2.5814, 8.2985, 4.9221, 2.2455, 3.1210,
        0.5709, 3.2470, 0.5842, 2.7986, 3.7536, 5.0644, 3.5096, 2.7054, 4.9574,
        8.3427, 0.5779, 4.8470, 2.6761, 0.5882, 2.1367, 0.5845, 7.6088, 4.7681,
        4.7810, 1.6155, 6.4468, 0.5677, 2.9096, 0.5816, 0.6064, 0.5738, 1.5794,
        4.5440, 0.5526, 0.5715, 2.9139, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        1.8227, 0.5899, 2.0503, 2.3983, 0.5932, 0.5805, 2.1903, 0.5725, 3.3583,
        0.5888, 1.8608, 3.1097, 0.5884, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 1.6203, 0.5880, 0.5720, 1.5753, 0.5771, 0.5898, 0.5736,
        0.5626, 3.1318, 0.5602, 0.5833, 0.5816, 1.8063, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 2.2486, 1.6698, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0610, 0.0656, 0.0646, 0.0577, 0.0476, 0.0515, 0.0475, 0.0456, 0.0596,
        0.0512, 0.0549, 0.0616, 0.0492, 0.0634, 0.0487, 0.0665, 0.0545, 0.0598,
        0.0775, 0.0398, 0.0633, 0.0510, 0.0479, 0.0549, 0.0591, 0.0540, 0.0330,
        0.0452, 0.0418, 0.0390, 0.0470, 0.0551, 0.0370, 0.0379, 0.0430, 0.0432,
        0.0326, 0.0590, 0.0282, 0.0405, 0.0197, 0.0482, 0.0613, 0.0279, 0.0234,
        0.0245, 0.0328, 0.0324, 0.0385, 0.0396, 0.0199, 0.0156, 0.0283, 0.0350,
        0.0239, 0.0371, 0.0245, 0.0513, 0.0472, 0.0286, 0.0470, 0.0327, 0.0259,
        0.0335, 0.0193, 0.0316, 0.0232, 0.0554, 0.0352, 0.0168, 0.0260, 0.0332,
        0.0271, 0.0275, 0.0176, 0.0215, 0.0303, 0.0095, 0.0156, 0.0157, 0.0162,
        0.0253, 0.0266, 0.0216, 0.0155, 0.0163, 0.0148, 0.0205, 0.0230, 0.0152,
        0.0260, 0.0142, 0.0183, 0.0184, 0.0245, 0.0240, 0.0166, 0.0175, 0.0211,
        0.0248], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.24338624338624337, middle:0.10638297872340426, tail0.125
3shot of client 1:head:0.4181459566074951, middle:0.0625, tail0.0
3shot of client 2:head:0.3959731543624161, middle:0.039473684210526314, tail0.0
3shot of client 3:head:0.38461538461538464, middle:0.1349206349206349, tail0.03333333333333333
3shot of client 4:head:0.4405737704918033, middle:0.06956521739130435, tail0.0
3shot of client 5:head:0.30724070450097846, middle:0.072, tail0.0
3shot of client 6:head:0.3401360544217687, middle:0.05333333333333334, tail0.05263157894736842
3shot of client 7:head:0.2864583333333333, middle:0.08695652173913043, tail0.0
3shot of client 8:head:0.37585421412300685, middle:0.03418803418803419, tail0.11538461538461539
3shot of client 9:head:0.2788844621513944, middle:0.08823529411764706, tail0.06666666666666667
3shot of client 10:head:0.4245810055865922, middle:0.09302325581395349, tail0.045454545454545456
3shot of client 11:head:0.33618233618233617, middle:0.056818181818181816, tail0.0
3shot of client 12:head:0.40804597701149425, middle:0.09523809523809523, tail0.0
3shot of client 13:head:0.36419753086419754, middle:0.11764705882352941, tail0.05
3shot of client 14:head:0.3908355795148248, middle:0.09473684210526316, tail0.0
3shot of client 15:head:0.28174603174603174, middle:0.0967741935483871, tail0.0
3shot of client 16:head:0.3952702702702703, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.36177474402730375, middle:0.013888888888888888, tail0.0
3shot of client 18:head:0.4632352941176471, middle:0.07142857142857142, tail0.0
3shot of client 19:head:0.4511784511784512, middle:0.1375, tail0.058823529411764705
round 18, local average test acc  0.2959 

round 18, local macro average F1 score  0.0963 

round 18, local weighted average F1 score  0.2521 

round 18, global test acc  0.0960 

round 18, average 3shot acc: [head: 0.3674, middle: 0.0770, tail: 0.0274] 

round 18, global 3shot acc: [head: 0.2878, middle: 0.0696, tail: 0.0004] 

l_head tensor([5.2334, 3.3793, 4.8639, 0.5952, 7.2051, 8.2907, 7.6095, 1.6822, 8.9415,
        2.6191, 3.3409, 9.0958, 4.4042, 2.6733, 8.7428, 5.2450, 2.5101, 3.2054,
        0.5709, 3.5092, 0.5842, 3.1507, 4.0103, 5.3094, 3.6141, 2.7752, 5.1114,
        8.7566, 0.5779, 5.0906, 2.5681, 0.5882, 2.2804, 0.5845, 7.8763, 5.1027,
        4.9484, 1.7221, 6.7409, 0.5677, 3.0174, 0.5816, 0.6064, 0.5738, 1.6283,
        4.7317, 0.5526, 0.5715, 3.0451, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        1.9246, 0.5899, 2.2130, 2.5627, 0.5932, 0.5805, 2.2566, 0.5725, 3.5702,
        0.5888, 1.9173, 3.3619, 0.5884, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 1.6657, 0.5880, 0.5720, 1.5760, 0.5771, 0.5898, 0.5736,
        0.5626, 3.4052, 0.5602, 0.5833, 0.5816, 1.8191, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 2.4346, 1.8437, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux 
  4%|▍         | 19/500 [1:23:21<35:42:08, 267.21s/it]
  4%|▍         | 20/500 [1:27:52<35:45:40, 268.21s/it]tensor([0.0649, 0.0595, 0.0541, 0.0507, 0.0467, 0.0482, 0.0700, 0.0537, 0.0620,
        0.0573, 0.0467, 0.0585, 0.0508, 0.0494, 0.0701, 0.0488, 0.0641, 0.0493,
        0.0796, 0.0707, 0.0510, 0.0531, 0.0493, 0.0701, 0.0788, 0.0363, 0.0371,
        0.0657, 0.0572, 0.0415, 0.0555, 0.0478, 0.0356, 0.0388, 0.0672, 0.0352,
        0.0363, 0.0520, 0.0384, 0.0441, 0.0240, 0.0416, 0.0551, 0.0329, 0.0268,
        0.0254, 0.0325, 0.0491, 0.0361, 0.0416, 0.0239, 0.0173, 0.0255, 0.0485,
        0.0239, 0.0292, 0.0231, 0.0381, 0.0382, 0.0296, 0.0397, 0.0333, 0.0330,
        0.0399, 0.0172, 0.0327, 0.0314, 0.0453, 0.0344, 0.0280, 0.0205, 0.0316,
        0.0471, 0.0232, 0.0174, 0.0227, 0.0340, 0.0140, 0.0230, 0.0194, 0.0187,
        0.0245, 0.0254, 0.0178, 0.0197, 0.0208, 0.0141, 0.0165, 0.0272, 0.0114,
        0.0230, 0.0125, 0.0167, 0.0198, 0.0306, 0.0191, 0.0167, 0.0097, 0.0245,
        0.0159], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.3915343915343915, middle:0.11702127659574468, tail0.125
3shot of client 1:head:0.4516765285996055, middle:0.1484375, tail0.0
3shot of client 2:head:0.436241610738255, middle:0.09210526315789473, tail0.05555555555555555
3shot of client 3:head:0.41995841995842, middle:0.1111111111111111, tail0.06666666666666667
3shot of client 4:head:0.444672131147541, middle:0.05217391304347826, tail0.034482758620689655
3shot of client 5:head:0.32289628180039137, middle:0.032, tail0.125
3shot of client 6:head:0.2687074829931973, middle:0.10666666666666667, tail0.0
3shot of client 7:head:0.2552083333333333, middle:0.08695652173913043, tail0.0
3shot of client 8:head:0.38496583143507973, middle:0.05982905982905983, tail0.07692307692307693
3shot of client 9:head:0.17928286852589642, middle:0.10294117647058823, tail0.0
3shot of client 10:head:0.34916201117318435, middle:0.12790697674418605, tail0.0
3shot of client 11:head:0.4985754985754986, middle:0.045454545454545456, tail0.0
3shot of client 12:head:0.4339080459770115, middle:0.07142857142857142, tail0.09523809523809523
3shot of client 13:head:0.4537037037037037, middle:0.08235294117647059, tail0.0
3shot of client 14:head:0.20754716981132076, middle:0.11578947368421053, tail0.041666666666666664
3shot of client 15:head:0.30952380952380953, middle:0.12903225806451613, tail0.0
3shot of client 16:head:0.3310810810810811, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.33447098976109213, middle:0.041666666666666664, tail0.0
3shot of client 18:head:0.6102941176470589, middle:0.07142857142857142, tail0.0
3shot of client 19:head:0.4107744107744108, middle:0.15, tail0.0
round 19, local average test acc  0.3037 

round 19, local macro average F1 score  0.1041 

round 19, local weighted average F1 score  0.2671 

round 19, global test acc  0.1024 

round 19, average 3shot acc: [head: 0.3747, middle: 0.0880, tail: 0.0310] 

round 19, global 3shot acc: [head: 0.2663, middle: 0.1000, tail: 0.0096] 

l_head tensor([5.4472, 3.6656, 5.1091, 0.5952, 7.4442, 8.4915, 7.7829, 1.6915, 9.2808,
        2.6739, 3.6211, 9.4159, 4.4176, 2.9263, 9.1685, 5.4753, 2.4965, 3.4623,
        0.5709, 3.7890, 0.5842, 3.2874, 4.0350, 5.5848, 3.6792, 2.9304, 5.3201,
        9.0110, 0.5779, 5.3120, 2.6064, 0.5882, 2.2213, 0.5845, 8.1823, 5.2422,
        5.1247, 1.9111, 6.8488, 0.5677, 2.9730, 0.5816, 0.6064, 0.5738, 1.8634,
        4.9959, 0.5526, 0.5715, 3.4743, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        1.9971, 0.5899, 2.4474, 2.6773, 0.5932, 0.5805, 2.4616, 0.5725, 3.6471,
        0.5888, 2.0755, 3.5305, 0.5884, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 1.7882, 0.5880, 0.5720, 1.7246, 0.5771, 0.5898, 0.5736,
        0.5626, 3.5978, 0.5602, 0.5833, 0.5816, 1.8722, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 2.4719, 1.8576, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0792, 0.0637, 0.0508, 0.0527, 0.0462, 0.0582, 0.0480, 0.0539, 0.0501,
        0.0525, 0.0531, 0.0497, 0.0538, 0.0489, 0.0567, 0.0659, 0.0577, 0.0672,
        0.0612, 0.0585, 0.0513, 0.0665, 0.0545, 0.0591, 0.0826, 0.0424, 0.0366,
        0.0553, 0.0475, 0.0392, 0.0697, 0.0389, 0.0467, 0.0357, 0.0519, 0.0365,
        0.0418, 0.0527, 0.0334, 0.0523, 0.0270, 0.0533, 0.0561, 0.0333, 0.0242,
        0.0263, 0.0428, 0.0438, 0.0350, 0.0418, 0.0247, 0.0184, 0.0306, 0.0424,
        0.0262, 0.0360, 0.0291, 0.0440, 0.0374, 0.0387, 0.0403, 0.0347, 0.0302,
        0.0349, 0.0211, 0.0509, 0.0241, 0.0747, 0.0385, 0.0261, 0.0249, 0.0326,
        0.0383, 0.0307, 0.0229, 0.0194, 0.0415, 0.0134, 0.0252, 0.0217, 0.0200,
        0.0226, 0.0288, 0.0231, 0.0218, 0.0196, 0.0172, 0.0203, 0.0284, 0.0180,
        0.0304, 0.0121, 0.0146, 0.0207, 0.0295, 0.0241, 0.0207, 0.0141, 0.0293,
        0.0248], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.3835978835978836, middle:0.14893617021276595, tail0.08333333333333333
3shot of client 1:head:0.41420118343195267, middle:0.15625, tail0.0
3shot of client 2:head:0.4395973154362416, middle:0.10526315789473684, tail0.0
3shot of client 3:head:0.4386694386694387, middle:0.23015873015873015, tail0.0
3shot of client 4:head:0.4918032786885246, middle:0.034782608695652174, tail0.0
3shot of client 5:head:0.30724070450097846, middle:0.024, tail0.0625
3shot of client 6:head:0.29591836734693877, middle:0.08, tail0.0
3shot of client 7:head:0.203125, middle:0.08695652173913043, tail0.08333333333333333
3shot of client 8:head:0.3917995444191344, middle:0.03418803418803419, tail0.11538461538461539
3shot of client 9:head:0.3386454183266932, middle:0.10294117647058823, tail0.06666666666666667
3shot of client 10:head:0.30446927374301674, middle:0.06976744186046512, tail0.0
3shot of client 11:head:0.37037037037037035, middle:0.13636363636363635, tail0.08695652173913043
3shot of client 12:head:0.47988505747126436, middle:0.13095238095238096, tail0.0
3shot of client 13:head:0.4783950617283951, middle:0.10588235294117647, tail0.05
3shot of client 14:head:0.42857142857142855, middle:0.05263157894736842, tail0.0
3shot of client 15:head:0.2619047619047619, middle:0.12903225806451613, tail0.0625
3shot of client 16:head:0.28378378378378377, middle:0.22058823529411764, tail0.0
3shot of client 17:head:0.378839590443686, middle:0.041666666666666664, tail0.0
3shot of client 18:head:0.5294117647058824, middle:0.12857142857142856, tail0.0
3shot of client 19:head:0.4882154882154882, middle:0.1125, tail0.0
round 20, local average test acc  0.3152 

round 20, local macro average F1 score  0.1097 

round 20, local weighted average F1 score  0.2742 

round 20, global test acc  0.1131 

round 20, average 3shot acc: [head: 0.3854, middle: 0.1066, tail: 0.0305] 

round 20, global 3shot acc: [head: 0.3222, middle: 0.0831, tail: 0.0096] 

l_head 
  4%|▍         | 21/500 [1:32:25<35:52:11, 269.59s/it]
  4%|▍         | 22/500 [1:36:59<36:00:17, 271.17s/it]tensor([5.5175, 4.1207, 5.2318, 0.5952, 7.6834, 8.6531, 8.0115, 1.7312, 9.5713,
        2.8090, 3.6908, 9.8664, 4.6358, 2.9358, 9.5230, 5.6743, 2.5914, 3.7689,
        0.5709, 3.8820, 0.5842, 3.4202, 4.3535, 5.9422, 3.9770, 3.0802, 5.5434,
        9.0775, 0.5779, 5.4959, 2.7277, 0.5882, 2.3635, 0.5845, 8.3614, 5.5035,
        5.3433, 1.9179, 7.1054, 0.5677, 3.0771, 0.5816, 0.6064, 0.5738, 1.8137,
        5.1729, 0.5526, 0.5715, 3.4798, 0.5812, 0.5685, 0.5647, 0.5684, 0.5907,
        2.1173, 0.5899, 2.5739, 2.7451, 0.5932, 0.5805, 2.5928, 0.5725, 3.6677,
        0.5888, 2.2797, 3.5432, 0.5884, 0.5852, 0.5940, 0.5859, 0.5820, 0.5943,
        0.5836, 0.5873, 1.8015, 0.5880, 0.5720, 1.7797, 0.5771, 0.5898, 0.5736,
        0.5626, 3.7423, 0.5602, 0.5833, 0.5816, 1.9713, 0.5983, 0.5671, 0.5803,
        0.5966, 0.5718, 0.5854, 0.6018, 0.5545, 2.5775, 2.0006, 0.5684, 0.5987,
        0.5868], device='cuda:1', grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0637, 0.0618, 0.0508, 0.0608, 0.0463, 0.0588, 0.0609, 0.0730, 0.0524,
        0.0702, 0.0538, 0.0582, 0.0588, 0.0643, 0.0641, 0.0515, 0.0685, 0.0562,
        0.0584, 0.0618, 0.0683, 0.0691, 0.0481, 0.0589, 0.0947, 0.0555, 0.0353,
        0.0377, 0.0645, 0.0352, 0.0677, 0.0525, 0.0371, 0.0352, 0.0446, 0.0521,
        0.0343, 0.0483, 0.0299, 0.0490, 0.0302, 0.0433, 0.0396, 0.0376, 0.0217,
        0.0242, 0.0368, 0.0438, 0.0376, 0.0387, 0.0241, 0.0217, 0.0353, 0.0478,
        0.0274, 0.0533, 0.0302, 0.0573, 0.0410, 0.0247, 0.0396, 0.0386, 0.0289,
        0.0259, 0.0196, 0.0348, 0.0292, 0.0464, 0.0448, 0.0255, 0.0253, 0.0358,
        0.0383, 0.0271, 0.0176, 0.0219, 0.0384, 0.0150, 0.0213, 0.0221, 0.0190,
        0.0269, 0.0242, 0.0199, 0.0207, 0.0178, 0.0175, 0.0202, 0.0263, 0.0163,
        0.0188, 0.0172, 0.0144, 0.0209, 0.0233, 0.0183, 0.0185, 0.0192, 0.0231,
        0.0249], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.35185185185185186, middle:0.2127659574468085, tail0.041666666666666664
3shot of client 1:head:0.33727810650887574, middle:0.171875, tail0.0
3shot of client 2:head:0.4597315436241611, middle:0.07894736842105263, tail0.05555555555555555
3shot of client 3:head:0.34511434511434513, middle:0.23015873015873015, tail0.0
3shot of client 4:head:0.46311475409836067, middle:0.09565217391304348, tail0.0
3shot of client 5:head:0.4207436399217221, middle:0.016, tail0.09375
3shot of client 6:head:0.30952380952380953, middle:0.09333333333333334, tail0.05263157894736842
3shot of client 7:head:0.3072916666666667, middle:0.17391304347826086, tail0.0
3shot of client 8:head:0.3895216400911162, middle:0.05982905982905983, tail0.07692307692307693
3shot of client 9:head:0.30677290836653387, middle:0.1323529411764706, tail0.0
3shot of client 10:head:0.45251396648044695, middle:0.05813953488372093, tail0.0
3shot of client 11:head:0.358974358974359, middle:0.045454545454545456, tail0.08695652173913043
3shot of client 12:head:0.4827586206896552, middle:0.17857142857142858, tail0.0
3shot of client 13:head:0.30246913580246915, middle:0.07058823529411765, tail0.15
3shot of client 14:head:0.29380053908355797, middle:0.11578947368421053, tail0.041666666666666664
3shot of client 15:head:0.32142857142857145, middle:0.16129032258064516, tail0.0
3shot of client 16:head:0.3581081081081081, middle:0.014705882352941176, tail0.0
3shot of client 17:head:0.41638225255972694, middle:0.09722222222222222, tail0.058823529411764705
3shot of client 18:head:0.48161764705882354, middle:0.05714285714285714, tail0.0
3shot of client 19:head:0.38047138047138046, middle:0.2125, tail0.058823529411764705
round 21, local average test acc  0.3108 

round 21, local macro average F1 score  0.1156 

round 21, local weighted average F1 score  0.2786 

round 21, global test acc  0.1093 

round 21, average 3shot acc: [head: 0.3770, middle: 0.1138, tail: 0.0358] 

round 21, global 3shot acc: [head: 0.2952, middle: 0.0727, tail: 0.0228] 

l_head tensor([ 5.6811,  4.1953,  5.4101,  0.5952,  7.7043,  8.8299,  8.1493,  1.6332,
         9.7729,  3.0637,  3.9910, 10.0574,  5.0352,  3.0644,  9.5921,  5.9625,
         2.7168,  3.7369,  0.5709,  4.0608,  0.5842,  3.4059,  4.2799,  6.0397,
         4.0913,  3.0783,  5.6874,  9.2313,  0.5779,  5.6399,  2.9962,  0.5882,
         2.5434,  0.5845,  8.4223,  5.7095,  5.7422,  1.9966,  7.3924,  0.5677,
         3.2893,  0.5816,  0.6064,  0.5738,  1.9473,  5.4056,  0.5526,  0.5715,
         3.6972,  0.5812,  0.5685,  0.5647,  0.5684,  0.5907,  2.2286,  0.5899,
         2.6052,  2.8256,  0.5932,  0.5805,  2.8343,  0.5725,  3.8067,  0.5888,
         2.2265,  3.7187,  0.5884,  0.5852,  0.5940,  0.5859,  0.5820,  0.5943,
         0.5836,  0.5873,  1.9089,  0.5880,  0.5720,  1.8384,  0.5771,  0.5898,
         0.5736,  0.5626,  3.9738,  0.5602,  0.5833,  0.5816,  2.0835,  0.5983,
         0.5671,  0.5803,  0.5966,  0.5718,  0.5854,  0.6018,  0.5545,  2.6255,
         2.0178,  0.5684,  0.5987,  0.5868], device='cuda:1',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0755, 0.0728, 0.0618, 0.0654, 0.0525, 0.0574, 0.0491, 0.0597, 0.0606,
        0.0619, 0.0578, 0.0570, 0.0620, 0.0537, 0.0652, 0.0603, 0.0540, 0.0638,
        0.0770, 0.0453, 0.0666, 0.0532, 0.0773, 0.0667, 0.0627, 0.0568, 0.0359,
        0.0412, 0.0514, 0.0417, 0.0526, 0.0516, 0.0520, 0.0453, 0.0462, 0.0421,
        0.0499, 0.0577, 0.0307, 0.0464, 0.0312, 0.0480, 0.0653, 0.0457, 0.0315,
        0.0238, 0.0332, 0.0448, 0.0400, 0.0540, 0.0195, 0.0251, 0.0332, 0.0369,
        0.0290, 0.0499, 0.0244, 0.0435, 0.0464, 0.0338, 0.0557, 0.0342, 0.0327,
        0.0352, 0.0186, 0.0315, 0.0290, 0.0555, 0.0381, 0.0250, 0.0388, 0.0321,
        0.0288, 0.0260, 0.0252, 0.0215, 0.0619, 0.0161, 0.0257, 0.0206, 0.0342,
        0.0355, 0.0264, 0.0243, 0.0302, 0.0175, 0.0152, 0.0211, 0.0290, 0.0191,
        0.0283, 0.0155, 0.0177, 0.0179, 0.0289, 0.0180, 0.0191, 0.0163, 0.0194,
        0.0373], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.3888888888888889, middle:0.13829787234042554, tail0.0
3shot of client 1:head:0.41222879684418146, middle:0.21875, tail0.0
3shot of client 2:head:0.40604026845637586, middle:0.07894736842105263, tail0.16666666666666666
3shot of client 3:head:0.33264033264033266, middle:0.30952380952380953, tail0.0

  5%|▍         | 23/500 [1:41:34<36:03:14, 272.11s/it]3shot of client 4:head:0.4610655737704918, middle:0.11304347826086956, tail0.034482758620689655
3shot of client 5:head:0.40313111545988256, middle:0.04, tail0.0625
3shot of client 6:head:0.282312925170068, middle:0.16, tail0.0
3shot of client 7:head:0.3177083333333333, middle:0.08695652173913043, tail0.0
3shot of client 8:head:0.48291571753986334, middle:0.02564102564102564, tail0.07692307692307693
3shot of client 9:head:0.30677290836653387, middle:0.07352941176470588, tail0.0
3shot of client 10:head:0.441340782122905, middle:0.05813953488372093, tail0.0
3shot of client 11:head:0.4928774928774929, middle:0.03409090909090909, tail0.0
3shot of client 12:head:0.4827586206896552, middle:0.10714285714285714, tail0.0
3shot of client 13:head:0.43209876543209874, middle:0.1411764705882353, tail0.0
3shot of client 14:head:0.4636118598382749, middle:0.11578947368421053, tail0.08333333333333333
3shot of client 15:head:0.36904761904761907, middle:0.22580645161290322, tail0.0
3shot of client 16:head:0.40878378378378377, middle:0.058823529411764705, tail0.0
3shot of client 17:head:0.37542662116040953, middle:0.1388888888888889, tail0.0
3shot of client 18:head:0.46691176470588236, middle:0.14285714285714285, tail0.058823529411764705
3shot of client 19:head:0.4377104377104377, middle:0.1375, tail0.11764705882352941
round 22, local average test acc  0.3354 

round 22, local macro average F1 score  0.1231 

round 22, local weighted average F1 score  0.3044 

round 22, global test acc  0.1056 

round 22, average 3shot acc: [head: 0.4082, middle: 0.1202, tail: 0.0300] 

round 22, global 3shot acc: [head: 0.3200, middle: 0.0708, tail: 0.0017] 

l_head tensor([ 5.6416,  4.5050,  5.7990,  0.5952,  7.7108,  9.1490,  8.4315,  1.9165,
        10.0142,  3.1444,  4.0596, 10.4146,  5.2078,  3.1469,  9.5560,  6.3140,
         2.8948,  3.9367,  0.5709,  4.2270,  0.5842,  3.6214,  4.3972,  6.1553,
         4.2164,  3.2531,  5.8874,  9.4060,  0.5779,  5.8877,  2.9903,  0.5882,
         2.7143,  0.5845,  8.6971,  5.9499,  5.7027,  2.1323,  7.6102,  0.5677,
         3.3562,  0.5816,  0.6064,  0.5738,  1.8348,  5.6476,  0.5526,  0.5715,
         4.0357,  0.5812,  0.5685,  0.5647,  0.5684,  0.5907,  2.2610,  0.5899,
         2.6529,  3.0909,  0.5932,  0.5805,  2.9813,  0.5725,  3.9034,  0.5888,
         2.3666,  3.8570,  0.5884,  0.5852,  0.5940,  0.5859,  0.5820,  0.5943,
         0.5836,  0.5873,  2.0228,  0.5880,  0.5720,  1.8622,  0.5771,  0.5898,
         0.5736,  0.5626,  4.3358,  0.5602,  0.5833,  0.5816,  2.2099,  0.5983,
         0.5671,  0.5803,  0.5966,  0.5718,  0.5854,  0.6018,  0.5545,  2.7359,
         2.2291,  0.5684,  0.5987,  0.5868], device='cuda:1',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0734, 0.0750, 0.0691, 0.0543, 0.0522, 0.0512, 0.0693, 0.0655, 0.0748,
        0.0605, 0.0578, 0.0603, 0.0537, 0.0531, 0.0649, 0.0502, 0.0632, 0.0679,
        0.0797, 0.0670, 0.0596, 0.0540, 0.0880, 0.0808, 0.0718, 0.0505, 0.0379,
        0.0520, 0.0548, 0.0430, 0.0663, 0.0499, 0.0406, 0.0501, 0.0488, 0.0334,
        0.0552, 0.0576, 0.0321, 0.0400, 0.0296, 0.0660, 0.0737, 0.0344, 0.0327,
        0.0266, 0.0337, 0.0512, 0.0378, 0.0446, 0.0290, 0.0217, 0.0328, 0.0465,
        0.0322, 0.0435, 0.0228, 0.0368, 0.0440, 0.0489, 0.0448, 0.0369, 0.0302,
        0.0347, 0.0212, 0.0251, 0.0351, 0.0345, 0.0397, 0.0264, 0.0298, 0.0295,
        0.0480, 0.0263, 0.0211, 0.0216, 0.0460, 0.0156, 0.0248, 0.0209, 0.0270,
        0.0276, 0.0296, 0.0194, 0.0267, 0.0225, 0.0218, 0.0279, 0.0340, 0.0194,
        0.0332, 0.0175, 0.0166, 0.0175, 0.0331, 0.0226, 0.0210, 0.0133, 0.0240,
        0.0248], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.3201058201058201, middle:0.18085106382978725, tail0.125
3shot of client 1:head:0.3767258382642998, middle:0.1484375, tail0.0
3shot of client 2:head:0.42953020134228187, middle:0.14473684210526316, tail0.1111111111111111
3shot of client 3:head:0.3659043659043659, middle:0.3253968253968254, tail0.06666666666666667
3shot of client 4:head:0.4344262295081967, middle:0.06956521739130435, tail0.0
3shot of client 5:head:0.3776908023483366, middle:0.056, tail0.125
3shot of client 6:head:0.3401360544217687, middle:0.12, tail0.05263157894736842
3shot of client 7:head:0.24479166666666666, middle:0.13043478260869565, tail0.0
3shot of client 8:head:0.4009111617312073, middle:0.1111111111111111, tail0.07692307692307693
3shot of client 9:head:0.3187250996015936, middle:0.1323529411764706, tail0.0
3shot of client 10:head:0.42178770949720673, middle:0.08139534883720931, tail0.0
3shot of client 11:head:0.5441595441595442, middle:0.045454545454545456, tail0.0
3shot of client 12:head:0.5, middle:0.08333333333333333, tail0.09523809523809523
3shot of client 13:head:0.5092592592592593, middle:0.1411764705882353, tail0.05
3shot of client 14:head:0.477088948787062, middle:0.11578947368421053, tail0.08333333333333333
3shot of client 15:head:0.26587301587301587, middle:0.1935483870967742, tail0.0
3shot of client 16:head:0.36824324324324326, middle:0.058823529411764705, tail0.05555555555555555
3shot of client 17:head:0.39590443686006827, middle:0.06944444444444445, tail0.0
3shot of client 18:head:0.5625, middle:0.15714285714285714, tail0.11764705882352941
3shot of client 19:head:0.48484848484848486, middle:0.1375, tail0.0
round 23, local average test acc  0.3362 

round 23, local macro average F1 score  0.1304 

round 23, local weighted average F1 score  0.3052 

round 23, global test acc  0.1153 

round 23, average 3shot acc: [head: 0.4069, middle: 0.1251, tail: 0.0480] 

round 23, global 3shot acc: [head: 0.3463, middle: 0.0665, tail: 0.0096] 

l_head tensor([ 5.9654,  4.6240,  5.7937,  0.5952,  7.8621,  9.4428,  8.7566,  1.8276,
        10.2211,  3.4033,  4.2019, 10.8565,  5.3877,  3.2265,  9.7585,  6.4635,
         2.9855,  4.2291,  0.5709,  4.3002,  0.5842,  3.8906,  4.5366,  6.3778,
         4.4577,  3.4167,  6.2697,  9.5820,  0.5779,  6.0184,  3.0887,  0.5882,
         2.8478,  0.5845,  8.8806,  6.1851,  6.0015,  2.1736,  7.8368,  0.5677,
         3.3597,  0.5816,  0.6064,  0.5738,  1.8962,  5.8583,  0.5526,  0.5715,
         4.1560,  0.5812,  0.5685,  0.5647,  0.5684,  0.5907,  2.3121,  0.5899,
         2.8313,  3.2572,  0.5932,  0.5805,  3.2078,  0.5725,  4.0547,  0.5888,
         2.5523,  3.9591,  0.5884,  0.5852,  0.5940,  0.5859,  0.5820,  0.5943,
         0.5836,  0.5873,  1.9253,  0.5880,  0.5720,  1.8699,  0.5771,  0.5898,
         0.5736,  0.5626,  4.5964,  0.5602,  0.5833,  0.5816,  2.1552,  0.5983,
         0.5671,  0.5803,  0.5966,  0.5718,  0.5854,  0.6018,  0.5545,  2.9443,
         2.3077,  0.5684,  0.5987,  0.5868], device='cuda:1',
       grad_fn=<NormBackward1>)
g_head 
  5%|▍         | 24/500 [1:46:08<36:03:48, 272.75s/it]
  5%|▌         | 25/500 [1:50:43<36:04:53, 273.46s/it]tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0844, 0.0611, 0.0638, 0.0629, 0.0466, 0.0739, 0.0618, 0.0594, 0.0634,
        0.0615, 0.0484, 0.0559, 0.0543, 0.0517, 0.0771, 0.0676, 0.0759, 0.0665,
        0.0633, 0.0686, 0.0723, 0.0579, 0.0670, 0.0506, 0.0683, 0.0419, 0.0331,
        0.0730, 0.0636, 0.0350, 0.0635, 0.0612, 0.0455, 0.0363, 0.0682, 0.0413,
        0.0394, 0.0405, 0.0465, 0.0470, 0.0324, 0.0551, 0.0489, 0.0461, 0.0267,
        0.0321, 0.0358, 0.0465, 0.0449, 0.0532, 0.0269, 0.0266, 0.0398, 0.0518,
        0.0281, 0.0645, 0.0296, 0.0386, 0.0513, 0.0469, 0.0476, 0.0332, 0.0375,
        0.0364, 0.0235, 0.0386, 0.0309, 0.0539, 0.0442, 0.0317, 0.0291, 0.0329,
        0.0354, 0.0251, 0.0215, 0.0237, 0.0414, 0.0134, 0.0201, 0.0222, 0.0183,
        0.0400, 0.0343, 0.0337, 0.0215, 0.0200, 0.0186, 0.0222, 0.0221, 0.0114,
        0.0243, 0.0152, 0.0218, 0.0205, 0.0276, 0.0253, 0.0182, 0.0167, 0.0281,
        0.0387], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.3941798941798942, middle:0.1702127659574468, tail0.041666666666666664
3shot of client 1:head:0.4378698224852071, middle:0.203125, tail0.0
3shot of client 2:head:0.47651006711409394, middle:0.09210526315789473, tail0.1111111111111111
3shot of client 3:head:0.35550935550935553, middle:0.24603174603174602, tail0.13333333333333333
3shot of client 4:head:0.48360655737704916, middle:0.11304347826086956, tail0.034482758620689655
3shot of client 5:head:0.3913894324853229, middle:0.056, tail0.09375
3shot of client 6:head:0.35714285714285715, middle:0.09333333333333334, tail0.0
3shot of client 7:head:0.3072916666666667, middle:0.13043478260869565, tail0.16666666666666666
3shot of client 8:head:0.39863325740318906, middle:0.10256410256410256, tail0.038461538461538464
3shot of client 9:head:0.32270916334661354, middle:0.10294117647058823, tail0.06666666666666667
3shot of client 10:head:0.48324022346368717, middle:0.06976744186046512, tail0.045454545454545456
3shot of client 11:head:0.43874643874643876, middle:0.056818181818181816, tail0.0
3shot of client 12:head:0.5, middle:0.13095238095238096, tail0.09523809523809523
3shot of client 13:head:0.5401234567901234, middle:0.16470588235294117, tail0.1
3shot of client 14:head:0.3557951482479784, middle:0.05263157894736842, tail0.125
3shot of client 15:head:0.32142857142857145, middle:0.16129032258064516, tail0.0625
3shot of client 16:head:0.30405405405405406, middle:0.1323529411764706, tail0.05555555555555555
3shot of client 17:head:0.3924914675767918, middle:0.16666666666666666, tail0.11764705882352941
3shot of client 18:head:0.5367647058823529, middle:0.1, tail0.11764705882352941
3shot of client 19:head:0.38047138047138046, middle:0.2625, tail0.058823529411764705
round 24, local average test acc  0.3399 

round 24, local macro average F1 score  0.1353 

round 24, local weighted average F1 score  0.3066 

round 24, global test acc  0.1178 

round 24, average 3shot acc: [head: 0.4089, middle: 0.1304, tail: 0.0732] 

round 24, global 3shot acc: [head: 0.3056, middle: 0.1150, tail: 0.0115] 

l_head tensor([ 6.0400,  4.8325,  5.9238,  0.5952,  8.2138,  9.7303,  8.9624,  1.9398,
        10.3660,  3.4798,  4.4938, 11.3525,  5.3588,  3.4513,  9.9939,  6.5974,
         3.2232,  4.4990,  0.5709,  4.4816,  0.5842,  3.9346,  4.7792,  6.4616,
         4.7124,  3.5446,  6.4834,  9.7791,  0.5779,  6.2350,  3.3422,  0.5882,
         3.0546,  0.5845,  9.1370,  6.5512,  6.3966,  2.2437,  8.0750,  0.5677,
         3.3870,  0.5816,  0.6064,  0.5738,  1.9629,  5.9815,  0.5526,  0.5715,
         4.0875,  0.5812,  0.5685,  0.5647,  0.5684,  0.5907,  2.3574,  0.5899,
         2.8301,  3.3409,  0.5932,  0.5805,  3.3560,  0.5725,  4.1149,  0.5888,
         2.5978,  4.1867,  0.5884,  0.5852,  0.5940,  0.5859,  0.5820,  0.5943,
         0.5836,  0.5873,  1.9825,  0.5880,  0.5720,  1.9332,  0.5771,  0.5898,
         0.5736,  0.5626,  4.7025,  0.5602,  0.5833,  0.5816,  2.3093,  0.5983,
         0.5671,  0.5803,  0.5966,  0.5718,  0.5854,  0.6018,  0.5545,  2.9786,
         2.3204,  0.5684,  0.5987,  0.5868], device='cuda:1',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0801, 0.0691, 0.0653, 0.0521, 0.0520, 0.0619, 0.0603, 0.0830, 0.0574,
        0.0621, 0.0659, 0.0476, 0.0568, 0.0554, 0.0785, 0.0676, 0.0615, 0.0714,
        0.0551, 0.0525, 0.0713, 0.0618, 0.0785, 0.0752, 0.0607, 0.0484, 0.0495,
        0.0569, 0.0564, 0.0397, 0.0547, 0.0682, 0.0534, 0.0537, 0.0519, 0.0453,
        0.0476, 0.0709, 0.0377, 0.0566, 0.0308, 0.0538, 0.0432, 0.0374, 0.0257,
        0.0325, 0.0459, 0.0516, 0.0515, 0.0553, 0.0277, 0.0260, 0.0380, 0.0434,
        0.0306, 0.0394, 0.0300, 0.0421, 0.0571, 0.0397, 0.0616, 0.0345, 0.0440,
        0.0266, 0.0225, 0.0440, 0.0245, 0.0685, 0.0329, 0.0330, 0.0270, 0.0376,
        0.0327, 0.0229, 0.0234, 0.0219, 0.0386, 0.0149, 0.0268, 0.0210, 0.0224,
        0.0370, 0.0265, 0.0183, 0.0260, 0.0229, 0.0210, 0.0180, 0.0226, 0.0181,
        0.0229, 0.0175, 0.0168, 0.0209, 0.0304, 0.0246, 0.0164, 0.0138, 0.0269,
        0.0289], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.37566137566137564, middle:0.19148936170212766, tail0.041666666666666664
3shot of client 1:head:0.4437869822485207, middle:0.140625, tail0.0
3shot of client 2:head:0.33557046979865773, middle:0.21052631578947367, tail0.16666666666666666
3shot of client 3:head:0.42411642411642414, middle:0.20634920634920634, tail0.03333333333333333
3shot of client 4:head:0.42827868852459017, middle:0.1391304347826087, tail0.06896551724137931
3shot of client 5:head:0.5322896281800391, middle:0.024, tail0.09375
3shot of client 6:head:0.3197278911564626, middle:0.14666666666666667, tail0.05263157894736842
3shot of client 7:head:0.3541666666666667, middle:0.15217391304347827, tail0.08333333333333333
3shot of client 8:head:0.4715261958997722, middle:0.02564102564102564, tail0.038461538461538464
3shot of client 9:head:0.2908366533864542, middle:0.11764705882352941, tail0.0
3shot of client 10:head:0.5363128491620112, middle:0.10465116279069768, tail0.0
3shot of client 11:head:0.22507122507122507, middle:0.11363636363636363, tail0.13043478260869565
3shot of client 12:head:0.4109195402298851, middle:0.13095238095238096, tail0.09523809523809523
3shot of client 13:head:0.4506172839506173, middle:0.12941176470588237, tail0.15

  5%|▌         | 26/500 [1:55:20<36:08:09, 274.45s/it]3shot of client 14:head:0.4366576819407008, middle:0.042105263157894736, tail0.041666666666666664
3shot of client 15:head:0.3333333333333333, middle:0.25806451612903225, tail0.0625
3shot of client 16:head:0.31756756756756754, middle:0.20588235294117646, tail0.05555555555555555
3shot of client 17:head:0.4334470989761092, middle:0.06944444444444445, tail0.058823529411764705
3shot of client 18:head:0.5625, middle:0.05714285714285714, tail0.058823529411764705
3shot of client 19:head:0.48484848484848486, middle:0.2, tail0.11764705882352941
round 25, local average test acc  0.3396 

round 25, local macro average F1 score  0.1379 

round 25, local weighted average F1 score  0.3097 

round 25, global test acc  0.1277 

round 25, average 3shot acc: [head: 0.4084, middle: 0.1333, tail: 0.0675] 

round 25, global 3shot acc: [head: 0.3015, middle: 0.1188, tail: 0.0328] 

l_head tensor([ 6.2432,  4.9139,  5.9894,  0.5952,  8.2755, 10.0683,  9.1415,  2.0434,
        10.3894,  3.4588,  4.8895, 11.6256,  5.4448,  3.6683, 10.2081,  6.8611,
         3.4259,  4.5268,  0.5709,  4.7949,  0.5842,  4.0700,  4.8739,  6.7602,
         4.6042,  3.7502,  6.7207,  9.9476,  0.5779,  6.4818,  3.4739,  0.5882,
         3.1028,  0.5845,  9.3279,  6.7539,  6.4816,  2.5145,  8.0650,  0.5677,
         3.5441,  0.5816,  0.6064,  0.5738,  2.2112,  6.1360,  0.5526,  0.5715,
         4.1942,  0.5812,  0.5685,  0.5647,  0.5684,  0.5907,  2.3775,  0.5899,
         3.0653,  3.3763,  0.5932,  0.5805,  3.4004,  0.5725,  4.3685,  0.5888,
         2.6440,  4.3608,  0.5884,  0.5852,  0.5940,  0.5859,  0.5820,  0.5943,
         0.5836,  0.5873,  2.1138,  0.5880,  0.5720,  2.0646,  0.5771,  0.5898,
         0.5736,  0.5626,  4.8074,  0.5602,  0.5833,  0.5816,  2.3075,  0.5983,
         0.5671,  0.5803,  0.5966,  0.5718,  0.5854,  0.6018,  0.5545,  3.1224,
         2.4592,  0.5684,  0.5987,  0.5868], device='cuda:1',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.0844, 0.0769, 0.0632, 0.0551, 0.0573, 0.0653, 0.0539, 0.0647, 0.0608,
        0.0632, 0.0660, 0.0603, 0.0616, 0.0649, 0.0633, 0.0676, 0.0554, 0.0704,
        0.0820, 0.0569, 0.0735, 0.0723, 0.0736, 0.0663, 0.0695, 0.0559, 0.0442,
        0.0476, 0.0566, 0.0477, 0.0602, 0.0604, 0.0557, 0.0465, 0.0514, 0.0416,
        0.0516, 0.0683, 0.0370, 0.0639, 0.0304, 0.0612, 0.0676, 0.0360, 0.0333,
        0.0317, 0.0479, 0.0500, 0.0487, 0.0500, 0.0304, 0.0218, 0.0378, 0.0493,
        0.0349, 0.0477, 0.0353, 0.0427, 0.0457, 0.0503, 0.0534, 0.0454, 0.0312,
        0.0369, 0.0216, 0.0415, 0.0299, 0.0635, 0.0397, 0.0324, 0.0347, 0.0404,
        0.0308, 0.0337, 0.0229, 0.0257, 0.0436, 0.0160, 0.0253, 0.0270, 0.0233,
        0.0268, 0.0353, 0.0233, 0.0242, 0.0270, 0.0208, 0.0307, 0.0349, 0.0177,
        0.0357, 0.0200, 0.0163, 0.0230, 0.0343, 0.0271, 0.0159, 0.0177, 0.0234,
        0.0421], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.4365079365079365, middle:0.1702127659574468, tail0.08333333333333333
3shot of client 1:head:0.42209072978303747, middle:0.1484375, tail0.0
3shot of client 2:head:0.37583892617449666, middle:0.17105263157894737, tail0.0
3shot of client 3:head:0.43451143451143454, middle:0.23015873015873015, tail0.0
3shot of client 4:head:0.4713114754098361, middle:0.14782608695652175, tail0.10344827586206896
3shot of client 5:head:0.5166340508806262, middle:0.072, tail0.09375
3shot of client 6:head:0.3673469387755102, middle:0.21333333333333335, tail0.05263157894736842
3shot of client 7:head:0.28125, middle:0.17391304347826086, tail0.08333333333333333
3shot of client 8:head:0.5079726651480638, middle:0.05982905982905983, tail0.11538461538461539
3shot of client 9:head:0.398406374501992, middle:0.1323529411764706, tail0.0
3shot of client 10:head:0.4273743016759777, middle:0.1511627906976744, tail0.0
3shot of client 11:head:0.49572649572649574, middle:0.045454545454545456, tail0.08695652173913043
3shot of client 12:head:0.5172413793103449, middle:0.07142857142857142, tail0.14285714285714285
3shot of client 13:head:0.4382716049382716, middle:0.17647058823529413, tail0.0
3shot of client 14:head:0.33153638814016173, middle:0.07368421052631578, tail0.041666666666666664
3shot of client 15:head:0.28174603174603174, middle:0.11290322580645161, tail0.0
3shot of client 16:head:0.3952702702702703, middle:0.23529411764705882, tail0.05555555555555555
3shot of client 17:head:0.46075085324232085, middle:0.08333333333333333, tail0.0
3shot of client 18:head:0.5257352941176471, middle:0.2571428571428571, tail0.11764705882352941
3shot of client 19:head:0.5084175084175084, middle:0.1125, tail0.11764705882352941
round 26, local average test acc  0.3569 

round 26, local macro average F1 score  0.1475 

round 26, local weighted average F1 score  0.3321 

round 26, global test acc  0.1393 

round 26, average 3shot acc: [head: 0.4297, middle: 0.1419, tail: 0.0547] 

round 26, global 3shot acc: [head: 0.3619, middle: 0.1519, tail: 0.0045] 

l_head tensor([ 6.3103,  4.9272,  6.2428,  0.5952,  8.4907, 10.2070,  9.2816,  2.2325,
        10.5324,  3.6109,  5.0863, 11.8968,  5.7143,  3.8865, 10.4721,  7.1471,
         3.4720,  4.5890,  0.5709,  4.8388,  0.5842,  4.2623,  4.9356,  6.8240,
         4.9114,  3.9727,  6.9991, 10.3042,  0.5779,  6.6112,  3.6469,  0.5882,
         3.1037,  0.5845,  9.4475,  6.9869,  6.7492,  2.5140,  8.3003,  0.5677,
         3.4414,  0.5816,  0.6064,  0.5738,  2.3926,  6.2050,  0.5526,  0.5715,
         4.4943,  0.5812,  0.5685,  0.5647,  0.5684,  0.5907,  2.3744,  0.5899,
         3.1341,  3.6041,  0.5932,  0.5805,  3.5073,  0.5725,  4.4627,  0.5888,
         2.7214,  4.4998,  0.5884,  0.5852,  0.5940,  0.5859,  0.5820,  0.5943,
         0.5836,  0.5873,  2.3090,  0.5880,  0.5720,  2.1973,  0.5771,  0.5898,
         0.5736,  0.5626,  4.8724,  0.5602,  0.5833,  0.5816,  2.4056,  0.5983,
         0.5671,  0.5803,  0.5966,  0.5718,  0.5854,  0.6018,  0.5545,  3.1160,
         2.5634,  0.5684,  0.5987,  0.5868], device='cuda:1',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux   5%|▌         | 27/500 [1:59:57<36:09:36, 275.22s/it]  6%|▌         | 28/500 [2:04:33<36:06:31, 275.41s/it]tensor([0.0818, 0.0650, 0.0543, 0.0552, 0.0497, 0.0581, 0.0748, 0.0859, 0.0645,
        0.0715, 0.0574, 0.0613, 0.0626, 0.0611, 0.0913, 0.0580, 0.0764, 0.0809,
        0.0623, 0.0755, 0.0684, 0.0734, 0.0820, 0.0790, 0.0726, 0.0494, 0.0517,
        0.0624, 0.0636, 0.0426, 0.0598, 0.0493, 0.0513, 0.0416, 0.0658, 0.0404,
        0.0595, 0.0686, 0.0479, 0.0579, 0.0332, 0.0530, 0.0585, 0.0347, 0.0293,
        0.0283, 0.0530, 0.0673, 0.0505, 0.0510, 0.0347, 0.0272, 0.0351, 0.0775,
        0.0312, 0.0477, 0.0313, 0.0460, 0.0339, 0.0443, 0.0472, 0.0538, 0.0432,
        0.0353, 0.0234, 0.0364, 0.0371, 0.0558, 0.0383, 0.0432, 0.0317, 0.0371,
        0.0572, 0.0229, 0.0277, 0.0256, 0.0401, 0.0180, 0.0329, 0.0353, 0.0265,
        0.0239, 0.0278, 0.0172, 0.0309, 0.0271, 0.0242, 0.0174, 0.0354, 0.0209,
        0.0259, 0.0211, 0.0186, 0.0273, 0.0326, 0.0247, 0.0235, 0.0147, 0.0417,
        0.0239], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.37037037037037035, middle:0.18085106382978725, tail0.041666666666666664
3shot of client 1:head:0.48520710059171596, middle:0.1796875, tail0.0
3shot of client 2:head:0.3288590604026846, middle:0.19736842105263158, tail0.1111111111111111
3shot of client 3:head:0.40540540540540543, middle:0.25396825396825395, tail0.03333333333333333
3shot of client 4:head:0.41598360655737704, middle:0.1391304347826087, tail0.0
3shot of client 5:head:0.44227005870841485, middle:0.152, tail0.1875
3shot of client 6:head:0.2585034013605442, middle:0.22666666666666666, tail0.05263157894736842
3shot of client 7:head:0.3697916666666667, middle:0.1956521739130435, tail0.16666666666666666
3shot of client 8:head:0.4054669703872437, middle:0.08547008547008547, tail0.07692307692307693
3shot of client 9:head:0.450199203187251, middle:0.058823529411764705, tail0.0
3shot of client 10:head:0.40782122905027934, middle:0.11627906976744186, tail0.045454545454545456
3shot of client 11:head:0.46153846153846156, middle:0.09090909090909091, tail0.13043478260869565
3shot of client 12:head:0.49137931034482757, middle:0.13095238095238096, tail0.09523809523809523
3shot of client 13:head:0.3611111111111111, middle:0.12941176470588237, tail0.1
3shot of client 14:head:0.33692722371967654, middle:0.11578947368421053, tail0.041666666666666664
3shot of client 15:head:0.3492063492063492, middle:0.2903225806451613, tail0.0
3shot of client 16:head:0.3310810810810811, middle:0.2647058823529412, tail0.0
3shot of client 17:head:0.4300341296928328, middle:0.18055555555555555, tail0.058823529411764705
3shot of client 18:head:0.5845588235294118, middle:0.08571428571428572, tail0.17647058823529413
3shot of client 19:head:0.30303030303030304, middle:0.175, tail0.17647058823529413
round 27, local average test acc  0.3386 

round 27, local macro average F1 score  0.1475 

round 27, local weighted average F1 score  0.3215 

round 27, global test acc  0.1384 

round 27, average 3shot acc: [head: 0.3994, middle: 0.1625, tail: 0.0747] 

round 27, global 3shot acc: [head: 0.3926, middle: 0.0992, tail: 0.0140] 

l_head tensor([ 6.5631,  5.1149,  6.4831,  0.5952,  8.6280, 10.2259,  9.5821,  2.1757,
        10.7520,  3.6373,  5.2948, 12.2329,  5.8233,  3.9789, 10.6482,  7.4339,
         3.4467,  4.7377,  0.5709,  5.1635,  0.5842,  4.4917,  4.9828,  6.9421,
         5.2291,  4.0612,  7.1615, 10.5469,  0.5779,  6.9026,  3.7353,  0.5882,
         3.4146,  0.5845,  9.6224,  7.1192,  6.8663,  2.6416,  8.5843,  0.5677,
         3.6938,  0.5816,  0.6064,  0.5738,  2.3579,  6.4986,  0.5526,  0.5715,
         4.5162,  0.5812,  0.5685,  0.5647,  0.5684,  0.5907,  2.5570,  0.5899,
         3.3245,  3.8647,  0.5932,  0.5805,  3.7051,  0.5725,  4.8068,  0.5888,
         3.0126,  4.6175,  0.5884,  0.5852,  0.5940,  0.5859,  0.5820,  0.5943,
         0.5836,  0.5873,  2.3890,  0.5880,  0.5720,  2.2960,  0.5771,  0.5898,
         0.5736,  0.5626,  4.9678,  0.5602,  0.5833,  0.5816,  2.5079,  0.5983,
         0.5671,  0.5803,  0.5966,  0.5718,  0.5854,  0.6018,  0.5545,  3.3418,
         2.6956,  0.5684,  0.5987,  0.5868], device='cuda:1',
       grad_fn=<NormBackward1>)
g_head tensor([0.1401, 0.1417, 0.1388, 0.1372, 0.1430, 0.1484, 0.1573, 0.1249, 0.1588,
        0.1501, 0.1527, 0.1575, 0.1418, 0.1238, 0.1448, 0.1446, 0.1551, 0.1356,
        0.1306, 0.1304, 0.1396, 0.1420, 0.1450, 0.1526, 0.1339, 0.1364, 0.1562,
        0.1390, 0.1510, 0.1439, 0.1459, 0.1505, 0.1436, 0.1430, 0.1449, 0.1314,
        0.1374, 0.1443, 0.1412, 0.1486, 0.1478, 0.1388, 0.1500, 0.1490, 0.1448,
        0.1389, 0.1614, 0.1439, 0.1379, 0.1434, 0.1425, 0.1440, 0.1373, 0.1400,
        0.1310, 0.1424, 0.1345, 0.1476, 0.1399, 0.1288, 0.1430, 0.1464, 0.1326,
        0.1625, 0.1446, 0.1301, 0.1509, 0.1458, 0.1331, 0.1383, 0.1479, 0.1391,
        0.1421, 0.1418, 0.1420, 0.1380, 0.1311, 0.1392, 0.1471, 0.1498, 0.1400,
        0.1290, 0.1306, 0.1511, 0.1363, 0.1428, 0.1470, 0.1408, 0.1589, 0.1460,
        0.1493, 0.1420, 0.1426, 0.1447, 0.1432, 0.1477, 0.1278, 0.1327, 0.1265,
        0.1383], device='cuda:1', grad_fn=<NormBackward1>)
g_aux tensor([0.1031, 0.0674, 0.0716, 0.0675, 0.0568, 0.0723, 0.0675, 0.0743, 0.0690,
        0.0679, 0.0771, 0.0640, 0.0619, 0.0623, 0.1076, 0.0753, 0.0595, 0.0728,
        0.0667, 0.0612, 0.0807, 0.0755, 0.0673, 0.0732, 0.0757, 0.0624, 0.0395,
        0.0577, 0.0806, 0.0539, 0.0766, 0.0535, 0.0475, 0.0503, 0.0573, 0.0457,
        0.0471, 0.0591, 0.0510, 0.0658, 0.0336, 0.0710, 0.0597, 0.0443, 0.0330,
        0.0367, 0.0429, 0.0466, 0.0443, 0.0510, 0.0307, 0.0300, 0.0444, 0.0561,
        0.0375, 0.0491, 0.0346, 0.0411, 0.0646, 0.0460, 0.0435, 0.0438, 0.0341,
        0.0311, 0.0224, 0.0489, 0.0324, 0.0583, 0.0405, 0.0497, 0.0455, 0.0433,
        0.0314, 0.0321, 0.0295, 0.0242, 0.0418, 0.0140, 0.0225, 0.0297, 0.0257,
        0.0290, 0.0379, 0.0301, 0.0278, 0.0247, 0.0263, 0.0317, 0.0292, 0.0191,
        0.0255, 0.0252, 0.0157, 0.0251, 0.0280, 0.0293, 0.0249, 0.0132, 0.0317,
        0.0437], device='cuda:1', grad_fn=<NormBackward1>)
3shot of client 0:head:0.42063492063492064, middle:0.24468085106382978, tail0.125
3shot of client 1:head:0.3668639053254438, middle:0.1875, tail0.0
3shot of client 2:head:0.4228187919463087, middle:0.23684210526315788, tail0.2777777777777778
3shot of client 3:head:0.37214137214137216, middle:0.2619047619047619, tail0.1
3shot of client 4:head:0.5717213114754098, middle:0.1565217391304348, tail0.034482758620689655
3shot of client 5:head:0.49706457925636005, middle:0.08, tail0.09375
3shot of client 6:head:0.2619047619047619, middle:0.18666666666666668, tail0.10526315789473684
3shot of client 7:head:0.34375, middle:0.13043478260869565, tail0.0
3shot of client 8:head:0.5034168564920274, middle:0.07692307692307693, tail0.07692307692307693
3shot of client 9:head:0.41434262948207173, middle:0.14705882352941177, tail0.06666666666666667
3shot of client 10:head:0.441340782122905, middle:0.1744186046511628, tail0.045454545454545456
3shot of client 11:head:0.4444444444444444, middle:0.09090909090909091, tail0.043478260869565216
3shot of client 12:head:0.5660919540229885, middle:0.17857142857142858, tail0.047619047619047616
3shot of client 13:head:0.3549382716049383, middle:0.27058823529411763, tail0.15
3shot of client 14:head:0.5256064690026954, middle:0.12631578947368421, tail0.0
3shot of client 15:head:0.42857142857142855, middle:0.2903225806451613, tail0.0625
3shot of client 16:head:0.4358108108108108, middle:0.20588235294117646, tail0.0
3shot of client 17:head:0.5187713310580204, middle:0.09722222222222222, tail0.0
3shot of client 18:head:0.5882352941176471, middle:0.17142857142857143, tail0.0
3shot of client 19:head:0.5521885521885522, middle:0.2, tail0.11764705882352941
round 28, local average test acc  0.3808 

round 28, local macro average F1 score  0.1635 

round 28, local weighted average F1 score  0.3620 

round 28, global test acc  0.1510 

round 28, average 3shot acc: [head: 0.4515, middle: 0.1757, tail: 0.0673] 

round 28, global 3shot acc: [head: 0.4522, middle: 0.1023, tail: 0.0049] 

l_head   6%|▌         | 29/500 [2:09:12<36:10:06, 276.45s/it]